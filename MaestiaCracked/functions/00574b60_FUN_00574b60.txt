PROGRAM  : Maestia.exe
FUNCTION : FUN_00574b60
ENTRY    : 00574b60
BODY     : [[00574b60, 00574d0d]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00574b60(GRefCountNTSImpl *param_1,int *param_2)

{
  int iVar1;
  GRefCountImpl *this;
  uint uVar2;
  GRefCountImpl *pGVar3;
  int *piVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  int *in_ECX;
  float10 fVar8;
  GRefCountNTSImpl *local_3c;
  int *local_38;
  undefined4 uStack_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  undefined4 uStack_8;
  
  uVar2 = 0;
  if (in_ECX[0x18] != 0) {
    piVar4 = (int *)in_ECX[0x17];
    do {
      if ((int)param_1 <= *piVar4) {
        if ((GRefCountNTSImpl *)((int *)in_ECX[0x17])[uVar2 * 2] == param_1) {
          return 0;
        }
        break;
      }
      uVar2 = uVar2 + 1;
      piVar4 = piVar4 + 2;
    } while (uVar2 < (uint)in_ECX[0x18]);
  }
  in_ECX[0x2c0] = in_ECX[0x2c0] | 0x100;
  local_3c = param_1;
  if (param_2 != (int *)0x0) {
    param_2[1] = param_2[1] + 1;
  }
  local_38 = param_2;
  FUN_00574760(uVar2,&local_3c);
  (**(code **)(*param_2 + 0x158))(param_1);
  if (param_1 == (GRefCountNTSImpl *)0x0) {
    in_ECX[0x1a] = (int)param_2;
    pGVar3 = (GRefCountImpl *)(**(code **)(*param_2 + 0x48))();
    if (pGVar3 != (GRefCountImpl *)0x0) {
      GRefCountImpl::AddRef(pGVar3);
    }
    if (in_ECX[0x1b] != 0) {
      FUN_00524240();
    }
    in_ECX[0x1b] = (int)pGVar3;
    iVar1 = in_ECX[0x40];
    pGVar3 = *(GRefCountImpl **)(pGVar3 + 0x10);
    if (pGVar3 != (GRefCountImpl *)0x0) {
      GRefCountImpl::AddRef(pGVar3);
    }
    this = *(GRefCountImpl **)(iVar1 + 0x14);
    if (this != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this);
    }
    *(GRefCountImpl **)(iVar1 + 0x14) = pGVar3;
    fVar8 = (float10)(**(code **)(*(int *)in_ECX[0x1b] + 0x24))();
    in_ECX[0x4f] = (int)(float)((float10)1 / fVar8);
    if ((*(byte *)(in_ECX + 0x2c0) & 1) == 0) {
      piVar4 = (int *)(**(code **)(*param_2 + 0x48))();
      (**(code **)(*piVar4 + 0x1c))();
      uVar5 = FUN_0063b380();
      (**(code **)(*piVar4 + 0x18))();
      uVar6 = FUN_0063b380();
      (**(code **)(*piVar4 + 0x1c))();
      uVar7 = FUN_0063b380();
      (**(code **)(*piVar4 + 0x18))();
      local_38 = (int *)FUN_0063b380();
      uStack_c = 0x3f800000;
      uStack_10 = 0x3f800000;
      uStack_30 = 0;
      uStack_2c = 0;
      uStack_8 = 0;
      uStack_14 = 0;
      uStack_18 = 0;
      uStack_1c = 0;
      uStack_20 = 0;
      uStack_34 = uVar7;
      uStack_28 = uVar6;
      uStack_24 = uVar5;
      (**(code **)(*in_ECX + 100))(&local_38);
    }
  }
  in_ECX[0x2c0] = in_ECX[0x2c0] | 0x80;
  if (local_3c != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(local_3c);
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00574b60 : SUB ESP,0x3c
00574b63 : PUSH EBX
00574b64 : MOV EBX,dword ptr [ESP + 0x44]
00574b68 : PUSH ESI
00574b69 : MOV ESI,ECX
00574b6b : XOR EAX,EAX
00574b6d : CMP dword ptr [ESI + 0x60],EAX
00574b70 : JBE 0x00574b88
00574b72 : MOV EDX,dword ptr [ESI + 0x5c]
00574b75 : MOV ECX,EDX
00574b77 : CMP dword ptr [ECX],EBX
00574b79 : JGE 0x00574cfb
00574b7f : INC EAX
00574b80 : ADD ECX,0x8
00574b83 : CMP EAX,dword ptr [ESI + 0x60]
00574b86 : JC 0x00574b77
00574b88 : OR dword ptr [ESI + 0xb00],0x100
00574b92 : PUSH EDI
00574b93 : MOV EDI,dword ptr [ESP + 0x50]
00574b97 : MOV dword ptr [ESP + 0x10],0x0
00574b9f : MOV dword ptr [ESP + 0xc],EBX
00574ba3 : TEST EDI,EDI
00574ba5 : JZ 0x00574baa
00574ba7 : INC dword ptr [EDI + 0x4]
00574baa : LEA ECX,[ESP + 0xc]
00574bae : PUSH ECX
00574baf : PUSH EAX
00574bb0 : LEA ECX,[ESI + 0x5c]
00574bb3 : MOV dword ptr [ESP + 0x18],EDI
00574bb7 : CALL 0x00574760
00574bbc : MOV EDX,dword ptr [EDI]
00574bbe : MOV EAX,dword ptr [EDX + 0x158]
00574bc4 : PUSH EBX
00574bc5 : MOV ECX,EDI
00574bc7 : CALL EAX
00574bc9 : TEST EBX,EBX
00574bcb : JNZ 0x00574cd9
00574bd1 : MOV dword ptr [ESI + 0x68],EDI
00574bd4 : MOV EDX,dword ptr [EDI]
00574bd6 : MOV EAX,dword ptr [EDX + 0x48]
00574bd9 : MOV ECX,EDI
00574bdb : CALL EAX
00574bdd : MOV EBX,EAX
00574bdf : TEST EBX,EBX
00574be1 : JZ 0x00574bea
00574be3 : MOV ECX,EBX
00574be5 : CALL 0x00523dd0
00574bea : MOV ECX,dword ptr [ESI + 0x6c]
00574bed : TEST ECX,ECX
00574bef : JZ 0x00574bf6
00574bf1 : CALL 0x00524240
00574bf6 : PUSH EBP
00574bf7 : MOV dword ptr [ESI + 0x6c],EBX
00574bfa : MOV EBP,dword ptr [ESI + 0x100]
00574c00 : MOV ECX,EBX
00574c02 : MOV EBX,dword ptr [ECX + 0x10]
00574c05 : ADD EBP,0x14
00574c08 : TEST EBX,EBX
00574c0a : JZ 0x00574c13
00574c0c : MOV ECX,EBX
00574c0e : CALL 0x00523dd0
00574c13 : MOV ECX,dword ptr [EBP]
00574c16 : TEST ECX,ECX
00574c18 : JZ 0x00574c1f
00574c1a : CALL 0x004ff7e0
00574c1f : MOV dword ptr [EBP],EBX
00574c22 : MOV ECX,dword ptr [ESI + 0x6c]
00574c25 : MOV EDX,dword ptr [ECX]
00574c27 : MOV EAX,dword ptr [EDX + 0x24]
00574c2a : CALL EAX
00574c2c : FLD1
00574c2e : TEST byte ptr [ESI + 0xb00],0x1
00574c35 : FDIVRP
00574c37 : FSTP float ptr [ESI + 0x13c]
00574c3d : JNZ 0x00574cd8
00574c43 : MOV EDX,dword ptr [EDI]
00574c45 : MOV EAX,dword ptr [EDX + 0x48]
00574c48 : MOV ECX,EDI
00574c4a : CALL EAX
00574c4c : MOV EDI,EAX
00574c4e : MOV EDX,dword ptr [EDI]
00574c50 : MOV EAX,dword ptr [EDX + 0x1c]
00574c53 : MOV ECX,EDI
00574c55 : CALL EAX
00574c57 : CALL 0x0063b380
00574c5c : MOV EDX,dword ptr [EDI]
00574c5e : MOV EBP,EAX
00574c60 : MOV EAX,dword ptr [EDX + 0x18]
00574c63 : MOV ECX,EDI
00574c65 : CALL EAX
00574c67 : CALL 0x0063b380
00574c6c : MOV EDX,dword ptr [EDI]
00574c6e : MOV EBX,EAX
00574c70 : MOV EAX,dword ptr [EDX + 0x1c]
00574c73 : MOV ECX,EDI
00574c75 : CALL EAX
00574c77 : CALL 0x0063b380
00574c7c : MOV EDX,dword ptr [EDI]
00574c7e : MOV dword ptr [ESP + 0x50],EAX
00574c82 : MOV EAX,dword ptr [EDX + 0x18]
00574c85 : MOV ECX,EDI
00574c87 : CALL EAX
00574c89 : CALL 0x0063b380
00574c8e : FLD1
00574c90 : MOV ECX,dword ptr [ESP + 0x50]
00574c94 : FST float ptr [ESP + 0x44]
00574c98 : MOV EDX,dword ptr [ESI]
00574c9a : FSTP float ptr [ESP + 0x40]
00574c9e : MOV EDX,dword ptr [EDX + 0x64]
00574ca1 : MOV dword ptr [ESP + 0x18],EAX
00574ca5 : XOR EAX,EAX
00574ca7 : MOV dword ptr [ESP + 0x20],EAX
00574cab : MOV dword ptr [ESP + 0x24],EAX
00574caf : MOV dword ptr [ESP + 0x48],EAX
00574cb3 : MOV dword ptr [ESP + 0x3c],EAX
00574cb7 : MOV dword ptr [ESP + 0x38],EAX
00574cbb : MOV dword ptr [ESP + 0x34],EAX
00574cbf : MOV dword ptr [ESP + 0x30],EAX
00574cc3 : LEA EAX,[ESP + 0x18]
00574cc7 : MOV dword ptr [ESP + 0x1c],ECX
00574ccb : PUSH EAX
00574ccc : MOV ECX,ESI
00574cce : MOV dword ptr [ESP + 0x2c],EBX
00574cd2 : MOV dword ptr [ESP + 0x30],EBP
00574cd6 : CALL EDX
00574cd8 : POP EBP
00574cd9 : MOV ECX,dword ptr [ESP + 0x10]
00574cdd : OR dword ptr [ESI + 0xb00],0x80
00574ce7 : POP EDI
00574ce8 : TEST ECX,ECX
00574cea : JZ 0x00574cf1
00574cec : CALL 0x004ff7c0
00574cf1 : POP ESI
00574cf2 : MOV AL,0x1
00574cf4 : POP EBX
00574cf5 : ADD ESP,0x3c
00574cf8 : RET 0x8
00574cfb : CMP dword ptr [EDX + EAX*0x8],EBX
00574cfe : JNZ 0x00574b88
00574d04 : POP ESI
00574d05 : XOR AL,AL
00574d07 : POP EBX
00574d08 : ADD ESP,0x3c
00574d0b : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_006dee40
ENTRY    : 006dee40
BODY     : [[006dee40, 006df001]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006dee40(void)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int *unaff_ESI;
  uint uStack_8;
  int *piStack_4;
  
  iVar3 = unaff_ESI[0x39];
  if (iVar3 == 1) {
    iVar3 = unaff_ESI[0x3a];
    unaff_ESI[0x3e] = *(int *)(iVar3 + 0x1c);
    unaff_ESI[0x3f] = *(int *)(iVar3 + 0x20);
    uVar1 = *(uint *)(iVar3 + 0xc);
    uVar2 = *(uint *)(iVar3 + 0x20) / uVar1;
    uVar4 = *(uint *)(iVar3 + 0x20) % uVar1;
    *(undefined4 *)(iVar3 + 0x34) = 1;
    *(undefined4 *)(iVar3 + 0x38) = 1;
    *(undefined4 *)(iVar3 + 0x3c) = 1;
    *(undefined4 *)(iVar3 + 0x40) = 8;
    *(undefined4 *)(iVar3 + 0x44) = 1;
    if (uVar4 == 0) {
      uVar4 = uVar1;
    }
    *(uint *)(iVar3 + 0x48) = uVar4;
    unaff_ESI[0x40] = 1;
    unaff_ESI[0x41] = 0;
  }
  else {
    if ((iVar3 < 1) || (4 < iVar3)) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x1a;
      *(int *)(*unaff_ESI + 0x18) = unaff_ESI[0x39];
      *(undefined4 *)(*unaff_ESI + 0x1c) = 4;
      (**(code **)*unaff_ESI)();
    }
    iVar3 = FUN_006d9580(unaff_ESI[7],unaff_ESI[0x36] * 8);
    unaff_ESI[0x3e] = iVar3;
    uVar2 = FUN_006d9580(unaff_ESI[8],unaff_ESI[0x37] * 8);
    unaff_ESI[0x3f] = uVar2;
    unaff_ESI[0x40] = 0;
    uStack_8 = 0;
    if (0 < unaff_ESI[0x39]) {
      piStack_4 = unaff_ESI + 0x3a;
      do {
        iVar3 = *piStack_4;
        uVar2 = *(uint *)(iVar3 + 8);
        uVar1 = *(uint *)(iVar3 + 0xc);
        *(uint *)(iVar3 + 0x40) = uVar2 * 8;
        uVar4 = *(uint *)(iVar3 + 0x1c) % uVar2;
        iVar5 = uVar1 * uVar2;
        *(uint *)(iVar3 + 0x34) = uVar2;
        *(uint *)(iVar3 + 0x38) = uVar1;
        *(int *)(iVar3 + 0x3c) = iVar5;
        if (uVar4 == 0) {
          uVar4 = uVar2;
        }
        *(uint *)(iVar3 + 0x44) = uVar4;
        uVar2 = *(uint *)(iVar3 + 0x20) % uVar1;
        if (uVar2 == 0) {
          uVar2 = uVar1;
        }
        *(uint *)(iVar3 + 0x48) = uVar2;
        if (10 < unaff_ESI[0x40] + iVar5) {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0xd;
          (**(code **)*unaff_ESI)();
        }
        for (; 0 < iVar5; iVar5 = iVar5 + -1) {
          unaff_ESI[unaff_ESI[0x40] + 0x41] = uStack_8;
          unaff_ESI[0x40] = unaff_ESI[0x40] + 1;
        }
        piStack_4 = piStack_4 + 1;
        uVar2 = uStack_8 + 1;
        uStack_8 = uVar2;
      } while ((int)uVar2 < unaff_ESI[0x39]);
    }
  }
  if (0 < unaff_ESI[0x30]) {
    uVar2 = unaff_ESI[0x3e] * unaff_ESI[0x30];
    if (0xfffe < (int)uVar2) {
      uVar2 = 0xffff;
    }
    unaff_ESI[0x2f] = uVar2;
  }
  return uVar2;
}



============================================================
DISASSEMBLY
============================================================
006dee40 : MOV EAX,dword ptr [ESI + 0xe4]
006dee46 : SUB ESP,0x8
006dee49 : PUSH EBX
006dee4a : MOV EBX,0x1
006dee4f : PUSH EDI
006dee50 : CMP EAX,EBX
006dee52 : JNZ 0x006deea7
006dee54 : MOV ECX,dword ptr [ESI + 0xe8]
006dee5a : MOV EAX,dword ptr [ECX + 0x1c]
006dee5d : MOV dword ptr [ESI + 0xf8],EAX
006dee63 : MOV EDX,dword ptr [ECX + 0x20]
006dee66 : MOV dword ptr [ESI + 0xfc],EDX
006dee6c : MOV EDI,dword ptr [ECX + 0xc]
006dee6f : MOV EAX,dword ptr [ECX + 0x20]
006dee72 : XOR EDX,EDX
006dee74 : DIV EDI
006dee76 : MOV dword ptr [ECX + 0x34],EBX
006dee79 : MOV dword ptr [ECX + 0x38],EBX
006dee7c : MOV dword ptr [ECX + 0x3c],EBX
006dee7f : MOV dword ptr [ECX + 0x40],0x8
006dee86 : MOV dword ptr [ECX + 0x44],EBX
006dee89 : TEST EDX,EDX
006dee8b : JNZ 0x006dee8f
006dee8d : MOV EDX,EDI
006dee8f : MOV dword ptr [ECX + 0x48],EDX
006dee92 : MOV dword ptr [ESI + 0x100],EBX
006dee98 : MOV dword ptr [ESI + 0x104],0x0
006deea2 : JMP 0x006defd7
006deea7 : XOR EDI,EDI
006deea9 : CMP EAX,EDI
006deeab : JLE 0x006deeb2
006deead : CMP EAX,0x4
006deeb0 : JLE 0x006deed9
006deeb2 : MOV EAX,dword ptr [ESI]
006deeb4 : MOV dword ptr [EAX + 0x14],0x1a
006deebb : MOV ECX,dword ptr [ESI]
006deebd : MOV EDX,dword ptr [ESI + 0xe4]
006deec3 : MOV dword ptr [ECX + 0x18],EDX
006deec6 : MOV EAX,dword ptr [ESI]
006deec8 : MOV dword ptr [EAX + 0x1c],0x4
006deecf : MOV ECX,dword ptr [ESI]
006deed1 : MOV EDX,dword ptr [ECX]
006deed3 : PUSH ESI
006deed4 : CALL EDX
006deed6 : ADD ESP,0x4
006deed9 : MOV EAX,dword ptr [ESI + 0xd8]
006deedf : MOV ECX,dword ptr [ESI + 0x1c]
006deee2 : ADD EAX,EAX
006deee4 : ADD EAX,EAX
006deee6 : ADD EAX,EAX
006deee8 : PUSH EAX
006deee9 : PUSH ECX
006deeea : CALL 0x006d9580
006deeef : MOV EDX,dword ptr [ESI + 0xdc]
006deef5 : ADD EDX,EDX
006deef7 : ADD EDX,EDX
006deef9 : ADD EDX,EDX
006deefb : MOV dword ptr [ESI + 0xf8],EAX
006def01 : MOV EAX,dword ptr [ESI + 0x20]
006def04 : PUSH EDX
006def05 : PUSH EAX
006def06 : CALL 0x006d9580
006def0b : ADD ESP,0x10
006def0e : CMP dword ptr [ESI + 0xe4],EDI
006def14 : MOV dword ptr [ESI + 0xfc],EAX
006def1a : MOV dword ptr [ESI + 0x100],EDI
006def20 : MOV dword ptr [ESP + 0x8],EDI
006def24 : JLE 0x006defd7
006def2a : LEA ECX,[ESI + 0xe8]
006def30 : MOV dword ptr [ESP + 0xc],ECX
006def34 : PUSH EBP
006def35 : MOV EDX,dword ptr [ESP + 0x10]
006def39 : MOV ECX,dword ptr [EDX]
006def3b : MOV EDI,dword ptr [ECX + 0x8]
006def3e : LEA EAX,[EDI*0x8 + 0x0]
006def45 : MOV EBP,dword ptr [ECX + 0xc]
006def48 : MOV dword ptr [ECX + 0x40],EAX
006def4b : MOV EAX,dword ptr [ECX + 0x1c]
006def4e : XOR EDX,EDX
006def50 : DIV EDI
006def52 : MOV EBX,EBP
006def54 : IMUL EBX,EDI
006def57 : MOV dword ptr [ECX + 0x34],EDI
006def5a : MOV dword ptr [ECX + 0x38],EBP
006def5d : MOV dword ptr [ECX + 0x3c],EBX
006def60 : TEST EDX,EDX
006def62 : JNZ 0x006def66
006def64 : MOV EDX,EDI
006def66 : MOV EAX,dword ptr [ECX + 0x20]
006def69 : MOV dword ptr [ECX + 0x44],EDX
006def6c : XOR EDX,EDX
006def6e : DIV EBP
006def70 : TEST EDX,EDX
006def72 : JNZ 0x006def76
006def74 : MOV EDX,EBP
006def76 : MOV dword ptr [ECX + 0x48],EDX
006def79 : MOV ECX,dword ptr [ESI + 0x100]
006def7f : MOV EDI,EBX
006def81 : ADD ECX,EDI
006def83 : CMP ECX,0xa
006def86 : JLE 0x006def9b
006def88 : MOV EDX,dword ptr [ESI]
006def8a : MOV dword ptr [EDX + 0x14],0xd
006def91 : MOV EAX,dword ptr [ESI]
006def93 : MOV ECX,dword ptr [EAX]
006def95 : PUSH ESI
006def96 : CALL ECX
006def98 : ADD ESP,0x4
006def9b : TEST EDI,EDI
006def9d : JLE 0x006defbc
006def9f : NOP
006defa0 : MOV EDX,dword ptr [ESI + 0x100]
006defa6 : MOV EAX,dword ptr [ESP + 0xc]
006defaa : DEC EDI
006defab : MOV dword ptr [ESI + EDX*0x4 + 0x104],EAX
006defb2 : INC dword ptr [ESI + 0x100]
006defb8 : TEST EDI,EDI
006defba : JG 0x006defa0
006defbc : MOV EAX,dword ptr [ESP + 0xc]
006defc0 : ADD dword ptr [ESP + 0x10],0x4
006defc5 : INC EAX
006defc6 : CMP EAX,dword ptr [ESI + 0xe4]
006defcc : MOV dword ptr [ESP + 0xc],EAX
006defd0 : JL 0x006def35
006defd6 : POP EBP
006defd7 : MOV ECX,dword ptr [ESI + 0xc0]
006defdd : POP EDI
006defde : POP EBX
006defdf : TEST ECX,ECX
006defe1 : JLE 0x006deffe
006defe3 : MOV EAX,dword ptr [ESI + 0xf8]
006defe9 : IMUL EAX,ECX
006defec : CMP EAX,0xffff
006deff1 : JL 0x006deff8
006deff3 : MOV EAX,0xffff
006deff8 : MOV dword ptr [ESI + 0xbc],EAX
006deffe : ADD ESP,0x8
006df001 : RET

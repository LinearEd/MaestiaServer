PROGRAM  : Maestia.exe
FUNCTION : FUN_00679350
ENTRY    : 00679350
BODY     : [[00679350, 006793bd]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00679350(int param_1)

{
  char *pcVar1;
  undefined4 *puVar2;
  uint uVar3;
  
  puVar2 = *(undefined4 **)(param_1 + 0x18);
  pcVar1 = (char *)((int)puVar2 + 0x21);
  uVar3 = (**(code **)(*(int *)puVar2[7] + 0x28))(pcVar1,0x800);
  if (uVar3 == 0) {
    if (*(char *)(puVar2 + 8) != '\0') {
      return 0;
    }
    *pcVar1 = -1;
    *(undefined1 *)((int)puVar2 + 0x22) = 0xd9;
    uVar3 = 2;
  }
  if ((((*(char *)(puVar2 + 8) != '\0') && (3 < uVar3)) && (*pcVar1 == -1)) &&
     (((*(char *)((int)puVar2 + 0x22) == -0x27 && (*(char *)((int)puVar2 + 0x23) == -1)) &&
      (*(char *)(puVar2 + 9) == -0x28)))) {
    *(undefined1 *)((int)puVar2 + 0x22) = 0xd8;
    *(undefined1 *)(puVar2 + 9) = 0xd9;
  }
  *puVar2 = pcVar1;
  puVar2[1] = uVar3;
  *(undefined1 *)(puVar2 + 8) = 0;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00679350 : MOV EAX,dword ptr [ESP + 0x4]
00679354 : PUSH ESI
00679355 : MOV ESI,dword ptr [EAX + 0x18]
00679358 : MOV ECX,dword ptr [ESI + 0x1c]
0067935b : MOV EDX,dword ptr [ECX]
0067935d : MOV EAX,dword ptr [EDX + 0x28]
00679360 : PUSH EDI
00679361 : PUSH 0x800
00679366 : LEA EDI,[ESI + 0x21]
00679369 : PUSH EDI
0067936a : CALL EAX
0067936c : MOV DL,0xd9
0067936e : TEST EAX,EAX
00679370 : JA 0x00679388
00679372 : CMP byte ptr [ESI + 0x20],0x0
00679376 : JZ 0x0067937d
00679378 : POP EDI
00679379 : XOR AL,AL
0067937b : POP ESI
0067937c : RET
0067937d : MOV byte ptr [EDI],0xff
00679380 : MOV byte ptr [ESI + 0x22],DL
00679383 : MOV EAX,0x2
00679388 : CMP byte ptr [ESI + 0x20],0x0
0067938c : JZ 0x006793b0
0067938e : CMP EAX,0x4
00679391 : JC 0x006793b0
00679393 : CMP byte ptr [EDI],0xff
00679396 : JNZ 0x006793b0
00679398 : CMP byte ptr [ESI + 0x22],DL
0067939b : JNZ 0x006793b0
0067939d : CMP byte ptr [ESI + 0x23],0xff
006793a1 : JNZ 0x006793b0
006793a3 : MOV CL,0xd8
006793a5 : CMP byte ptr [ESI + 0x24],CL
006793a8 : JNZ 0x006793b0
006793aa : MOV byte ptr [ESI + 0x22],CL
006793ad : MOV byte ptr [ESI + 0x24],DL
006793b0 : MOV dword ptr [ESI],EDI
006793b2 : MOV dword ptr [ESI + 0x4],EAX
006793b5 : POP EDI
006793b6 : MOV byte ptr [ESI + 0x20],0x0
006793ba : MOV AL,0x1
006793bc : POP ESI
006793bd : RET

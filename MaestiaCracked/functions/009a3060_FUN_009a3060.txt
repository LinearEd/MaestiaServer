PROGRAM  : Maestia.exe
FUNCTION : FUN_009a3060
ENTRY    : 009a3060
BODY     : [[009a3060, 009a32a0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a3060(undefined4 param_1)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  int in_ECX;
  int in_EDX;
  int *piVar4;
  int local_70;
  int local_6c [8];
  undefined1 local_4c [28];
  undefined1 local_30 [28];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar3 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5b783;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  if (in_ECX != 0) {
    local_6c[0] = in_ECX;
    FUN_004437f0(local_6c);
    if (local_70 == *(int *)(iVar3 + 0x44)) {
      piVar4 = (int *)0x0;
    }
    else {
      piVar4 = *(int **)(local_70 + 0x10);
    }
    iVar3 = (**(code **)(*piVar4 + 0x3c))(uVar2);
    if ((iVar3 != 0) && (cVar1 = FUN_009a08d0(param_1), cVar1 != '\0')) {
      if (*(uint *)(*(int *)(DAT_0172491c + 0x17c) + 0xa0) < (uint)*(byte *)(piVar4 + 0x10)) {
        FUN_00406460(L"IDS_CHR_INSUFFICIENT_LEVEL");
        local_8 = 0;
        FUN_0081d120(local_30);
        local_8 = CONCAT31(local_8._1_3_,2);
        FUN_00406560();
        (**(code **)(**(int **)(*(int *)(in_EDX + 4) + 0x1a8) + 0x44))(local_4c,3);
        FUN_008a1050(0xca);
        local_8 = 0xffffffff;
        FUN_00406560();
      }
      else {
        local_6c[0] = (**(code **)(piVar4[0x4a] + 4))();
        while (local_6c[0] != 0) {
          iVar3 = FUN_004f5680();
          if (iVar3 != 0) {
            FUN_00824a20(DAT_0172491c,0);
            local_8 = 3;
            iVar3 = FUN_00406f20();
            if ((iVar3 != 0) && (iVar3 = FUN_00406f20(), iVar3 != 0)) {
              FUN_00824a20(DAT_0172491c,0);
              local_8._0_1_ = 4;
              FUN_00824a20(DAT_0172491c,0);
              local_8._0_1_ = 5;
              cVar1 = FUN_00404700();
              if (cVar1 != '\0') {
                local_8._0_1_ = 4;
                FUN_00406560();
                local_8 = CONCAT31(local_8._1_3_,3);
                FUN_00406560();
                local_8 = 0xffffffff;
                FUN_00406560();
                break;
              }
              local_8._0_1_ = 4;
              FUN_00406560();
              local_8 = CONCAT31(local_8._1_3_,3);
              FUN_00406560();
            }
            local_8 = 0xffffffff;
            FUN_00406560();
          }
        }
      }
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009a3060 : PUSH EBP
009a3061 : MOV EBP,ESP
009a3063 : PUSH -0x1
009a3065 : PUSH 0xb5b783
009a306a : MOV EAX,FS:[0x0]
009a3070 : PUSH EAX
009a3071 : SUB ESP,0x60
009a3074 : MOV EAX,[0x00d66fa0]
009a3079 : XOR EAX,EBP
009a307b : MOV dword ptr [EBP + -0x10],EAX
009a307e : PUSH EBX
009a307f : PUSH ESI
009a3080 : PUSH EDI
009a3081 : PUSH EAX
009a3082 : LEA EAX,[EBP + -0xc]
009a3085 : MOV FS:[0x0],EAX
009a308b : MOV EDI,ECX
009a308d : MOV ESI,EDX
009a308f : TEST EDI,EDI
009a3091 : JZ 0x009a3169
009a3097 : MOV EBX,dword ptr [0x00d7c54c]
009a309d : LEA EAX,[EBP + -0x68]
009a30a0 : PUSH EAX
009a30a1 : LEA ECX,[EBX + 0x40]
009a30a4 : LEA EAX,[EBP + -0x6c]
009a30a7 : MOV dword ptr [EBP + -0x68],EDI
009a30aa : CALL 0x004437f0
009a30af : MOV EBX,dword ptr [EBX + 0x44]
009a30b2 : MOV EAX,dword ptr [EBP + -0x6c]
009a30b5 : CMP EAX,EBX
009a30b7 : JZ 0x009a30be
009a30b9 : MOV EBX,dword ptr [EAX + 0x10]
009a30bc : JMP 0x009a30c0
009a30be : XOR EBX,EBX
009a30c0 : MOV EDX,dword ptr [EBX]
009a30c2 : MOV EAX,dword ptr [EDX + 0x3c]
009a30c5 : MOV ECX,EBX
009a30c7 : CALL EAX
009a30c9 : TEST EAX,EAX
009a30cb : JZ 0x009a3169
009a30d1 : MOV ECX,dword ptr [EBP + 0x8]
009a30d4 : MOV EAX,EDI
009a30d6 : PUSH ECX
009a30d7 : MOV EDI,ESI
009a30d9 : CALL 0x009a08d0
009a30de : TEST AL,AL
009a30e0 : JZ 0x009a3169
009a30e6 : MOV EDX,dword ptr [0x0172491c]
009a30ec : MOV EAX,dword ptr [EDX + 0x17c]
009a30f2 : MOVZX ECX,byte ptr [EBX + 0x40]
009a30f6 : MOV EAX,dword ptr [EAX + 0xa0]
009a30fc : CMP ECX,EAX
009a30fe : JBE 0x009a3189
009a3104 : PUSH 0xc88ef8
009a3109 : LEA ECX,[EBP + -0x2c]
009a310c : CALL 0x00406460
009a3111 : MOV dword ptr [EBP + -0x4],0x0
009a3118 : MOV ECX,dword ptr [0x0172491c]
009a311e : LEA EDX,[EBP + -0x2c]
009a3121 : PUSH EDX
009a3122 : LEA EDI,[EBP + -0x48]
009a3125 : CALL 0x0081d120
009a312a : MOV byte ptr [EBP + -0x4],0x2
009a312e : LEA ECX,[EBP + -0x2c]
009a3131 : CALL 0x00406560
009a3136 : MOV EAX,dword ptr [ESI + 0x4]
009a3139 : MOV ECX,dword ptr [EAX + 0x1a8]
009a313f : MOV EDX,dword ptr [ECX]
009a3141 : MOV EDX,dword ptr [EDX + 0x44]
009a3144 : PUSH 0x3
009a3146 : MOV EAX,EDI
009a3148 : PUSH EAX
009a3149 : CALL EDX
009a314b : MOV ECX,dword ptr [0x017248dc]
009a3151 : PUSH 0xca
009a3156 : CALL 0x008a1050
009a315b : MOV dword ptr [EBP + -0x4],0xffffffff
009a3162 : MOV ECX,EDI
009a3164 : CALL 0x00406560
009a3169 : XOR AL,AL
009a316b : MOV ECX,dword ptr [EBP + -0xc]
009a316e : MOV dword ptr FS:[0x0],ECX
009a3175 : POP ECX
009a3176 : POP EDI
009a3177 : POP ESI
009a3178 : POP EBX
009a3179 : MOV ECX,dword ptr [EBP + -0x10]
009a317c : XOR ECX,EBP
009a317e : CALL 0x00633e6b
009a3183 : MOV ESP,EBP
009a3185 : POP EBP
009a3186 : RET 0x4
009a3189 : MOV EAX,dword ptr [EBX + 0x128]
009a318f : MOV EDX,dword ptr [EAX + 0x4]
009a3192 : ADD EBX,0x128
009a3198 : MOV ECX,EBX
009a319a : CALL EDX
009a319c : MOV dword ptr [EBP + -0x68],EAX
009a319f : TEST EAX,EAX
009a31a1 : JZ 0x009a3169
009a31a3 : LEA EDX,[EBP + -0x68]
009a31a6 : MOV EAX,EBX
009a31a8 : CALL 0x004f5680
009a31ad : MOV EDI,EAX
009a31af : TEST EDI,EDI
009a31b1 : JZ 0x009a3264
009a31b7 : MOV EAX,[0x0172491c]
009a31bc : PUSH 0x0
009a31be : LEA EDX,[EDI + 0x18]
009a31c1 : PUSH EAX
009a31c2 : LEA ESI,[EBP + -0x64]
009a31c5 : CALL 0x00824a20
009a31ca : MOV dword ptr [EBP + -0x4],0x3
009a31d1 : MOV DX,word ptr [EDI + 0x6]
009a31d5 : MOV ECX,EBX
009a31d7 : CALL 0x00406f20
009a31dc : MOV ESI,EAX
009a31de : TEST ESI,ESI
009a31e0 : JZ 0x009a3255
009a31e2 : MOV ECX,dword ptr [0x0172491c]
009a31e8 : MOV EAX,dword ptr [ECX + 0x17c]
009a31ee : MOV EDX,dword ptr [EAX + 0x16d8]
009a31f4 : MOV ECX,EBX
009a31f6 : CALL 0x00406f20
009a31fb : MOV EDI,EAX
009a31fd : TEST EDI,EDI
009a31ff : JZ 0x009a3255
009a3201 : MOV EAX,[0x0172491c]
009a3206 : PUSH 0x0
009a3208 : LEA EDX,[ESI + 0x18]
009a320b : PUSH EAX
009a320c : LEA ESI,[EBP + -0x2c]
009a320f : CALL 0x00824a20
009a3214 : MOV byte ptr [EBP + -0x4],0x4
009a3218 : MOV ECX,dword ptr [0x0172491c]
009a321e : PUSH 0x0
009a3220 : LEA EDX,[EDI + 0x18]
009a3223 : PUSH ECX
009a3224 : LEA ESI,[EBP + -0x48]
009a3227 : CALL 0x00824a20
009a322c : MOV byte ptr [EBP + -0x4],0x5
009a3230 : MOV EAX,ESI
009a3232 : LEA ECX,[EBP + -0x2c]
009a3235 : CALL 0x00404700
009a323a : TEST AL,AL
009a323c : JNZ 0x009a3273
009a323e : MOV byte ptr [EBP + -0x4],0x4
009a3242 : MOV ECX,ESI
009a3244 : CALL 0x00406560
009a3249 : MOV byte ptr [EBP + -0x4],0x3
009a324d : LEA ECX,[EBP + -0x2c]
009a3250 : CALL 0x00406560
009a3255 : MOV dword ptr [EBP + -0x4],0xffffffff
009a325c : LEA ECX,[EBP + -0x64]
009a325f : CALL 0x00406560
009a3264 : CMP dword ptr [EBP + -0x68],0x0
009a3268 : JNZ 0x009a31a3
009a326e : JMP 0x009a3169
009a3273 : MOV byte ptr [EBP + -0x4],0x4
009a3277 : LEA ECX,[EBP + -0x48]
009a327a : CALL 0x00406560
009a327f : MOV byte ptr [EBP + -0x4],0x3
009a3283 : LEA ECX,[EBP + -0x2c]
009a3286 : CALL 0x00406560
009a328b : MOV dword ptr [EBP + -0x4],0xffffffff
009a3292 : LEA ECX,[EBP + -0x64]
009a3295 : CALL 0x00406560
009a329a : MOV AL,0x1
009a329c : JMP 0x009a316b

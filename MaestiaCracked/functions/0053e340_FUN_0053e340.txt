PROGRAM  : Maestia.exe
FUNCTION : FUN_0053e340
ENTRY    : 0053e340
BODY     : [[0053e340, 0053e509]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_0053e340(undefined4 *param_1,uint param_2,uint param_3)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  int in_ECX;
  uint uVar4;
  int iVar5;
  int local_80;
  undefined1 local_7c [8];
  undefined1 local_74 [4];
  undefined4 local_70;
  undefined1 local_6c [8];
  int local_64;
  int *local_60;
  undefined4 local_5c;
  undefined2 local_58;
  undefined2 local_56;
  undefined1 local_54;
  undefined2 local_52;
  GRefCountImpl *local_44;
  int *local_3c;
  uint local_38;
  int local_34;
  uint local_30;
  undefined1 local_2c [44];
  
  FUN_0053ccd0(in_ECX + 0x10,in_ECX,param_2);
  if (param_3 < param_2) {
    param_3 = param_2;
  }
  if (param_3 == 0xffffffff) {
    iVar5 = 0x7fffffff;
  }
  else {
    iVar5 = param_3 - param_2;
  }
  uVar2 = FUN_00515dd0(in_ECX);
  FUN_00504200(uVar2);
  local_80 = 0;
  iVar1 = local_80;
  uVar4 = local_30;
  while ((local_30 = uVar4, 0 < iVar5 && (local_30 < *(uint *)(local_34 + 4)))) {
    iVar3 = FUN_0053cdb0();
    local_80 = iVar1;
    if (*(int *)(iVar3 + 0xc) != 0) {
      local_80 = iVar1 + 1;
      if (iVar1 == 0) {
        FUN_00504700(*(int *)(iVar3 + 0xc));
      }
      else {
        uVar2 = FUN_00560000(local_2c,local_7c);
        FUN_00504700(uVar2);
        FUN_00504260();
      }
    }
    iVar5 = iVar5 - *(int *)(iVar3 + 8);
    iVar1 = local_80;
    if (((int)local_38 < 0) || ((uint)local_3c[1] <= local_38)) {
      uVar4 = *(uint *)(local_34 + 4);
    }
    else {
      uVar4 = *(uint *)(*local_3c + local_38 * 0xc);
      if ((uVar4 <= local_30) &&
         (uVar4 = local_30 + *(int *)(*local_3c + local_38 * 0xc + 4), (int)local_38 < local_3c[1]))
      {
        local_38 = local_38 + 1;
      }
    }
  }
  *param_1 = &PTR_FUN_00cd3f2c;
  param_1[1] = 1;
  *param_1 = &PTR_FUN_00b86530;
  FUN_0051c380(local_74,local_70);
  FUN_0051c380(local_6c,local_70);
  if (local_64 != 0) {
    *(int *)(local_64 + 4) = *(int *)(local_64 + 4) + 1;
  }
  param_1[6] = local_64;
  if (local_60 != (int *)0x0) {
    *local_60 = *local_60 + 1;
  }
  param_1[7] = local_60;
  param_1[8] = local_5c;
  *(undefined2 *)(param_1 + 9) = local_58;
  *(undefined1 *)(param_1 + 10) = local_54;
  *(undefined2 *)((int)param_1 + 0x26) = local_56;
  *(undefined2 *)((int)param_1 + 0x2a) = local_52;
  FUN_00504260();
  if (local_44 != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release(local_44);
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0053e340 : SUB ESP,0x84
0053e346 : PUSH ESI
0053e347 : PUSH EDI
0053e348 : MOV EDI,dword ptr [ESP + 0x94]
0053e34f : MOV ESI,ECX
0053e351 : PUSH EDI
0053e352 : PUSH ESI
0053e353 : LEA EAX,[ESI + 0x10]
0053e356 : PUSH EAX
0053e357 : LEA ECX,[ESP + 0x48]
0053e35b : CALL 0x0053ccd0
0053e360 : MOV EAX,dword ptr [ESP + 0x98]
0053e367 : CMP EAX,EDI
0053e369 : JNC 0x0053e36d
0053e36b : MOV EAX,EDI
0053e36d : PUSH EBP
0053e36e : CMP EAX,-0x1
0053e371 : JNZ 0x0053e37a
0053e373 : MOV EBP,0x7fffffff
0053e378 : JMP 0x0053e37e
0053e37a : SUB EAX,EDI
0053e37c : MOV EBP,EAX
0053e37e : PUSH ESI
0053e37f : CALL 0x00515dd0
0053e384 : PUSH EAX
0053e385 : LEA ECX,[ESP + 0x18]
0053e389 : CALL 0x00504200
0053e38e : MOV dword ptr [ESP + 0x10],0x0
0053e396 : TEST EBP,EBP
0053e398 : JLE 0x0053e451
0053e39e : MOV ECX,dword ptr [ESP + 0x60]
0053e3a2 : PUSH EBX
0053e3a3 : MOV EBX,dword ptr [ESP + 0x60]
0053e3a7 : CMP ECX,dword ptr [EBX + 0x4]
0053e3aa : JNC 0x0053e450
0053e3b0 : LEA ECX,[ESP + 0x44]
0053e3b4 : CALL 0x0053cdb0
0053e3b9 : MOV ESI,EAX
0053e3bb : MOV ECX,dword ptr [ESI + 0xc]
0053e3be : TEST ECX,ECX
0053e3c0 : JZ 0x0053e3ff
0053e3c2 : MOV EAX,dword ptr [ESP + 0x14]
0053e3c6 : MOV EDX,EAX
0053e3c8 : INC EAX
0053e3c9 : MOV dword ptr [ESP + 0x14],EAX
0053e3cd : TEST EDX,EDX
0053e3cf : JNZ 0x0053e3dd
0053e3d1 : PUSH ECX
0053e3d2 : LEA ECX,[ESP + 0x1c]
0053e3d6 : CALL 0x00504700
0053e3db : JMP 0x0053e3ff
0053e3dd : LEA EAX,[ESP + 0x18]
0053e3e1 : PUSH EAX
0053e3e2 : LEA EDX,[ESP + 0x6c]
0053e3e6 : PUSH EDX
0053e3e7 : CALL 0x00560000
0053e3ec : PUSH EAX
0053e3ed : LEA ECX,[ESP + 0x1c]
0053e3f1 : CALL 0x00504700
0053e3f6 : LEA ECX,[ESP + 0x68]
0053e3fa : CALL 0x00504260
0053e3ff : MOV EAX,dword ptr [ESP + 0x5c]
0053e403 : SUB EBP,dword ptr [ESI + 0x8]
0053e406 : MOV EBX,dword ptr [ESP + 0x60]
0053e40a : TEST EAX,EAX
0053e40c : JL 0x0053e441
0053e40e : MOV EDI,dword ptr [ESP + 0x58]
0053e412 : CMP EAX,dword ptr [EDI + 0x4]
0053e415 : JNC 0x0053e441
0053e417 : MOV EDX,dword ptr [EDI]
0053e419 : LEA ECX,[EAX + EAX*0x2]
0053e41c : MOV ESI,dword ptr [EDX + ECX*0x4]
0053e41f : LEA EDX,[EDX + ECX*0x4]
0053e422 : MOV ECX,dword ptr [ESP + 0x64]
0053e426 : CMP ECX,ESI
0053e428 : JNC 0x0053e42e
0053e42a : MOV ECX,ESI
0053e42c : JMP 0x0053e444
0053e42e : ADD ECX,dword ptr [EDX + 0x4]
0053e431 : MOV dword ptr [ESP + 0x64],ECX
0053e435 : CMP EAX,dword ptr [EDI + 0x4]
0053e438 : JGE 0x0053e448
0053e43a : INC EAX
0053e43b : MOV dword ptr [ESP + 0x5c],EAX
0053e43f : JMP 0x0053e448
0053e441 : MOV ECX,dword ptr [EBX + 0x4]
0053e444 : MOV dword ptr [ESP + 0x64],ECX
0053e448 : TEST EBP,EBP
0053e44a : JG 0x0053e3a7
0053e450 : POP EBX
0053e451 : MOV EAX,dword ptr [ESP + 0x20]
0053e455 : MOV ESI,dword ptr [ESP + 0x94]
0053e45c : PUSH EAX
0053e45d : LEA ECX,[ESP + 0x20]
0053e461 : MOV dword ptr [ESI],0xcd3f2c
0053e467 : PUSH ECX
0053e468 : MOV EDI,0x1
0053e46d : LEA ECX,[ESI + 0x8]
0053e470 : MOV dword ptr [ESI + 0x4],EDI
0053e473 : MOV dword ptr [ESI],0xb86530
0053e479 : MOV byte ptr [ESP + 0x16],0x0
0053e47e : CALL 0x0051c380
0053e483 : MOV EDX,dword ptr [ESP + 0x20]
0053e487 : PUSH EDX
0053e488 : LEA EAX,[ESP + 0x28]
0053e48c : PUSH EAX
0053e48d : LEA ECX,[ESI + 0x10]
0053e490 : MOV byte ptr [ESP + 0x17],0x0
0053e495 : CALL 0x0051c380
0053e49a : MOV EAX,dword ptr [ESP + 0x2c]
0053e49e : POP EBP
0053e49f : TEST EAX,EAX
0053e4a1 : JZ 0x0053e4aa
0053e4a3 : ADD dword ptr [EAX + 0x4],EDI
0053e4a6 : MOV EAX,dword ptr [ESP + 0x28]
0053e4aa : MOV dword ptr [ESI + 0x18],EAX
0053e4ad : MOV EAX,dword ptr [ESP + 0x2c]
0053e4b1 : TEST EAX,EAX
0053e4b3 : JZ 0x0053e4bb
0053e4b5 : ADD dword ptr [EAX],EDI
0053e4b7 : MOV EAX,dword ptr [ESP + 0x2c]
0053e4bb : MOVZX EDX,word ptr [ESP + 0x34]
0053e4c0 : MOV ECX,dword ptr [ESP + 0x30]
0053e4c4 : MOV dword ptr [ESI + 0x1c],EAX
0053e4c7 : MOV AX,word ptr [ESP + 0x36]
0053e4cc : MOV dword ptr [ESI + 0x20],ECX
0053e4cf : MOV CL,byte ptr [ESP + 0x38]
0053e4d3 : MOV word ptr [ESI + 0x24],DX
0053e4d7 : MOVZX EDX,word ptr [ESP + 0x3a]
0053e4dc : MOV byte ptr [ESI + 0x28],CL
0053e4df : LEA ECX,[ESP + 0x10]
0053e4e3 : MOV word ptr [ESI + 0x26],AX
0053e4e7 : MOV word ptr [ESI + 0x2a],DX
0053e4eb : CALL 0x00504260
0053e4f0 : MOV ECX,dword ptr [ESP + 0x48]
0053e4f4 : TEST ECX,ECX
0053e4f6 : JZ 0x0053e4fd
0053e4f8 : CALL 0x004ff7e0
0053e4fd : POP EDI
0053e4fe : MOV EAX,ESI
0053e500 : POP ESI
0053e501 : ADD ESP,0x84
0053e507 : RET 0xc

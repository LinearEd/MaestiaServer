PROGRAM  : Maestia.exe
FUNCTION : FUN_00912860
ENTRY    : 00912860
BODY     : [[00912860, 00912b88]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00912860(undefined4 param_1,undefined4 param_2)

{
  wchar_t wVar1;
  uint uVar2;
  undefined4 uVar3;
  wchar_t *pwVar4;
  int iVar5;
  int iVar6;
  undefined4 in_ECX;
  int iVar7;
  wchar_t *pwVar8;
  int iVar9;
  bool bVar10;
  int local_70;
  int local_6c;
  undefined4 local_68;
  undefined1 local_60 [4];
  int local_5c;
  int local_58;
  undefined1 local_50 [4];
  undefined2 local_4c;
  undefined4 local_3c;
  uint local_38;
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b3f65e;
  local_14 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffff80;
  ExceptionList = &local_14;
  local_38 = 7;
  local_3c = 0;
  local_4c = 0;
  FUN_00406360(&DAT_00c67238,1);
  local_c = 0;
  uVar3 = FUN_00404350(param_2,uVar2);
  local_c._0_1_ = 1;
  FUN_0070cd60(local_60,uVar3,local_50,0);
  local_c = CONCAT31(local_c._1_3_,3);
  if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_1c = 7;
  local_20 = 0;
  local_30 = 0;
  local_c = CONCAT31(local_c._1_3_,4);
  if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_38 = 7;
  local_4c = 0;
  local_3c = 0;
  iVar6 = local_58 - local_5c >> 0x1f;
  iVar7 = (local_58 - local_5c) / 0x1c + iVar6;
  if (iVar7 != iVar6) {
    if (*(uint *)(local_5c + 0x18) < 8) {
      pwVar4 = (wchar_t *)(local_5c + 4);
    }
    else {
      pwVar4 = *(wchar_t **)(local_5c + 4);
    }
    pwVar8 = L"KeyChanged";
    do {
      wVar1 = *pwVar4;
      bVar10 = (ushort)wVar1 < (ushort)*pwVar8;
      if (wVar1 != *pwVar8) {
LAB_0091298c:
        iVar5 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
        goto LAB_00912991;
      }
      if (wVar1 == L'\0') break;
      wVar1 = pwVar4[1];
      bVar10 = (ushort)wVar1 < (ushort)pwVar8[1];
      if (wVar1 != pwVar8[1]) goto LAB_0091298c;
      pwVar4 = pwVar4 + 2;
      pwVar8 = pwVar8 + 2;
    } while (wVar1 != L'\0');
    iVar5 = 0;
LAB_00912991:
    if (iVar5 == 0) {
      if ((uint)(iVar7 - iVar6) < 2) {
        local_6c = 0;
      }
      else {
        if (*(uint *)(local_5c + 0x34) < 8) {
          iVar6 = local_5c + 0x20;
        }
        else {
          iVar6 = *(int *)(local_5c + 0x20);
        }
        local_6c = FUN_00634f4d(iVar6);
      }
      if ((uint)((local_58 - local_5c) / 0x1c) < 3) {
        local_68 = 0;
      }
      else {
        if (*(uint *)(local_5c + 0x50) < 8) {
          iVar6 = local_5c + 0x3c;
        }
        else {
          iVar6 = *(int *)(local_5c + 0x3c);
        }
        local_68 = FUN_00634f4d(iVar6);
      }
      if ((uint)((local_58 - local_5c) / 0x1c) < 4) {
        local_70 = 0;
      }
      else {
        if (*(uint *)(local_5c + 0x6c) < 8) {
          iVar6 = local_5c + 0x58;
        }
        else {
          iVar6 = *(int *)(local_5c + 0x58);
        }
        local_70 = FUN_00634f4d(iVar6);
      }
      if ((uint)((local_58 - local_5c) / 0x1c) < 5) {
        iVar6 = 0;
      }
      else {
        if (*(uint *)(local_5c + 0x88) < 8) {
          iVar6 = local_5c + 0x74;
        }
        else {
          iVar6 = *(int *)(local_5c + 0x74);
        }
        iVar6 = FUN_00634f4d(iVar6);
      }
      if ((uint)((local_58 - local_5c) / 0x1c) < 6) {
        iVar7 = 0;
      }
      else if (*(uint *)(local_5c + 0xa4) < 8) {
        iVar7 = FUN_00634f4d(local_5c + 0x90);
      }
      else {
        iVar7 = FUN_00634f4d(*(undefined4 *)(local_5c + 0x90));
      }
      iVar9 = 0;
      iVar5 = 0;
      if (local_70 != 0) {
        iVar5 = 0x11;
      }
      if (iVar6 != 0) {
        if (iVar5 == 0) {
          iVar5 = 0x12;
        }
        else {
          iVar9 = 0x12;
        }
      }
      if (iVar7 != 0) {
        if (iVar5 == 0) {
          iVar5 = 0x10;
        }
        else if (iVar9 == 0) {
          iVar9 = 0x10;
        }
      }
      if (local_6c != 0) {
        FUN_0090fab0(in_ECX,local_6c,local_68,iVar5,iVar9);
      }
    }
  }
  local_c = 0xffffffff;
  if (local_5c != 0) {
    FUN_00405450(in_ECX);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00912860 : PUSH EBP
00912861 : MOV EBP,ESP
00912863 : AND ESP,0xfffffff8
00912866 : PUSH -0x1
00912868 : PUSH 0xb3f65e
0091286d : MOV EAX,FS:[0x0]
00912873 : PUSH EAX
00912874 : SUB ESP,0x60
00912877 : PUSH EBX
00912878 : PUSH ESI
00912879 : PUSH EDI
0091287a : MOV EAX,[0x00d66fa0]
0091287f : XOR EAX,ESP
00912881 : PUSH EAX
00912882 : LEA EAX,[ESP + 0x70]
00912886 : MOV FS:[0x0],EAX
0091288c : MOV dword ptr [ESP + 0x20],ECX
00912890 : PUSH 0x1
00912892 : XOR EAX,EAX
00912894 : MOV EDI,0x7
00912899 : XOR EBX,EBX
0091289b : PUSH 0xc67238
009128a0 : LEA ECX,[ESP + 0x3c]
009128a4 : MOV dword ptr [ESP + 0x54],EDI
009128a8 : MOV dword ptr [ESP + 0x50],EBX
009128ac : MOV word ptr [ESP + 0x40],AX
009128b1 : CALL 0x00406360
009128b6 : MOV dword ptr [ESP + 0x78],EBX
009128ba : MOV ECX,dword ptr [EBP + 0xc]
009128bd : PUSH ECX
009128be : LEA ESI,[ESP + 0x54]
009128c2 : CALL 0x00404350
009128c7 : ADD ESP,0x4
009128ca : MOV byte ptr [ESP + 0x78],0x1
009128cf : PUSH EBX
009128d0 : LEA EDX,[ESP + 0x38]
009128d4 : PUSH EDX
009128d5 : PUSH EAX
009128d6 : LEA EAX,[ESP + 0x30]
009128da : PUSH EAX
009128db : CALL 0x0070cd60
009128e0 : ADD ESP,0x10
009128e3 : MOV byte ptr [ESP + 0x78],0x3
009128e8 : MOV ESI,0x8
009128ed : CMP dword ptr [ESP + 0x68],ESI
009128f1 : JC 0x009128fc
009128f3 : MOV ECX,dword ptr [ESP + 0x54]
009128f7 : CALL 0x006f04e0
009128fc : XOR ECX,ECX
009128fe : MOV dword ptr [ESP + 0x68],EDI
00912902 : MOV dword ptr [ESP + 0x64],EBX
00912906 : MOV word ptr [ESP + 0x54],CX
0091290b : MOV byte ptr [ESP + 0x78],0x4
00912910 : CMP dword ptr [ESP + 0x4c],ESI
00912914 : JC 0x0091291f
00912916 : MOV ECX,dword ptr [ESP + 0x38]
0091291a : CALL 0x006f04e0
0091291f : MOV ECX,dword ptr [ESP + 0x28]
00912923 : MOV dword ptr [ESP + 0x4c],EDI
00912927 : MOV EDI,dword ptr [ESP + 0x2c]
0091292b : XOR EDX,EDX
0091292d : MOV ESI,EDI
0091292f : SUB ESI,ECX
00912931 : MOV word ptr [ESP + 0x38],DX
00912936 : MOV EAX,0x92492493
0091293b : IMUL ESI
0091293d : ADD EDX,ESI
0091293f : MOV dword ptr [ESP + 0x48],EBX
00912943 : SAR EDX,0x4
00912946 : MOV EBX,EDX
00912948 : SHR EBX,0x1f
0091294b : ADD EBX,EDX
0091294d : JZ 0x00912b3c
00912953 : CMP dword ptr [ECX + 0x18],0x8
00912957 : JC 0x0091295e
00912959 : MOV EAX,dword ptr [ECX + 0x4]
0091295c : JMP 0x00912961
0091295e : LEA EAX,[ECX + 0x4]
00912961 : MOV EDX,0xc6723c
00912966 : MOV SI,word ptr [EAX]
00912969 : CMP SI,word ptr [EDX]
0091296c : JNZ 0x0091298c
0091296e : TEST SI,SI
00912971 : JZ 0x00912988
00912973 : MOV SI,word ptr [EAX + 0x2]
00912977 : CMP SI,word ptr [EDX + 0x2]
0091297b : JNZ 0x0091298c
0091297d : ADD EAX,0x4
00912980 : ADD EDX,0x4
00912983 : TEST SI,SI
00912986 : JNZ 0x00912966
00912988 : XOR EAX,EAX
0091298a : JMP 0x00912991
0091298c : SBB EAX,EAX
0091298e : SBB EAX,-0x1
00912991 : TEST EAX,EAX
00912993 : JNZ 0x00912b3c
00912999 : CMP EBX,0x1
0091299c : LEA EBX,[EAX + 0x8]
0091299f : JBE 0x009129c5
009129a1 : CMP dword ptr [ECX + 0x34],EBX
009129a4 : JC 0x009129ab
009129a6 : MOV ECX,dword ptr [ECX + 0x20]
009129a9 : JMP 0x009129ae
009129ab : ADD ECX,0x20
009129ae : PUSH ECX
009129af : CALL 0x00634f4d
009129b4 : MOV EDI,dword ptr [ESP + 0x30]
009129b8 : MOV ECX,dword ptr [ESP + 0x2c]
009129bc : ADD ESP,0x4
009129bf : MOV dword ptr [ESP + 0x18],EAX
009129c3 : JMP 0x009129cd
009129c5 : MOV dword ptr [ESP + 0x18],0x0
009129cd : MOV ESI,EDI
009129cf : SUB ESI,ECX
009129d1 : MOV EAX,0x92492493
009129d6 : IMUL ESI
009129d8 : ADD EDX,ESI
009129da : SAR EDX,0x4
009129dd : MOV EAX,EDX
009129df : SHR EAX,0x1f
009129e2 : ADD EAX,EDX
009129e4 : CMP EAX,0x2
009129e7 : JBE 0x00912a0d
009129e9 : CMP dword ptr [ECX + 0x50],EBX
009129ec : JC 0x009129f3
009129ee : MOV ECX,dword ptr [ECX + 0x3c]
009129f1 : JMP 0x009129f6
009129f3 : ADD ECX,0x3c
009129f6 : PUSH ECX
009129f7 : CALL 0x00634f4d
009129fc : MOV EDI,dword ptr [ESP + 0x30]
00912a00 : MOV ECX,dword ptr [ESP + 0x2c]
00912a04 : ADD ESP,0x4
00912a07 : MOV dword ptr [ESP + 0x1c],EAX
00912a0b : JMP 0x00912a15
00912a0d : MOV dword ptr [ESP + 0x1c],0x0
00912a15 : MOV ESI,EDI
00912a17 : SUB ESI,ECX
00912a19 : MOV EAX,0x92492493
00912a1e : IMUL ESI
00912a20 : ADD EDX,ESI
00912a22 : SAR EDX,0x4
00912a25 : MOV EAX,EDX
00912a27 : SHR EAX,0x1f
00912a2a : ADD EAX,EDX
00912a2c : CMP EAX,0x3
00912a2f : JBE 0x00912a55
00912a31 : CMP dword ptr [ECX + 0x6c],EBX
00912a34 : JC 0x00912a3b
00912a36 : MOV ECX,dword ptr [ECX + 0x58]
00912a39 : JMP 0x00912a3e
00912a3b : ADD ECX,0x58
00912a3e : PUSH ECX
00912a3f : CALL 0x00634f4d
00912a44 : MOV EDI,dword ptr [ESP + 0x30]
00912a48 : MOV ECX,dword ptr [ESP + 0x2c]
00912a4c : ADD ESP,0x4
00912a4f : MOV dword ptr [ESP + 0x14],EAX
00912a53 : JMP 0x00912a5d
00912a55 : MOV dword ptr [ESP + 0x14],0x0
00912a5d : MOV ESI,EDI
00912a5f : SUB ESI,ECX
00912a61 : MOV EAX,0x92492493
00912a66 : IMUL ESI
00912a68 : ADD EDX,ESI
00912a6a : SAR EDX,0x4
00912a6d : MOV EAX,EDX
00912a6f : SHR EAX,0x1f
00912a72 : ADD EAX,EDX
00912a74 : CMP EAX,0x4
00912a77 : JBE 0x00912a9e
00912a79 : CMP dword ptr [ECX + 0x88],EBX
00912a7f : JC 0x00912a86
00912a81 : MOV ECX,dword ptr [ECX + 0x74]
00912a84 : JMP 0x00912a89
00912a86 : ADD ECX,0x74
00912a89 : PUSH ECX
00912a8a : CALL 0x00634f4d
00912a8f : MOV EDI,dword ptr [ESP + 0x30]
00912a93 : MOV ECX,dword ptr [ESP + 0x2c]
00912a97 : ADD ESP,0x4
00912a9a : MOV EBX,EAX
00912a9c : JMP 0x00912aa0
00912a9e : XOR EBX,EBX
00912aa0 : SUB EDI,ECX
00912aa2 : MOV ESI,EDI
00912aa4 : MOV EAX,0x92492493
00912aa9 : IMUL ESI
00912aab : ADD EDX,ESI
00912aad : SAR EDX,0x4
00912ab0 : MOV EAX,EDX
00912ab2 : SHR EAX,0x1f
00912ab5 : ADD EAX,EDX
00912ab7 : CMP EAX,0x5
00912aba : JBE 0x00912ae7
00912abc : CMP dword ptr [ECX + 0xa4],0x8
00912ac3 : JC 0x00912ad6
00912ac5 : MOV ECX,dword ptr [ECX + 0x90]
00912acb : PUSH ECX
00912acc : CALL 0x00634f4d
00912ad1 : ADD ESP,0x4
00912ad4 : JMP 0x00912ae9
00912ad6 : ADD ECX,0x90
00912adc : PUSH ECX
00912add : CALL 0x00634f4d
00912ae2 : ADD ESP,0x4
00912ae5 : JMP 0x00912ae9
00912ae7 : XOR EAX,EAX
00912ae9 : XOR EDX,EDX
00912aeb : XOR ECX,ECX
00912aed : CMP dword ptr [ESP + 0x14],EDX
00912af1 : JZ 0x00912af6
00912af3 : LEA ECX,[EDX + 0x11]
00912af6 : TEST EBX,EBX
00912af8 : JZ 0x00912b0a
00912afa : TEST ECX,ECX
00912afc : JNZ 0x00912b05
00912afe : MOV ECX,0x12
00912b03 : JMP 0x00912b0a
00912b05 : MOV EDX,0x12
00912b0a : TEST EAX,EAX
00912b0c : JZ 0x00912b22
00912b0e : TEST ECX,ECX
00912b10 : JNZ 0x00912b19
00912b12 : MOV ECX,0x10
00912b17 : JMP 0x00912b22
00912b19 : TEST EDX,EDX
00912b1b : JNZ 0x00912b22
00912b1d : MOV EDX,0x10
00912b22 : MOV EAX,dword ptr [ESP + 0x18]
00912b26 : TEST EAX,EAX
00912b28 : JZ 0x00912b3c
00912b2a : PUSH EDX
00912b2b : MOV EDX,dword ptr [ESP + 0x24]
00912b2f : PUSH ECX
00912b30 : MOV ECX,dword ptr [ESP + 0x24]
00912b34 : PUSH ECX
00912b35 : PUSH EAX
00912b36 : PUSH EDX
00912b37 : CALL 0x0090fab0
00912b3c : MOV dword ptr [ESP + 0x78],0xffffffff
00912b44 : MOV EAX,dword ptr [ESP + 0x28]
00912b48 : XOR ESI,ESI
00912b4a : CMP EAX,ESI
00912b4c : JZ 0x00912b68
00912b4e : MOV ECX,dword ptr [ESP + 0x20]
00912b52 : MOV EDI,dword ptr [ESP + 0x2c]
00912b56 : PUSH ECX
00912b57 : CALL 0x00405450
00912b5c : MOV ECX,dword ptr [ESP + 0x2c]
00912b60 : ADD ESP,0x4
00912b63 : CALL 0x006f04e0
00912b68 : MOV dword ptr [ESP + 0x30],ESI
00912b6c : MOV dword ptr [ESP + 0x2c],ESI
00912b70 : MOV dword ptr [ESP + 0x28],ESI
00912b74 : MOV ECX,dword ptr [ESP + 0x70]
00912b78 : MOV dword ptr FS:[0x0],ECX
00912b7f : POP ECX
00912b80 : POP EDI
00912b81 : POP ESI
00912b82 : POP EBX
00912b83 : MOV ESP,EBP
00912b85 : POP EBP
00912b86 : RET 0x8

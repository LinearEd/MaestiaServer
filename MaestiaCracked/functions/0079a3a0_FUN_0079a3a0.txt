PROGRAM  : Maestia.exe
FUNCTION : FUN_0079a3a0
ENTRY    : 0079a3a0
BODY     : [[0079a3a0, 0079a694]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0079a3a0(int param_1,undefined4 param_2,undefined4 *param_3)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  undefined4 *puVar4;
  int iVar5;
  undefined4 ****ppppuVar6;
  int *in_ECX;
  int in_EDX;
  int in_stack_0000001c;
  uint in_stack_00000020;
  int in_stack_00000028;
  int in_stack_0000002c;
  undefined4 *in_stack_00000038;
  int in_stack_00000048;
  uint in_stack_0000004c;
  undefined1 local_30 [4];
  undefined4 ***local_2c [4];
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b39ad9;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  puVar4 = param_3;
  if (in_stack_00000020 < 8) {
    puVar4 = &param_3;
  }
  local_14 = uVar2;
  iVar3 = FUN_00405b70(puVar4,uVar2);
  if ((iVar3 != 0) || (in_stack_0000001c != 0)) {
    FUN_00405eb0(&param_2,0,0xffffffff);
    cVar1 = FUN_007d97d0(in_ECX);
    if ((cVar1 == '\0') && (in_EDX != 0)) {
      cVar1 = FUN_004049e0();
      FUN_00405eb0(&param_2,0,0xffffffff);
      if (cVar1 != '\0') {
        local_8 = 0xffffffff;
        FUN_0047c240(&param_2);
        goto LAB_0079a677;
      }
    }
  }
  puVar4 = in_stack_00000038;
  if (in_stack_0000004c < 8) {
    puVar4 = &stack0x00000038;
  }
  iVar3 = FUN_00405b70(puVar4,uVar2);
  if ((((iVar3 != 0) || (in_stack_00000048 != 0)) &&
      (cVar1 = (**(code **)(*in_ECX + 0xe8))(&stack0x00000034,1,1,0,0,0), cVar1 == '\0')) &&
     (in_EDX != 0)) {
    cVar1 = FUN_004049e0();
    FUN_00405eb0(&stack0x00000034,0,0xffffffff);
    if (cVar1 != '\0') {
      local_8 = 0xffffffff;
      FUN_0047c240(&param_2);
      goto LAB_0079a677;
    }
  }
  local_18 = 7;
  local_1c = 0;
  local_2c[0] = (undefined4 ***)((uint)local_2c[0] & 0xffff0000);
  local_8 = CONCAT31(local_8._1_3_,1);
  iVar3 = (in_stack_0000002c - in_stack_00000028) / 0x1c;
  if (param_1 == -1) {
    if (0 < iVar3) {
      iVar5 = in_stack_00000028;
      if (iVar3 != 1) {
        iVar5 = _rand();
        iVar5 = in_stack_00000028 + (iVar5 % iVar3) * 0x1c;
      }
      goto LAB_0079a598;
    }
    FUN_00406360(&DAT_00c158dc,0);
  }
  else if ((param_1 < 0) || (iVar3 <= param_1)) {
    FUN_00406360(&DAT_00c158d8,0);
  }
  else {
    iVar5 = in_stack_00000028 + param_1 * 0x1c;
LAB_0079a598:
    FUN_00405eb0(iVar5,0,0xffffffff);
  }
  ppppuVar6 = (undefined4 ****)local_2c[0];
  if (local_18 < 8) {
    ppppuVar6 = local_2c;
  }
  iVar3 = FUN_00405b70(ppppuVar6);
  if ((iVar3 != 0) || (local_1c != 0)) {
    if (in_ECX[0xa3] == 0) {
      FUN_007d8b50();
    }
    cVar1 = FUN_0079d8b0(in_ECX[0xa3],1);
    if ((cVar1 == '\0') && (in_EDX != 0)) {
      cVar1 = FUN_004049e0();
      FUN_00405eb0(local_30,0,0xffffffff);
      if (cVar1 != '\0') {
        local_8 = CONCAT31(local_8._1_3_,cVar1 == '\0');
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_0047c240(&param_2);
        goto LAB_0079a677;
      }
    }
  }
  local_8 = local_8 & 0xffffff00;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c[0] = (undefined4 ***)((uint)local_2c[0] & 0xffff0000);
  local_8 = 0xffffffff;
  FUN_0047c240(&param_2);
LAB_0079a677:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0079a3a0 : PUSH EBP
0079a3a1 : MOV EBP,ESP
0079a3a3 : PUSH -0x1
0079a3a5 : PUSH 0xb39ad9
0079a3aa : MOV EAX,FS:[0x0]
0079a3b0 : PUSH EAX
0079a3b1 : SUB ESP,0x28
0079a3b4 : MOV EAX,[0x00d66fa0]
0079a3b9 : XOR EAX,EBP
0079a3bb : MOV dword ptr [EBP + -0x10],EAX
0079a3be : PUSH EBX
0079a3bf : PUSH ESI
0079a3c0 : PUSH EDI
0079a3c1 : PUSH EAX
0079a3c2 : LEA EAX,[EBP + -0xc]
0079a3c5 : MOV FS:[0x0],EAX
0079a3cb : MOV ESI,ECX
0079a3cd : MOV EDI,EDX
0079a3cf : MOV dword ptr [EBP + -0x34],ESI
0079a3d2 : MOV dword ptr [EBP + -0x30],EDI
0079a3d5 : MOV dword ptr [EBP + -0x4],0x0
0079a3dc : CMP dword ptr [EBP + 0x24],0x8
0079a3e0 : MOV EAX,dword ptr [EBP + 0x10]
0079a3e3 : JNC 0x0079a3e8
0079a3e5 : LEA EAX,[EBP + 0x10]
0079a3e8 : PUSH EAX
0079a3e9 : XOR EDX,EDX
0079a3eb : MOV ECX,0xc158b8
0079a3f0 : CALL 0x00405b70
0079a3f5 : ADD ESP,0x4
0079a3f8 : TEST EAX,EAX
0079a3fa : JNZ 0x0079a406
0079a3fc : CMP dword ptr [EBP + 0x20],EAX
0079a3ff : SETNZ AL
0079a402 : TEST EAX,EAX
0079a404 : JZ 0x0079a46b
0079a406 : PUSH -0x1
0079a408 : PUSH 0x0
0079a40a : LEA EAX,[EBP + 0xc]
0079a40d : PUSH EAX
0079a40e : LEA ECX,[ESI + 0x408]
0079a414 : CALL 0x00405eb0
0079a419 : PUSH ESI
0079a41a : LEA ECX,[EBP + 0xc]
0079a41d : CALL 0x007d97d0
0079a422 : TEST AL,AL
0079a424 : JNZ 0x0079a46b
0079a426 : TEST EDI,EDI
0079a428 : JZ 0x0079a46b
0079a42a : MOV ESI,0xc158bc
0079a42f : MOV ECX,EDI
0079a431 : MOV BL,0x1
0079a433 : CALL 0x004049e0
0079a438 : TEST AL,AL
0079a43a : JZ 0x0079a43e
0079a43c : XOR BL,BL
0079a43e : PUSH -0x1
0079a440 : PUSH 0x0
0079a442 : LEA ECX,[EBP + 0xc]
0079a445 : PUSH ECX
0079a446 : MOV ECX,EDI
0079a448 : CALL 0x00405eb0
0079a44d : TEST BL,BL
0079a44f : JNZ 0x0079a468
0079a451 : MOV dword ptr [EBP + -0x4],0xffffffff
0079a458 : LEA EDX,[EBP + 0xc]
0079a45b : PUSH EDX
0079a45c : CALL 0x0047c240
0079a461 : XOR AL,AL
0079a463 : JMP 0x0079a677
0079a468 : MOV ESI,dword ptr [EBP + -0x34]
0079a46b : CMP dword ptr [EBP + 0x50],0x8
0079a46f : MOV EAX,dword ptr [EBP + 0x3c]
0079a472 : JNC 0x0079a477
0079a474 : LEA EAX,[EBP + 0x3c]
0079a477 : PUSH EAX
0079a478 : XOR EDX,EDX
0079a47a : MOV ECX,0xc158c8
0079a47f : CALL 0x00405b70
0079a484 : ADD ESP,0x4
0079a487 : TEST EAX,EAX
0079a489 : JNZ 0x0079a495
0079a48b : CMP dword ptr [EBP + 0x4c],EAX
0079a48e : SETNZ AL
0079a491 : TEST EAX,EAX
0079a493 : JZ 0x0079a4f9
0079a495 : MOV EAX,dword ptr [ESI]
0079a497 : MOV EDX,dword ptr [EAX + 0xe8]
0079a49d : PUSH EDI
0079a49e : PUSH 0x0
0079a4a0 : PUSH 0x0
0079a4a2 : PUSH 0x0
0079a4a4 : PUSH 0x1
0079a4a6 : PUSH 0x1
0079a4a8 : LEA ECX,[EBP + 0x38]
0079a4ab : PUSH ECX
0079a4ac : MOV ECX,ESI
0079a4ae : CALL EDX
0079a4b0 : TEST AL,AL
0079a4b2 : JNZ 0x0079a4f9
0079a4b4 : TEST EDI,EDI
0079a4b6 : JZ 0x0079a4f9
0079a4b8 : MOV EDI,dword ptr [EBP + -0x30]
0079a4bb : MOV ESI,0xc158cc
0079a4c0 : MOV ECX,EDI
0079a4c2 : MOV BL,0x1
0079a4c4 : CALL 0x004049e0
0079a4c9 : TEST AL,AL
0079a4cb : JZ 0x0079a4cf
0079a4cd : XOR BL,BL
0079a4cf : PUSH -0x1
0079a4d1 : PUSH 0x0
0079a4d3 : LEA EAX,[EBP + 0x38]
0079a4d6 : PUSH EAX
0079a4d7 : MOV ECX,EDI
0079a4d9 : CALL 0x00405eb0
0079a4de : TEST BL,BL
0079a4e0 : JNZ 0x0079a4f9
0079a4e2 : MOV dword ptr [EBP + -0x4],0xffffffff
0079a4e9 : LEA ECX,[EBP + 0xc]
0079a4ec : PUSH ECX
0079a4ed : CALL 0x0047c240
0079a4f2 : XOR AL,AL
0079a4f4 : JMP 0x0079a677
0079a4f9 : XOR EDX,EDX
0079a4fb : MOV dword ptr [EBP + -0x14],0x7
0079a502 : MOV dword ptr [EBP + -0x18],0x0
0079a509 : MOV word ptr [EBP + -0x28],DX
0079a50d : MOV byte ptr [EBP + -0x4],0x1
0079a511 : MOV ECX,dword ptr [EBP + 0x30]
0079a514 : MOV EDI,dword ptr [EBP + 0x2c]
0079a517 : SUB ECX,EDI
0079a519 : MOV EAX,0x92492493
0079a51e : IMUL ECX
0079a520 : MOV EAX,dword ptr [EBP + 0x8]
0079a523 : ADD EDX,ECX
0079a525 : SAR EDX,0x4
0079a528 : MOV ESI,EDX
0079a52a : SHR ESI,0x1f
0079a52d : ADD ESI,EDX
0079a52f : CMP EAX,-0x1
0079a532 : JZ 0x0079a55b
0079a534 : TEST EAX,EAX
0079a536 : JL 0x0079a54a
0079a538 : CMP EAX,ESI
0079a53a : JGE 0x0079a54a
0079a53c : LEA ECX,[EAX*0x8 + 0x0]
0079a543 : SUB ECX,EAX
0079a545 : LEA EAX,[EDI + ECX*0x4]
0079a548 : JMP 0x0079a593
0079a54a : PUSH 0x0
0079a54c : PUSH 0xc158d8
0079a551 : LEA ECX,[EBP + -0x2c]
0079a554 : CALL 0x00406360
0079a559 : JMP 0x0079a5a0
0079a55b : TEST ESI,ESI
0079a55d : JG 0x0079a570
0079a55f : PUSH 0x0
0079a561 : PUSH 0xc158dc
0079a566 : LEA ECX,[EBP + -0x2c]
0079a569 : CALL 0x00406360
0079a56e : JMP 0x0079a5a0
0079a570 : CMP ESI,0x1
0079a573 : JNZ 0x0079a57c
0079a575 : PUSH -0x1
0079a577 : PUSH 0x0
0079a579 : PUSH EDI
0079a57a : JMP 0x0079a598
0079a57c : CALL 0x00635d2f
0079a581 : CDQ
0079a582 : IDIV ESI
0079a584 : MOV ECX,dword ptr [EBP + 0x2c]
0079a587 : LEA EAX,[EDX*0x8 + 0x0]
0079a58e : SUB EAX,EDX
0079a590 : LEA EAX,[ECX + EAX*0x4]
0079a593 : PUSH -0x1
0079a595 : PUSH 0x0
0079a597 : PUSH EAX
0079a598 : LEA ECX,[EBP + -0x2c]
0079a59b : CALL 0x00405eb0
0079a5a0 : CMP dword ptr [EBP + -0x14],0x8
0079a5a4 : MOV EAX,dword ptr [EBP + -0x28]
0079a5a7 : JNC 0x0079a5ac
0079a5a9 : LEA EAX,[EBP + -0x28]
0079a5ac : PUSH EAX
0079a5ad : XOR EDX,EDX
0079a5af : MOV ECX,0xc158e0
0079a5b4 : CALL 0x00405b70
0079a5b9 : ADD ESP,0x4
0079a5bc : TEST EAX,EAX
0079a5be : JNZ 0x0079a5ca
0079a5c0 : CMP dword ptr [EBP + -0x18],EAX
0079a5c3 : SETNZ AL
0079a5c6 : TEST EAX,EAX
0079a5c8 : JZ 0x0079a63f
0079a5ca : MOV ESI,dword ptr [EBP + -0x34]
0079a5cd : CMP dword ptr [ESI + 0x28c],0x0
0079a5d4 : JNZ 0x0079a5db
0079a5d6 : CALL 0x007d8b50
0079a5db : MOV EAX,dword ptr [ESI + 0x28c]
0079a5e1 : PUSH 0x1
0079a5e3 : PUSH EAX
0079a5e4 : LEA EDX,[EBP + -0x2c]
0079a5e7 : CALL 0x0079d8b0
0079a5ec : TEST AL,AL
0079a5ee : JNZ 0x0079a63f
0079a5f0 : CMP dword ptr [EBP + -0x30],0x0
0079a5f4 : JZ 0x0079a63f
0079a5f6 : MOV EDI,dword ptr [EBP + -0x30]
0079a5f9 : MOV ESI,0xc158e4
0079a5fe : MOV ECX,EDI
0079a600 : MOV BL,0x1
0079a602 : CALL 0x004049e0
0079a607 : TEST AL,AL
0079a609 : JZ 0x0079a60d
0079a60b : XOR BL,BL
0079a60d : PUSH -0x1
0079a60f : PUSH 0x0
0079a611 : LEA EDX,[EBP + -0x2c]
0079a614 : PUSH EDX
0079a615 : MOV ECX,EDI
0079a617 : CALL 0x00405eb0
0079a61c : TEST BL,BL
0079a61e : JNZ 0x0079a63f
0079a620 : MOV byte ptr [EBP + -0x4],BL
0079a623 : LEA ECX,[EBP + -0x2c]
0079a626 : CALL 0x00406560
0079a62b : MOV dword ptr [EBP + -0x4],0xffffffff
0079a632 : LEA EAX,[EBP + 0xc]
0079a635 : PUSH EAX
0079a636 : CALL 0x0047c240
0079a63b : XOR AL,AL
0079a63d : JMP 0x0079a677
0079a63f : MOV byte ptr [EBP + -0x4],0x0
0079a643 : CMP dword ptr [EBP + -0x14],0x8
0079a647 : JC 0x0079a651
0079a649 : MOV ECX,dword ptr [EBP + -0x28]
0079a64c : CALL 0x006f04e0
0079a651 : XOR ECX,ECX
0079a653 : MOV dword ptr [EBP + -0x14],0x7
0079a65a : MOV dword ptr [EBP + -0x18],0x0
0079a661 : MOV word ptr [EBP + -0x28],CX
0079a665 : MOV dword ptr [EBP + -0x4],0xffffffff
0079a66c : LEA EDX,[EBP + 0xc]
0079a66f : PUSH EDX
0079a670 : CALL 0x0047c240
0079a675 : MOV AL,0x1
0079a677 : MOV ECX,dword ptr [EBP + -0xc]
0079a67a : MOV dword ptr FS:[0x0],ECX
0079a681 : POP ECX
0079a682 : POP EDI
0079a683 : POP ESI
0079a684 : POP EBX
0079a685 : MOV ECX,dword ptr [EBP + -0x10]
0079a688 : XOR ECX,EBP
0079a68a : CALL 0x00633e6b
0079a68f : MOV ESP,EBP
0079a691 : POP EBP
0079a692 : RET 0x4c

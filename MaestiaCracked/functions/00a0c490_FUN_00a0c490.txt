PROGRAM  : Maestia.exe
FUNCTION : FUN_00a0c490
ENTRY    : 00a0c490
BODY     : [[00a0c490, 00a0c653]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a0c490(LPWSTR param_1)

{
  undefined *puVar1;
  BOOL BVar2;
  undefined *puVar3;
  undefined *puVar4;
  undefined4 *puVar5;
  void *in_ECX;
  int iVar6;
  undefined4 *puVar7;
  undefined1 auStack_22c [4];
  _SYSTEMTIME local_228;
  wchar_t local_218 [262];
  uint local_c;
  
  local_c = DAT_00d66fa0 ^ (uint)auStack_22c;
  GetLocalTime(&local_228);
  if (in_ECX == (void *)0x0) {
    puVar5 = DAT_00d71c8c;
    if (DAT_00d71ca0 < 8) {
      puVar5 = &DAT_00d71c8c;
    }
    __snwprintf(local_218,0x103,L"%s[%04d%02d%02d %02d-%02d-%02d]",puVar5,(uint)local_228.wYear,
                (uint)local_228.wMonth,(uint)local_228.wDay,(uint)local_228.wHour,
                (uint)local_228.wMinute,(uint)local_228.wSecond);
    lstrcatW(param_1,local_218);
    lstrcatW(param_1,L".dmp");
    __security_check_cookie(local_c ^ (uint)auStack_22c);
    return;
  }
  BVar2 = IsBadReadPtr(in_ECX,4);
  if (BVar2 != 1) {
    FUN_00a0a640();
    puVar5 = *(undefined4 **)((int)in_ECX + 4);
    puVar7 = &DAT_00d7c968;
    for (iVar6 = 0xb3; iVar6 != 0; iVar6 = iVar6 + -1) {
      *puVar7 = *puVar5;
      puVar5 = puVar5 + 1;
      puVar7 = puVar7 + 1;
    }
    FUN_00a0bcc0(4,1);
  }
  puVar3 = (undefined *)FUN_00a0bcc0(4,1);
  puVar1 = &DAT_00cab368;
  while (puVar3 != (undefined *)0x0) {
    puVar4 = (undefined *)FUN_00a0bcc0(4,1);
    puVar1 = puVar3;
    puVar3 = puVar4;
  }
  if (puVar1 == (undefined *)0x0) {
    __snwprintf(local_218,0x103,L"%s_c%d_p%d[%04d%02d%02d %02d-%02d-%02d]",L"unknown",
                DAT_00da9420 & 0xffff,DAT_00da9424 & 0xffff,(uint)local_228.wYear,
                (uint)local_228.wMonth,(uint)local_228.wDay,(uint)local_228.wHour,
                (uint)local_228.wMinute,(uint)local_228.wSecond);
    lstrcatW(param_1,local_218);
    lstrcatW(param_1,L".dmp");
    __security_check_cookie(local_c ^ (uint)auStack_22c);
    return;
  }
  __snwprintf(local_218,0x103,L"%s_c%d_p%d[%04d%02d%02d %02d-%02d-%02d]",puVar1,
              DAT_00da9420 & 0xffff,DAT_00da9424 & 0xffff,(uint)local_228.wYear,
              (uint)local_228.wMonth,(uint)local_228.wDay,(uint)local_228.wHour,
              (uint)local_228.wMinute,(uint)local_228.wSecond);
  lstrcatW(param_1,local_218);
  lstrcatW(param_1,L".dmp");
  __security_check_cookie(local_c ^ (uint)auStack_22c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a0c490 : PUSH EBP
00a0c491 : MOV EBP,ESP
00a0c493 : AND ESP,0xfffffff8
00a0c496 : SUB ESP,0x224
00a0c49c : MOV EAX,[0x00d66fa0]
00a0c4a1 : XOR EAX,ESP
00a0c4a3 : MOV dword ptr [ESP + 0x220],EAX
00a0c4aa : PUSH EBX
00a0c4ab : MOV EBX,dword ptr [EBP + 0x8]
00a0c4ae : PUSH ESI
00a0c4af : PUSH EDI
00a0c4b0 : LEA EAX,[ESP + 0x10]
00a0c4b4 : PUSH EAX
00a0c4b5 : MOV EDI,ECX
00a0c4b7 : CALL dword ptr [0x00b85154]
00a0c4bd : TEST EDI,EDI
00a0c4bf : JZ 0x00a0c5da
00a0c4c5 : PUSH 0x4
00a0c4c7 : PUSH EDI
00a0c4c8 : CALL dword ptr [0x00b85170]
00a0c4ce : CMP EAX,0x1
00a0c4d1 : JZ 0x00a0c4f3
00a0c4d3 : MOV ESI,dword ptr [EDI + 0x4]
00a0c4d6 : CALL 0x00a0a640
00a0c4db : MOV ESI,dword ptr [EDI + 0x4]
00a0c4de : PUSH 0x1
00a0c4e0 : MOV ECX,0xb3
00a0c4e5 : MOV EDI,0xd7c968
00a0c4ea : PUSH 0x4
00a0c4ec : MOVSD.REP ES:EDI,ESI
00a0c4ee : CALL 0x00a0bcc0
00a0c4f3 : PUSH 0x1
00a0c4f5 : PUSH 0x4
00a0c4f7 : MOV ESI,0xcab368
00a0c4fc : CALL 0x00a0bcc0
00a0c501 : TEST EAX,EAX
00a0c503 : JZ 0x00a0c514
00a0c505 : PUSH 0x1
00a0c507 : PUSH 0x4
00a0c509 : MOV ESI,EAX
00a0c50b : CALL 0x00a0bcc0
00a0c510 : TEST EAX,EAX
00a0c512 : JNZ 0x00a0c505
00a0c514 : MOVZX EDX,word ptr [ESP + 0x1c]
00a0c519 : PUSH EDX
00a0c51a : MOVZX EDX,word ptr [ESP + 0x1e]
00a0c51f : MOV ECX,dword ptr [0x00da9424]
00a0c525 : MOV EAX,[0x00da9420]
00a0c52a : PUSH EDX
00a0c52b : MOVZX EDX,word ptr [ESP + 0x20]
00a0c530 : PUSH EDX
00a0c531 : MOVZX EDX,word ptr [ESP + 0x22]
00a0c536 : PUSH EDX
00a0c537 : MOVZX EDX,word ptr [ESP + 0x22]
00a0c53c : PUSH EDX
00a0c53d : MOVZX EDX,word ptr [ESP + 0x24]
00a0c542 : AND ECX,0xffff
00a0c548 : PUSH EDX
00a0c549 : AND EAX,0xffff
00a0c54e : PUSH ECX
00a0c54f : PUSH EAX
00a0c550 : LEA EAX,[ESP + 0x40]
00a0c554 : TEST ESI,ESI
00a0c556 : JZ 0x00a0c597
00a0c558 : PUSH ESI
00a0c559 : PUSH 0xcab370
00a0c55e : PUSH 0x103
00a0c563 : PUSH EAX
00a0c564 : CALL 0x006343c8
00a0c569 : MOV ESI,dword ptr [0x00b8515c]
00a0c56f : ADD ESP,0x30
00a0c572 : LEA ECX,[ESP + 0x20]
00a0c576 : PUSH ECX
00a0c577 : PUSH EBX
00a0c578 : CALL ESI
00a0c57a : PUSH 0xcab3c0
00a0c57f : PUSH EBX
00a0c580 : CALL ESI
00a0c582 : POP EDI
00a0c583 : POP ESI
00a0c584 : POP EBX
00a0c585 : MOV ECX,dword ptr [ESP + 0x220]
00a0c58c : XOR ECX,ESP
00a0c58e : CALL 0x00633e6b
00a0c593 : MOV ESP,EBP
00a0c595 : POP EBP
00a0c596 : RET
00a0c597 : PUSH 0xcab3cc
00a0c59c : PUSH 0xcab3e8
00a0c5a1 : PUSH 0x103
00a0c5a6 : PUSH EAX
00a0c5a7 : CALL 0x006343c8
00a0c5ac : MOV ESI,dword ptr [0x00b8515c]
00a0c5b2 : ADD ESP,0x30
00a0c5b5 : LEA ECX,[ESP + 0x20]
00a0c5b9 : PUSH ECX
00a0c5ba : PUSH EBX
00a0c5bb : CALL ESI
00a0c5bd : PUSH 0xcab3dc
00a0c5c2 : PUSH EBX
00a0c5c3 : CALL ESI
00a0c5c5 : POP EDI
00a0c5c6 : POP ESI
00a0c5c7 : POP EBX
00a0c5c8 : MOV ECX,dword ptr [ESP + 0x220]
00a0c5cf : XOR ECX,ESP
00a0c5d1 : CALL 0x00633e6b
00a0c5d6 : MOV ESP,EBP
00a0c5d8 : POP EBP
00a0c5d9 : RET
00a0c5da : CMP dword ptr [0x00d71ca0],0x8
00a0c5e1 : MOV EAX,[0x00d71c8c]
00a0c5e6 : JNC 0x00a0c5ed
00a0c5e8 : MOV EAX,0xd71c8c
00a0c5ed : MOVZX EDX,word ptr [ESP + 0x1c]
00a0c5f2 : MOVZX ECX,word ptr [ESP + 0x1a]
00a0c5f7 : PUSH EDX
00a0c5f8 : MOVZX EDX,word ptr [ESP + 0x1c]
00a0c5fd : PUSH ECX
00a0c5fe : MOVZX ECX,word ptr [ESP + 0x1e]
00a0c603 : PUSH EDX
00a0c604 : MOVZX EDX,word ptr [ESP + 0x1e]
00a0c609 : PUSH ECX
00a0c60a : MOVZX ECX,word ptr [ESP + 0x20]
00a0c60f : PUSH EDX
00a0c610 : PUSH ECX
00a0c611 : PUSH EAX
00a0c612 : PUSH 0xcab438
00a0c617 : LEA EDX,[ESP + 0x40]
00a0c61b : PUSH 0x103
00a0c620 : PUSH EDX
00a0c621 : CALL 0x006343c8
00a0c626 : MOV ESI,dword ptr [0x00b8515c]
00a0c62c : ADD ESP,0x28
00a0c62f : LEA EAX,[ESP + 0x20]
00a0c633 : PUSH EAX
00a0c634 : PUSH EBX
00a0c635 : CALL ESI
00a0c637 : PUSH 0xcab478
00a0c63c : PUSH EBX
00a0c63d : CALL ESI
00a0c63f : MOV ECX,dword ptr [ESP + 0x22c]
00a0c646 : POP EDI
00a0c647 : POP ESI
00a0c648 : POP EBX
00a0c649 : XOR ECX,ESP
00a0c64b : CALL 0x00633e6b
00a0c650 : MOV ESP,EBP
00a0c652 : POP EBP
00a0c653 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005b9cc0
ENTRY    : 005b9cc0
BODY     : [[005b9cc0, 005b9e22]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005b9cc0(uint param_1)

{
  undefined1 *puVar1;
  undefined4 uVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  LONG LVar6;
  undefined4 *puVar7;
  uint uVar8;
  undefined4 *puStack_14;
  undefined1 auStack_10 [4];
  undefined4 uStack_c;
  
  uVar3 = param_1;
  if (0 < *(int *)(param_1 + 0x1c)) {
    puVar1 = *(undefined1 **)(param_1 + 4);
    FUN_00526400();
    *puVar1 = 0;
    iVar4 = (**(code **)(**(int **)(uVar3 + 8) + 8))();
    if (iVar4 == 0x19) {
      iVar4 = FUN_00515840(0x30,0);
      if (iVar4 == 0) {
        iVar4 = 0;
      }
      else {
        iVar4 = FUN_00551210(*(undefined4 *)(uVar3 + 0x18));
      }
      uVar2 = *(undefined4 *)(uVar3 + 0x18);
      FUN_00526260(0);
      FUN_005272e0(&puStack_14,uVar2,0xffffffff,0);
      FUN_0051c480(*puStack_14);
      iVar5 = FUN_005b9c60(&param_1);
      if (iVar5 == 0) {
        puVar7 = (undefined4 *)0x0;
      }
      else {
        puVar7 = (undefined4 *)(iVar5 + 4);
      }
      uVar8 = param_1 & 0xfffffffc;
      LVar6 = InterlockedExchangeAdd((LONG *)(uVar8 + 4),-1);
      if (LVar6 == 1) {
        FUN_00515cf0(uVar8);
      }
      if (puVar7 != (undefined4 *)0x0) {
        uStack_c = *puVar7;
        auStack_10[0] = 4;
        FUN_00500670(*(int *)(uVar3 + 0x18) + 0x78,"bytesLoaded",auStack_10);
        FUN_00526bc0();
        uStack_c = puVar7[1];
        auStack_10[0] = 4;
        FUN_00500670(*(int *)(uVar3 + 0x18) + 0x78,"bytesTotal",auStack_10);
        FUN_00526bc0();
      }
      FUN_005271c0(iVar4);
      puStack_14[2] = puStack_14[2] + -1;
      if (puStack_14[2] == 0) {
        FUN_00525340();
      }
      if (iVar4 != 0) {
        FUN_00503db0();
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005b9cc0 : SUB ESP,0x14
005b9cc3 : PUSH ESI
005b9cc4 : MOV ESI,dword ptr [ESP + 0x1c]
005b9cc8 : CMP dword ptr [ESI + 0x1c],0x1
005b9ccc : JL 0x005b9e1e
005b9cd2 : PUSH EDI
005b9cd3 : MOV EDI,dword ptr [ESI + 0x4]
005b9cd6 : MOV ECX,EDI
005b9cd8 : CALL 0x00526400
005b9cdd : MOV byte ptr [EDI],0x0
005b9ce0 : MOV ECX,dword ptr [ESI + 0x8]
005b9ce3 : MOV EAX,dword ptr [ECX]
005b9ce5 : MOV EDX,dword ptr [EAX + 0x8]
005b9ce8 : CALL EDX
005b9cea : CMP EAX,0x19
005b9ced : JNZ 0x005b9e1d
005b9cf3 : MOV EAX,dword ptr [ESI + 0x8]
005b9cf6 : PUSH EBX
005b9cf7 : PUSH EBP
005b9cf8 : TEST EAX,EAX
005b9cfa : JZ 0x005b9d01
005b9cfc : LEA EBP,[EAX + -0x10]
005b9cff : JMP 0x005b9d03
005b9d01 : XOR EBP,EBP
005b9d03 : MOV EAX,dword ptr [ESI + 0x18]
005b9d06 : MOV ECX,dword ptr [EAX + 0x78]
005b9d09 : MOV ECX,dword ptr [ECX + 0x288]
005b9d0f : PUSH 0x0
005b9d11 : PUSH 0x30
005b9d13 : CALL 0x00515840
005b9d18 : TEST EAX,EAX
005b9d1a : JZ 0x005b9d2b
005b9d1c : MOV EDX,dword ptr [ESI + 0x18]
005b9d1f : PUSH EDX
005b9d20 : MOV ECX,EAX
005b9d22 : CALL 0x00551210
005b9d27 : MOV EBX,EAX
005b9d29 : JMP 0x005b9d2d
005b9d2b : XOR EBX,EBX
005b9d2d : MOV EDI,dword ptr [ESI + 0x18]
005b9d30 : PUSH 0x0
005b9d32 : MOV ECX,ESI
005b9d34 : CALL 0x00526260
005b9d39 : PUSH 0x0
005b9d3b : PUSH -0x1
005b9d3d : PUSH EDI
005b9d3e : LEA ECX,[ESP + 0x1c]
005b9d42 : PUSH ECX
005b9d43 : MOV ECX,EAX
005b9d45 : CALL 0x005272e0
005b9d4a : MOV EDX,dword ptr [ESP + 0x10]
005b9d4e : MOV EAX,dword ptr [EDX]
005b9d50 : PUSH EAX
005b9d51 : LEA ECX,[ESP + 0x2c]
005b9d55 : CALL 0x0051c480
005b9d5a : LEA ECX,[ESP + 0x28]
005b9d5e : PUSH ECX
005b9d5f : LEA ECX,[EBP + 0x30]
005b9d62 : CALL 0x005b9c60
005b9d67 : TEST EAX,EAX
005b9d69 : JZ 0x005b9d70
005b9d6b : LEA EBP,[EAX + 0x4]
005b9d6e : JMP 0x005b9d72
005b9d70 : XOR EBP,EBP
005b9d72 : MOV EDI,dword ptr [ESP + 0x28]
005b9d76 : AND EDI,0xfffffffc
005b9d79 : PUSH -0x1
005b9d7b : LEA EDX,[EDI + 0x4]
005b9d7e : PUSH EDX
005b9d7f : CALL dword ptr [0x00b851cc]
005b9d85 : SUB EAX,0x1
005b9d88 : JNZ 0x005b9d90
005b9d8a : PUSH EDI
005b9d8b : CALL 0x00515cf0
005b9d90 : TEST EBP,EBP
005b9d92 : JZ 0x005b9df1
005b9d94 : MOV EDX,dword ptr [ESI + 0x18]
005b9d97 : MOV EAX,dword ptr [EBP]
005b9d9a : LEA ECX,[ESP + 0x14]
005b9d9e : PUSH ECX
005b9d9f : PUSH 0xb90a28
005b9da4 : ADD EDX,0x78
005b9da7 : LEA EDI,[EBX + 0x10]
005b9daa : PUSH EDX
005b9dab : MOV ECX,EDI
005b9dad : MOV byte ptr [ESP + 0x20],0x4
005b9db2 : MOV dword ptr [ESP + 0x24],EAX
005b9db6 : CALL 0x00500670
005b9dbb : LEA ECX,[ESP + 0x14]
005b9dbf : CALL 0x00526bc0
005b9dc4 : MOV EDX,dword ptr [ESI + 0x18]
005b9dc7 : MOV EAX,dword ptr [EBP + 0x4]
005b9dca : LEA ECX,[ESP + 0x14]
005b9dce : PUSH ECX
005b9dcf : PUSH 0xb90a1c
005b9dd4 : ADD EDX,0x78
005b9dd7 : PUSH EDX
005b9dd8 : MOV ECX,EDI
005b9dda : MOV byte ptr [ESP + 0x20],0x4
005b9ddf : MOV dword ptr [ESP + 0x24],EAX
005b9de3 : CALL 0x00500670
005b9de8 : LEA ECX,[ESP + 0x14]
005b9dec : CALL 0x00526bc0
005b9df1 : MOV ECX,dword ptr [ESI + 0x4]
005b9df4 : PUSH EBX
005b9df5 : CALL 0x005271c0
005b9dfa : MOV EAX,dword ptr [ESP + 0x10]
005b9dfe : DEC dword ptr [EAX + 0x8]
005b9e01 : MOV ECX,EAX
005b9e03 : ADD EAX,0x8
005b9e06 : CMP dword ptr [EAX],0x0
005b9e09 : JNZ 0x005b9e10
005b9e0b : CALL 0x00525340
005b9e10 : TEST EBX,EBX
005b9e12 : JZ 0x005b9e1b
005b9e14 : MOV ECX,EBX
005b9e16 : CALL 0x00503db0
005b9e1b : POP EBP
005b9e1c : POP EBX
005b9e1d : POP EDI
005b9e1e : POP ESI
005b9e1f : ADD ESP,0x14
005b9e22 : RET

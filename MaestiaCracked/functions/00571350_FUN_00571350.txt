PROGRAM  : Maestia.exe
FUNCTION : FUN_00571350
ENTRY    : 00571350
BODY     : [[00571350, 00571576]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00571350(int param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int in_ECX;
  bool bVar7;
  
  uVar1 = *(uint *)(param_1 + 4);
  if ((uVar1 & 4) == 0) {
    if ((uVar1 & 8) == 0) {
      if ((uVar1 & 0x10) == 0) {
        iVar3 = FUN_00515840(0x34,0);
        if ((iVar3 == 0) || (iVar3 = FUN_00570d50(param_1,in_ECX), iVar3 == 0)) goto LAB_0057152c;
        for (iVar4 = *(int *)(in_ECX + 0xb48); iVar4 != 0; iVar4 = *(int *)(iVar4 + 4)) {
          iVar5 = *(int *)(*(int *)(iVar3 + 0x10) + 0x14);
          iVar2 = *(int *)(iVar4 + 0x10);
          if (iVar5 == 0) {
            if (*(int *)(iVar2 + 0x10) != -1) {
              bVar7 = *(int *)(iVar2 + 0x10) == *(int *)(*(int *)(iVar3 + 0x10) + 0x10);
              goto LAB_00571517;
            }
          }
          else if (*(int *)(iVar2 + 0x14) != 0) {
            bVar7 = *(int *)(*(int *)(iVar2 + 0x14) + 0xc) == *(int *)(iVar5 + 0xc);
LAB_00571517:
            if (bVar7) {
              *(undefined1 *)(iVar2 + 100) = 1;
            }
          }
        }
      }
      else {
        iVar3 = FUN_0051b1a0();
        if (((iVar3 == 0) || (iVar3 = FUN_00515840(0x1c,0), iVar3 == 0)) ||
           (iVar3 = FUN_00571140(param_1,in_ECX), iVar3 == 0)) goto LAB_0057152c;
        iVar4 = FUN_00526fa0(0);
        if (iVar4 != 0) {
          iVar5 = FUN_00526fa0(0);
          for (iVar4 = *(int *)(in_ECX + 0xb48); iVar4 != 0; iVar4 = *(int *)(iVar4 + 4)) {
            iVar2 = *(int *)(iVar4 + 0x10);
            if ((*(char *)(iVar2 + 0x50) != '\0') && (iVar6 = FUN_00526fa0(0), iVar5 == iVar6)) {
              *(undefined1 *)(iVar2 + 100) = 1;
            }
          }
        }
      }
    }
    else {
      iVar3 = FUN_0051b1a0();
      if (((iVar3 == 0) || (iVar3 = FUN_00515840(0x1c,0), iVar3 == 0)) ||
         (iVar3 = FUN_00570fd0(param_1,in_ECX), iVar3 == 0)) goto LAB_0057152c;
      iVar4 = FUN_00526fa0(0);
      if (iVar4 != 0) {
        iVar5 = FUN_00526fa0(0);
        for (iVar4 = *(int *)(in_ECX + 0xb48); iVar4 != 0; iVar4 = *(int *)(iVar4 + 4)) {
          iVar2 = *(int *)(iVar4 + 0x10);
          if ((*(char *)(iVar2 + 0x3c) != '\0') && (iVar6 = FUN_00526fa0(0), iVar5 == iVar6)) {
            *(undefined1 *)(iVar2 + 100) = 1;
          }
        }
      }
    }
  }
  else {
    iVar3 = FUN_00515840(0x1c,0);
    if (iVar3 == 0) goto LAB_0057152c;
    iVar3 = FUN_00570e90(param_1,in_ECX);
  }
  if (iVar3 != 0) {
    iVar4 = *(int *)(in_ECX + 0xb48);
    if (iVar4 != 0) {
      iVar5 = *(int *)(iVar4 + 4);
      while (iVar5 != 0) {
        iVar4 = *(int *)(iVar4 + 4);
        iVar5 = *(int *)(iVar4 + 4);
      }
      *(int *)(iVar4 + 4) = iVar3;
      *(int *)(iVar3 + 8) = iVar4;
      return;
    }
    *(int *)(in_ECX + 0xb48) = iVar3;
    return;
  }
LAB_0057152c:
  FUN_0056ef70();
  FUN_00515cf0(param_1);
  return;
}



============================================================
DISASSEMBLY
============================================================
00571350 : PUSH ECX
00571351 : PUSH EBX
00571352 : PUSH EBP
00571353 : MOV EBP,dword ptr [ESP + 0x10]
00571357 : MOV EAX,dword ptr [EBP + 0x4]
0057135a : PUSH ESI
0057135b : PUSH EDI
0057135c : MOV EBX,ECX
0057135e : TEST AL,0x4
00571360 : JZ 0x00571386
00571362 : MOV ECX,dword ptr [EBX + 0x14]
00571365 : PUSH 0x0
00571367 : PUSH 0x1c
00571369 : CALL 0x00515840
0057136e : TEST EAX,EAX
00571370 : JZ 0x0057152c
00571376 : PUSH EBX
00571377 : PUSH EBP
00571378 : MOV ECX,EAX
0057137a : CALL 0x00570e90
0057137f : MOV EDI,EAX
00571381 : JMP 0x00571528
00571386 : TEST AL,0x8
00571388 : JZ 0x00571429
0057138e : LEA ECX,[EBP + 0xc]
00571391 : CALL 0x0051b1a0
00571396 : TEST EAX,EAX
00571398 : JZ 0x0057152c
0057139e : MOV ECX,dword ptr [EBX + 0x14]
005713a1 : PUSH 0x0
005713a3 : PUSH 0x1c
005713a5 : CALL 0x00515840
005713aa : TEST EAX,EAX
005713ac : JZ 0x0057152c
005713b2 : PUSH EBX
005713b3 : PUSH EBP
005713b4 : MOV ECX,EAX
005713b6 : CALL 0x00570fd0
005713bb : MOV EDI,EAX
005713bd : TEST EDI,EDI
005713bf : JZ 0x0057152c
005713c5 : MOV ECX,dword ptr [EDI + 0x10]
005713c8 : PUSH 0x0
005713ca : ADD ECX,0x3c
005713cd : CALL 0x00526fa0
005713d2 : TEST EAX,EAX
005713d4 : JZ 0x00571528
005713da : MOV ECX,dword ptr [EDI + 0x10]
005713dd : PUSH 0x0
005713df : ADD ECX,0x3c
005713e2 : CALL 0x00526fa0
005713e7 : MOV ESI,dword ptr [EBX + 0xb48]
005713ed : MOV dword ptr [ESP + 0x10],EAX
005713f1 : TEST ESI,ESI
005713f3 : JZ 0x00571528
005713f9 : LEA ESP,[ESP]
00571400 : MOV EBP,dword ptr [ESI + 0x10]
00571403 : CMP byte ptr [EBP + 0x3c],0x0
00571407 : LEA ECX,[EBP + 0x3c]
0057140a : JZ 0x0057141d
0057140c : PUSH 0x0
0057140e : CALL 0x00526fa0
00571413 : CMP dword ptr [ESP + 0x10],EAX
00571417 : JNZ 0x0057141d
00571419 : MOV byte ptr [EBP + 0x64],0x1
0057141d : MOV ESI,dword ptr [ESI + 0x4]
00571420 : TEST ESI,ESI
00571422 : JNZ 0x00571400
00571424 : JMP 0x00571524
00571429 : TEST AL,0x10
0057142b : JZ 0x005714c6
00571431 : LEA ECX,[EBP + 0xc]
00571434 : CALL 0x0051b1a0
00571439 : TEST EAX,EAX
0057143b : JZ 0x0057152c
00571441 : MOV ECX,dword ptr [EBX + 0x14]
00571444 : PUSH 0x0
00571446 : PUSH 0x1c
00571448 : CALL 0x00515840
0057144d : TEST EAX,EAX
0057144f : JZ 0x0057152c
00571455 : PUSH EBX
00571456 : PUSH EBP
00571457 : MOV ECX,EAX
00571459 : CALL 0x00571140
0057145e : MOV EDI,EAX
00571460 : TEST EDI,EDI
00571462 : JZ 0x0057152c
00571468 : MOV ECX,dword ptr [EDI + 0x10]
0057146b : PUSH 0x0
0057146d : ADD ECX,0x50
00571470 : CALL 0x00526fa0
00571475 : TEST EAX,EAX
00571477 : JZ 0x00571528
0057147d : MOV ECX,dword ptr [EDI + 0x10]
00571480 : PUSH 0x0
00571482 : ADD ECX,0x50
00571485 : CALL 0x00526fa0
0057148a : MOV ESI,dword ptr [EBX + 0xb48]
00571490 : MOV dword ptr [ESP + 0x10],EAX
00571494 : TEST ESI,ESI
00571496 : JZ 0x00571528
0057149c : LEA ESP,[ESP]
005714a0 : MOV EBP,dword ptr [ESI + 0x10]
005714a3 : CMP byte ptr [EBP + 0x50],0x0
005714a7 : LEA ECX,[EBP + 0x50]
005714aa : JZ 0x005714bd
005714ac : PUSH 0x0
005714ae : CALL 0x00526fa0
005714b3 : CMP dword ptr [ESP + 0x10],EAX
005714b7 : JNZ 0x005714bd
005714b9 : MOV byte ptr [EBP + 0x64],0x1
005714bd : MOV ESI,dword ptr [ESI + 0x4]
005714c0 : TEST ESI,ESI
005714c2 : JNZ 0x005714a0
005714c4 : JMP 0x00571524
005714c6 : MOV ECX,dword ptr [EBX + 0x14]
005714c9 : PUSH 0x0
005714cb : PUSH 0x34
005714cd : CALL 0x00515840
005714d2 : TEST EAX,EAX
005714d4 : JZ 0x0057152c
005714d6 : PUSH EBX
005714d7 : PUSH EBP
005714d8 : MOV ECX,EAX
005714da : CALL 0x00570d50
005714df : MOV EDI,EAX
005714e1 : TEST EDI,EDI
005714e3 : JZ 0x0057152c
005714e5 : MOV EAX,dword ptr [EBX + 0xb48]
005714eb : TEST EAX,EAX
005714ed : JZ 0x00571528
005714ef : NOP
005714f0 : MOV ESI,dword ptr [EDI + 0x10]
005714f3 : MOV EBP,dword ptr [ESI + 0x14]
005714f6 : MOV EDX,dword ptr [EAX + 0x10]
005714f9 : TEST EBP,EBP
005714fb : JZ 0x0057150c
005714fd : MOV ECX,dword ptr [EDX + 0x14]
00571500 : TEST ECX,ECX
00571502 : JZ 0x0057151d
00571504 : MOV ECX,dword ptr [ECX + 0xc]
00571507 : CMP ECX,dword ptr [EBP + 0xc]
0057150a : JMP 0x00571517
0057150c : MOV ECX,dword ptr [EDX + 0x10]
0057150f : CMP ECX,-0x1
00571512 : JZ 0x0057151d
00571514 : CMP ECX,dword ptr [ESI + 0x10]
00571517 : JNZ 0x0057151d
00571519 : MOV byte ptr [EDX + 0x64],0x1
0057151d : MOV EAX,dword ptr [EAX + 0x4]
00571520 : TEST EAX,EAX
00571522 : JNZ 0x005714f0
00571524 : MOV EBP,dword ptr [ESP + 0x18]
00571528 : TEST EDI,EDI
0057152a : JNZ 0x00571541
0057152c : MOV ECX,EBP
0057152e : CALL 0x0056ef70
00571533 : PUSH EBP
00571534 : CALL 0x00515cf0
00571539 : POP EDI
0057153a : POP ESI
0057153b : POP EBP
0057153c : POP EBX
0057153d : POP ECX
0057153e : RET 0x4
00571541 : MOV EAX,dword ptr [EBX + 0xb48]
00571547 : TEST EAX,EAX
00571549 : JNZ 0x00571559
0057154b : MOV dword ptr [EBX + 0xb48],EDI
00571551 : POP EDI
00571552 : POP ESI
00571553 : POP EBP
00571554 : POP EBX
00571555 : POP ECX
00571556 : RET 0x4
00571559 : CMP dword ptr [EAX + 0x4],0x0
0057155d : JZ 0x00571569
0057155f : NOP
00571560 : MOV EAX,dword ptr [EAX + 0x4]
00571563 : CMP dword ptr [EAX + 0x4],0x0
00571567 : JNZ 0x00571560
00571569 : MOV dword ptr [EAX + 0x4],EDI
0057156c : MOV dword ptr [EDI + 0x8],EAX
0057156f : POP EDI
00571570 : POP ESI
00571571 : POP EBP
00571572 : POP EBX
00571573 : POP ECX
00571574 : RET 0x4

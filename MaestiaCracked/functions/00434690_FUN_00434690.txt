PROGRAM  : Maestia.exe
FUNCTION : FUN_00434690
ENTRY    : 00434690
BODY     : [[00434690, 004346e3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00434690(void)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  wchar_t *in_ECX;
  ushort *unaff_ESI;
  
  _Dest = (wchar_t *)(unaff_ESI + 2);
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 1) = 0x46;
  *(undefined1 *)((int)unaff_ESI + 3) = 0x37;
  _wcsncpy(_Dest,in_ECX,0xff);
  unaff_ESI[0x101] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 3) >> 1) * 2 + 6U ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00434690 : PUSH EDI
00434691 : PUSH 0xff
00434696 : PUSH ECX
00434697 : XOR EAX,EAX
00434699 : LEA EDI,[ESI + 0x4]
0043469c : PUSH EDI
0043469d : MOV word ptr [ESI],AX
004346a0 : MOV byte ptr [ESI + 0x2],0x46
004346a4 : MOV byte ptr [ESI + 0x3],0x37
004346a8 : CALL 0x00634e39
004346ad : ADD ESP,0xc
004346b0 : XOR EDX,EDX
004346b2 : MOV EAX,EDI
004346b4 : MOV word ptr [EDI + 0x1fe],DX
004346bb : LEA EDX,[EAX + 0x2]
004346be : POP EDI
004346bf : NOP
004346c0 : MOV CX,word ptr [EAX]
004346c3 : ADD EAX,0x2
004346c6 : TEST CX,CX
004346c9 : JNZ 0x004346c0
004346cb : SUB EAX,EDX
004346cd : SAR EAX,0x1
004346cf : LEA EAX,[EAX + EAX*0x1 + 0x6]
004346d3 : XOR AX,word ptr [ESI]
004346d6 : MOV ECX,0x1fff
004346db : AND AX,CX
004346de : XOR word ptr [ESI],AX
004346e1 : MOV EAX,ESI
004346e3 : RET

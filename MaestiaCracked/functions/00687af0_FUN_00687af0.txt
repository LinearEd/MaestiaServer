PROGRAM  : Maestia.exe
FUNCTION : FUN_00687af0
ENTRY    : 00687af0
BODY     : [[00687af0, 00687b56]]

============================================================
DECOMPILED C CODE
============================================================

undefined2 FUN_00687af0(int *param_1,undefined4 *param_2)

{
  undefined2 uVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar3 = param_2;
  uVar1 = 0;
  *param_2 = 0;
  iVar2 = param_1[2];
  if ((uint)param_1[1] <= iVar2 + 1U) {
LAB_00687b4c:
    *puVar3 = 0x55;
    return 0;
  }
  if ((code *)param_1[5] == (code *)0x0) {
    puVar3 = (undefined4 *)(*param_1 + iVar2);
    if (puVar3 == (undefined4 *)0x0) goto LAB_00687b45;
  }
  else {
    iVar2 = (*(code *)param_1[5])(param_1,iVar2,&param_2,2);
    if (iVar2 != 2) goto LAB_00687b4c;
    puVar3 = &param_2;
  }
  uVar1 = *(undefined2 *)puVar3;
LAB_00687b45:
  param_1[2] = param_1[2] + 2;
  return uVar1;
}



============================================================
DISASSEMBLY
============================================================
00687af0 : PUSH ESI
00687af1 : MOV ESI,dword ptr [ESP + 0x8]
00687af5 : PUSH EDI
00687af6 : MOV EDI,dword ptr [ESP + 0x10]
00687afa : XOR EAX,EAX
00687afc : MOV dword ptr [EDI],EAX
00687afe : MOV EDX,dword ptr [ESI + 0x8]
00687b01 : LEA ECX,[EDX + 0x1]
00687b04 : CMP ECX,dword ptr [ESI + 0x4]
00687b07 : JNC 0x00687b4c
00687b09 : MOV ECX,dword ptr [ESI + 0x14]
00687b0c : TEST ECX,ECX
00687b0e : JZ 0x00687b29
00687b10 : PUSH 0x2
00687b12 : LEA EAX,[ESP + 0x14]
00687b16 : PUSH EAX
00687b17 : PUSH EDX
00687b18 : PUSH ESI
00687b19 : CALL ECX
00687b1b : ADD ESP,0x10
00687b1e : CMP EAX,0x2
00687b21 : JNZ 0x00687b4c
00687b23 : LEA ECX,[ESP + 0x10]
00687b27 : JMP 0x00687b2f
00687b29 : MOV ECX,dword ptr [ESI]
00687b2b : ADD ECX,EDX
00687b2d : JZ 0x00687b45
00687b2f : MOVSX DX,byte ptr [ECX + 0x1]
00687b34 : MOVZX AX,byte ptr [ECX]
00687b38 : ADD ECX,0x2
00687b3b : SHL DX,0x8
00687b3f : OR DX,AX
00687b42 : MOVZX EAX,DX
00687b45 : ADD dword ptr [ESI + 0x8],0x2
00687b49 : POP EDI
00687b4a : POP ESI
00687b4b : RET
00687b4c : MOV dword ptr [EDI],0x55
00687b52 : POP EDI
00687b53 : XOR EAX,EAX
00687b55 : POP ESI
00687b56 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006852d0
ENTRY    : 006852d0
BODY     : [[006852d0, 006854ad]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006852d0(int param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  LONG LVar2;
  uint *puVar3;
  GRefCountImpl *this;
  int *unaff_EDI;
  int *piVar4;
  int *piStack_98;
  int *piStack_94;
  int *piStack_90;
  int *piVar5;
  int *local_78 [2];
  int *piStack_70;
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)local_78;
  *(undefined1 *)(*(int *)(param_1 + 4) + 0x74) = 0;
  *param_3 = 0;
  iVar1 = *(int *)(*(int *)(param_1 + 4) + 0x5c);
  if ((iVar1 != 0x1000000) && (iVar1 != 0x2000000)) {
    piVar5 = (int *)(*(int *)(param_1 + 4) + 0x70);
    *piVar5 = *piVar5 + 1;
    iVar1 = FUN_0051b1a0();
    if (iVar1 != 0) {
      piStack_90 = (int *)0x685345;
      FUN_0051c6e0();
      piStack_90 = *(int **)(*(int *)(param_1 + 4) + 4);
      piStack_94 = (int *)0x68535f;
      FUN_00678eb0();
      piStack_90 = (int *)0x685377;
      LVar2 = InterlockedExchangeAdd((LONG *)(((uint)local_78[0] & 0xfffffffc) + 4),-1);
      if (LVar2 == 1) {
        FUN_00515cf0();
      }
      piStack_90 = (int *)0x685397;
      puVar3 = (uint *)FUN_0051c6e0();
      piStack_98 = *(int **)(*(int *)(param_1 + 4) + 4);
      piStack_90 = (int *)0xbd6554;
      piStack_94 = (int *)((*puVar3 & 0xfffffffc) + 8);
      FUN_00678eb0();
      piStack_90 = (undefined4 *)0x6853c7;
      LVar2 = InterlockedExchangeAdd((LONG *)(((uint)local_78[0] & 0xfffffffc) + 4),-1);
      if (LVar2 == 1) {
        FUN_00515cf0();
      }
    }
    this = (GRefCountImpl *)(**(code **)(*(int *)(*(int *)(*(int *)(param_1 + 4) + 4) + 8) + 0xc))()
    ;
    *(undefined1 *)(param_1 + 0x3a) = 0;
    *(undefined1 *)(param_1 + 0x39) = 0;
    piStack_90 = *(int **)(param_1 + 0x14);
    piStack_94 = (int *)0x685404;
    iVar1 = (**(code **)*piStack_90)();
    if (-1 < iVar1) {
      iVar1 = (**(code **)(*piStack_70 + 0xc))();
      if (iVar1 == 0) {
        piVar5 = (int *)0x0;
        piStack_90 = (int *)&stack0xffffff84;
        piStack_94 = (int *)0x1;
        piStack_98 = unaff_EDI;
        iVar1 = (**(code **)(*unaff_EDI + 0x10))();
        while (iVar1 == 0) {
          piVar4 = (int *)&stack0xffffff7c;
          (**(code **)(*piVar5 + 0xc))(piVar5);
          (**(code **)(*piStack_94 + 8))(piStack_94);
          iVar1 = (**(code **)(*piVar4 + 0x10))(piVar4,1,&piStack_98,0);
        }
        (**(code **)(*piStack_90 + 8))(piStack_90);
      }
      piStack_90 = (undefined4 *)0x68548e;
      (**(code **)(*local_78[0] + 8))();
    }
    if (this != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this);
    }
  }
  __security_check_cookie(local_4 ^ (uint)local_78);
  return;
}



============================================================
DISASSEMBLY
============================================================
006852d0 : SUB ESP,0x78
006852d3 : MOV EAX,[0x00d66fa0]
006852d8 : XOR EAX,ESP
006852da : MOV dword ptr [ESP + 0x74],EAX
006852de : MOV EAX,dword ptr [ESP + 0x84]
006852e5 : PUSH ESI
006852e6 : MOV ESI,dword ptr [ESP + 0x80]
006852ed : MOV ECX,dword ptr [ESI + 0x4]
006852f0 : MOV byte ptr [ECX + 0x74],0x0
006852f4 : MOV dword ptr [EAX],0x0
006852fa : MOV EAX,dword ptr [ESI + 0x4]
006852fd : MOV ECX,dword ptr [EAX + 0x5c]
00685300 : CMP ECX,0x1000000
00685306 : JZ 0x0068549a
0068530c : CMP ECX,0x2000000
00685312 : JZ 0x0068549a
00685318 : INC dword ptr [EAX + 0x70]
0068531b : MOV ECX,dword ptr [ESI + 0x4]
0068531e : PUSH EDI
0068531f : ADD ECX,0x8
00685322 : CALL 0x0051b1a0
00685327 : TEST EAX,EAX
00685329 : JBE 0x006853d3
0068532f : MOV ECX,dword ptr [ESI + 0x4]
00685332 : PUSH EBP
00685333 : PUSH 0xbd7f7c
00685338 : LEA EDX,[ESP + 0x10]
0068533c : PUSH EDX
0068533d : ADD ECX,0x8
00685340 : CALL 0x0051c6e0
00685345 : MOV EAX,dword ptr [EAX]
00685347 : MOV ECX,dword ptr [ESI + 0x4]
0068534a : MOV EDX,dword ptr [ECX + 0x4]
0068534d : AND EAX,0xfffffffc
00685350 : PUSH 0xcca874
00685355 : ADD EAX,0x8
00685358 : PUSH EAX
00685359 : PUSH EDX
0068535a : CALL 0x00678eb0
0068535f : MOV EDI,dword ptr [ESP + 0x18]
00685363 : MOV EBP,dword ptr [0x00b851cc]
00685369 : ADD ESP,0xc
0068536c : AND EDI,0xfffffffc
0068536f : PUSH -0x1
00685371 : LEA EAX,[EDI + 0x4]
00685374 : PUSH EAX
00685375 : CALL EBP
00685377 : SUB EAX,0x1
0068537a : JNZ 0x00685382
0068537c : PUSH EDI
0068537d : CALL 0x00515cf0
00685382 : PUSH 0xbd7fcc
00685387 : LEA ECX,[ESP + 0x10]
0068538b : PUSH ECX
0068538c : MOV ECX,dword ptr [ESI + 0x4]
0068538f : ADD ECX,0x8
00685392 : CALL 0x0051c6e0
00685397 : MOV EDX,dword ptr [EAX]
00685399 : MOV EAX,dword ptr [ESI + 0x4]
0068539c : MOV ECX,dword ptr [EAX + 0x4]
0068539f : PUSH 0x1
006853a1 : PUSH 0xa
006853a3 : AND EDX,0xfffffffc
006853a6 : PUSH 0xbd6554
006853ab : ADD EDX,0x8
006853ae : PUSH EDX
006853af : PUSH ECX
006853b0 : CALL 0x00678eb0
006853b5 : MOV EDI,dword ptr [ESP + 0x20]
006853b9 : ADD ESP,0x14
006853bc : AND EDI,0xfffffffc
006853bf : PUSH -0x1
006853c1 : LEA EDX,[EDI + 0x4]
006853c4 : PUSH EDX
006853c5 : CALL EBP
006853c7 : SUB EAX,0x1
006853ca : POP EBP
006853cb : JNZ 0x006853d3
006853cd : PUSH EDI
006853ce : CALL 0x00515cf0
006853d3 : MOV EAX,dword ptr [ESI + 0x4]
006853d6 : MOV ECX,dword ptr [EAX + 0x4]
006853d9 : MOV EDX,dword ptr [ECX + 0x8]
006853dc : MOV EAX,dword ptr [EDX + 0xc]
006853df : ADD ECX,0x8
006853e2 : PUSH 0x1b
006853e4 : CALL EAX
006853e6 : MOV byte ptr [ESI + 0x3a],0x0
006853ea : MOV byte ptr [ESI + 0x39],0x0
006853ee : MOV ESI,dword ptr [ESI + 0x14]
006853f1 : MOV ECX,dword ptr [ESI]
006853f3 : LEA EDX,[ESP + 0x10]
006853f7 : PUSH EDX
006853f8 : PUSH 0xbefc70
006853fd : MOV EDI,EAX
006853ff : MOV EAX,dword ptr [ECX]
00685401 : PUSH ESI
00685402 : CALL EAX
00685404 : TEST EAX,EAX
00685406 : JL 0x0068548e
0068540c : MOV EAX,dword ptr [ESP + 0x10]
00685410 : MOV ECX,dword ptr [EAX]
00685412 : LEA EDX,[ESP + 0x8]
00685416 : PUSH EDX
00685417 : PUSH EAX
00685418 : MOV EAX,dword ptr [ECX + 0xc]
0068541b : CALL EAX
0068541d : TEST EAX,EAX
0068541f : JNZ 0x00685482
00685421 : MOV EAX,dword ptr [ESP + 0x8]
00685425 : MOV ECX,dword ptr [EAX]
00685427 : PUSH 0x0
00685429 : LEA EDX,[ESP + 0x10]
0068542d : PUSH EDX
0068542e : PUSH 0x1
00685430 : PUSH EAX
00685431 : MOV EAX,dword ptr [ECX + 0x10]
00685434 : CALL EAX
00685436 : TEST EAX,EAX
00685438 : JNZ 0x00685476
0068543a : LEA EBX,[EBX]
00685440 : MOV EAX,dword ptr [ESP + 0xc]
00685444 : MOV ECX,dword ptr [EAX]
00685446 : LEA EDX,[ESP + 0x14]
0068544a : PUSH EDX
0068544b : PUSH EAX
0068544c : MOV EAX,dword ptr [ECX + 0xc]
0068544f : CALL EAX
00685451 : MOV EAX,dword ptr [ESP + 0xc]
00685455 : MOV ECX,dword ptr [EAX]
00685457 : MOV EDX,dword ptr [ECX + 0x8]
0068545a : PUSH EAX
0068545b : CALL EDX
0068545d : MOV EAX,dword ptr [ESP + 0x8]
00685461 : MOV ECX,dword ptr [EAX]
00685463 : PUSH 0x0
00685465 : LEA EDX,[ESP + 0x10]
00685469 : PUSH EDX
0068546a : PUSH 0x1
0068546c : PUSH EAX
0068546d : MOV EAX,dword ptr [ECX + 0x10]
00685470 : CALL EAX
00685472 : TEST EAX,EAX
00685474 : JZ 0x00685440
00685476 : MOV EAX,dword ptr [ESP + 0x8]
0068547a : MOV ECX,dword ptr [EAX]
0068547c : MOV EDX,dword ptr [ECX + 0x8]
0068547f : PUSH EAX
00685480 : CALL EDX
00685482 : MOV EAX,dword ptr [ESP + 0x10]
00685486 : MOV ECX,dword ptr [EAX]
00685488 : MOV EDX,dword ptr [ECX + 0x8]
0068548b : PUSH EAX
0068548c : CALL EDX
0068548e : TEST EDI,EDI
00685490 : JZ 0x00685499
00685492 : MOV ECX,EDI
00685494 : CALL 0x004ff7e0
00685499 : POP EDI
0068549a : MOV ECX,dword ptr [ESP + 0x78]
0068549e : POP ESI
0068549f : XOR ECX,ESP
006854a1 : XOR EAX,EAX
006854a3 : CALL 0x00633e6b
006854a8 : ADD ESP,0x78
006854ab : RET 0xc

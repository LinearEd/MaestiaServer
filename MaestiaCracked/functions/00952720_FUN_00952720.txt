PROGRAM  : Maestia.exe
FUNCTION : FUN_00952720
ENTRY    : 00952720
BODY     : [[00952720, 0095297f] [00952982, 00952a33]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00952720(int param_1,int param_2,int *param_3,uint *param_4,int param_5)

{
  short sVar1;
  int *piVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  undefined1 *puVar6;
  undefined4 *puVar7;
  int *piVar8;
  short *psVar9;
  uint uVar10;
  short *psVar11;
  int iVar12;
  int local_24;
  int local_20;
  int local_1c;
  short *local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puVar3 = param_4;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2cfd1;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar5 = *(int *)(param_1 + 0x80);
  if (iVar5 != 0) {
    local_1c = *(int *)(iVar5 + 0x10);
    if ((param_2 == 1) && ((*(int *)(iVar5 + 0x14) - *(int *)(iVar5 + 0x10) & 0xfffffffcU) == 0)) {
      param_2 = 0;
    }
    local_24 = 0;
    if (0 < param_5) {
      while( true ) {
        param_4 = (uint *)0x0;
        iVar5 = FUN_006f0760(0x70,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar4);
        local_8 = 0;
        if (iVar5 == 0) {
          local_14 = 0;
        }
        else {
          local_14 = FUN_00421060(iVar5);
        }
        local_8 = 0xffffffff;
        puVar7 = (undefined4 *)*param_3;
        if ((puVar7 == (undefined4 *)0x0) || (*puVar3 < 8)) {
          *puVar3 = 0;
          psVar9 = (short *)0x0;
        }
        else {
          *(undefined4 *)(local_14 + 8) = *puVar7;
          *(undefined4 *)(local_14 + 0xc) = puVar7[1];
          *puVar3 = *puVar3 - 8;
          psVar9 = (short *)(puVar7 + 2);
        }
        *param_3 = (int)psVar9;
        if ((psVar9 == (short *)0x0) || (uVar10 = *puVar3, uVar10 < 2)) {
          *puVar3 = 0;
          psVar9 = (short *)0x0;
        }
        else if ((*psVar9 < 0) || (iVar5 = (int)*psVar9, (int)uVar10 < iVar5 + 2)) {
          psVar9 = (short *)0x0;
          param_4 = (uint *)0x0;
          *puVar3 = 0;
        }
        else {
          param_4 = (uint *)(psVar9 + 1);
          *puVar3 = (uVar10 - iVar5) - 2;
          psVar9 = (short *)(iVar5 + 2 + (int)psVar9);
        }
        *param_3 = (int)psVar9;
        if ((((psVar9 == (short *)0x0) || (uVar10 = *puVar3, uVar10 < 2)) || (*psVar9 < 0)) ||
           (iVar5 = (int)*psVar9, (int)uVar10 < iVar5 + 2)) {
          psVar11 = (short *)0x0;
          puVar6 = (undefined1 *)0x0;
          *puVar3 = 0;
        }
        else {
          *puVar3 = (uVar10 - iVar5) - 2;
          psVar11 = psVar9 + 1;
          puVar6 = (undefined1 *)(iVar5 + 2 + (int)psVar9);
        }
        *param_3 = (int)puVar6;
        if ((puVar6 == (undefined1 *)0x0) || (*puVar3 == 0)) {
          *puVar3 = 0;
          puVar7 = (undefined4 *)0x0;
        }
        else {
          *(undefined1 *)(local_14 + 100) = *puVar6;
          *puVar3 = *puVar3 - 1;
          puVar7 = (undefined4 *)(puVar6 + 1);
        }
        *param_3 = (int)puVar7;
        if ((puVar7 == (undefined4 *)0x0) || (*puVar3 < 8)) {
          *puVar3 = 0;
          puVar7 = (undefined4 *)0x0;
        }
        else {
          *(undefined4 *)(local_14 + 0x68) = *puVar7;
          *(undefined4 *)(local_14 + 0x6c) = puVar7[1];
          *puVar3 = *puVar3 - 8;
          puVar7 = puVar7 + 2;
        }
        *param_3 = (int)puVar7;
        piVar8 = *(int **)(*(int *)(param_1 + 0x80) + 0x10);
        piVar2 = *(int **)(*(int *)(param_1 + 0x80) + 0x14);
        local_20 = local_14;
        local_18 = psVar11;
        if (piVar8 != piVar2) {
          do {
            if ((*(int *)(*piVar8 + 8) == *(int *)(local_14 + 8)) &&
               (*(int *)(*piVar8 + 0xc) == *(int *)(local_14 + 0xc))) {
              FUN_00421150(local_14);
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            piVar8 = piVar8 + 1;
          } while (piVar8 != piVar2);
        }
        if ((param_4 == (uint *)0x0) || (psVar11 == (short *)0x0)) break;
        psVar9 = (short *)param_4;
        do {
          sVar1 = *psVar9;
          psVar9 = psVar9 + 1;
        } while (sVar1 != 0);
        FUN_00406360(param_4,(int)psVar9 - (int)((int)param_4 + 2) >> 1);
        psVar9 = psVar11;
        do {
          sVar1 = *psVar9;
          psVar9 = psVar9 + 1;
        } while (sVar1 != 0);
        FUN_00406360(psVar11,(int)psVar9 - (int)(psVar11 + 1) >> 1);
        if (param_2 == 1) {
          iVar5 = *(int *)(param_1 + 0x80);
          if ((*(int *)(iVar5 + 0x14) - *(int *)(iVar5 + 0x10) & 0xfffffffcU) == 0) {
            iVar12 = 0;
          }
          else {
            iVar12 = local_1c - *(int *)(iVar5 + 0x10) >> 2;
          }
          FUN_0042fe80(iVar5 + 0xc,local_1c,&local_20);
          local_1c = *(int *)(iVar5 + 0x10) + iVar12 * 4 + 4;
        }
        else {
          iVar5 = *(int *)(param_1 + 0x80);
          iVar12 = *(int *)(iVar5 + 0x10);
          if (iVar12 == 0) {
            uVar10 = 0;
          }
          else {
            uVar10 = *(int *)(iVar5 + 0x18) - iVar12 >> 2;
          }
          piVar8 = *(int **)(iVar5 + 0x14);
          if ((uint)((int)piVar8 - iVar12 >> 2) < uVar10) {
            *piVar8 = local_14;
            *(int **)(iVar5 + 0x14) = piVar8 + 1;
          }
          else {
            FUN_0042fe80(iVar5 + 0xc,piVar8,&local_20);
          }
        }
        local_24 = local_24 + 1;
        if (param_5 <= local_24) {
          ExceptionList = local_10;
          return;
        }
      }
      if (local_14 != 0) {
        FUN_00421150(local_14);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00952720 : PUSH EBP
00952721 : MOV EBP,ESP
00952723 : PUSH -0x1
00952725 : PUSH 0xb2cfd1
0095272a : MOV EAX,FS:[0x0]
00952730 : PUSH EAX
00952731 : SUB ESP,0x20
00952734 : PUSH EBX
00952735 : PUSH ESI
00952736 : PUSH EDI
00952737 : MOV EAX,[0x00d66fa0]
0095273c : XOR EAX,EBP
0095273e : PUSH EAX
0095273f : LEA EAX,[EBP + -0xc]
00952742 : MOV FS:[0x0],EAX
00952748 : MOV EBX,dword ptr [EBP + 0x14]
0095274b : MOV EAX,dword ptr [EBP + 0x8]
0095274e : MOV EAX,dword ptr [EAX + 0x80]
00952754 : XOR ECX,ECX
00952756 : CMP EAX,ECX
00952758 : JZ 0x00952a20
0095275e : CMP dword ptr [EBP + 0xc],0x1
00952762 : MOV EDX,dword ptr [EAX + 0x10]
00952765 : MOV dword ptr [EBP + -0x18],EDX
00952768 : JNZ 0x0095277b
0095276a : MOV EDX,dword ptr [EAX + 0x14]
0095276d : SUB EDX,dword ptr [EAX + 0x10]
00952770 : TEST EDX,0xfffffffc
00952776 : JNZ 0x0095277b
00952778 : MOV dword ptr [EBP + 0xc],ECX
0095277b : CMP dword ptr [EBP + 0x18],ECX
0095277e : MOV dword ptr [EBP + -0x20],ECX
00952781 : JLE 0x00952a20
00952787 : MOV EAX,[0x01725270]
0095278c : SHR EAX,0x3
0095278f : MOV ECX,0x0
00952794 : AND EAX,0x1
00952797 : SETZ CL
0095279a : XOR ESI,ESI
0095279c : PUSH ECX
0095279d : PUSH ESI
0095279e : PUSH 0xbf1a4a
009527a3 : PUSH 0x70
009527a5 : CALL 0x006f0760
009527aa : ADD ESP,0x10
009527ad : MOV dword ptr [EBP + 0x14],EAX
009527b0 : MOV dword ptr [EBP + -0x4],ESI
009527b3 : CMP EAX,ESI
009527b5 : JZ 0x009527c4
009527b7 : PUSH EAX
009527b8 : CALL 0x00421060
009527bd : MOV EDI,EAX
009527bf : MOV dword ptr [EBP + -0x10],EAX
009527c2 : JMP 0x009527c9
009527c4 : XOR EDI,EDI
009527c6 : MOV dword ptr [EBP + -0x10],EDI
009527c9 : MOV dword ptr [EBP + -0x4],0xffffffff
009527d0 : MOV EDX,dword ptr [EBP + 0x10]
009527d3 : MOV EAX,dword ptr [EDX]
009527d5 : MOV dword ptr [EBP + -0x1c],EDI
009527d8 : CMP EAX,ESI
009527da : JZ 0x009527f4
009527dc : CMP dword ptr [EBX],0x8
009527df : JC 0x009527f4
009527e1 : MOV ECX,dword ptr [EAX]
009527e3 : MOV dword ptr [EDI + 0x8],ECX
009527e6 : MOV ECX,dword ptr [EAX + 0x4]
009527e9 : MOV dword ptr [EDI + 0xc],ECX
009527ec : ADD dword ptr [EBX],-0x8
009527ef : LEA ECX,[EAX + 0x8]
009527f2 : JMP 0x009527f8
009527f4 : MOV dword ptr [EBX],ESI
009527f6 : XOR ECX,ECX
009527f8 : MOV dword ptr [EDX],ECX
009527fa : CMP ECX,ESI
009527fc : JZ 0x00952830
009527fe : MOV EAX,dword ptr [EBX]
00952800 : CMP EAX,0x2
00952803 : JC 0x00952830
00952805 : MOVZX EDX,word ptr [ECX]
00952808 : CMP DX,SI
0095280b : JL 0x00952827
0095280d : MOVSX EDX,DX
00952810 : LEA ESI,[EDX + 0x2]
00952813 : CMP EAX,ESI
00952815 : JL 0x00952827
00952817 : SUB EAX,EDX
00952819 : SUB EAX,0x2
0095281c : LEA ESI,[ECX + 0x2]
0095281f : MOV dword ptr [EBX],EAX
00952821 : LEA ECX,[EDX + ECX*0x1 + 0x2]
00952825 : JMP 0x00952834
00952827 : XOR ECX,ECX
00952829 : MOV dword ptr [EBP + 0x14],ECX
0095282c : MOV dword ptr [EBX],ECX
0095282e : JMP 0x00952837
00952830 : MOV dword ptr [EBX],ESI
00952832 : XOR ECX,ECX
00952834 : MOV dword ptr [EBP + 0x14],ESI
00952837 : MOV EDX,dword ptr [EBP + 0x10]
0095283a : MOV dword ptr [EDX],ECX
0095283c : TEST ECX,ECX
0095283e : JZ 0x00952869
00952840 : MOV EAX,dword ptr [EBX]
00952842 : CMP EAX,0x2
00952845 : JC 0x00952869
00952847 : MOVZX EDX,word ptr [ECX]
0095284a : TEST DX,DX
0095284d : JL 0x00952869
0095284f : MOVSX EDX,DX
00952852 : LEA ESI,[EDX + 0x2]
00952855 : CMP EAX,ESI
00952857 : JL 0x00952869
00952859 : SUB EAX,EDX
0095285b : SUB EAX,0x2
0095285e : MOV dword ptr [EBX],EAX
00952860 : LEA ESI,[ECX + 0x2]
00952863 : LEA EAX,[EDX + ECX*0x1 + 0x2]
00952867 : JMP 0x0095286f
00952869 : XOR ESI,ESI
0095286b : XOR EAX,EAX
0095286d : MOV dword ptr [EBX],EAX
0095286f : MOV ECX,dword ptr [EBP + 0x10]
00952872 : MOV dword ptr [EBP + -0x14],ESI
00952875 : MOV dword ptr [ECX],EAX
00952877 : TEST EAX,EAX
00952879 : JZ 0x0095288a
0095287b : CMP dword ptr [EBX],0x1
0095287e : JC 0x0095288a
00952880 : MOV DL,byte ptr [EAX]
00952882 : MOV byte ptr [EDI + 0x64],DL
00952885 : DEC dword ptr [EBX]
00952887 : INC EAX
00952888 : JMP 0x00952892
0095288a : MOV dword ptr [EBX],0x0
00952890 : XOR EAX,EAX
00952892 : MOV dword ptr [ECX],EAX
00952894 : TEST EAX,EAX
00952896 : JZ 0x009528b0
00952898 : CMP dword ptr [EBX],0x8
0095289b : JC 0x009528b0
0095289d : MOV EDX,dword ptr [EAX]
0095289f : MOV dword ptr [EDI + 0x68],EDX
009528a2 : MOV EDX,dword ptr [EAX + 0x4]
009528a5 : MOV dword ptr [EDI + 0x6c],EDX
009528a8 : ADD dword ptr [EBX],-0x8
009528ab : ADD EAX,0x8
009528ae : JMP 0x009528b8
009528b0 : MOV dword ptr [EBX],0x0
009528b6 : XOR EAX,EAX
009528b8 : MOV dword ptr [ECX],EAX
009528ba : MOV EAX,dword ptr [EBP + 0x8]
009528bd : MOV ECX,dword ptr [EAX + 0x80]
009528c3 : MOV EAX,dword ptr [ECX + 0x10]
009528c6 : MOV ECX,dword ptr [ECX + 0x14]
009528c9 : CMP EAX,ECX
009528cb : JZ 0x009528f8
009528cd : MOV EDX,dword ptr [EDI + 0xc]
009528d0 : MOV ESI,dword ptr [EDI + 0x8]
009528d3 : MOV dword ptr [EBP + -0x24],EDX
009528d6 : MOV EDX,dword ptr [EAX]
009528d8 : MOV EDI,dword ptr [EDX + 0x8]
009528db : CMP EDI,ESI
009528dd : JNZ 0x009528eb
009528df : MOV EDX,dword ptr [EDX + 0xc]
009528e2 : CMP EDX,dword ptr [EBP + -0x24]
009528e5 : JZ 0x00952970
009528eb : ADD EAX,0x4
009528ee : CMP EAX,ECX
009528f0 : JNZ 0x009528d6
009528f2 : MOV EDI,dword ptr [EBP + -0x10]
009528f5 : MOV ESI,dword ptr [EBP + -0x14]
009528f8 : MOV EAX,dword ptr [EBP + 0x14]
009528fb : TEST EAX,EAX
009528fd : JZ 0x00952a0f
00952903 : TEST ESI,ESI
00952905 : JZ 0x00952a0f
0095290b : LEA EDX,[EAX + 0x2]
0095290e : MOV EDI,EDI
00952910 : MOV CX,word ptr [EAX]
00952913 : ADD EAX,0x2
00952916 : TEST CX,CX
00952919 : JNZ 0x00952910
0095291b : SUB EAX,EDX
0095291d : SAR EAX,0x1
0095291f : PUSH EAX
00952920 : MOV EAX,dword ptr [EBP + 0x14]
00952923 : PUSH EAX
00952924 : LEA ECX,[EDI + 0x10]
00952927 : CALL 0x00406360
0095292c : MOV EAX,ESI
0095292e : LEA EDX,[EAX + 0x2]
00952931 : MOV CX,word ptr [EAX]
00952934 : ADD EAX,0x2
00952937 : TEST CX,CX
0095293a : JNZ 0x00952931
0095293c : SUB EAX,EDX
0095293e : SAR EAX,0x1
00952940 : PUSH EAX
00952941 : PUSH ESI
00952942 : LEA ECX,[EDI + 0x2c]
00952945 : CALL 0x00406360
0095294a : CMP dword ptr [EBP + 0xc],0x1
0095294e : JNZ 0x009529a6
00952950 : MOV ECX,dword ptr [EBP + 0x8]
00952953 : MOV ESI,dword ptr [ECX + 0x80]
00952959 : MOV EAX,dword ptr [ESI + 0x10]
0095295c : MOV EDX,dword ptr [ESI + 0x14]
0095295f : ADD ESI,0xc
00952962 : SUB EDX,EAX
00952964 : TEST EDX,0xfffffffc
0095296a : JNZ 0x00952982
0095296c : XOR EDI,EDI
0095296e : JMP 0x0095298a
00952970 : MOV ESI,dword ptr [EBP + -0x10]
00952973 : PUSH ESI
00952974 : CALL 0x00421150
00952979 : MOV ECX,ESI
0095297b : CALL 0x006f04e0
00952982 : MOV EDI,dword ptr [EBP + -0x18]
00952985 : SUB EDI,EAX
00952987 : SAR EDI,0x2
0095298a : MOV ECX,dword ptr [EBP + -0x18]
0095298d : LEA EAX,[EBP + -0x1c]
00952990 : PUSH EAX
00952991 : PUSH ECX
00952992 : PUSH ESI
00952993 : CALL 0x0042fe80
00952998 : MOV EDX,dword ptr [ESI + 0x4]
0095299b : LEA EAX,[EDX + EDI*0x4]
0095299e : ADD EAX,0x4
009529a1 : MOV dword ptr [EBP + -0x18],EAX
009529a4 : JMP 0x009529eb
009529a6 : MOV EAX,dword ptr [EBP + 0x8]
009529a9 : MOV EAX,dword ptr [EAX + 0x80]
009529af : MOV ESI,dword ptr [EAX + 0x10]
009529b2 : ADD EAX,0xc
009529b5 : TEST ESI,ESI
009529b7 : JNZ 0x009529bd
009529b9 : XOR ECX,ECX
009529bb : JMP 0x009529c5
009529bd : MOV ECX,dword ptr [EAX + 0xc]
009529c0 : SUB ECX,ESI
009529c2 : SAR ECX,0x2
009529c5 : MOV EDX,dword ptr [EAX + 0x8]
009529c8 : MOV EDI,EDX
009529ca : SUB EDI,ESI
009529cc : SAR EDI,0x2
009529cf : CMP EDI,ECX
009529d1 : JNC 0x009529e0
009529d3 : MOV ECX,dword ptr [EBP + -0x10]
009529d6 : MOV dword ptr [EDX],ECX
009529d8 : ADD EDX,0x4
009529db : MOV dword ptr [EAX + 0x8],EDX
009529de : JMP 0x009529eb
009529e0 : LEA ECX,[EBP + -0x1c]
009529e3 : PUSH ECX
009529e4 : PUSH EDX
009529e5 : PUSH EAX
009529e6 : CALL 0x0042fe80
009529eb : MOV EAX,dword ptr [EBP + -0x20]
009529ee : INC EAX
009529ef : CMP EAX,dword ptr [EBP + 0x18]
009529f2 : MOV dword ptr [EBP + -0x20],EAX
009529f5 : JL 0x00952787
009529fb : MOV ECX,dword ptr [EBP + -0xc]
009529fe : MOV dword ptr FS:[0x0],ECX
00952a05 : POP ECX
00952a06 : POP EDI
00952a07 : POP ESI
00952a08 : POP EBX
00952a09 : MOV ESP,EBP
00952a0b : POP EBP
00952a0c : RET 0x14
00952a0f : TEST EDI,EDI
00952a11 : JZ 0x00952a20
00952a13 : PUSH EDI
00952a14 : CALL 0x00421150
00952a19 : MOV ECX,EDI
00952a1b : CALL 0x006f04e0
00952a20 : MOV ECX,dword ptr [EBP + -0xc]
00952a23 : MOV dword ptr FS:[0x0],ECX
00952a2a : POP ECX
00952a2b : POP EDI
00952a2c : POP ESI
00952a2d : POP EBX
00952a2e : MOV ESP,EBP
00952a30 : POP EBP
00952a31 : RET 0x14

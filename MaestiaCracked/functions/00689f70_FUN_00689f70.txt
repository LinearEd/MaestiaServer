PROGRAM  : Maestia.exe
FUNCTION : FUN_00689f70
ENTRY    : 00689f70
BODY     : [[00689f70, 00689f7c] [00689f80, 00689ff1]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 *
FUN_00689f70(undefined4 *param_1,undefined4 param_2,char *param_3,undefined4 *param_4,
            undefined4 *param_5)

{
  char cVar1;
  char *_Src;
  char *pcVar2;
  size_t _Size;
  void *_Dst;
  
  _Src = param_3;
  pcVar2 = param_3;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  _Size = (int)pcVar2 - (int)(param_3 + 1);
  if (0x7fffffff < (int)(_Size + 6)) {
    return (undefined4 *)0xa;
  }
  _Dst = (void *)FUN_00688c00(*param_1,_Size + 6,&param_1);
  if (param_1 == (undefined4 *)0x0) {
    _memcpy(_Dst,_Src,_Size);
    *(undefined4 *)((int)_Dst + _Size) = 0x7273722f;
    *(undefined2 *)((int)_Dst + _Size + 4) = 99;
    *param_4 = _Dst;
    *param_5 = 0;
    param_1 = (undefined4 *)0x0;
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
00689f70 : PUSH EBX
00689f71 : MOV EBX,dword ptr [ESP + 0x10]
00689f75 : MOV EAX,EBX
00689f77 : PUSH EDI
00689f78 : LEA EDX,[EAX + 0x1]
00689f7b : JMP 0x00689f80
00689f80 : MOV CL,byte ptr [EAX]
00689f82 : INC EAX
00689f83 : TEST CL,CL
00689f85 : JNZ 0x00689f80
00689f87 : SUB EAX,EDX
00689f89 : MOV EDI,EAX
00689f8b : MOV EAX,dword ptr [ESP + 0xc]
00689f8f : MOV ECX,dword ptr [EAX]
00689f91 : LEA EAX,[EDI + 0x6]
00689f94 : CMP EAX,0x7fffffff
00689f99 : JLE 0x00689fa3
00689f9b : POP EDI
00689f9c : MOV EAX,0xa
00689fa1 : POP EBX
00689fa2 : RET
00689fa3 : PUSH ESI
00689fa4 : LEA EDX,[ESP + 0x10]
00689fa8 : PUSH EDX
00689fa9 : PUSH EAX
00689faa : PUSH ECX
00689fab : CALL 0x00688c00
00689fb0 : MOV ESI,EAX
00689fb2 : MOV EAX,dword ptr [ESP + 0x1c]
00689fb6 : ADD ESP,0xc
00689fb9 : TEST EAX,EAX
00689fbb : JNZ 0x00689fee
00689fbd : PUSH EDI
00689fbe : PUSH EBX
00689fbf : PUSH ESI
00689fc0 : CALL 0x0063ae40
00689fc5 : MOV EAX,[0x00bd8514]
00689fca : MOV EDX,dword ptr [ESP + 0x28]
00689fce : MOV dword ptr [ESI + EDI*0x1],EAX
00689fd1 : MOV CX,word ptr [0x00bd8518]
00689fd8 : MOV EAX,dword ptr [ESP + 0x2c]
00689fdc : MOV word ptr [ESI + EDI*0x1 + 0x4],CX
00689fe1 : MOV dword ptr [EDX],ESI
00689fe3 : ADD ESP,0xc
00689fe6 : MOV dword ptr [EAX],0x0
00689fec : XOR EAX,EAX
00689fee : POP ESI
00689fef : POP EDI
00689ff0 : POP EBX
00689ff1 : RET

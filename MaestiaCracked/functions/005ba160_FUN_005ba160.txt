PROGRAM  : Maestia.exe
FUNCTION : FUN_005ba160
ENTRY    : 005ba160
BODY     : [[005ba160, 005ba298]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005ba160(undefined4 param_1,int param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint *puVar3;
  int *piVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_005ba19c;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_005b9e30(param_1,iVar7);
LAB_005ba19c:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    FUN_0051c2c0(param_2);
    puVar1[3] = *(uint *)(param_2 + 4);
    puVar1[4] = *(uint *)(param_2 + 8);
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
  iVar2 = iVar7 + 8 + uVar6 * 0x14;
  uVar5 = puVar1[1];
  if (uVar5 == param_3) {
    if (iVar2 != 0) {
      FUN_005b9c20(puVar1);
    }
    FUN_0051bc20(param_2);
    puVar1[3] = *(uint *)(param_2 + 4);
    puVar1[4] = *(uint *)(param_2 + 8);
    *puVar1 = uVar6;
    puVar1[1] = param_3;
    return;
  }
  puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
      uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
    uVar5 = *puVar3;
    puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  }
  if (iVar2 != 0) {
    FUN_005b9c20(puVar1);
  }
  *puVar3 = uVar6;
  FUN_0051bc20(param_2);
  puVar1[3] = *(uint *)(param_2 + 4);
  puVar1[4] = *(uint *)(param_2 + 8);
  puVar1[1] = param_3;
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
005ba160 : PUSH EBX
005ba161 : PUSH EBP
005ba162 : PUSH ESI
005ba163 : PUSH EDI
005ba164 : MOV EDI,ECX
005ba166 : MOV EAX,dword ptr [EDI]
005ba168 : TEST EAX,EAX
005ba16a : JNZ 0x005ba175
005ba16c : MOV EAX,dword ptr [ESP + 0x14]
005ba170 : PUSH 0x8
005ba172 : PUSH EAX
005ba173 : JMP 0x005ba197
005ba175 : MOV ECX,dword ptr [EAX + 0x4]
005ba178 : LEA EDX,[ECX*0x4 + 0x4]
005ba17f : MOV ECX,dword ptr [EAX]
005ba181 : LEA ECX,[ECX + ECX*0x4]
005ba184 : CMP ECX,EDX
005ba186 : JBE 0x005ba19c
005ba188 : MOV EDX,dword ptr [EAX + 0x4]
005ba18b : MOV ECX,dword ptr [ESP + 0x14]
005ba18f : LEA EAX,[EDX + EDX*0x1 + 0x2]
005ba193 : PUSH EAX
005ba194 : PUSH ECX
005ba195 : MOV ECX,EDI
005ba197 : CALL 0x005b9e30
005ba19c : MOV EAX,dword ptr [EDI]
005ba19e : MOV ESI,dword ptr [ESP + 0x1c]
005ba1a2 : AND ESI,dword ptr [EAX + 0x4]
005ba1a5 : INC dword ptr [EAX]
005ba1a7 : MOV EAX,dword ptr [EDI]
005ba1a9 : LEA EDX,[ESI + ESI*0x4]
005ba1ac : LEA EDI,[EAX + EDX*0x4 + 0x8]
005ba1b0 : MOV EDX,0xfffffffe
005ba1b5 : CMP dword ptr [EDI],EDX
005ba1b7 : JNZ 0x005ba1e4
005ba1b9 : MOV EBP,dword ptr [ESP + 0x18]
005ba1bd : LEA EBX,[EDI + 0x8]
005ba1c0 : PUSH EBP
005ba1c1 : MOV ECX,EBX
005ba1c3 : MOV dword ptr [EDI],0xffffffff
005ba1c9 : CALL 0x0051c2c0
005ba1ce : MOV EAX,dword ptr [EBP + 0x4]
005ba1d1 : MOV dword ptr [EBX + 0x4],EAX
005ba1d4 : MOV ECX,dword ptr [EBP + 0x8]
005ba1d7 : MOV dword ptr [EBX + 0x8],ECX
005ba1da : MOV dword ptr [EDI + 0x4],ESI
005ba1dd : POP EDI
005ba1de : POP ESI
005ba1df : POP EBP
005ba1e0 : POP EBX
005ba1e1 : RET 0xc
005ba1e4 : MOV ECX,dword ptr [EAX + 0x4]
005ba1e7 : MOV EBX,ESI
005ba1e9 : LEA ESP,[ESP]
005ba1f0 : INC EBX
005ba1f1 : AND EBX,ECX
005ba1f3 : LEA EBP,[EBX + EBX*0x4]
005ba1f6 : CMP dword ptr [EAX + EBP*0x4 + 0x8],EDX
005ba1fa : JNZ 0x005ba1f0
005ba1fc : LEA EDX,[EBX + EBX*0x4]
005ba1ff : LEA ECX,[EAX + EDX*0x4 + 0x8]
005ba203 : MOV EDX,dword ptr [EDI + 0x4]
005ba206 : CMP EDX,ESI
005ba208 : JNZ 0x005ba23f
005ba20a : TEST ECX,ECX
005ba20c : JZ 0x005ba214
005ba20e : PUSH EDI
005ba20f : CALL 0x005b9c20
005ba214 : MOV EAX,dword ptr [ESP + 0x18]
005ba218 : LEA EBP,[EDI + 0x8]
005ba21b : PUSH EAX
005ba21c : MOV ECX,EBP
005ba21e : CALL 0x0051bc20
005ba223 : MOV EAX,dword ptr [ESP + 0x18]
005ba227 : MOV ECX,dword ptr [EAX + 0x4]
005ba22a : MOV dword ptr [EBP + 0x4],ECX
005ba22d : MOV EDX,dword ptr [EAX + 0x8]
005ba230 : MOV dword ptr [EBP + 0x8],EDX
005ba233 : MOV dword ptr [EDI],EBX
005ba235 : MOV dword ptr [EDI + 0x4],ESI
005ba238 : POP EDI
005ba239 : POP ESI
005ba23a : POP EBP
005ba23b : POP EBX
005ba23c : RET 0xc
005ba23f : LEA EDX,[EDX + EDX*0x4]
005ba242 : CMP dword ptr [EAX + EDX*0x4 + 0x8],ESI
005ba246 : LEA EBP,[EAX + EDX*0x4 + 0x8]
005ba24a : JZ 0x005ba261
005ba24c : LEA ESP,[ESP]
005ba250 : MOV EBP,dword ptr [EBP]
005ba253 : LEA EDX,[EBP + EBP*0x4]
005ba257 : CMP dword ptr [EAX + EDX*0x4 + 0x8],ESI
005ba25b : LEA EBP,[EAX + EDX*0x4 + 0x8]
005ba25f : JNZ 0x005ba250
005ba261 : TEST ECX,ECX
005ba263 : JZ 0x005ba26b
005ba265 : PUSH EDI
005ba266 : CALL 0x005b9c20
005ba26b : MOV dword ptr [EBP],EBX
005ba26e : MOV EBP,dword ptr [ESP + 0x18]
005ba272 : LEA EBX,[EDI + 0x8]
005ba275 : PUSH EBP
005ba276 : MOV ECX,EBX
005ba278 : CALL 0x0051bc20
005ba27d : MOV EAX,dword ptr [EBP + 0x4]
005ba280 : MOV dword ptr [EBX + 0x4],EAX
005ba283 : MOV ECX,dword ptr [EBP + 0x8]
005ba286 : MOV dword ptr [EBX + 0x8],ECX
005ba289 : MOV dword ptr [EDI + 0x4],ESI
005ba28c : MOV dword ptr [EDI],0xffffffff
005ba292 : POP EDI
005ba293 : POP ESI
005ba294 : POP EBP
005ba295 : POP EBX
005ba296 : RET 0xc

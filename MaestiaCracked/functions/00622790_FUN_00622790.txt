PROGRAM  : Maestia.exe
FUNCTION : FUN_00622790
ENTRY    : 00622790
BODY     : [[00622790, 006227d8] [006227e0, 006228d6]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_00622790(int param_1,byte *param_2,int param_3)

{
  byte bVar1;
  code *pcVar2;
  int iVar3;
  byte *pbVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  byte *pbVar7;
  bool bVar8;
  
  if (param_2 == (byte *)0x0) {
    if (param_3 == 0) {
      puVar6 = (undefined4 *)0x0;
    }
    else {
      if (DAT_00d7b458 < 8) {
        *(undefined4 *)(&DAT_00d7b430 + DAT_00d7b458 * 4) = *(undefined4 *)(param_1 + 300);
        DAT_00d7b458 = DAT_00d7b458 + 1;
      }
      iVar3 = DAT_00d7b458;
      if (param_1 == 0) goto LAB_006228a1;
      uVar5 = *(undefined4 *)(param_1 + 0x124);
      while( true ) {
        *(undefined4 *)(param_1 + 300) = uVar5;
LAB_006228a1:
        puVar6 = *(undefined4 **)(param_1 + 300);
        if ((puVar6 == (undefined4 *)0x0) || (puVar6[0x4c] == param_3)) break;
        uVar5 = *puVar6;
      }
      if (iVar3 != 0) {
        DAT_00d7b458 = iVar3 + -1;
        *(undefined4 *)(param_1 + 300) = *(undefined4 *)(&DAT_00d7b430 + DAT_00d7b458 * 4);
        return puVar6;
      }
    }
    return puVar6;
  }
  if (DAT_00d7b458 < 8) {
    *(undefined4 *)(&DAT_00d7b430 + DAT_00d7b458 * 4) = *(undefined4 *)(param_1 + 300);
    DAT_00d7b458 = DAT_00d7b458 + 1;
  }
  pcVar2 = DAT_00d7b45c;
  if (param_1 != 0) {
    *(undefined4 *)(param_1 + 300) = *(undefined4 *)(param_1 + 0x124);
    pcVar2 = DAT_00d7b45c;
  }
  while (puVar6 = *(undefined4 **)(param_1 + 300), puVar6 != (undefined4 *)0x0) {
    if (pcVar2 == (code *)0x0) {
      pbVar4 = (byte *)(puVar6 + 4);
      pbVar7 = param_2;
      do {
        bVar1 = *pbVar4;
        bVar8 = bVar1 < *pbVar7;
        if (bVar1 != *pbVar7) {
LAB_00622830:
          iVar3 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
          goto LAB_00622835;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar4[1];
        bVar8 = bVar1 < pbVar7[1];
        if (bVar1 != pbVar7[1]) goto LAB_00622830;
        pbVar4 = pbVar4 + 2;
        pbVar7 = pbVar7 + 2;
      } while (bVar1 != 0);
      iVar3 = 0;
LAB_00622835:
      if (iVar3 == 0) break;
      *(undefined4 *)(param_1 + 300) = *puVar6;
    }
    else {
      iVar3 = (*pcVar2)(param_2,puVar6);
      if (iVar3 == 0) break;
      *(undefined4 *)(param_1 + 300) = **(undefined4 **)(param_1 + 300);
      pcVar2 = DAT_00d7b45c;
    }
  }
  if (DAT_00d7b458 != 0) {
    DAT_00d7b458 = DAT_00d7b458 + -1;
    *(undefined4 *)(param_1 + 300) = *(undefined4 *)(&DAT_00d7b430 + DAT_00d7b458 * 4);
  }
  return puVar6;
}



============================================================
DISASSEMBLY
============================================================
00622790 : PUSH EBP
00622791 : MOV EBP,dword ptr [ESP + 0xc]
00622795 : PUSH ESI
00622796 : TEST EBP,EBP
00622798 : JZ 0x00622866
0062279e : MOV EAX,[0x00d7b458]
006227a3 : CMP EAX,0x8
006227a6 : PUSH EDI
006227a7 : MOV EDI,dword ptr [ESP + 0x10]
006227ab : JGE 0x006227c0
006227ad : MOV ECX,dword ptr [EDI + 0x12c]
006227b3 : MOV dword ptr [EAX*0x4 + 0xd7b430],ECX
006227ba : INC EAX
006227bb : MOV [0x00d7b458],EAX
006227c0 : TEST EDI,EDI
006227c2 : JZ 0x006227d0
006227c4 : MOV EDX,dword ptr [EDI + 0x124]
006227ca : MOV dword ptr [EDI + 0x12c],EDX
006227d0 : PUSH EBX
006227d1 : MOV EBX,dword ptr [0x00d7b45c]
006227d7 : JMP 0x006227e0
006227e0 : MOV ESI,dword ptr [EDI + 0x12c]
006227e6 : TEST ESI,ESI
006227e8 : JZ 0x00622843
006227ea : TEST EBX,EBX
006227ec : JZ 0x00622809
006227ee : PUSH ESI
006227ef : PUSH EBP
006227f0 : CALL EBX
006227f2 : ADD ESP,0x8
006227f5 : TEST EAX,EAX
006227f7 : JZ 0x00622843
006227f9 : MOV EAX,dword ptr [EDI + 0x12c]
006227ff : MOV ECX,dword ptr [EAX]
00622801 : MOV dword ptr [EDI + 0x12c],ECX
00622807 : JMP 0x006227d1
00622809 : MOV ECX,EBP
0062280b : LEA EAX,[ESI + 0x10]
0062280e : MOV EDI,EDI
00622810 : MOV DL,byte ptr [EAX]
00622812 : CMP DL,byte ptr [ECX]
00622814 : JNZ 0x00622830
00622816 : TEST DL,DL
00622818 : JZ 0x0062282c
0062281a : MOV DL,byte ptr [EAX + 0x1]
0062281d : CMP DL,byte ptr [ECX + 0x1]
00622820 : JNZ 0x00622830
00622822 : ADD EAX,0x2
00622825 : ADD ECX,0x2
00622828 : TEST DL,DL
0062282a : JNZ 0x00622810
0062282c : XOR EAX,EAX
0062282e : JMP 0x00622835
00622830 : SBB EAX,EAX
00622832 : SBB EAX,-0x1
00622835 : TEST EAX,EAX
00622837 : JZ 0x00622843
00622839 : MOV EDX,dword ptr [ESI]
0062283b : MOV dword ptr [EDI + 0x12c],EDX
00622841 : JMP 0x006227e0
00622843 : MOV EAX,[0x00d7b458]
00622848 : POP EBX
00622849 : TEST EAX,EAX
0062284b : JZ 0x00622860
0062284d : DEC EAX
0062284e : MOV [0x00d7b458],EAX
00622853 : MOV EAX,dword ptr [EAX*0x4 + 0xd7b430]
0062285a : MOV dword ptr [EDI + 0x12c],EAX
00622860 : POP EDI
00622861 : MOV EAX,ESI
00622863 : POP ESI
00622864 : POP EBP
00622865 : RET
00622866 : MOV ESI,dword ptr [ESP + 0x14]
0062286a : TEST ESI,ESI
0062286c : JZ 0x006228d2
0062286e : MOV EDX,dword ptr [0x00d7b458]
00622874 : CMP EDX,0x8
00622877 : MOV ECX,dword ptr [ESP + 0xc]
0062287b : JGE 0x00622891
0062287d : MOV EAX,dword ptr [ECX + 0x12c]
00622883 : MOV dword ptr [EDX*0x4 + 0xd7b430],EAX
0062288a : INC EDX
0062288b : MOV dword ptr [0x00d7b458],EDX
00622891 : TEST ECX,ECX
00622893 : JZ 0x006228a1
00622895 : MOV EAX,dword ptr [ECX + 0x124]
0062289b : MOV dword ptr [ECX + 0x12c],EAX
006228a1 : MOV EAX,dword ptr [ECX + 0x12c]
006228a7 : TEST EAX,EAX
006228a9 : JZ 0x006228b7
006228ab : CMP dword ptr [EAX + 0x130],ESI
006228b1 : JZ 0x006228b7
006228b3 : MOV EAX,dword ptr [EAX]
006228b5 : JMP 0x0062289b
006228b7 : TEST EDX,EDX
006228b9 : JZ 0x006228d4
006228bb : DEC EDX
006228bc : MOV dword ptr [0x00d7b458],EDX
006228c2 : MOV EDX,dword ptr [EDX*0x4 + 0xd7b430]
006228c9 : POP ESI
006228ca : MOV dword ptr [ECX + 0x12c],EDX
006228d0 : POP EBP
006228d1 : RET
006228d2 : XOR EAX,EAX
006228d4 : POP ESI
006228d5 : POP EBP
006228d6 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0067d630
ENTRY    : 0067d630
BODY     : [[0067d630, 0067d69c] [0067d6a0, 0067d6dc] [0067d6e0, 0067dc33]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0067d630(void)

{
  undefined4 *puVar1;
  HKL pHVar2;
  char cVar3;
  uint uVar4;
  HKL *lpList;
  uint uVar5;
  HRESULT HVar6;
  UINT UVar7;
  int *piVar8;
  undefined4 uVar9;
  LONG LVar10;
  HKL pHVar11;
  int iVar12;
  int *piVar13;
  int *in_ECX;
  int *unaff_ESI;
  int iVar14;
  BSTR bstrString;
  uint uVar15;
  BSTR pOStack_274;
  int *piStack_270;
  int *piStack_26c;
  LPVOID pvStack_268;
  int *piStack_264;
  uint uStack_260;
  int *piStack_25c;
  undefined1 auStack_258 [4];
  void *pvStack_254;
  undefined4 uStack_250;
  int iStack_24c;
  undefined4 uStack_248;
  undefined4 uStack_244;
  undefined4 uStack_240;
  int iStack_23c;
  undefined4 uStack_238;
  undefined2 uStack_234;
  undefined4 uStack_230;
  undefined4 uStack_22c;
  int iStack_228;
  undefined4 uStack_224;
  undefined4 uStack_21c;
  undefined4 uStack_218;
  int iStack_214;
  undefined4 uStack_210;
  WCHAR aWStack_20c [260];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&pOStack_274;
  in_ECX[0x12] = 0x1000000;
  in_ECX[0x11] = 0x1000000;
  uVar4 = GetKeyboardLayoutList(0,(HKL *)0x0);
  if (uVar4 == 0) {
    (**(code **)(*in_ECX + 0x38))("No IME\'s Installed!","GFxIME Error");
  }
  lpList = (HKL *)FUN_00515840(uVar4 * 4,0);
  GetKeyboardLayoutList(uVar4,lpList);
  uVar5 = 0;
  if (uVar4 != 0) {
    do {
      pHVar11 = lpList[uVar5];
      in_ECX[0x2f] = (int)pHVar11;
      lpList[uVar5] = pHVar11;
      uVar5 = uVar5 + 1;
    } while (uVar5 < uVar4);
  }
  cVar3 = FUN_0067c7e0(lpList,uVar4);
  FUN_00515cf0(lpList);
  if (cVar3 != '\0') goto LAB_0067dc1b;
  uVar4 = 0;
  if (in_ECX[0x2a] != 0) {
    do {
      (&DAT_00d7c380)[uVar4] = 0;
      uVar4 = uVar4 + 1;
    } while (uVar4 < (uint)in_ECX[0x2a]);
  }
  HVar6 = CoCreateInstance((IID *)&DAT_00bef2a0,(LPUNKNOWN)0x0,1,(IID *)&DAT_00bef9f0,&piStack_264);
  if (HVar6 < 0) {
    (**(code **)(*in_ECX + 0x3c))
              (HVar6,"GFxIME Error: Failure to Initialize InputProcessorProfiles!");
LAB_0067d71f:
    piStack_26c = (int *)0x0;
    if (in_ECX[0x2c] != 0) {
      piStack_270 = (int *)0x0;
      do {
        piVar13 = piStack_270;
        if (*(int *)(in_ECX[0x2b] + 0xc + (int)piStack_270) != 0) {
          iStack_24c = 0x1000000;
          FUN_0051b6e0();
          if ((*(uint *)(in_ECX[0x2b] + 8 + (int)piVar13) & 0xfff) == 0x409) {
            iStack_24c = 0x10000000;
            FUN_0051bb20("English");
          }
          if ((*(uint *)(in_ECX[0x2b] + 8 + (int)piVar13) & 0xfff) == 0x404) {
            iStack_24c = 9;
            FUN_0051bb20("Chinese (Traditional)");
          }
          if ((*(uint *)(in_ECX[0x2b] + 8 + (int)piVar13) & 0xfff) == 0x804) {
            iStack_24c = 0x80000;
            FUN_0051bb20("Chinese (Simplified)");
          }
          if ((*(uint *)(in_ECX[0x2b] + 8 + (int)piVar13) & 0xfff) == 0x412) {
            iStack_24c = 0x2000;
            FUN_0051bb20("Korean");
          }
          if ((*(uint *)(in_ECX[0x2b] + 8 + (int)piVar13) & 0xfff) == 0x411) {
            iStack_24c = 0x400;
            FUN_0051bb20("Japanese");
LAB_0067da04:
            uVar4 = 0;
            if (in_ECX[0x14] != 0) {
              piVar8 = (int *)(in_ECX[0x13] + 8);
              do {
                if (*piVar8 == iStack_24c) goto LAB_0067db0d;
                uVar4 = uVar4 + 1;
                piVar8 = piVar8 + 4;
              } while (uVar4 < (uint)in_ECX[0x14]);
            }
            uVar4 = *(uint *)(in_ECX[0x2b] + 8 + (int)piVar13);
            pvStack_254 = (void *)FUN_00515840((*(uint *)((uint)pOStack_274 & 0xfffffffc) &
                                               0x7fffffff) + 1,0);
            _memcpy(pvStack_254,(uint *)((uint)pOStack_274 & 0xfffffffc) + 2,
                    (*(uint *)((uint)pOStack_274 & 0xfffffffc) & 0x7fffffff) + 1);
            uVar5 = in_ECX[0x14] + 1;
            if (uVar5 < (uint)in_ECX[0x14]) {
              uVar15 = uVar5;
              if (uVar5 < (uint)in_ECX[0x15] >> 1) {
LAB_0067da9c:
                FUN_00502cb0(in_ECX + 0x13,uVar15);
              }
            }
            else if ((uint)in_ECX[0x15] <= uVar5) {
              uVar15 = (uVar5 >> 2) + uVar5;
              goto LAB_0067da9c;
            }
            in_ECX[0x14] = uVar5;
            puVar1 = (undefined4 *)(uVar5 * 0x10 + -0x10 + in_ECX[0x13]);
            if (puVar1 != (undefined4 *)0x0) {
              *puVar1 = pvStack_254;
              puVar1[1] = uStack_250;
              puVar1[2] = iStack_24c;
              puVar1[3] = uVar4 & 0xfff;
            }
            uVar9 = FUN_0051c6e0(&uStack_260,&DAT_00bd6690);
            FUN_0051bd70(uVar9);
            uVar4 = uStack_260 & 0xfffffffc;
            LVar10 = InterlockedExchangeAdd((LONG *)(uVar4 + 4),-1);
            if (LVar10 == 1) {
              FUN_00515cf0(uVar4);
            }
            in_ECX[0x10] = in_ECX[0x10] + 1;
            piVar13 = piStack_270;
          }
          else if (iStack_24c != 0x1000000) goto LAB_0067da04;
LAB_0067db0d:
          uVar4 = (uint)pOStack_274 & 0xfffffffc;
          LVar10 = InterlockedExchangeAdd((LONG *)(uVar4 + 4),-1);
          if (LVar10 == 1) {
            FUN_00515cf0(uVar4);
          }
        }
        piStack_26c = (int *)((int)piStack_26c + 1);
        piStack_270 = piVar13 + 4;
      } while (piStack_26c < (int *)in_ECX[0x2c]);
    }
  }
  else {
    if (piStack_264 == (int *)0x0) goto LAB_0067d71f;
    iVar12 = (**(code **)(*piStack_264 + 0x3c))(piStack_264,&pvStack_268,&piStack_26c);
    iVar14 = iStack_24c;
    if (-1 < iVar12) {
      piStack_270 = (int *)0x0;
      if (piStack_26c != (int *)0x0) {
        do {
          piVar13 = piStack_270;
          iVar12 = GetLocaleInfoW((uint)*(ushort *)((int)pvStack_268 + (int)piStack_270 * 2),2,
                                  aWStack_20c,0x104);
          if (iVar12 != 0) {
            (**(code **)(*piStack_264 + 0x40))
                      (piStack_264,*(undefined2 *)((int)pvStack_268 + (int)piVar13 * 2),&piStack_25c
                      );
            uStack_250 = 0;
            uStack_230 = 0;
            uStack_244 = 0;
            uStack_21c = 0;
            uStack_22c = 0;
            uStack_240 = 0;
            uStack_218 = 0;
            iStack_228 = iVar14;
            uStack_224 = uStack_248;
            iStack_23c = iVar14;
            uStack_238 = uStack_248;
            iStack_214 = iVar14;
            uStack_210 = uStack_248;
            uStack_234 = *(undefined2 *)((int)pvStack_268 + (int)piVar13 * 2);
            FUN_0067d4c0(&uStack_244,aWStack_20c);
            pOStack_274 = SysAllocString((OLECHAR *)0x0);
            FUN_0051b6e0();
            if (piStack_25c != (int *)0x0) {
              iVar12 = (**(code **)(*piStack_25c + 0x10))(piStack_25c,1,&uStack_244,0);
              while (iVar12 != 1) {
                bstrString = (BSTR)&stack0xfffffd7c;
                (**(code **)(*(int *)pOStack_274 + 0x30))
                          (pOStack_274,&pvStack_254,uStack_244,&uStack_22c);
                UVar7 = SysStringLen(bstrString);
                if (UVar7 != 0) {
                  SysFreeString(bstrString);
                }
                iVar12 = (**(code **)(*unaff_ESI + 0x10))(unaff_ESI,1,&pvStack_268,0);
              }
              (**(code **)(*piStack_26c + 8))(piStack_26c);
            }
            uVar4 = uStack_260 & 0xfffffffc;
            LVar10 = InterlockedExchangeAdd((LONG *)(uVar4 + 4),-1);
            piVar13 = piStack_270;
            if (LVar10 == 1) {
              FUN_00515cf0(uVar4);
              piVar13 = piStack_270;
            }
          }
          piStack_270 = (int *)((int)piVar13 + 1);
        } while (piStack_270 < piStack_26c);
      }
      CoTaskMemFree(pvStack_268);
    }
  }
  pHVar11 = GetKeyboardLayout(0);
  uVar4 = 0;
  if (in_ECX[0x2c] != 0) {
    iVar14 = 0;
    do {
      puVar1 = (undefined4 *)(iVar14 + in_ECX[0x2b]);
      if ((*(int *)(iVar14 + 0xc + in_ECX[0x2b]) != 0) &&
         (iVar12 = (**(code **)(*in_ECX + 0x40))(puVar1[1],*puVar1), iVar12 != -1)) {
        (&DAT_00d68894)[iVar12 * 4] = *(undefined4 *)(iVar14 + 8 + in_ECX[0x2b]);
        pHVar2 = *(HKL *)(iVar14 + 8 + in_ECX[0x2b]);
        in_ECX[0x2f] = (int)pHVar2;
        if (pHVar2 == pHVar11) {
          in_ECX[0x12] = (&DAT_00d68890)[iVar12 * 4];
        }
      }
      uVar4 = uVar4 + 1;
      iVar14 = iVar14 + 0x10;
    } while (uVar4 < (uint)in_ECX[0x2c]);
  }
  if (piStack_264 != (int *)0x0) {
    (**(code **)(*piStack_264 + 0x34))(piStack_264,auStack_258);
  }
  pHVar11 = GetKeyboardLayout(0);
  in_ECX[0x2f] = (uint)pHVar11 & 0xfff;
  in_ECX[0x11] = 0x1000000;
  if (in_ECX[0x10] != 0) {
    piVar13 = (int *)(in_ECX[0x13] + 8);
    uVar4 = 0;
    do {
      if (piVar13[1] == in_ECX[0x2f]) {
        in_ECX[0x11] = *piVar13;
      }
      uVar4 = uVar4 + 1;
      piVar13 = piVar13 + 4;
    } while (uVar4 < (uint)in_ECX[0x10]);
  }
LAB_0067dc1b:
  __security_check_cookie(local_4 ^ (uint)&pOStack_274);
  return;
}



============================================================
DISASSEMBLY
============================================================
0067d630 : SUB ESP,0x274
0067d636 : MOV EAX,[0x00d66fa0]
0067d63b : XOR EAX,ESP
0067d63d : MOV dword ptr [ESP + 0x270],EAX
0067d644 : PUSH EBX
0067d645 : MOV EBX,dword ptr [0x00b854bc]
0067d64b : PUSH EBP
0067d64c : PUSH ESI
0067d64d : PUSH EDI
0067d64e : MOV ESI,ECX
0067d650 : MOV EAX,0x1000000
0067d655 : PUSH 0x0
0067d657 : PUSH 0x0
0067d659 : MOV dword ptr [ESI + 0x48],EAX
0067d65c : MOV dword ptr [ESI + 0x44],EAX
0067d65f : CALL EBX
0067d661 : MOV EDI,EAX
0067d663 : TEST EDI,EDI
0067d665 : JNZ 0x0067d67a
0067d667 : MOV EAX,dword ptr [ESI]
0067d669 : MOV EDX,dword ptr [EAX + 0x38]
0067d66c : PUSH 0xbd7c2c
0067d671 : PUSH 0xbd7c9c
0067d676 : MOV ECX,ESI
0067d678 : CALL EDX
0067d67a : MOV ECX,dword ptr [0x00d73250]
0067d680 : PUSH 0x0
0067d682 : LEA EAX,[EDI*0x4 + 0x0]
0067d689 : PUSH EAX
0067d68a : CALL 0x00515840
0067d68f : MOV EBP,EAX
0067d691 : PUSH EBP
0067d692 : PUSH EDI
0067d693 : CALL EBX
0067d695 : XOR EAX,EAX
0067d697 : TEST EDI,EDI
0067d699 : JBE 0x0067d6b3
0067d69b : JMP 0x0067d6a0
0067d6a0 : MOV ECX,dword ptr [EBP + EAX*0x4]
0067d6a4 : MOV dword ptr [ESI + 0xbc],ECX
0067d6aa : MOV dword ptr [EBP + EAX*0x4],ECX
0067d6ae : INC EAX
0067d6af : CMP EAX,EDI
0067d6b1 : JC 0x0067d6a0
0067d6b3 : PUSH EDI
0067d6b4 : PUSH EBP
0067d6b5 : MOV ECX,ESI
0067d6b7 : CALL 0x0067c7e0
0067d6bc : PUSH EBP
0067d6bd : MOV BL,AL
0067d6bf : CALL 0x00515cf0
0067d6c4 : TEST BL,BL
0067d6c6 : JZ 0x0067d6cf
0067d6c8 : MOV AL,BL
0067d6ca : JMP 0x0067dc1b
0067d6cf : XOR EDI,EDI
0067d6d1 : XOR EAX,EAX
0067d6d3 : CMP dword ptr [ESI + 0xa8],EDI
0067d6d9 : JBE 0x0067d6f0
0067d6db : JMP 0x0067d6e0
0067d6e0 : MOV dword ptr [EAX*0x4 + 0xd7c380],EDI
0067d6e7 : INC EAX
0067d6e8 : CMP EAX,dword ptr [ESI + 0xa8]
0067d6ee : JC 0x0067d6e0
0067d6f0 : LEA ECX,[ESP + 0x20]
0067d6f4 : PUSH ECX
0067d6f5 : PUSH 0xbef9f0
0067d6fa : PUSH 0x1
0067d6fc : PUSH EDI
0067d6fd : PUSH 0xbef2a0
0067d702 : CALL dword ptr [0x00b85774]
0067d708 : CMP EAX,EDI
0067d70a : JGE 0x0067d843
0067d710 : MOV EDX,dword ptr [ESI]
0067d712 : PUSH 0xbd7c60
0067d717 : PUSH EAX
0067d718 : MOV EAX,dword ptr [EDX + 0x3c]
0067d71b : MOV ECX,ESI
0067d71d : CALL EAX
0067d71f : MOV dword ptr [ESP + 0x18],EDI
0067d723 : CMP dword ptr [ESI + 0xb0],EDI
0067d729 : JBE 0x0067db47
0067d72f : XOR EBP,EBP
0067d731 : MOV dword ptr [ESP + 0x14],EBP
0067d735 : MOV EDX,dword ptr [ESI + 0xac]
0067d73b : CMP dword ptr [EDX + EBP*0x1 + 0xc],0x0
0067d740 : JZ 0x0067db2b
0067d746 : MOV EDI,0x1000000
0067d74b : LEA ECX,[ESP + 0x10]
0067d74f : MOV dword ptr [ESP + 0x38],EDI
0067d753 : CALL 0x0051b6e0
0067d758 : MOV EAX,dword ptr [ESI + 0xac]
0067d75e : MOV ECX,dword ptr [EAX + EBP*0x1 + 0x8]
0067d762 : AND ECX,0xfff
0067d768 : CMP ECX,0x409
0067d76e : JNZ 0x0067d786
0067d770 : PUSH 0xbd6498
0067d775 : LEA ECX,[ESP + 0x14]
0067d779 : MOV dword ptr [ESP + 0x3c],0x10000000
0067d781 : CALL 0x0051bb20
0067d786 : MOV EDX,dword ptr [ESI + 0xac]
0067d78c : MOV EAX,dword ptr [EDX + EBP*0x1 + 0x8]
0067d790 : AND EAX,0xfff
0067d795 : CMP EAX,0x404
0067d79a : JNZ 0x0067d7b2
0067d79c : PUSH 0xbd6454
0067d7a1 : LEA ECX,[ESP + 0x14]
0067d7a5 : MOV dword ptr [ESP + 0x3c],0x9
0067d7ad : CALL 0x0051bb20
0067d7b2 : MOV ECX,dword ptr [ESI + 0xac]
0067d7b8 : MOV EDX,dword ptr [ECX + EBP*0x1 + 0x8]
0067d7bc : AND EDX,0xfff
0067d7c2 : CMP EDX,0x804
0067d7c8 : JNZ 0x0067d7e0
0067d7ca : PUSH 0xbd646c
0067d7cf : LEA ECX,[ESP + 0x14]
0067d7d3 : MOV dword ptr [ESP + 0x3c],0x80000
0067d7db : CALL 0x0051bb20
0067d7e0 : MOV EAX,dword ptr [ESI + 0xac]
0067d7e6 : MOV ECX,dword ptr [EAX + EBP*0x1 + 0x8]
0067d7ea : AND ECX,0xfff
0067d7f0 : CMP ECX,0x412
0067d7f6 : JNZ 0x0067d80e
0067d7f8 : PUSH 0xbd6484
0067d7fd : LEA ECX,[ESP + 0x14]
0067d801 : MOV dword ptr [ESP + 0x3c],0x2000
0067d809 : CALL 0x0051bb20
0067d80e : MOV EDX,dword ptr [ESI + 0xac]
0067d814 : MOV EAX,dword ptr [EDX + EBP*0x1 + 0x8]
0067d818 : AND EAX,0xfff
0067d81d : CMP EAX,0x411
0067d822 : JNZ 0x0067d9fa
0067d828 : PUSH 0xbd648c
0067d82d : LEA ECX,[ESP + 0x14]
0067d831 : MOV dword ptr [ESP + 0x3c],0x400
0067d839 : CALL 0x0051bb20
0067d83e : JMP 0x0067da04
0067d843 : MOV EAX,dword ptr [ESP + 0x20]
0067d847 : CMP EAX,EDI
0067d849 : JZ 0x0067d71f
0067d84f : MOV ECX,dword ptr [EAX]
0067d851 : LEA EDX,[ESP + 0x18]
0067d855 : PUSH EDX
0067d856 : LEA EDX,[ESP + 0x20]
0067d85a : PUSH EDX
0067d85b : PUSH EAX
0067d85c : MOV EAX,dword ptr [ECX + 0x3c]
0067d85f : CALL EAX
0067d861 : TEST EAX,EAX
0067d863 : JL 0x0067db47
0067d869 : MOV dword ptr [ESP + 0x14],EDI
0067d86d : CMP dword ptr [ESP + 0x18],EDI
0067d871 : JBE 0x0067d9ea
0067d877 : MOV EBP,dword ptr [ESP + 0x3c]
0067d87b : MOV EBX,dword ptr [ESP + 0x38]
0067d87f : NOP
0067d880 : MOV EDX,dword ptr [ESP + 0x1c]
0067d884 : MOVZX EAX,word ptr [EDX + EDI*0x2]
0067d888 : PUSH 0x104
0067d88d : LEA ECX,[ESP + 0x7c]
0067d891 : PUSH ECX
0067d892 : PUSH 0x2
0067d894 : PUSH EAX
0067d895 : CALL dword ptr [0x00b851d8]
0067d89b : TEST EAX,EAX
0067d89d : JZ 0x0067d9db
0067d8a3 : MOV EAX,dword ptr [ESP + 0x20]
0067d8a7 : MOV ECX,dword ptr [EAX]
0067d8a9 : LEA EDX,[ESP + 0x28]
0067d8ad : PUSH EDX
0067d8ae : MOV EDX,dword ptr [ESP + 0x20]
0067d8b2 : MOVZX EDX,word ptr [EDX + EDI*0x2]
0067d8b6 : PUSH EDX
0067d8b7 : PUSH EAX
0067d8b8 : MOV EAX,dword ptr [ECX + 0x40]
0067d8bb : CALL EAX
0067d8bd : XOR ECX,ECX
0067d8bf : XOR EAX,EAX
0067d8c1 : XOR EDX,EDX
0067d8c3 : MOV word ptr [ESP + 0x36],CX
0067d8c8 : MOV word ptr [ESP + 0x34],DX
0067d8cd : MOV ECX,dword ptr [ESP + 0x34]
0067d8d1 : MOV dword ptr [ESP + 0x54],EAX
0067d8d5 : MOV dword ptr [ESP + 0x40],EAX
0067d8d9 : MOV dword ptr [ESP + 0x68],EAX
0067d8dd : MOV EAX,dword ptr [ESP + 0x1c]
0067d8e1 : MOV dword ptr [ESP + 0x58],ECX
0067d8e5 : MOV dword ptr [ESP + 0x44],ECX
0067d8e9 : MOV dword ptr [ESP + 0x6c],ECX
0067d8ed : MOV dword ptr [ESP + 0x5c],EBX
0067d8f1 : MOV dword ptr [ESP + 0x60],EBP
0067d8f5 : MOV dword ptr [ESP + 0x48],EBX
0067d8f9 : MOV dword ptr [ESP + 0x4c],EBP
0067d8fd : MOV dword ptr [ESP + 0x70],EBX
0067d901 : MOV dword ptr [ESP + 0x74],EBP
0067d905 : MOV CX,word ptr [EAX + EDI*0x2]
0067d909 : LEA EDX,[ESP + 0x78]
0067d90d : PUSH EDX
0067d90e : LEA EAX,[ESP + 0x44]
0067d912 : MOV word ptr [ESP + 0x54],CX
0067d917 : PUSH EAX
0067d918 : MOV ECX,ESI
0067d91a : CALL 0x0067d4c0
0067d91f : XOR EDI,EDI
0067d921 : PUSH EDI
0067d922 : CALL dword ptr [0x00b853d8]
0067d928 : LEA ECX,[ESP + 0x24]
0067d92c : MOV dword ptr [ESP + 0x10],EAX
0067d930 : CALL 0x0051b6e0
0067d935 : MOV EAX,dword ptr [ESP + 0x28]
0067d939 : CMP EAX,EDI
0067d93b : JZ 0x0067d9b9
0067d941 : MOV ECX,dword ptr [EAX]
0067d943 : PUSH EDI
0067d944 : LEA EDX,[ESP + 0x44]
0067d948 : PUSH EDX
0067d949 : PUSH 0x1
0067d94b : PUSH EAX
0067d94c : MOV EAX,dword ptr [ECX + 0x10]
0067d94f : CALL EAX
0067d951 : CMP EAX,0x1
0067d954 : JZ 0x0067d9ad
0067d956 : MOV EAX,dword ptr [ESP + 0x20]
0067d95a : MOV ECX,dword ptr [EAX]
0067d95c : LEA EDX,[ESP + 0x10]
0067d960 : PUSH EDX
0067d961 : LEA EDX,[ESP + 0x6c]
0067d965 : PUSH EDX
0067d966 : MOV EDX,dword ptr [ESP + 0x58]
0067d96a : PUSH EDX
0067d96b : LEA EDX,[ESP + 0x4c]
0067d96f : PUSH EDX
0067d970 : PUSH EAX
0067d971 : MOV EAX,dword ptr [ECX + 0x30]
0067d974 : CALL EAX
0067d976 : MOV ECX,dword ptr [ESP + 0x10]
0067d97a : PUSH ECX
0067d97b : CALL dword ptr [0x00b853dc]
0067d981 : TEST EAX,EAX
0067d983 : JZ 0x0067d994
0067d985 : MOV EDX,dword ptr [ESP + 0x10]
0067d989 : PUSH EDX
0067d98a : CALL dword ptr [0x00b853d0]
0067d990 : MOV dword ptr [ESP + 0x10],EDI
0067d994 : MOV EAX,dword ptr [ESP + 0x28]
0067d998 : MOV ECX,dword ptr [EAX]
0067d99a : PUSH EDI
0067d99b : LEA EDX,[ESP + 0x44]
0067d99f : PUSH EDX
0067d9a0 : PUSH 0x1
0067d9a2 : PUSH EAX
0067d9a3 : MOV EAX,dword ptr [ECX + 0x10]
0067d9a6 : CALL EAX
0067d9a8 : CMP EAX,0x1
0067d9ab : JNZ 0x0067d956
0067d9ad : MOV EAX,dword ptr [ESP + 0x28]
0067d9b1 : MOV ECX,dword ptr [EAX]
0067d9b3 : MOV EDX,dword ptr [ECX + 0x8]
0067d9b6 : PUSH EAX
0067d9b7 : CALL EDX
0067d9b9 : MOV EDI,dword ptr [ESP + 0x24]
0067d9bd : AND EDI,0xfffffffc
0067d9c0 : PUSH -0x1
0067d9c2 : LEA EAX,[EDI + 0x4]
0067d9c5 : PUSH EAX
0067d9c6 : CALL dword ptr [0x00b851cc]
0067d9cc : SUB EAX,0x1
0067d9cf : JNZ 0x0067d9d7
0067d9d1 : PUSH EDI
0067d9d2 : CALL 0x00515cf0
0067d9d7 : MOV EDI,dword ptr [ESP + 0x14]
0067d9db : INC EDI
0067d9dc : MOV dword ptr [ESP + 0x14],EDI
0067d9e0 : CMP EDI,dword ptr [ESP + 0x18]
0067d9e4 : JC 0x0067d880
0067d9ea : MOV ECX,dword ptr [ESP + 0x1c]
0067d9ee : PUSH ECX
0067d9ef : CALL dword ptr [0x00b85770]
0067d9f5 : JMP 0x0067db47
0067d9fa : CMP dword ptr [ESP + 0x38],EDI
0067d9fe : JZ 0x0067db0d
0067da04 : XOR ECX,ECX
0067da06 : CMP dword ptr [ESI + 0x50],ECX
0067da09 : JBE 0x0067da26
0067da0b : MOV EAX,dword ptr [ESI + 0x4c]
0067da0e : MOV EDX,dword ptr [ESP + 0x38]
0067da12 : ADD EAX,0x8
0067da15 : CMP dword ptr [EAX],EDX
0067da17 : JZ 0x0067db0d
0067da1d : INC ECX
0067da1e : ADD EAX,0x10
0067da21 : CMP ECX,dword ptr [ESI + 0x50]
0067da24 : JC 0x0067da15
0067da26 : MOV EAX,dword ptr [ESP + 0x10]
0067da2a : MOV EDX,dword ptr [ESI + 0xac]
0067da30 : MOV EBX,dword ptr [EDX + EBP*0x1 + 0x8]
0067da34 : MOV ECX,dword ptr [0x00d73250]
0067da3a : AND EAX,0xfffffffc
0067da3d : MOV EAX,dword ptr [EAX]
0067da3f : AND EAX,0x7fffffff
0067da44 : PUSH 0x0
0067da46 : INC EAX
0067da47 : PUSH EAX
0067da48 : AND EBX,0xfff
0067da4e : CALL 0x00515840
0067da53 : MOV ECX,EAX
0067da55 : MOV EAX,dword ptr [ESP + 0x10]
0067da59 : AND EAX,0xfffffffc
0067da5c : MOV EDX,dword ptr [EAX]
0067da5e : AND EDX,0x7fffffff
0067da64 : INC EDX
0067da65 : PUSH EDX
0067da66 : ADD EAX,0x8
0067da69 : PUSH EAX
0067da6a : PUSH ECX
0067da6b : MOV dword ptr [ESP + 0x3c],ECX
0067da6f : CALL 0x0063ae40
0067da74 : MOV EDI,dword ptr [ESI + 0x50]
0067da77 : LEA EBP,[ESI + 0x4c]
0067da7a : INC EDI
0067da7b : ADD ESP,0xc
0067da7e : CMP EDI,dword ptr [EBP + 0x4]
0067da81 : JNC 0x0067da8f
0067da83 : MOV EAX,dword ptr [EBP + 0x8]
0067da86 : SHR EAX,0x1
0067da88 : CMP EDI,EAX
0067da8a : JNC 0x0067daa4
0067da8c : PUSH EDI
0067da8d : JMP 0x0067da9c
0067da8f : CMP EDI,dword ptr [EBP + 0x8]
0067da92 : JC 0x0067daa4
0067da94 : MOV ECX,EDI
0067da96 : SHR ECX,0x2
0067da99 : ADD ECX,EDI
0067da9b : PUSH ECX
0067da9c : PUSH EBP
0067da9d : MOV ECX,EBP
0067da9f : CALL 0x00502cb0
0067daa4 : MOV EDX,dword ptr [EBP]
0067daa7 : MOV dword ptr [EBP + 0x4],EDI
0067daaa : SHL EDI,0x4
0067daad : LEA EAX,[EDI + EDX*0x1 + -0x10]
0067dab1 : TEST EAX,EAX
0067dab3 : JZ 0x0067dacc
0067dab5 : MOV ECX,dword ptr [ESP + 0x30]
0067dab9 : MOV EDX,dword ptr [ESP + 0x34]
0067dabd : MOV dword ptr [EAX],ECX
0067dabf : MOV ECX,dword ptr [ESP + 0x38]
0067dac3 : MOV dword ptr [EAX + 0x4],EDX
0067dac6 : MOV dword ptr [EAX + 0x8],ECX
0067dac9 : MOV dword ptr [EAX + 0xc],EBX
0067dacc : PUSH 0xbd6690
0067dad1 : LEA EDX,[ESP + 0x28]
0067dad5 : PUSH EDX
0067dad6 : LEA ECX,[ESP + 0x18]
0067dada : CALL 0x0051c6e0
0067dadf : PUSH EAX
0067dae0 : LEA ECX,[ESI + 0x38]
0067dae3 : CALL 0x0051bd70
0067dae8 : MOV EDI,dword ptr [ESP + 0x24]
0067daec : AND EDI,0xfffffffc
0067daef : PUSH -0x1
0067daf1 : LEA EAX,[EDI + 0x4]
0067daf4 : PUSH EAX
0067daf5 : CALL dword ptr [0x00b851cc]
0067dafb : SUB EAX,0x1
0067dafe : JNZ 0x0067db06
0067db00 : PUSH EDI
0067db01 : CALL 0x00515cf0
0067db06 : INC dword ptr [ESI + 0x40]
0067db09 : MOV EBP,dword ptr [ESP + 0x14]
0067db0d : MOV EDI,dword ptr [ESP + 0x10]
0067db11 : AND EDI,0xfffffffc
0067db14 : PUSH -0x1
0067db16 : LEA ECX,[EDI + 0x4]
0067db19 : PUSH ECX
0067db1a : CALL dword ptr [0x00b851cc]
0067db20 : SUB EAX,0x1
0067db23 : JNZ 0x0067db2b
0067db25 : PUSH EDI
0067db26 : CALL 0x00515cf0
0067db2b : MOV EAX,dword ptr [ESP + 0x18]
0067db2f : INC EAX
0067db30 : ADD EBP,0x10
0067db33 : MOV dword ptr [ESP + 0x18],EAX
0067db37 : MOV dword ptr [ESP + 0x14],EBP
0067db3b : CMP EAX,dword ptr [ESI + 0xb0]
0067db41 : JC 0x0067d735
0067db47 : PUSH 0x0
0067db49 : CALL dword ptr [0x00b8551c]
0067db4f : XOR EBX,EBX
0067db51 : MOV EBP,EAX
0067db53 : CMP dword ptr [ESI + 0xb0],EBX
0067db59 : JBE 0x0067dbc1
0067db5b : XOR EDI,EDI
0067db5d : LEA ECX,[ECX]
0067db60 : MOV EDX,dword ptr [ESI + 0xac]
0067db66 : CMP dword ptr [EDI + EDX*0x1 + 0xc],0x0
0067db6b : LEA EAX,[EDI + EDX*0x1]
0067db6e : JZ 0x0067dbb5
0067db70 : MOV ECX,dword ptr [EAX]
0067db72 : MOV EDX,dword ptr [ESI]
0067db74 : MOV EAX,dword ptr [EAX + 0x4]
0067db77 : MOV EDX,dword ptr [EDX + 0x40]
0067db7a : PUSH ECX
0067db7b : PUSH EAX
0067db7c : MOV ECX,ESI
0067db7e : CALL EDX
0067db80 : CMP EAX,-0x1
0067db83 : JZ 0x0067dbb5
0067db85 : MOV ECX,dword ptr [ESI + 0xac]
0067db8b : MOV EDX,dword ptr [EDI + ECX*0x1 + 0x8]
0067db8f : SHL EAX,0x4
0067db92 : MOV dword ptr [EAX + 0xd68894],EDX
0067db98 : MOV ECX,dword ptr [ESI + 0xac]
0067db9e : MOV ECX,dword ptr [EDI + ECX*0x1 + 0x8]
0067dba2 : MOV dword ptr [ESI + 0xbc],ECX
0067dba8 : CMP ECX,EBP
0067dbaa : JNZ 0x0067dbb5
0067dbac : MOV EDX,dword ptr [EAX + 0xd68890]
0067dbb2 : MOV dword ptr [ESI + 0x48],EDX
0067dbb5 : INC EBX
0067dbb6 : ADD EDI,0x10
0067dbb9 : CMP EBX,dword ptr [ESI + 0xb0]
0067dbbf : JC 0x0067db60
0067dbc1 : MOV EAX,dword ptr [ESP + 0x20]
0067dbc5 : TEST EAX,EAX
0067dbc7 : JZ 0x0067dbd6
0067dbc9 : MOV ECX,dword ptr [EAX]
0067dbcb : LEA EDX,[ESP + 0x2c]
0067dbcf : PUSH EDX
0067dbd0 : PUSH EAX
0067dbd1 : MOV EAX,dword ptr [ECX + 0x34]
0067dbd4 : CALL EAX
0067dbd6 : PUSH 0x0
0067dbd8 : CALL dword ptr [0x00b8551c]
0067dbde : AND EAX,0xfff
0067dbe3 : XOR ECX,ECX
0067dbe5 : MOV dword ptr [ESI + 0xbc],EAX
0067dbeb : MOV dword ptr [ESI + 0x44],0x1000000
0067dbf2 : CMP dword ptr [ESI + 0x40],ECX
0067dbf5 : JBE 0x0067dc19
0067dbf7 : MOV EAX,dword ptr [ESI + 0x4c]
0067dbfa : ADD EAX,0x8
0067dbfd : LEA ECX,[ECX]
0067dc00 : MOV EDX,dword ptr [EAX + 0x4]
0067dc03 : CMP EDX,dword ptr [ESI + 0xbc]
0067dc09 : JNZ 0x0067dc10
0067dc0b : MOV EDX,dword ptr [EAX]
0067dc0d : MOV dword ptr [ESI + 0x44],EDX
0067dc10 : INC ECX
0067dc11 : ADD EAX,0x10
0067dc14 : CMP ECX,dword ptr [ESI + 0x40]
0067dc17 : JC 0x0067dc00
0067dc19 : XOR AL,AL
0067dc1b : MOV ECX,dword ptr [ESP + 0x280]
0067dc22 : POP EDI
0067dc23 : POP ESI
0067dc24 : POP EBP
0067dc25 : POP EBX
0067dc26 : XOR ECX,ESP
0067dc28 : CALL 0x00633e6b
0067dc2d : ADD ESP,0x274
0067dc33 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00556b20
ENTRY    : 00556b20
BODY     : [[00556b20, 00556bb2] [00556bc0, 00556c86] [00556c90, 00556e40]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00556b20(void)

{
  uint uVar1;
  int iVar2;
  int *in_ECX;
  int iVar3;
  int *piVar4;
  int *piVar5;
  float fVar6;
  float fVar7;
  float fVar8;
  float fVar9;
  int iStack_158;
  uint uStack_154;
  uint uStack_150;
  int iStack_14c;
  undefined1 *puStack_148;
  undefined4 local_144;
  undefined1 *puStack_140;
  undefined4 local_13c;
  int aiStack_138 [6];
  undefined4 uStack_120;
  int iStack_110;
  undefined4 uStack_10c;
  int iStack_fc;
  undefined1 auStack_f8 [20];
  undefined4 uStack_e4;
  undefined4 uStack_e0;
  undefined4 uStack_dc;
  char cStack_d8;
  int iStack_cc;
  int iStack_c8;
  float fStack_8c;
  byte bStack_88;
  undefined1 auStack_84 [20];
  int iStack_70;
  undefined4 uStack_6c;
  undefined4 uStack_68;
  char cStack_64;
  int iStack_58;
  int iStack_54;
  float fStack_18;
  byte bStack_14;
  int *piStack_4;
  
  local_144 = 0;
  local_13c = 0;
  (**(code **)(*in_ECX + 0x44))(&local_144,&local_13c);
  puStack_148 = (undefined1 *)0x0;
  uStack_150 = 0;
  (**(code **)(*piStack_4 + 0x44))(&puStack_148,&uStack_150);
  if ((uStack_154 != uStack_150) || (iStack_14c != iStack_158)) {
    return 0;
  }
  FUN_005560e0(in_ECX);
  FUN_005560e0(piStack_4);
  while( true ) {
    if (cStack_64 == '\x01') {
      return 1;
    }
    if (cStack_d8 == '\x01') {
      return 0;
    }
    aiStack_138[0] = iStack_70;
    aiStack_138[1] = uStack_6c;
    aiStack_138[2] = uStack_68;
    aiStack_138[3] = uStack_e4;
    aiStack_138[4] = uStack_e0;
    aiStack_138[5] = uStack_dc;
    uVar1 = 0xc;
    iVar3 = 0;
    do {
      if (*(int *)((int)aiStack_138 + iVar3) != *(int *)((int)aiStack_138 + iVar3 + 0xc)) {
        return 0;
      }
      uVar1 = uVar1 - 4;
      iVar3 = iVar3 + 4;
    } while (3 < uVar1);
    puStack_148 = auStack_84;
    local_144 = 0;
    if (-1 < cStack_64) {
      do {
        FUN_00553740();
      } while (cStack_64 == '\x03');
    }
    puStack_140 = auStack_f8;
    local_13c = 0;
    if ((-1 < cStack_d8) && (cStack_d8 != '\x01')) {
      do {
        FUN_00553740();
      } while (cStack_d8 == '\x03');
    }
    fVar8 = (float)iStack_58;
    fVar7 = (float)iStack_54;
    if ((bStack_14 & 0x80) != 0) {
      fVar8 = fStack_18 * fVar8;
      fVar7 = fStack_18 * fVar7;
    }
    fVar6 = (float)iStack_cc;
    fVar9 = (float)iStack_c8;
    if ((bStack_88 & 0x80) != 0) {
      fVar6 = fStack_8c * fVar6;
      fVar9 = fStack_8c * fVar9;
    }
    if (fVar6 != fVar8) break;
    if (fVar9 != fVar7) {
      return 0;
    }
    iVar3 = FUN_005565a0();
    iVar2 = FUN_005565a0();
    if (iVar2 != iVar3) {
      return 0;
    }
    while ((puStack_148[0x20] != '\x01' && ((char)puStack_148[0x20] < '\0'))) {
      if (puStack_140[0x20] == '\x01') {
        return 0;
      }
      if (-1 < (char)puStack_140[0x20]) {
        return 0;
      }
      FUN_00554440(&uStack_120);
      FUN_00554440(&uStack_10c);
      if (iStack_110 != iStack_fc) {
        return 0;
      }
      piVar4 = &uStack_10c;
      piVar5 = &uStack_120;
      for (uVar1 = iStack_110 * 4; 3 < uVar1; uVar1 = uVar1 - 4) {
        if (*piVar5 != *piVar4) {
          return 0;
        }
        piVar4 = piVar4 + 1;
        piVar5 = piVar5 + 1;
      }
      if (uVar1 != 0) {
        if ((char)*piVar4 != (char)*piVar5) {
          return 0;
        }
        if (1 < uVar1) {
          if (*(char *)((int)piVar4 + 1) != *(char *)((int)piVar5 + 1)) {
            return 0;
          }
          if ((2 < uVar1) && (*(char *)((int)piVar4 + 2) != *(char *)((int)piVar5 + 2))) {
            return 0;
          }
        }
      }
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00556b20 : SUB ESP,0x158
00556b26 : PUSH EBP
00556b27 : PUSH ESI
00556b28 : MOV ESI,ECX
00556b2a : MOV EAX,dword ptr [ESI]
00556b2c : MOV EAX,dword ptr [EAX + 0x44]
00556b2f : PUSH EDI
00556b30 : LEA ECX,[ESP + 0x28]
00556b34 : PUSH ECX
00556b35 : LEA EDX,[ESP + 0x24]
00556b39 : XOR EBP,EBP
00556b3b : PUSH EDX
00556b3c : MOV ECX,ESI
00556b3e : MOV dword ptr [ESP + 0x28],EBP
00556b42 : MOV dword ptr [ESP + 0x30],EBP
00556b46 : CALL EAX
00556b48 : MOV EDI,dword ptr [ESP + 0x168]
00556b4f : MOV EDX,dword ptr [EDI]
00556b51 : MOV EDX,dword ptr [EDX + 0x44]
00556b54 : LEA EAX,[ESP + 0x1c]
00556b58 : PUSH EAX
00556b59 : LEA ECX,[ESP + 0x28]
00556b5d : PUSH ECX
00556b5e : MOV ECX,EDI
00556b60 : MOV dword ptr [ESP + 0x2c],EBP
00556b64 : MOV dword ptr [ESP + 0x24],EBP
00556b68 : CALL EDX
00556b6a : MOV EAX,dword ptr [ESP + 0x20]
00556b6e : CMP EAX,dword ptr [ESP + 0x24]
00556b72 : JNZ 0x00556e33
00556b78 : MOV ECX,dword ptr [ESP + 0x28]
00556b7c : CMP ECX,dword ptr [ESP + 0x1c]
00556b80 : JNZ 0x00556e33
00556b86 : PUSH EBX
00556b87 : PUSH ESI
00556b88 : LEA ECX,[ESP + 0xf8]
00556b8f : CALL 0x005560e0
00556b94 : PUSH EDI
00556b95 : LEA ECX,[ESP + 0x84]
00556b9c : CALL 0x005560e0
00556ba1 : MOV BL,byte ptr [ESP + 0x114]
00556ba8 : CMP BL,0x1
00556bab : JZ 0x00556e24
00556bb1 : JMP 0x00556bc0
00556bc0 : MOV DL,byte ptr [ESP + 0xa0]
00556bc7 : CMP DL,0x1
00556bca : JZ 0x00556e05
00556bd0 : MOV EAX,dword ptr [ESP + 0x108]
00556bd7 : MOV ECX,dword ptr [ESP + 0x10c]
00556bde : MOV dword ptr [ESP + 0x40],EAX
00556be2 : MOV EAX,dword ptr [ESP + 0x110]
00556be9 : MOV dword ptr [ESP + 0x44],ECX
00556bed : MOV ECX,dword ptr [ESP + 0x94]
00556bf4 : MOV dword ptr [ESP + 0x48],EAX
00556bf8 : MOV EAX,dword ptr [ESP + 0x98]
00556bff : MOV dword ptr [ESP + 0x4c],ECX
00556c03 : MOV ECX,dword ptr [ESP + 0x9c]
00556c0a : MOV dword ptr [ESP + 0x50],EAX
00556c0e : MOV dword ptr [ESP + 0x54],ECX
00556c12 : MOV EAX,0xc
00556c17 : XOR ECX,ECX
00556c19 : LEA ESP,[ESP]
00556c20 : MOV ESI,dword ptr [ESP + ECX*0x1 + 0x40]
00556c24 : CMP ESI,dword ptr [ESP + ECX*0x1 + 0x4c]
00556c28 : JNZ 0x00556e05
00556c2e : SUB EAX,0x4
00556c31 : ADD ECX,0x4
00556c34 : CMP EAX,0x4
00556c37 : JNC 0x00556c20
00556c39 : LEA EAX,[ESP + 0xf4]
00556c40 : MOV dword ptr [ESP + 0x30],EAX
00556c44 : MOV dword ptr [ESP + 0x34],EBP
00556c48 : TEST BL,BL
00556c4a : JS 0x00556c6d
00556c4c : LEA ESP,[ESP]
00556c50 : LEA ECX,[ESP + 0xf4]
00556c57 : CALL 0x00553740
00556c5c : CMP byte ptr [ESP + 0x114],0x3
00556c64 : JZ 0x00556c50
00556c66 : MOV DL,byte ptr [ESP + 0xa0]
00556c6d : LEA ECX,[ESP + 0x80]
00556c74 : MOV dword ptr [ESP + 0x38],ECX
00556c78 : MOV dword ptr [ESP + 0x3c],EBP
00556c7c : TEST DL,DL
00556c7e : JS 0x00556ca6
00556c80 : CMP DL,0x1
00556c83 : JZ 0x00556ca6
00556c85 : JMP 0x00556c90
00556c90 : LEA ECX,[ESP + 0x80]
00556c97 : CALL 0x00553740
00556c9c : CMP byte ptr [ESP + 0xa0],0x3
00556ca4 : JZ 0x00556c90
00556ca6 : TEST byte ptr [ESP + 0x164],0x80
00556cae : FILD dword ptr [ESP + 0x120]
00556cb5 : FSTP float ptr [ESP + 0x18]
00556cb9 : FILD dword ptr [ESP + 0x124]
00556cc0 : FSTP float ptr [ESP + 0x14]
00556cc4 : JZ 0x00556cdf
00556cc6 : FLD float ptr [ESP + 0x160]
00556ccd : FLD ST0
00556ccf : FMUL float ptr [ESP + 0x18]
00556cd3 : FSTP float ptr [ESP + 0x18]
00556cd7 : FMUL float ptr [ESP + 0x14]
00556cdb : FSTP float ptr [ESP + 0x14]
00556cdf : TEST byte ptr [ESP + 0xf0],0x80
00556ce7 : FILD dword ptr [ESP + 0xac]
00556cee : FSTP float ptr [ESP + 0x10]
00556cf2 : FILD dword ptr [ESP + 0xb0]
00556cf9 : FSTP float ptr [ESP + 0x1c]
00556cfd : JZ 0x00556d18
00556cff : FLD float ptr [ESP + 0xec]
00556d06 : FLD ST0
00556d08 : FMUL float ptr [ESP + 0x10]
00556d0c : FSTP float ptr [ESP + 0x10]
00556d10 : FMUL float ptr [ESP + 0x1c]
00556d14 : FSTP float ptr [ESP + 0x1c]
00556d18 : FLD float ptr [ESP + 0x18]
00556d1c : FLD float ptr [ESP + 0x10]
00556d20 : FUCOMPP
00556d22 : FNSTSW AX
00556d24 : TEST AH,0x44
00556d27 : JP 0x00556e05
00556d2d : FLD float ptr [ESP + 0x14]
00556d31 : FLD float ptr [ESP + 0x1c]
00556d35 : FUCOMPP
00556d37 : FNSTSW AX
00556d39 : TEST AH,0x44
00556d3c : JP 0x00556e05
00556d42 : LEA ECX,[ESP + 0x38]
00556d46 : CALL 0x005565a0
00556d4b : LEA ECX,[ESP + 0x30]
00556d4f : MOV ESI,EAX
00556d51 : CALL 0x005565a0
00556d56 : CMP EAX,ESI
00556d58 : JNZ 0x00556e05
00556d5e : MOV EDI,EDI
00556d60 : MOV EDX,dword ptr [ESP + 0x30]
00556d64 : MOV AL,byte ptr [EDX + 0x20]
00556d67 : CMP AL,0x1
00556d69 : JZ 0x00556e14
00556d6f : TEST AL,AL
00556d71 : JNS 0x00556e14
00556d77 : MOV EAX,dword ptr [ESP + 0x38]
00556d7b : MOV AL,byte ptr [EAX + 0x20]
00556d7e : CMP AL,0x1
00556d80 : JZ 0x00556e05
00556d86 : TEST AL,AL
00556d88 : JNS 0x00556e05
00556d8a : LEA ECX,[ESP + 0x58]
00556d8e : PUSH ECX
00556d8f : LEA ECX,[ESP + 0x34]
00556d93 : CALL 0x00554440
00556d98 : LEA EDX,[ESP + 0x6c]
00556d9c : PUSH EDX
00556d9d : LEA ECX,[ESP + 0x3c]
00556da1 : CALL 0x00554440
00556da6 : MOV EAX,dword ptr [ESP + 0x68]
00556daa : CMP EAX,dword ptr [ESP + 0x7c]
00556dae : JNZ 0x00556e05
00556db0 : ADD EAX,EAX
00556db2 : ADD EAX,EAX
00556db4 : LEA ECX,[ESP + 0x6c]
00556db8 : LEA ESI,[ESP + 0x58]
00556dbc : CMP EAX,0x4
00556dbf : JC 0x00556dd5
00556dc1 : MOV EDX,dword ptr [ESI]
00556dc3 : CMP EDX,dword ptr [ECX]
00556dc5 : JNZ 0x00556e05
00556dc7 : SUB EAX,0x4
00556dca : ADD ECX,0x4
00556dcd : ADD ESI,0x4
00556dd0 : CMP EAX,0x4
00556dd3 : JNC 0x00556dc1
00556dd5 : CMP EAX,EBP
00556dd7 : JZ 0x00556d60
00556dd9 : MOV DL,byte ptr [ECX]
00556ddb : CMP DL,byte ptr [ESI]
00556ddd : JNZ 0x00556e05
00556ddf : CMP EAX,0x1
00556de2 : JBE 0x00556d60
00556de8 : MOV DL,byte ptr [ECX + 0x1]
00556deb : CMP DL,byte ptr [ESI + 0x1]
00556dee : JNZ 0x00556e05
00556df0 : CMP EAX,0x2
00556df3 : JBE 0x00556d60
00556df9 : MOV AL,byte ptr [ECX + 0x2]
00556dfc : CMP AL,byte ptr [ESI + 0x2]
00556dff : JZ 0x00556d60
00556e05 : POP EBX
00556e06 : POP EDI
00556e07 : POP ESI
00556e08 : XOR AL,AL
00556e0a : POP EBP
00556e0b : ADD ESP,0x158
00556e11 : RET 0x4
00556e14 : MOV BL,byte ptr [ESP + 0x114]
00556e1b : CMP BL,0x1
00556e1e : JNZ 0x00556bc0
00556e24 : POP EBX
00556e25 : POP EDI
00556e26 : POP ESI
00556e27 : MOV AL,0x1
00556e29 : POP EBP
00556e2a : ADD ESP,0x158
00556e30 : RET 0x4
00556e33 : POP EDI
00556e34 : POP ESI
00556e35 : XOR AL,AL
00556e37 : POP EBP
00556e38 : ADD ESP,0x158
00556e3e : RET 0x4

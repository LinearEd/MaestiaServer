PROGRAM  : Maestia.exe
FUNCTION : FUN_00846540
ENTRY    : 00846540
BODY     : [[00846540, 00846af6]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_00846540(char param_1)

{
  short sVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  short *psVar6;
  undefined2 *puVar7;
  undefined4 *puVar8;
  int in_ECX;
  undefined4 *puVar9;
  int iVar10;
  int iVar11;
  wchar_t *pwVar12;
  short local_5c [2];
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  int local_48;
  undefined1 local_44 [4];
  undefined2 local_40;
  undefined4 local_30;
  uint local_2c;
  undefined2 local_28;
  undefined2 local_26;
  undefined2 local_24;
  undefined2 local_22;
  undefined2 local_20;
  undefined2 local_1c;
  undefined2 local_1a;
  undefined2 local_18;
  undefined2 local_16;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1b821;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar3;
  if (*(int *)(in_ECX + 0x14) != 0) {
    iVar11 = 0;
    local_54 = in_ECX;
    iVar4 = FUN_00405bb0(&DAT_00c3c454);
    if (iVar4 != 0) {
      FUN_00406460(&DAT_00c3c458);
      local_8 = 0;
      local_58 = *(int *)(in_ECX + 0x14);
      if (0 < *(int *)(in_ECX + 0x14)) {
        local_4c = 3;
        local_48 = 1;
        local_50 = 4;
        iVar4 = 2;
        do {
          if (iVar4 < local_58) {
            puVar8 = (undefined4 *)(in_ECX + 4);
            puVar9 = puVar8;
            if (7 < *(uint *)(in_ECX + 0x18)) {
              puVar9 = (undefined4 *)*puVar8;
            }
            if (*(short *)((int)puVar9 + iVar11 * 2) != 0x28) goto LAB_00846825;
            puVar9 = puVar8;
            if (7 < *(uint *)(in_ECX + 0x18)) {
              puVar9 = (undefined4 *)*puVar8;
            }
            if (*(short *)(local_50 + (int)puVar9) != 0x29) goto LAB_00846825;
            puVar9 = puVar8;
            if (7 < *(uint *)(in_ECX + 0x18)) {
              puVar9 = (undefined4 *)*puVar8;
            }
            if (*(short *)((int)puVar9 + iVar11 * 2 + 2) != 0x42) {
              if (7 < *(uint *)(in_ECX + 0x18)) {
                puVar8 = (undefined4 *)*puVar8;
              }
              if (*(short *)((int)puVar8 + iVar11 * 2 + 2) == 0x4d) {
                if (param_1 == '\0') {
                  uVar5 = FUN_00404750(L"<font color=\'%s\' >",L"#0d3f7e");
                  local_8._0_1_ = 2;
                  FUN_00405c30(uVar5,0,0xffffffff);
                  local_8 = (uint)local_8._1_3_ << 8;
                  FUN_00406560();
                  in_ECX = local_54;
                }
                goto LAB_0084680d;
              }
              psVar6 = (short *)FUN_00401490(local_48);
              if (*psVar6 == 0x4e) {
                if (param_1 == '\0') {
                  uVar5 = FUN_00404750(L"<font color=\'%s\' >",L"#015c55");
                  local_8._0_1_ = 3;
                  FUN_00405c30(uVar5,0,0xffffffff);
                  local_8 = (uint)local_8._1_3_ << 8;
                  FUN_00406560();
                  in_ECX = local_54;
                }
                goto LAB_0084680d;
              }
              psVar6 = (short *)FUN_00401490(local_48);
              if (*psVar6 == 0x49) {
                if (param_1 == '\0') {
                  uVar5 = FUN_00404750(L"<font color=\'%s\'>",L"#572a74");
                  local_8._0_1_ = 4;
                  FUN_00405c30(uVar5,0,0xffffffff);
                  local_8 = (uint)local_8._1_3_ << 8;
                  FUN_00406560();
                  in_ECX = local_54;
                }
                goto LAB_0084680d;
              }
              psVar6 = (short *)FUN_00401490(local_48);
              if (*psVar6 == 0x50) {
                if (param_1 == '\0') {
                  uVar5 = FUN_00404750(L"<font color=\'%s\' >",L"#e5c173");
                  local_8._0_1_ = 5;
                  FUN_00405c30(uVar5,0,0xffffffff);
                  local_8 = (uint)local_8._1_3_ << 8;
                  FUN_00406560();
                  in_ECX = local_54;
                }
                goto LAB_0084680d;
              }
              if (iVar11 < local_58) {
                puVar7 = (undefined2 *)FUN_00401490(iVar11);
                local_1c = *puVar7;
                puVar7 = (undefined2 *)FUN_00401490(local_48);
                local_1a = *puVar7;
                puVar7 = (undefined2 *)FUN_00401490(iVar4);
                local_18 = *puVar7;
                local_16 = 0;
                FUN_00404980(local_44);
                goto LAB_0084680d;
              }
              pwVar12 = L"!!!! Buffer Over Run !!! ";
              goto LAB_00846a90;
            }
            if (param_1 == '\0') {
              uVar5 = FUN_00404750(L"<font color=\'#%02X%02X%02X\'>",0,0x4d,0x9f);
              local_8._0_1_ = 1;
              FUN_00405c30(uVar5,0,0xffffffff);
              local_8 = (uint)local_8._1_3_ << 8;
              FUN_00406560();
              in_ECX = local_54;
            }
LAB_0084680d:
            local_48 = local_48 + 3;
            local_4c = local_4c + 3;
            iVar11 = iVar11 + 3;
            iVar4 = iVar4 + 3;
            local_50 = local_50 + 6;
          }
          else {
LAB_00846825:
            if (local_4c < local_58) {
              uVar2 = *(uint *)(in_ECX + 0x18);
              puVar8 = (undefined4 *)(in_ECX + 4);
              puVar9 = puVar8;
              if (7 < uVar2) {
                puVar9 = (undefined4 *)*puVar8;
              }
              if (*(short *)((int)puVar9 + iVar11 * 2) == 0x28) {
                puVar9 = puVar8;
                if (7 < uVar2) {
                  puVar9 = (undefined4 *)*puVar8;
                }
                if (*(short *)((int)puVar9 + iVar11 * 2 + 2) == 0x2f) {
                  puVar9 = puVar8;
                  if (7 < uVar2) {
                    puVar9 = (undefined4 *)*puVar8;
                  }
                  if (*(short *)((int)puVar9 + iVar11 * 2 + 6) == 0x29) {
                    if (7 < uVar2) {
                      puVar8 = (undefined4 *)*puVar8;
                    }
                    if (*(short *)(local_50 + (int)puVar8) == 0x42) {
                      if (param_1 == '\0') {
                        FUN_00404980(local_44);
                      }
                      local_48 = local_48 + 4;
                      local_4c = local_4c + 4;
                      iVar11 = iVar11 + 4;
                      iVar4 = iVar4 + 4;
                      local_50 = local_50 + 8;
                    }
                    else {
                      psVar6 = (short *)FUN_00401490(iVar4);
                      if (*psVar6 == 0x4d) {
                        if (param_1 == '\0') {
                          FUN_00404980(local_44);
                        }
                        local_48 = local_48 + 4;
                        local_4c = local_4c + 4;
                        iVar11 = iVar11 + 4;
                        iVar4 = iVar4 + 4;
                        local_50 = local_50 + 8;
                      }
                      else {
                        psVar6 = (short *)FUN_00401490(iVar4);
                        if (*psVar6 == 0x4e) {
                          if (param_1 == '\0') {
                            FUN_00404980(local_44);
                          }
                          local_48 = local_48 + 4;
                          local_4c = local_4c + 4;
                          iVar11 = iVar11 + 4;
                          iVar4 = iVar4 + 4;
                          local_50 = local_50 + 8;
                        }
                        else {
                          psVar6 = (short *)FUN_00401490(iVar4);
                          if (*psVar6 == 0x49) {
                            if (param_1 == '\0') {
                              FUN_00404980(local_44);
                            }
                            local_48 = local_48 + 4;
                            local_4c = local_4c + 4;
                            iVar11 = iVar11 + 4;
                            iVar4 = iVar4 + 4;
                            local_50 = local_50 + 8;
                          }
                          else {
                            psVar6 = (short *)FUN_00401490(iVar4);
                            if (*psVar6 == 0x50) {
                              if (param_1 == '\0') {
                                FUN_00404980(local_44);
                              }
                              local_48 = local_48 + 4;
                              local_4c = local_4c + 4;
                              iVar11 = iVar11 + 4;
                              iVar4 = iVar4 + 4;
                              local_50 = local_50 + 8;
                            }
                            else {
                              if (local_58 <= iVar11) {
                                pwVar12 = L"!!!! Buffer Over Run !!! ";
                                goto LAB_00846a90;
                              }
                              puVar7 = (undefined2 *)FUN_00401490(iVar11);
                              local_28 = *puVar7;
                              puVar7 = (undefined2 *)FUN_00401490(local_48);
                              local_26 = *puVar7;
                              puVar7 = (undefined2 *)FUN_00401490(iVar4);
                              local_24 = *puVar7;
                              puVar7 = (undefined2 *)FUN_00401490(local_4c);
                              local_22 = *puVar7;
                              local_20 = 0;
                              FUN_00404980(local_44);
                              local_48 = local_48 + 4;
                              local_4c = local_4c + 4;
                              iVar11 = iVar11 + 4;
                              iVar4 = iVar4 + 4;
                              local_50 = local_50 + 8;
                            }
                          }
                        }
                      }
                    }
                    goto LAB_00846a72;
                  }
                }
              }
            }
            if (local_58 <= iVar11) {
              pwVar12 = L"!!!! Buffer Over Run !!! ";
LAB_00846a90:
              FUN_008018d0(pwVar12,uVar3);
              break;
            }
            if (*(uint *)(in_ECX + 0x18) < 8) {
              iVar10 = in_ECX + 4;
            }
            else {
              iVar10 = *(int *)(in_ECX + 4);
            }
            local_5c[0] = *(short *)(iVar10 + iVar11 * 2);
            psVar6 = local_5c;
            local_5c[1] = 0;
            do {
              sVar1 = *psVar6;
              psVar6 = psVar6 + 1;
            } while (sVar1 != 0);
            FUN_00404870(local_5c,(int)psVar6 - (int)(local_5c + 1) >> 1);
            local_48 = local_48 + 1;
            local_4c = local_4c + 1;
            iVar11 = iVar11 + 1;
            iVar4 = iVar4 + 1;
            local_50 = local_50 + 2;
            in_ECX = local_54;
          }
LAB_00846a72:
        } while (iVar11 < local_58);
      }
      FUN_00405eb0(local_44,0,0xffffffff);
      local_8 = 0xffffffff;
      if (7 < local_2c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_2c = 7;
      local_30 = 0;
      local_40 = 0;
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00846540 : PUSH EBP
00846541 : MOV EBP,ESP
00846543 : PUSH -0x1
00846545 : PUSH 0xb1b821
0084654a : MOV EAX,FS:[0x0]
00846550 : PUSH EAX
00846551 : SUB ESP,0xd8
00846557 : MOV EAX,[0x00d66fa0]
0084655c : XOR EAX,EBP
0084655e : MOV dword ptr [EBP + -0x10],EAX
00846561 : PUSH EBX
00846562 : PUSH ESI
00846563 : PUSH EDI
00846564 : PUSH EAX
00846565 : LEA EAX,[EBP + -0xc]
00846568 : MOV FS:[0x0],EAX
0084656e : MOV ESI,ECX
00846570 : MOV EAX,dword ptr [ESI + 0x14]
00846573 : MOV dword ptr [EBP + -0x50],ESI
00846576 : TEST EAX,EAX
00846578 : JZ 0x00846ad9
0084657e : PUSH 0xc3c454
00846583 : XOR EDI,EDI
00846585 : CALL 0x00405bb0
0084658a : TEST EAX,EAX
0084658c : JZ 0x00846ad9
00846592 : PUSH 0xc3c458
00846597 : LEA ECX,[EBP + -0x40]
0084659a : CALL 0x00406460
0084659f : MOV dword ptr [EBP + -0x4],EDI
008465a2 : MOV EAX,dword ptr [ESI + 0x14]
008465a5 : MOV dword ptr [EBP + -0x54],EAX
008465a8 : TEST EAX,EAX
008465aa : JLE 0x00846aa1
008465b0 : MOV dword ptr [EBP + -0x48],0x3
008465b7 : MOV EBX,0x2
008465bc : MOV dword ptr [EBP + -0x44],0x1
008465c3 : MOV dword ptr [EBP + -0x4c],0x4
008465ca : LEA EBX,[EBX]
008465d0 : CMP EBX,dword ptr [EBP + -0x54]
008465d3 : JGE 0x00846825
008465d9 : MOV EDX,dword ptr [ESI + 0x18]
008465dc : LEA EAX,[ESI + 0x4]
008465df : CMP EDX,0x8
008465e2 : JC 0x008465e8
008465e4 : MOV ECX,dword ptr [EAX]
008465e6 : JMP 0x008465ea
008465e8 : MOV ECX,EAX
008465ea : CMP word ptr [ECX + EDI*0x2],0x28
008465ef : JNZ 0x00846825
008465f5 : CMP EDX,0x8
008465f8 : JC 0x008465fe
008465fa : MOV ECX,dword ptr [EAX]
008465fc : JMP 0x00846600
008465fe : MOV ECX,EAX
00846600 : MOV EDX,dword ptr [EBP + -0x4c]
00846603 : CMP word ptr [EDX + ECX*0x1],0x29
00846608 : JNZ 0x00846825
0084660e : MOV EDX,dword ptr [ESI + 0x18]
00846611 : CMP EDX,0x8
00846614 : JC 0x0084661a
00846616 : MOV ECX,dword ptr [EAX]
00846618 : JMP 0x0084661c
0084661a : MOV ECX,EAX
0084661c : CMP word ptr [ECX + EDI*0x2 + 0x2],0x42
00846622 : JNZ 0x0084666b
00846624 : CMP byte ptr [EBP + 0x8],0x0
00846628 : JNZ 0x0084680d
0084662e : PUSH 0x9f
00846633 : PUSH 0x4d
00846635 : PUSH 0x0
00846637 : PUSH 0xc3c45c
0084663c : LEA ESI,[EBP + -0x74]
0084663f : CALL 0x00404750
00846644 : ADD ESP,0x10
00846647 : MOV byte ptr [EBP + -0x4],0x1
0084664b : PUSH -0x1
0084664d : PUSH 0x0
0084664f : PUSH EAX
00846650 : LEA ECX,[EBP + -0x40]
00846653 : CALL 0x00405c30
00846658 : MOV byte ptr [EBP + -0x4],0x0
0084665c : MOV ECX,ESI
0084665e : CALL 0x00406560
00846663 : MOV ESI,dword ptr [EBP + -0x50]
00846666 : JMP 0x0084680d
0084666b : CMP EDX,0x8
0084666e : JC 0x00846672
00846670 : MOV EAX,dword ptr [EAX]
00846672 : CMP word ptr [EAX + EDI*0x2 + 0x2],0x4d
00846678 : JNZ 0x008466c0
0084667a : CMP byte ptr [EBP + 0x8],0x0
0084667e : JNZ 0x0084680d
00846684 : PUSH 0xc3c498
00846689 : PUSH 0xc3c4a8
0084668e : LEA ESI,[EBP + 0xffffff38]
00846694 : CALL 0x00404750
00846699 : ADD ESP,0x8
0084669c : MOV byte ptr [EBP + -0x4],0x2
008466a0 : PUSH -0x1
008466a2 : PUSH 0x0
008466a4 : PUSH EAX
008466a5 : LEA ECX,[EBP + -0x40]
008466a8 : CALL 0x00405c30
008466ad : MOV byte ptr [EBP + -0x4],0x0
008466b1 : MOV ECX,ESI
008466b3 : CALL 0x00406560
008466b8 : MOV ESI,dword ptr [EBP + -0x50]
008466bb : JMP 0x0084680d
008466c0 : MOV EAX,dword ptr [EBP + -0x44]
008466c3 : PUSH EAX
008466c4 : MOV ECX,ESI
008466c6 : CALL 0x00401490
008466cb : CMP word ptr [EAX],0x4e
008466cf : JNZ 0x00846717
008466d1 : CMP byte ptr [EBP + 0x8],0x0
008466d5 : JNZ 0x0084680d
008466db : PUSH 0xc3c4d0
008466e0 : PUSH 0xc3c4e0
008466e5 : LEA ESI,[EBP + 0xffffff70]
008466eb : CALL 0x00404750
008466f0 : ADD ESP,0x8
008466f3 : MOV byte ptr [EBP + -0x4],0x3
008466f7 : PUSH -0x1
008466f9 : PUSH 0x0
008466fb : PUSH EAX
008466fc : LEA ECX,[EBP + -0x40]
008466ff : CALL 0x00405c30
00846704 : MOV byte ptr [EBP + -0x4],0x0
00846708 : MOV ECX,ESI
0084670a : CALL 0x00406560
0084670f : MOV ESI,dword ptr [EBP + -0x50]
00846712 : JMP 0x0084680d
00846717 : MOV ECX,dword ptr [EBP + -0x44]
0084671a : PUSH ECX
0084671b : MOV ECX,ESI
0084671d : CALL 0x00401490
00846722 : CMP word ptr [EAX],0x49
00846726 : JNZ 0x0084676e
00846728 : CMP byte ptr [EBP + 0x8],0x0
0084672c : JNZ 0x0084680d
00846732 : PUSH 0xc3c508
00846737 : PUSH 0xc3c518
0084673c : LEA ESI,[EBP + 0xffffff54]
00846742 : CALL 0x00404750
00846747 : ADD ESP,0x8
0084674a : MOV byte ptr [EBP + -0x4],0x4
0084674e : PUSH -0x1
00846750 : PUSH 0x0
00846752 : PUSH EAX
00846753 : LEA ECX,[EBP + -0x40]
00846756 : CALL 0x00405c30
0084675b : MOV byte ptr [EBP + -0x4],0x0
0084675f : MOV ECX,ESI
00846761 : CALL 0x00406560
00846766 : MOV ESI,dword ptr [EBP + -0x50]
00846769 : JMP 0x0084680d
0084676e : MOV EDX,dword ptr [EBP + -0x44]
00846771 : PUSH EDX
00846772 : MOV ECX,ESI
00846774 : CALL 0x00401490
00846779 : CMP word ptr [EAX],0x50
0084677d : JNZ 0x008467c2
0084677f : CMP byte ptr [EBP + 0x8],0x0
00846783 : JNZ 0x0084680d
00846789 : PUSH 0xc3c53c
0084678e : PUSH 0xc3c54c
00846793 : LEA ESI,[EBP + 0xffffff1c]
00846799 : CALL 0x00404750
0084679e : ADD ESP,0x8
008467a1 : MOV byte ptr [EBP + -0x4],0x5
008467a5 : PUSH -0x1
008467a7 : PUSH 0x0
008467a9 : PUSH EAX
008467aa : LEA ECX,[EBP + -0x40]
008467ad : CALL 0x00405c30
008467b2 : MOV byte ptr [EBP + -0x4],0x0
008467b6 : MOV ECX,ESI
008467b8 : CALL 0x00406560
008467bd : MOV ESI,dword ptr [EBP + -0x50]
008467c0 : JMP 0x0084680d
008467c2 : CMP dword ptr [EBP + -0x54],EDI
008467c5 : JLE 0x00846a7d
008467cb : PUSH EDI
008467cc : MOV ECX,ESI
008467ce : CALL 0x00401490
008467d3 : MOVZX EAX,word ptr [EAX]
008467d6 : MOV ECX,dword ptr [EBP + -0x44]
008467d9 : PUSH ECX
008467da : MOV ECX,ESI
008467dc : MOV word ptr [EBP + -0x18],AX
008467e0 : CALL 0x00401490
008467e5 : MOV DX,word ptr [EAX]
008467e8 : PUSH EBX
008467e9 : MOV ECX,ESI
008467eb : MOV word ptr [EBP + -0x16],DX
008467ef : CALL 0x00401490
008467f4 : MOVZX EAX,word ptr [EAX]
008467f7 : LEA EDX,[EBP + -0x40]
008467fa : XOR ECX,ECX
008467fc : PUSH EDX
008467fd : LEA EDX,[EBP + -0x18]
00846800 : MOV word ptr [EBP + -0x14],AX
00846804 : MOV word ptr [EBP + -0x12],CX
00846808 : CALL 0x00404980
0084680d : MOV EAX,0x3
00846812 : ADD dword ptr [EBP + -0x44],EAX
00846815 : ADD dword ptr [EBP + -0x48],EAX
00846818 : ADD EDI,EAX
0084681a : ADD EBX,EAX
0084681c : ADD dword ptr [EBP + -0x4c],0x6
00846820 : JMP 0x00846a72
00846825 : MOV EAX,dword ptr [EBP + -0x54]
00846828 : CMP dword ptr [EBP + -0x48],EAX
0084682b : JGE 0x00846a12
00846831 : MOV EDX,dword ptr [ESI + 0x18]
00846834 : LEA EAX,[ESI + 0x4]
00846837 : CMP EDX,0x8
0084683a : JC 0x00846840
0084683c : MOV ECX,dword ptr [EAX]
0084683e : JMP 0x00846842
00846840 : MOV ECX,EAX
00846842 : CMP word ptr [ECX + EDI*0x2],0x28
00846847 : JNZ 0x00846a12
0084684d : CMP EDX,0x8
00846850 : JC 0x00846856
00846852 : MOV ECX,dword ptr [EAX]
00846854 : JMP 0x00846858
00846856 : MOV ECX,EAX
00846858 : CMP word ptr [ECX + EDI*0x2 + 0x2],0x2f
0084685e : JNZ 0x00846a12
00846864 : CMP EDX,0x8
00846867 : JC 0x0084686d
00846869 : MOV ECX,dword ptr [EAX]
0084686b : JMP 0x0084686f
0084686d : MOV ECX,EAX
0084686f : CMP word ptr [ECX + EDI*0x2 + 0x6],0x29
00846875 : JNZ 0x00846a12
0084687b : CMP EDX,0x8
0084687e : JC 0x00846882
00846880 : MOV EAX,dword ptr [EAX]
00846882 : MOV ECX,dword ptr [EBP + -0x4c]
00846885 : CMP word ptr [ECX + EAX*0x1],0x42
0084688a : JNZ 0x008468b8
0084688c : CMP byte ptr [EBP + 0x8],0x0
00846890 : JNZ 0x008468a0
00846892 : LEA EDX,[EBP + -0x40]
00846895 : PUSH EDX
00846896 : MOV EDX,0xc3c5a8
0084689b : CALL 0x00404980
008468a0 : MOV EAX,0x4
008468a5 : ADD dword ptr [EBP + -0x44],EAX
008468a8 : ADD dword ptr [EBP + -0x48],EAX
008468ab : ADD EDI,EAX
008468ad : ADD EBX,EAX
008468af : ADD dword ptr [EBP + -0x4c],0x8
008468b3 : JMP 0x00846a72
008468b8 : PUSH EBX
008468b9 : MOV ECX,ESI
008468bb : CALL 0x00401490
008468c0 : CMP word ptr [EAX],0x4d
008468c4 : JNZ 0x008468f2
008468c6 : CMP byte ptr [EBP + 0x8],0x0
008468ca : JNZ 0x008468da
008468cc : LEA EAX,[EBP + -0x40]
008468cf : PUSH EAX
008468d0 : MOV EDX,0xc3c5b8
008468d5 : CALL 0x00404980
008468da : MOV EAX,0x4
008468df : ADD dword ptr [EBP + -0x44],EAX
008468e2 : ADD dword ptr [EBP + -0x48],EAX
008468e5 : ADD EDI,EAX
008468e7 : ADD EBX,EAX
008468e9 : ADD dword ptr [EBP + -0x4c],0x8
008468ed : JMP 0x00846a72
008468f2 : PUSH EBX
008468f3 : MOV ECX,ESI
008468f5 : CALL 0x00401490
008468fa : CMP word ptr [EAX],0x4e
008468fe : JNZ 0x0084692c
00846900 : CMP byte ptr [EBP + 0x8],0x0
00846904 : JNZ 0x00846914
00846906 : LEA ECX,[EBP + -0x40]
00846909 : PUSH ECX
0084690a : MOV EDX,0xc3c5c8
0084690f : CALL 0x00404980
00846914 : MOV EAX,0x4
00846919 : ADD dword ptr [EBP + -0x44],EAX
0084691c : ADD dword ptr [EBP + -0x48],EAX
0084691f : ADD EDI,EAX
00846921 : ADD EBX,EAX
00846923 : ADD dword ptr [EBP + -0x4c],0x8
00846927 : JMP 0x00846a72
0084692c : PUSH EBX
0084692d : MOV ECX,ESI
0084692f : CALL 0x00401490
00846934 : CMP word ptr [EAX],0x49
00846938 : JNZ 0x00846966
0084693a : CMP byte ptr [EBP + 0x8],0x0
0084693e : JNZ 0x0084694e
00846940 : LEA EDX,[EBP + -0x40]
00846943 : PUSH EDX
00846944 : MOV EDX,0xc3c5d8
00846949 : CALL 0x00404980
0084694e : MOV EAX,0x4
00846953 : ADD dword ptr [EBP + -0x44],EAX
00846956 : ADD dword ptr [EBP + -0x48],EAX
00846959 : ADD EDI,EAX
0084695b : ADD EBX,EAX
0084695d : ADD dword ptr [EBP + -0x4c],0x8
00846961 : JMP 0x00846a72
00846966 : PUSH EBX
00846967 : MOV ECX,ESI
00846969 : CALL 0x00401490
0084696e : CMP word ptr [EAX],0x50
00846972 : JNZ 0x008469a0
00846974 : CMP byte ptr [EBP + 0x8],0x0
00846978 : JNZ 0x00846988
0084697a : LEA EAX,[EBP + -0x40]
0084697d : PUSH EAX
0084697e : MOV EDX,0xc3c5e8
00846983 : CALL 0x00404980
00846988 : MOV EAX,0x4
0084698d : ADD dword ptr [EBP + -0x44],EAX
00846990 : ADD dword ptr [EBP + -0x48],EAX
00846993 : ADD EDI,EAX
00846995 : ADD EBX,EAX
00846997 : ADD dword ptr [EBP + -0x4c],0x8
0084699b : JMP 0x00846a72
008469a0 : CMP dword ptr [EBP + -0x54],EDI
008469a3 : JLE 0x00846a84
008469a9 : PUSH EDI
008469aa : MOV ECX,ESI
008469ac : CALL 0x00401490
008469b1 : MOVZX ECX,word ptr [EAX]
008469b4 : MOV EDX,dword ptr [EBP + -0x44]
008469b7 : MOV word ptr [EBP + -0x24],CX
008469bb : PUSH EDX
008469bc : MOV ECX,ESI
008469be : CALL 0x00401490
008469c3 : MOVZX EAX,word ptr [EAX]
008469c6 : PUSH EBX
008469c7 : MOV ECX,ESI
008469c9 : MOV word ptr [EBP + -0x22],AX
008469cd : CALL 0x00401490
008469d2 : MOVZX ECX,word ptr [EAX]
008469d5 : MOV EDX,dword ptr [EBP + -0x48]
008469d8 : MOV word ptr [EBP + -0x20],CX
008469dc : PUSH EDX
008469dd : MOV ECX,ESI
008469df : CALL 0x00401490
008469e4 : MOVZX EAX,word ptr [EAX]
008469e7 : LEA EDX,[EBP + -0x40]
008469ea : XOR ECX,ECX
008469ec : PUSH EDX
008469ed : LEA EDX,[EBP + -0x24]
008469f0 : MOV word ptr [EBP + -0x1e],AX
008469f4 : MOV word ptr [EBP + -0x1c],CX
008469f8 : CALL 0x00404980
008469fd : MOV EAX,0x4
00846a02 : ADD dword ptr [EBP + -0x44],EAX
00846a05 : ADD dword ptr [EBP + -0x48],EAX
00846a08 : ADD EDI,EAX
00846a0a : ADD EBX,EAX
00846a0c : ADD dword ptr [EBP + -0x4c],0x8
00846a10 : JMP 0x00846a72
00846a12 : CMP dword ptr [EBP + -0x54],EDI
00846a15 : JLE 0x00846a8b
00846a17 : CMP dword ptr [ESI + 0x18],0x8
00846a1b : JC 0x00846a22
00846a1d : MOV ESI,dword ptr [ESI + 0x4]
00846a20 : JMP 0x00846a25
00846a22 : ADD ESI,0x4
00846a25 : MOV AX,word ptr [ESI + EDI*0x2]
00846a29 : MOV word ptr [EBP + -0x58],AX
00846a2d : XOR ECX,ECX
00846a2f : LEA EAX,[EBP + -0x58]
00846a32 : MOV word ptr [EBP + -0x56],CX
00846a36 : LEA EDX,[EAX + 0x2]
00846a39 : LEA ESP,[ESP]
00846a40 : MOV CX,word ptr [EAX]
00846a43 : ADD EAX,0x2
00846a46 : TEST CX,CX
00846a49 : JNZ 0x00846a40
00846a4b : SUB EAX,EDX
00846a4d : SAR EAX,0x1
00846a4f : PUSH EAX
00846a50 : LEA EDX,[EBP + -0x58]
00846a53 : PUSH EDX
00846a54 : LEA ESI,[EBP + -0x40]
00846a57 : CALL 0x00404870
00846a5c : MOV ESI,dword ptr [EBP + -0x50]
00846a5f : MOV EAX,0x1
00846a64 : ADD dword ptr [EBP + -0x44],EAX
00846a67 : ADD dword ptr [EBP + -0x48],EAX
00846a6a : ADD EDI,EAX
00846a6c : ADD EBX,EAX
00846a6e : ADD dword ptr [EBP + -0x4c],0x2
00846a72 : CMP EDI,dword ptr [EBP + -0x54]
00846a75 : JL 0x008465d0
00846a7b : JMP 0x00846aa1
00846a7d : PUSH 0xc3c574
00846a82 : JMP 0x00846a90
00846a84 : PUSH 0xc3c5f8
00846a89 : JMP 0x00846a90
00846a8b : PUSH 0xc3c62c
00846a90 : MOV ESI,dword ptr [0x00da98e8]
00846a96 : CALL 0x008018d0
00846a9b : MOV ESI,dword ptr [EBP + -0x50]
00846a9e : ADD ESP,0x4
00846aa1 : PUSH -0x1
00846aa3 : PUSH 0x0
00846aa5 : LEA EAX,[EBP + -0x40]
00846aa8 : PUSH EAX
00846aa9 : MOV ECX,ESI
00846aab : CALL 0x00405eb0
00846ab0 : MOV dword ptr [EBP + -0x4],0xffffffff
00846ab7 : CMP dword ptr [EBP + -0x28],0x8
00846abb : JC 0x00846ac5
00846abd : MOV ECX,dword ptr [EBP + -0x3c]
00846ac0 : CALL 0x006f04e0
00846ac5 : XOR ECX,ECX
00846ac7 : MOV dword ptr [EBP + -0x28],0x7
00846ace : MOV dword ptr [EBP + -0x2c],0x0
00846ad5 : MOV word ptr [EBP + -0x3c],CX
00846ad9 : MOV ECX,dword ptr [EBP + -0xc]
00846adc : MOV dword ptr FS:[0x0],ECX
00846ae3 : POP ECX
00846ae4 : POP EDI
00846ae5 : POP ESI
00846ae6 : POP EBX
00846ae7 : MOV ECX,dword ptr [EBP + -0x10]
00846aea : XOR ECX,EBP
00846aec : CALL 0x00633e6b
00846af1 : MOV ESP,EBP
00846af3 : POP EBP
00846af4 : RET 0x4

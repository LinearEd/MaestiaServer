PROGRAM  : Maestia.exe
FUNCTION : FUN_004ca080
ENTRY    : 004ca080
BODY     : [[004ca080, 004ca270]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_004ca080(float param_1,undefined8 *param_2)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  float fVar6;
  int iVar7;
  float *pfVar8;
  int in_EAX;
  float *pfVar9;
  int in_ECX;
  float *pfVar10;
  float fVar11;
  undefined8 local_c;
  
  if (in_EAX == 0) {
    in_EAX = in_ECX + 0x54;
  }
  if (*(int *)(in_ECX + 100) != in_EAX) {
    if ((uint)((*(int *)(in_EAX + 8) - *(int *)(in_EAX + 4)) / 0x18) < 2) goto LAB_004ca0b5;
    *(int *)(in_ECX + 100) = in_EAX;
    *(undefined4 *)(in_ECX + 0x6c) = *(undefined4 *)(*(int *)(in_EAX + 8) + -0x18);
    *(undefined4 *)(in_ECX + 0x70) = 0;
  }
  iVar7 = *(int *)(in_ECX + 100);
  param_1 = *(float *)(in_ECX + 0x68) + param_1;
  *(float *)(in_ECX + 0x68) = param_1;
  if (*(int *)(in_ECX + 0x70) + 1U < (uint)((*(int *)(iVar7 + 8) - *(int *)(iVar7 + 4)) / 0x18)) {
    pfVar8 = *(float **)(iVar7 + 8);
    pfVar9 = (float *)(*(int *)(iVar7 + 4) + *(int *)(in_ECX + 0x70) * 0x18);
    pfVar10 = pfVar9 + 6;
    if (pfVar9[6] <= param_1 && param_1 != pfVar9[6]) {
      do {
        pfVar9 = pfVar10;
        *(int *)(in_ECX + 0x70) = *(int *)(in_ECX + 0x70) + 1;
        pfVar10 = pfVar9 + 6;
        if (pfVar10 == pfVar8) {
          if (*(char *)(in_ECX + 0x11) == '\0') {
            *(undefined4 *)(in_ECX + 0x70) = 0;
            *(undefined4 *)(in_ECX + 0x68) = 0;
            *param_2 = *(undefined8 *)(pfVar9 + 2);
            param_2[1] = *(undefined8 *)(pfVar9 + 4);
            return 4;
          }
          local_c._0_4_ =
               (int)(longlong)ROUND(*(float *)(in_ECX + 0x68) / *(float *)(in_ECX + 0x6c));
          fVar1 = (float)(int)local_c;
          if ((int)local_c < 0) {
            fVar1 = fVar1 + 4.2949673e+09;
          }
          *(float *)(in_ECX + 0x68) = *(float *)(in_ECX + 0x68) - fVar1 * *(float *)(in_ECX + 0x6c);
          pfVar9 = *(float **)(iVar7 + 4);
          pfVar10 = pfVar9 + 6;
          *(undefined4 *)(in_ECX + 0x70) = 0;
        }
      } while (*pfVar10 <= *(float *)(in_ECX + 0x68) && *(float *)(in_ECX + 0x68) != *pfVar10);
    }
    fVar1 = pfVar10[4];
    fVar2 = pfVar9[4];
    fVar3 = pfVar10[5];
    fVar4 = pfVar9[5];
    fVar11 = (*(float *)(in_ECX + 0x68) - *pfVar9) / (*pfVar10 - *pfVar9);
    fVar5 = pfVar9[4];
    fVar6 = pfVar9[5];
    *param_2 = CONCAT44(pfVar9[3] + fVar11 * (pfVar10[3] - pfVar9[3]),
                        pfVar9[2] + (pfVar10[2] - pfVar9[2]) * fVar11);
    local_c = CONCAT44(fVar6 + fVar11 * (fVar3 - fVar4),fVar5 + fVar11 * (fVar1 - fVar2));
    param_2[1] = local_c;
    return 2;
  }
LAB_004ca0b5:
  *(undefined4 *)(in_ECX + 100) = 0;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
004ca080 : PUSH EBP
004ca081 : MOV EBP,ESP
004ca083 : SUB ESP,0x14
004ca086 : PUSH EBX
004ca087 : PUSH ESI
004ca088 : MOV ESI,EAX
004ca08a : XOR EBX,EBX
004ca08c : PUSH EDI
004ca08d : CMP ESI,EBX
004ca08f : JNZ 0x004ca094
004ca091 : LEA ESI,[ECX + 0x54]
004ca094 : CMP dword ptr [ECX + 0x64],ESI
004ca097 : JZ 0x004ca0d8
004ca099 : MOV EDX,dword ptr [ESI + 0x8]
004ca09c : SUB EDX,dword ptr [ESI + 0x4]
004ca09f : MOV EAX,0x2aaaaaab
004ca0a4 : IMUL EDX
004ca0a6 : SAR EDX,0x2
004ca0a9 : MOV EAX,EDX
004ca0ab : SHR EAX,0x1f
004ca0ae : ADD EAX,EDX
004ca0b0 : CMP EAX,0x2
004ca0b3 : JNC 0x004ca0c6
004ca0b5 : MOV dword ptr [ECX + 0x64],EBX
004ca0b8 : MOV EAX,0x1
004ca0bd : POP EDI
004ca0be : POP ESI
004ca0bf : POP EBX
004ca0c0 : MOV ESP,EBP
004ca0c2 : POP EBP
004ca0c3 : RET 0x8
004ca0c6 : MOV dword ptr [ECX + 0x64],ESI
004ca0c9 : MOV ESI,dword ptr [ESI + 0x8]
004ca0cc : FLD float ptr [ESI + -0x18]
004ca0cf : SUB ESI,0x18
004ca0d2 : FSTP float ptr [ECX + 0x6c]
004ca0d5 : MOV dword ptr [ECX + 0x70],EBX
004ca0d8 : MOVSS XMM0,dword ptr [ECX + 0x68]
004ca0dd : MOV ESI,dword ptr [ECX + 0x64]
004ca0e0 : ADDSS XMM0,dword ptr [EBP + 0x8]
004ca0e5 : MOV EDI,dword ptr [ECX + 0x70]
004ca0e8 : MOVSS dword ptr [ECX + 0x68],XMM0
004ca0ed : MOV EDX,dword ptr [ESI + 0x8]
004ca0f0 : SUB EDX,dword ptr [ESI + 0x4]
004ca0f3 : MOV EAX,0x2aaaaaab
004ca0f8 : IMUL EDX
004ca0fa : SAR EDX,0x2
004ca0fd : MOV EAX,EDX
004ca0ff : SHR EAX,0x1f
004ca102 : ADD EAX,EDX
004ca104 : LEA EDX,[EDI + 0x1]
004ca107 : CMP EAX,EDX
004ca109 : JBE 0x004ca0b5
004ca10b : MOV EDX,dword ptr [ESI + 0x4]
004ca10e : LEA EAX,[EDI + EDI*0x2]
004ca111 : MOV EDI,dword ptr [ESI + 0x8]
004ca114 : LEA EAX,[EDX + EAX*0x8]
004ca117 : COMISS XMM0,dword ptr [EAX + 0x18]
004ca11b : LEA EDX,[EAX + 0x18]
004ca11e : JBE 0x004ca18b
004ca120 : MOV EBX,0x1
004ca125 : ADD dword ptr [ECX + 0x70],EBX
004ca128 : MOV EAX,EDX
004ca12a : ADD EDX,0x18
004ca12d : CMP EDX,EDI
004ca12f : JNZ 0x004ca181
004ca131 : CMP byte ptr [ECX + 0x11],0x0
004ca135 : JZ 0x004ca23e
004ca13b : FLD float ptr [ECX + 0x6c]
004ca13e : FLD float ptr [ECX + 0x68]
004ca141 : FLD ST0
004ca143 : FDIV ST0,ST2
004ca145 : FNSTCW word ptr [EBP + 0xa]
004ca148 : MOVZX EAX,word ptr [EBP + 0xa]
004ca14c : OR EAX,0xc00
004ca151 : MOV dword ptr [EBP + -0x4],EAX
004ca154 : FLDCW word ptr [EBP + -0x4]
004ca157 : FISTP qword ptr [EBP + -0x8]
004ca15a : MOV EAX,dword ptr [EBP + -0x8]
004ca15d : FLDCW word ptr [EBP + 0xa]
004ca160 : FILD dword ptr [EBP + -0x8]
004ca163 : TEST EAX,EAX
004ca165 : JGE 0x004ca16d
004ca167 : FADD float ptr [0x00cdf0e0]
004ca16d : FMULP ST2
004ca16f : FSUBRP
004ca171 : FSTP float ptr [ECX + 0x68]
004ca174 : MOV EAX,dword ptr [ESI + 0x4]
004ca177 : LEA EDX,[EAX + 0x18]
004ca17a : MOV dword ptr [ECX + 0x70],0x0
004ca181 : MOVSS XMM0,dword ptr [ECX + 0x68]
004ca186 : COMISS XMM0,dword ptr [EDX]
004ca189 : JA 0x004ca125
004ca18b : MOVSS XMM1,dword ptr [EAX]
004ca18f : MOVSS XMM0,dword ptr [ECX + 0x68]
004ca194 : MOVSS XMM2,dword ptr [EDX]
004ca198 : MOVSS XMM3,dword ptr [EDX + 0x10]
004ca19d : SUBSS XMM3,dword ptr [EAX + 0x10]
004ca1a2 : MOVSS XMM4,dword ptr [EDX + 0x14]
004ca1a7 : SUBSS XMM4,dword ptr [EAX + 0x14]
004ca1ac : SUBSS XMM2,XMM1
004ca1b0 : SUBSS XMM0,XMM1
004ca1b4 : MOVSS XMM1,dword ptr [EDX + 0x8]
004ca1b9 : SUBSS XMM1,dword ptr [EAX + 0x8]
004ca1be : DIVSS XMM0,XMM2
004ca1c2 : MOVSS XMM2,dword ptr [EDX + 0xc]
004ca1c7 : SUBSS XMM2,dword ptr [EAX + 0xc]
004ca1cc : MULSS XMM1,XMM0
004ca1d0 : MOVAPS XMM5,XMM0
004ca1d3 : MULSS XMM5,XMM2
004ca1d7 : MOVAPS XMM2,XMM0
004ca1da : MULSS XMM2,XMM3
004ca1de : MOVSS XMM3,dword ptr [EAX + 0x8]
004ca1e3 : ADDSS XMM3,XMM1
004ca1e7 : MOVSS XMM1,dword ptr [EAX + 0xc]
004ca1ec : ADDSS XMM1,XMM5
004ca1f0 : MOVSS dword ptr [EBP + -0xc],XMM1
004ca1f5 : MOVSS XMM1,dword ptr [EAX + 0x10]
004ca1fa : ADDSS XMM1,XMM2
004ca1fe : MOVSS dword ptr [EBP + -0x8],XMM1
004ca203 : MOVSS XMM1,dword ptr [EAX + 0x14]
004ca208 : MOV EAX,dword ptr [EBP + 0xc]
004ca20b : MULSS XMM0,XMM4
004ca20f : ADDSS XMM1,XMM0
004ca213 : MOVSS dword ptr [EBP + -0x10],XMM3
004ca218 : MOVQ XMM0,qword ptr [EBP + -0x10]
004ca21d : MOVQ qword ptr [EAX],XMM0
004ca221 : MOVSS dword ptr [EBP + -0x4],XMM1
004ca226 : MOVQ XMM0,qword ptr [EBP + -0x8]
004ca22b : MOVQ qword ptr [EAX + 0x8],XMM0
004ca230 : MOV EAX,0x2
004ca235 : POP EDI
004ca236 : POP ESI
004ca237 : POP EBX
004ca238 : MOV ESP,EBP
004ca23a : POP EBP
004ca23b : RET 0x8
004ca23e : XORPS XMM0,XMM0
004ca241 : MOV dword ptr [ECX + 0x70],0x0
004ca248 : MOVSS dword ptr [ECX + 0x68],XMM0
004ca24d : MOVQ XMM0,qword ptr [EAX + 0x8]
004ca252 : MOV ECX,dword ptr [EBP + 0xc]
004ca255 : POP EDI
004ca256 : MOVQ qword ptr [ECX],XMM0
004ca25a : MOVQ XMM0,qword ptr [EAX + 0x10]
004ca25f : POP ESI
004ca260 : MOVQ qword ptr [ECX + 0x8],XMM0
004ca265 : MOV EAX,0x4
004ca26a : POP EBX
004ca26b : MOV ESP,EBP
004ca26d : POP EBP
004ca26e : RET 0x8

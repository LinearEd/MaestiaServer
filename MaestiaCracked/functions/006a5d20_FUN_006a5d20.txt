PROGRAM  : Maestia.exe
FUNCTION : FUN_006a5d20
ENTRY    : 006a5d20
BODY     : [[006a5d20, 006a5e1f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006a5d20(byte *param_1)

{
  byte bVar1;
  bool bVar2;
  bool bVar3;
  byte *in_EAX;
  uint uVar4;
  uint uVar5;
  int *in_EDX;
  uint local_14;
  uint local_10;
  undefined1 *local_c;
  int local_8;
  int local_4;
  
  local_c = (undefined1 *)*in_EDX;
  local_4 = in_EDX[4];
  local_8 = in_EDX[2];
  uVar5 = 0;
  bVar3 = true;
  uVar4 = 0;
  local_14 = 0x80;
  local_10 = 0;
  bVar2 = true;
  if (0 < local_4) {
    do {
      if (bVar2) {
        do {
          if (bVar3) {
            if (param_1 <= in_EAX) break;
            bVar1 = *in_EAX;
            in_EAX = in_EAX + 1;
            uVar4 = bVar1 & 0xf;
            bVar3 = false;
            uVar5 = (int)(uint)bVar1 >> 4;
          }
          else {
            bVar3 = true;
            uVar5 = uVar4;
          }
        } while (uVar5 == 0);
      }
      if (bVar3) {
        local_10 = local_10 | local_14;
      }
      local_14 = local_14 >> 1;
      local_8 = local_8 + -1;
      if (local_8 < 1) {
        *local_c = (undefined1)local_10;
        local_8 = in_EDX[2];
        *in_EDX = *in_EDX + in_EDX[1];
        local_c = (undefined1 *)*in_EDX;
LAB_006a5dd9:
        local_10 = 0;
        local_14 = 0x80;
      }
      else if (local_14 == 0) {
        *local_c = (undefined1)local_10;
        local_c = local_c + 1;
        goto LAB_006a5dd9;
      }
      uVar5 = uVar5 - 1;
      bVar2 = (int)uVar5 < 1;
      local_4 = local_4 + -1;
    } while (0 < local_4);
    if (local_14 != 0x80) {
      *local_c = (undefined1)local_10;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006a5d20 : SUB ESP,0x14
006a5d23 : MOV ECX,dword ptr [EDX]
006a5d25 : PUSH EBX
006a5d26 : MOV EBX,dword ptr [EDX + 0x10]
006a5d29 : PUSH EBP
006a5d2a : PUSH ESI
006a5d2b : PUSH EDI
006a5d2c : MOV EDI,EAX
006a5d2e : MOV EAX,dword ptr [EDX + 0x8]
006a5d31 : MOV dword ptr [ESP + 0x1c],EAX
006a5d35 : MOV dword ptr [ESP + 0x18],ECX
006a5d39 : XOR ECX,ECX
006a5d3b : MOV ESI,0x1
006a5d40 : XOR EAX,EAX
006a5d42 : MOV dword ptr [ESP + 0x10],0x80
006a5d4a : MOV dword ptr [ESP + 0x14],ECX
006a5d4e : MOV dword ptr [ESP + 0x20],EBX
006a5d52 : MOV EBP,ESI
006a5d54 : TEST EBX,EBX
006a5d56 : JLE 0x006a5e18
006a5d5c : LEA ESP,[ESP]
006a5d60 : TEST EBP,EBP
006a5d62 : JZ 0x006a5d8b
006a5d64 : MOV EBX,dword ptr [ESP + 0x28]
006a5d68 : TEST ESI,ESI
006a5d6a : JZ 0x006a5d80
006a5d6c : CMP EDI,EBX
006a5d6e : JNC 0x006a5d8b
006a5d70 : MOVZX EAX,byte ptr [EDI]
006a5d73 : MOV ECX,EAX
006a5d75 : INC EDI
006a5d76 : SAR ECX,0x4
006a5d79 : AND EAX,0xf
006a5d7c : XOR ESI,ESI
006a5d7e : JMP 0x006a5d87
006a5d80 : MOV ESI,0x1
006a5d85 : MOV ECX,EAX
006a5d87 : TEST ECX,ECX
006a5d89 : JZ 0x006a5d68
006a5d8b : MOV EBX,dword ptr [ESP + 0x14]
006a5d8f : TEST ESI,ESI
006a5d91 : JZ 0x006a5d9b
006a5d93 : OR EBX,dword ptr [ESP + 0x10]
006a5d97 : MOV dword ptr [ESP + 0x14],EBX
006a5d9b : MOV EBP,dword ptr [ESP + 0x1c]
006a5d9f : SHR dword ptr [ESP + 0x10],0x1
006a5da3 : DEC EBP
006a5da4 : MOV dword ptr [ESP + 0x1c],EBP
006a5da8 : TEST EBP,EBP
006a5daa : JG 0x006a5dc7
006a5dac : MOV EBP,dword ptr [ESP + 0x18]
006a5db0 : MOV byte ptr [EBP],BL
006a5db3 : MOV EBX,dword ptr [EDX + 0x8]
006a5db6 : MOV dword ptr [ESP + 0x1c],EBX
006a5dba : MOV EBX,dword ptr [EDX + 0x4]
006a5dbd : ADD dword ptr [EDX],EBX
006a5dbf : MOV EBX,dword ptr [EDX]
006a5dc1 : MOV dword ptr [ESP + 0x18],EBX
006a5dc5 : JMP 0x006a5dd9
006a5dc7 : CMP dword ptr [ESP + 0x10],0x0
006a5dcc : JNZ 0x006a5de9
006a5dce : MOV EBP,dword ptr [ESP + 0x18]
006a5dd2 : INC dword ptr [ESP + 0x18]
006a5dd6 : MOV byte ptr [EBP],BL
006a5dd9 : MOV dword ptr [ESP + 0x14],0x0
006a5de1 : MOV dword ptr [ESP + 0x10],0x80
006a5de9 : XOR EBX,EBX
006a5deb : DEC ECX
006a5dec : TEST ECX,ECX
006a5dee : SETLE BL
006a5df1 : MOV EBP,EBX
006a5df3 : MOV EBX,dword ptr [ESP + 0x20]
006a5df7 : DEC EBX
006a5df8 : MOV dword ptr [ESP + 0x20],EBX
006a5dfc : TEST EBX,EBX
006a5dfe : JG 0x006a5d60
006a5e04 : CMP dword ptr [ESP + 0x10],0x80
006a5e0c : JZ 0x006a5e18
006a5e0e : MOV DL,byte ptr [ESP + 0x14]
006a5e12 : MOV EAX,dword ptr [ESP + 0x18]
006a5e16 : MOV byte ptr [EAX],DL
006a5e18 : POP EDI
006a5e19 : POP ESI
006a5e1a : POP EBP
006a5e1b : POP EBX
006a5e1c : ADD ESP,0x14
006a5e1f : RET

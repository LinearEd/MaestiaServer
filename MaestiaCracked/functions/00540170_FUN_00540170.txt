PROGRAM  : Maestia.exe
FUNCTION : FUN_00540170
ENTRY    : 00540170
BODY     : [[00540170, 005401d4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00540170(uint param_1,int param_2)

{
  uint uVar1;
  int *in_ECX;
  
  if (param_2 == -1) {
    param_2 = -1;
  }
  else {
    param_2 = param_2 - param_1;
    if (param_2 == 0) {
      return;
    }
  }
  uVar1 = in_ECX[1];
  if (param_1 < uVar1) {
    if (param_2 + param_1 < uVar1) {
      _memmove((void *)(*in_ECX + param_1 * 2),(void *)(*in_ECX + (param_2 + param_1) * 2),
               ((uVar1 - param_2) - param_1) * 2);
      in_ECX[1] = in_ECX[1] - param_2;
    }
    else {
      in_ECX[1] = param_1;
    }
  }
  FUN_0053fde0(param_1,param_2);
  FUN_00540090();
  *(short *)(in_ECX + 9) = (short)in_ECX[9] + 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
00540170 : PUSH EBX
00540171 : MOV EBX,dword ptr [ESP + 0xc]
00540175 : PUSH ESI
00540176 : PUSH EDI
00540177 : MOV EDI,dword ptr [ESP + 0x10]
0054017b : MOV ESI,ECX
0054017d : CMP EBX,-0x1
00540180 : JNZ 0x00540187
00540182 : OR EBX,0xffffffff
00540185 : JMP 0x0054018b
00540187 : SUB EBX,EDI
00540189 : JZ 0x005401cf
0054018b : MOV EAX,dword ptr [ESI + 0x4]
0054018e : CMP EDI,EAX
00540190 : JNC 0x005401ba
00540192 : LEA EDX,[EBX + EDI*0x1]
00540195 : CMP EDX,EAX
00540197 : JC 0x0054019e
00540199 : MOV dword ptr [ESI + 0x4],EDI
0054019c : JMP 0x005401ba
0054019e : MOV ECX,dword ptr [ESI]
005401a0 : SUB EAX,EBX
005401a2 : SUB EAX,EDI
005401a4 : ADD EAX,EAX
005401a6 : PUSH EAX
005401a7 : LEA EAX,[ECX + EDX*0x2]
005401aa : PUSH EAX
005401ab : LEA ECX,[ECX + EDI*0x2]
005401ae : PUSH ECX
005401af : CALL 0x00636880
005401b4 : ADD ESP,0xc
005401b7 : SUB dword ptr [ESI + 0x4],EBX
005401ba : PUSH EBX
005401bb : PUSH EDI
005401bc : LEA ECX,[ESI + 0x10]
005401bf : CALL 0x0053fde0
005401c4 : MOV ECX,ESI
005401c6 : CALL 0x00540090
005401cb : INC word ptr [ESI + 0x24]
005401cf : POP EDI
005401d0 : POP ESI
005401d1 : POP EBX
005401d2 : RET 0x8

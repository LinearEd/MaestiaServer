PROGRAM  : Maestia.exe
FUNCTION : FUN_009f6750
ENTRY    : 009f6750
BODY     : [[009f6750, 009f6bab]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009f6750(undefined4 param_1)

{
  char cVar1;
  bool bVar2;
  float fVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  undefined4 uVar8;
  int in_ECX;
  int local_d8;
  float local_d4;
  longlong local_d0;
  float local_c4;
  undefined1 local_c0 [28];
  undefined1 local_a4 [112];
  undefined1 local_34 [32];
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  iVar6 = DAT_00d7c54c;
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b2532a;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (in_ECX == 0) {
    FUN_008018d0(L"[GetBuyPriceTooltip] pItem is Null",DAT_00d66fa0 ^ (uint)&stack0xffffff18);
    ExceptionList = local_14;
    return;
  }
  local_d4 = *(float *)(in_ECX + 0x10);
  local_c4 = local_d4;
  FUN_004437f0(&local_d4);
  if ((local_d8 != *(int *)(iVar6 + 0x44)) && (iVar6 = *(int *)(local_d8 + 0x10), iVar6 != 0)) {
    uVar7 = *(uint *)(in_ECX + 0xbc);
    bVar2 = uVar7 < 2;
    local_d4 = 1.0;
    iVar4 = FUN_008eb260(DAT_00d6f0f4);
    if ((iVar4 != 0) && (iVar5 = FUN_004049b0(*(undefined4 *)(iVar4 + 0x70)), iVar5 != 0)) {
      local_d4 = (float)*(ushort *)(iVar5 + 0x46) * 0.0001;
    }
    fVar3 = (float)*(int *)(iVar6 + 0x54);
    if (*(int *)(iVar6 + 0x54) < 0) {
      fVar3 = fVar3 + 4.2949673e+09;
    }
    if (bVar2) {
      local_d0 = (longlong)ROUND(fVar3 * local_d4 + 0.01);
      uVar7 = (uint)local_d0;
    }
    if (((iVar4 != 0) && (iVar6 = FUN_004049b0(*(undefined4 *)(iVar4 + 0x70)), iVar6 != 0)) &&
       ((cVar1 = *(char *)(iVar6 + 0x40), cVar1 == '\x03' ||
        ((cVar1 == '\x04' || (cVar1 == '\x06')))))) {
      uVar7 = FUN_00962140(local_c4);
    }
    FUN_00406460(L"IDS_ITEMEQUIP_PURCHASE2");
    local_c = 0;
    uVar8 = FUN_0070c2d0(uVar7,0);
    local_c._0_1_ = 1;
    FUN_0081d120(local_c0);
    local_c._0_1_ = 2;
    uVar8 = FUN_00403450(local_34,uVar8);
    local_c._0_1_ = 3;
    FUN_00405eb0(uVar8,0,0xffffffff);
    local_c._0_1_ = 2;
    FUN_00406560();
    local_c._0_1_ = 1;
    FUN_00406560();
    local_c = (uint)local_c._1_3_ << 8;
    FUN_00406560();
    local_c = 0xffffffff;
    FUN_00406560();
    if (bVar2) {
      iVar6 = FUN_0081cbe0(DAT_0172491c);
      local_c = 6;
      if (*(uint *)(iVar6 + 0x18) < 8) {
        iVar6 = iVar6 + 4;
      }
      else {
        iVar6 = *(int *)(iVar6 + 4);
      }
      uVar8 = FUN_00404750(L"@Y %s@N",iVar6);
      local_c._0_1_ = 7;
      FUN_00405c30(uVar8,0,0xffffffff);
      local_c = CONCAT31(local_c._1_3_,6);
      FUN_00406560();
      local_c = 0xffffffff;
      FUN_00406560();
      iVar6 = (int)ABS((1.0 - local_d4) * 100.0);
      if (0 < iVar6) {
        FUN_00406460(L"IDS_APPLY_BUY_TAX");
        local_c = 8;
        iVar4 = FUN_0081d120(local_c0);
        local_c._0_1_ = 9;
        if (*(uint *)(iVar4 + 0x18) < 8) {
          iVar4 = iVar4 + 4;
        }
        else {
          iVar4 = *(int *)(iVar4 + 4);
        }
        uVar8 = FUN_00404750(iVar4,iVar6);
        local_c._0_1_ = 10;
        uVar8 = FUN_00403380(local_a4,uVar8);
        local_c._0_1_ = 0xb;
        FUN_00405d50(uVar8);
        local_c._0_1_ = 10;
        FUN_00406560();
        local_c._0_1_ = 9;
        FUN_00406560();
        local_c = CONCAT31(local_c._1_3_,8);
        FUN_00406560();
        local_c = 0xffffffff;
        FUN_00406560();
      }
    }
    else {
      iVar6 = FUN_0081cbe0(DAT_0172491c);
      local_c = 4;
      if (*(uint *)(iVar6 + 0x18) < 8) {
        iVar6 = iVar6 + 4;
      }
      else {
        iVar6 = *(int *)(iVar6 + 4);
      }
      uVar8 = FUN_00404750(L"@Y %s@N",iVar6);
      local_c._0_1_ = 5;
      FUN_00405c30(uVar8,0,0xffffffff);
      local_c = CONCAT31(local_c._1_3_,4);
      FUN_00406560();
      local_c = 0xffffffff;
      FUN_00406560();
    }
    FUN_00404980(param_1);
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
009f6750 : PUSH EBP
009f6751 : MOV EBP,ESP
009f6753 : AND ESP,0xfffffff8
009f6756 : PUSH -0x1
009f6758 : PUSH 0xb2532a
009f675d : MOV EAX,FS:[0x0]
009f6763 : PUSH EAX
009f6764 : SUB ESP,0xc8
009f676a : PUSH EBX
009f676b : PUSH ESI
009f676c : PUSH EDI
009f676d : MOV EAX,[0x00d66fa0]
009f6772 : XOR EAX,ESP
009f6774 : PUSH EAX
009f6775 : LEA EAX,[ESP + 0xd8]
009f677c : MOV FS:[0x0],EAX
009f6782 : MOV ESI,ECX
009f6784 : TEST ESI,ESI
009f6786 : JNZ 0x009f67b1
009f6788 : MOV ESI,dword ptr [0x00da98e8]
009f678e : PUSH 0xca6870
009f6793 : CALL 0x008018d0
009f6798 : ADD ESP,0x4
009f679b : MOV ECX,dword ptr [ESP + 0xd8]
009f67a2 : MOV dword ptr FS:[0x0],ECX
009f67a9 : POP ECX
009f67aa : POP EDI
009f67ab : POP ESI
009f67ac : POP EBX
009f67ad : MOV ESP,EBP
009f67af : POP EBP
009f67b0 : RET
009f67b1 : MOV EAX,dword ptr [ESI + 0x10]
009f67b4 : MOV EDI,dword ptr [0x00d7c54c]
009f67ba : MOV dword ptr [ESP + 0x28],EAX
009f67be : MOV dword ptr [ESP + 0x18],EAX
009f67c2 : LEA EAX,[ESP + 0x18]
009f67c6 : PUSH EAX
009f67c7 : LEA ECX,[EDI + 0x40]
009f67ca : LEA EAX,[ESP + 0x18]
009f67ce : CALL 0x004437f0
009f67d3 : MOV EDI,dword ptr [EDI + 0x44]
009f67d6 : MOV EAX,dword ptr [ESP + 0x14]
009f67da : CMP EAX,EDI
009f67dc : JZ 0x009f6b96
009f67e2 : MOV EAX,dword ptr [EAX + 0x10]
009f67e5 : MOV dword ptr [ESP + 0x14],EAX
009f67e9 : TEST EAX,EAX
009f67eb : JZ 0x009f6b96
009f67f1 : MOV EBX,dword ptr [ESI + 0xbc]
009f67f7 : MOV byte ptr [ESP + 0x13],0x0
009f67fc : CMP EBX,0x1
009f67ff : JBE 0x009f6806
009f6801 : MOV byte ptr [ESP + 0x13],0x1
009f6806 : MOV ECX,dword ptr [0x00da9894]
009f680c : MOV EDX,dword ptr [0x00d6f0f4]
009f6812 : MOVSS XMM0,dword ptr [0x00c10fc4]
009f681a : MOV ESI,dword ptr [ECX]
009f681c : PUSH EDX
009f681d : MOVSS dword ptr [ESP + 0x1c],XMM0
009f6823 : CALL 0x008eb260
009f6828 : MOV EDI,EAX
009f682a : TEST EDI,EDI
009f682c : JZ 0x009f6854
009f682e : MOV EAX,dword ptr [EDI + 0x70]
009f6831 : PUSH EAX
009f6832 : CALL 0x004049b0
009f6837 : ADD ESP,0x4
009f683a : TEST EAX,EAX
009f683c : JZ 0x009f6854
009f683e : MOVZX EAX,word ptr [EAX + 0x46]
009f6842 : CVTSI2SS XMM0,EAX
009f6846 : MULSS XMM0,dword ptr [0x00cdf398]
009f684e : MOVSS dword ptr [ESP + 0x18],XMM0
009f6854 : MOV ECX,dword ptr [ESP + 0x14]
009f6858 : MOV EDX,dword ptr [ECX + 0x54]
009f685b : FILD dword ptr [ECX + 0x54]
009f685e : TEST EDX,EDX
009f6860 : JGE 0x009f6868
009f6862 : FADD float ptr [0x00cdf0e0]
009f6868 : CMP byte ptr [ESP + 0x13],0x0
009f686d : FMUL float ptr [ESP + 0x18]
009f6871 : JZ 0x009f6879
009f6873 : FSTP ST0
009f6875 : MOV ESI,EBX
009f6877 : JMP 0x009f68a1
009f6879 : FADD float ptr [0x00cdf23c]
009f687f : FNSTCW word ptr [ESP + 0x14]
009f6883 : MOVZX EAX,word ptr [ESP + 0x14]
009f6888 : OR EAX,0xc00
009f688d : MOV dword ptr [ESP + 0x1c],EAX
009f6891 : FLDCW word ptr [ESP + 0x1c]
009f6895 : FISTP qword ptr [ESP + 0x1c]
009f6899 : MOV ESI,dword ptr [ESP + 0x1c]
009f689d : FLDCW word ptr [ESP + 0x14]
009f68a1 : TEST EDI,EDI
009f68a3 : JZ 0x009f68d0
009f68a5 : MOV EAX,dword ptr [EDI + 0x70]
009f68a8 : PUSH EAX
009f68a9 : CALL 0x004049b0
009f68ae : ADD ESP,0x4
009f68b1 : TEST EAX,EAX
009f68b3 : JZ 0x009f68d0
009f68b5 : MOV AL,byte ptr [EAX + 0x40]
009f68b8 : CMP AL,0x3
009f68ba : JZ 0x009f68c4
009f68bc : CMP AL,0x4
009f68be : JZ 0x009f68c4
009f68c0 : CMP AL,0x6
009f68c2 : JNZ 0x009f68d0
009f68c4 : MOV EAX,dword ptr [ESP + 0x28]
009f68c8 : PUSH EAX
009f68c9 : CALL 0x00962140
009f68ce : MOV ESI,EAX
009f68d0 : PUSH 0xca68b8
009f68d5 : LEA ECX,[ESP + 0x30]
009f68d9 : CALL 0x00406460
009f68de : MOV dword ptr [ESP + 0xe0],0x0
009f68e9 : PUSH 0x0
009f68eb : PUSH ESI
009f68ec : LEA ECX,[ESP + 0x88]
009f68f3 : CALL 0x0070c2d0
009f68f8 : ADD ESP,0x8
009f68fb : MOV ESI,EAX
009f68fd : MOV byte ptr [ESP + 0xe0],0x1
009f6905 : LEA ECX,[ESP + 0x2c]
009f6909 : PUSH ECX
009f690a : MOV ECX,dword ptr [0x0172491c]
009f6910 : LEA EDI,[ESP + 0xa0]
009f6917 : CALL 0x0081d120
009f691c : MOV BL,0x2
009f691e : MOV byte ptr [ESP + 0xe0],BL
009f6925 : LEA EDX,[ESP + 0xb8]
009f692c : PUSH ESI
009f692d : PUSH EDX
009f692e : MOV ECX,EAX
009f6930 : CALL 0x00403450
009f6935 : ADD ESP,0x8
009f6938 : MOV byte ptr [ESP + 0xe0],0x3
009f6940 : MOV EDI,dword ptr [EBP + 0x8]
009f6943 : PUSH -0x1
009f6945 : PUSH 0x0
009f6947 : PUSH EAX
009f6948 : MOV ECX,EDI
009f694a : CALL 0x00405eb0
009f694f : MOV byte ptr [ESP + 0xe0],BL
009f6956 : LEA ECX,[ESP + 0xb8]
009f695d : CALL 0x00406560
009f6962 : MOV byte ptr [ESP + 0xe0],0x1
009f696a : LEA ECX,[ESP + 0x9c]
009f6971 : CALL 0x00406560
009f6976 : MOV byte ptr [ESP + 0xe0],0x0
009f697e : LEA ECX,[ESP + 0x80]
009f6985 : CALL 0x00406560
009f698a : MOV dword ptr [ESP + 0xe0],0xffffffff
009f6995 : LEA ECX,[ESP + 0x2c]
009f6999 : CALL 0x00406560
009f699e : CMP byte ptr [ESP + 0x13],0x0
009f69a3 : JZ 0x009f6a20
009f69a5 : MOV EAX,[0x0172491c]
009f69aa : PUSH EAX
009f69ab : MOV ECX,0xca686c
009f69b0 : LEA ESI,[ESP + 0x4c]
009f69b4 : CALL 0x0081cbe0
009f69b9 : MOV dword ptr [ESP + 0xe0],0x4
009f69c4 : CMP dword ptr [EAX + 0x18],0x8
009f69c8 : JC 0x009f69cf
009f69ca : MOV EAX,dword ptr [EAX + 0x4]
009f69cd : JMP 0x009f69d2
009f69cf : ADD EAX,0x4
009f69d2 : PUSH EAX
009f69d3 : PUSH 0xca68e8
009f69d8 : LEA ESI,[ESP + 0x6c]
009f69dc : CALL 0x00404750
009f69e1 : ADD ESP,0x8
009f69e4 : MOV byte ptr [ESP + 0xe0],0x5
009f69ec : PUSH -0x1
009f69ee : PUSH 0x0
009f69f0 : PUSH EAX
009f69f1 : MOV ECX,EDI
009f69f3 : CALL 0x00405c30
009f69f8 : MOV byte ptr [ESP + 0xe0],0x4
009f6a00 : MOV ECX,ESI
009f6a02 : CALL 0x00406560
009f6a07 : MOV dword ptr [ESP + 0xe0],0xffffffff
009f6a12 : LEA ECX,[ESP + 0x48]
009f6a16 : CALL 0x00406560
009f6a1b : JMP 0x009f6b8b
009f6a20 : MOV ECX,dword ptr [0x0172491c]
009f6a26 : PUSH ECX
009f6a27 : MOV ECX,0xca68f8
009f6a2c : LEA ESI,[ESP + 0x68]
009f6a30 : CALL 0x0081cbe0
009f6a35 : MOV dword ptr [ESP + 0xe0],0x6
009f6a40 : MOV EBX,0x8
009f6a45 : CMP dword ptr [EAX + 0x18],EBX
009f6a48 : JC 0x009f6a4f
009f6a4a : MOV EAX,dword ptr [EAX + 0x4]
009f6a4d : JMP 0x009f6a52
009f6a4f : ADD EAX,0x4
009f6a52 : PUSH EAX
009f6a53 : PUSH 0xca6900
009f6a58 : LEA ESI,[ESP + 0x50]
009f6a5c : CALL 0x00404750
009f6a61 : ADD ESP,0x8
009f6a64 : MOV byte ptr [ESP + 0xe0],0x7
009f6a6c : PUSH -0x1
009f6a6e : PUSH 0x0
009f6a70 : PUSH EAX
009f6a71 : MOV ECX,EDI
009f6a73 : CALL 0x00405c30
009f6a78 : MOV byte ptr [ESP + 0xe0],0x6
009f6a80 : MOV ECX,ESI
009f6a82 : CALL 0x00406560
009f6a87 : MOV dword ptr [ESP + 0xe0],0xffffffff
009f6a92 : LEA ECX,[ESP + 0x64]
009f6a96 : CALL 0x00406560
009f6a9b : MOVSS XMM0,dword ptr [0x00c10fc4]
009f6aa3 : SUBSS XMM0,dword ptr [ESP + 0x18]
009f6aa9 : MULSS XMM0,dword ptr [0x00cdf230]
009f6ab1 : MOVSS XMM1,dword ptr [0x00cdf350]
009f6ab9 : ANDPS XMM0,XMM1
009f6abc : CVTTSS2SI ESI,XMM0
009f6ac0 : TEST ESI,ESI
009f6ac2 : JLE 0x009f6b8b
009f6ac8 : PUSH 0xca6910
009f6acd : LEA ECX,[ESP + 0x30]
009f6ad1 : CALL 0x00406460
009f6ad6 : MOV dword ptr [ESP + 0xe0],EBX
009f6add : MOV ECX,dword ptr [0x0172491c]
009f6ae3 : LEA EDX,[ESP + 0x2c]
009f6ae7 : PUSH EDX
009f6ae8 : LEA EDI,[ESP + 0x84]
009f6aef : CALL 0x0081d120
009f6af4 : MOV byte ptr [ESP + 0xe0],0x9
009f6afc : CMP dword ptr [EAX + 0x18],EBX
009f6aff : JC 0x009f6b06
009f6b01 : MOV EAX,dword ptr [EAX + 0x4]
009f6b04 : JMP 0x009f6b09
009f6b06 : ADD EAX,0x4
009f6b09 : PUSH ESI
009f6b0a : PUSH EAX
009f6b0b : LEA ESI,[ESP + 0x6c]
009f6b0f : CALL 0x00404750
009f6b14 : MOV BL,0xa
009f6b16 : MOV byte ptr [ESP + 0xe8],BL
009f6b1d : PUSH EAX
009f6b1e : LEA EAX,[ESP + 0x54]
009f6b22 : PUSH EAX
009f6b23 : MOV EDX,0xca6934
009f6b28 : CALL 0x00403380
009f6b2d : ADD ESP,0x10
009f6b30 : MOV byte ptr [ESP + 0xe0],0xb
009f6b38 : MOV ECX,dword ptr [EBP + 0x8]
009f6b3b : PUSH EAX
009f6b3c : CALL 0x00405d50
009f6b41 : MOV byte ptr [ESP + 0xe0],BL
009f6b48 : LEA ECX,[ESP + 0x48]
009f6b4c : CALL 0x00406560
009f6b51 : MOV byte ptr [ESP + 0xe0],0x9
009f6b59 : MOV ECX,ESI
009f6b5b : CALL 0x00406560
009f6b60 : MOV byte ptr [ESP + 0xe0],0x8
009f6b68 : LEA ECX,[ESP + 0x80]
009f6b6f : CALL 0x00406560
009f6b74 : MOV dword ptr [ESP + 0xe0],0xffffffff
009f6b7f : LEA ECX,[ESP + 0x2c]
009f6b83 : CALL 0x00406560
009f6b88 : MOV EDI,dword ptr [EBP + 0x8]
009f6b8b : PUSH EDI
009f6b8c : MOV EDX,0xca6938
009f6b91 : CALL 0x00404980
009f6b96 : MOV ECX,dword ptr [ESP + 0xd8]
009f6b9d : MOV dword ptr FS:[0x0],ECX
009f6ba4 : POP ECX
009f6ba5 : POP EDI
009f6ba6 : POP ESI
009f6ba7 : POP EBX
009f6ba8 : MOV ESP,EBP
009f6baa : POP EBP
009f6bab : RET

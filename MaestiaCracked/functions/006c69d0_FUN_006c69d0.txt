PROGRAM  : Maestia.exe
FUNCTION : FUN_006c69d0
ENTRY    : 006c69d0
BODY     : [[006c69d0, 006c6be5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006c69d0(uint *param_1,int param_2)

{
  char cVar1;
  uint uVar2;
  int local_30;
  byte *local_2c;
  byte *local_28;
  int local_24;
  byte *local_20;
  byte *local_1c;
  int local_18;
  byte *local_14;
  byte *local_10;
  uint local_8;
  
  if (*(byte *)((int)param_1 + 9) < 8) {
    uVar2 = *param_1;
    cVar1 = *(char *)((int)param_1 + 9);
    if (cVar1 == '\x01') {
      local_10 = (byte *)((uVar2 - 1 >> 3) + param_2);
      local_14 = (byte *)(param_2 + -1 + uVar2);
      local_18 = 7 - (uVar2 + 7 & 7);
      for (local_8 = 0; local_8 < uVar2; local_8 = local_8 + 1) {
        *local_14 = (byte)((int)(uint)*local_10 >> ((byte)local_18 & 0x1f)) & 1;
        if (local_18 == 7) {
          local_18 = 0;
          local_10 = local_10 + -1;
        }
        else {
          local_18 = local_18 + 1;
        }
        local_14 = local_14 + -1;
      }
    }
    else if (cVar1 == '\x02') {
      local_1c = (byte *)((uVar2 - 1 >> 2) + param_2);
      local_20 = (byte *)(param_2 + -1 + uVar2);
      local_24 = (3 - (uVar2 + 3 & 3)) * 2;
      for (local_8 = 0; local_8 < uVar2; local_8 = local_8 + 1) {
        *local_20 = (byte)((int)(uint)*local_1c >> ((byte)local_24 & 0x1f)) & 3;
        if (local_24 == 6) {
          local_24 = 0;
          local_1c = local_1c + -1;
        }
        else {
          local_24 = local_24 + 2;
        }
        local_20 = local_20 + -1;
      }
    }
    else if (cVar1 == '\x04') {
      local_28 = (byte *)((uVar2 - 1 >> 1) + param_2);
      local_2c = (byte *)(param_2 + -1 + uVar2);
      local_30 = (1 - (uVar2 + 1 & 1)) * 4;
      for (local_8 = 0; local_8 < uVar2; local_8 = local_8 + 1) {
        *local_2c = (byte)((int)(uint)*local_28 >> ((byte)local_30 & 0x1f)) & 0xf;
        if (local_30 == 4) {
          local_30 = 0;
          local_28 = local_28 + -1;
        }
        else {
          local_30 = 4;
        }
        local_2c = local_2c + -1;
      }
    }
    *(undefined1 *)((int)param_1 + 9) = 8;
    *(char *)((int)param_1 + 0xb) = *(char *)((int)param_1 + 10) << 3;
    param_1[1] = *(byte *)((int)param_1 + 10) * uVar2;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006c69d0 : PUSH EBP
006c69d1 : MOV EBP,ESP
006c69d3 : SUB ESP,0x30
006c69d6 : MOV EAX,dword ptr [EBP + 0x8]
006c69d9 : MOVZX ECX,byte ptr [EAX + 0x9]
006c69dd : CMP ECX,0x8
006c69e0 : JGE 0x006c6be2
006c69e6 : MOV EDX,dword ptr [EBP + 0x8]
006c69e9 : MOV EAX,dword ptr [EDX]
006c69eb : MOV dword ptr [EBP + -0x8],EAX
006c69ee : MOV ECX,dword ptr [EBP + 0x8]
006c69f1 : MOV DL,byte ptr [ECX + 0x9]
006c69f4 : MOV byte ptr [EBP + -0x30],DL
006c69f7 : CMP byte ptr [EBP + -0x30],0x1
006c69fb : JZ 0x006c6a16
006c69fd : CMP byte ptr [EBP + -0x30],0x2
006c6a01 : JZ 0x006c6aa3
006c6a07 : CMP byte ptr [EBP + -0x30],0x4
006c6a0b : JZ 0x006c6b32
006c6a11 : JMP 0x006c6bba
006c6a16 : MOV EAX,dword ptr [EBP + -0x8]
006c6a19 : SUB EAX,0x1
006c6a1c : SHR EAX,0x3
006c6a1f : ADD EAX,dword ptr [EBP + 0xc]
006c6a22 : MOV dword ptr [EBP + -0xc],EAX
006c6a25 : MOV ECX,dword ptr [EBP + -0x8]
006c6a28 : MOV EDX,dword ptr [EBP + 0xc]
006c6a2b : LEA EAX,[EDX + ECX*0x1 + -0x1]
006c6a2f : MOV dword ptr [EBP + -0x10],EAX
006c6a32 : MOV ECX,dword ptr [EBP + -0x8]
006c6a35 : ADD ECX,0x7
006c6a38 : AND ECX,0x7
006c6a3b : MOV EDX,0x7
006c6a40 : SUB EDX,ECX
006c6a42 : MOV dword ptr [EBP + -0x14],EDX
006c6a45 : MOV dword ptr [EBP + -0x4],0x0
006c6a4c : JMP 0x006c6a57
006c6a4e : MOV EAX,dword ptr [EBP + -0x4]
006c6a51 : ADD EAX,0x1
006c6a54 : MOV dword ptr [EBP + -0x4],EAX
006c6a57 : MOV ECX,dword ptr [EBP + -0x4]
006c6a5a : CMP ECX,dword ptr [EBP + -0x8]
006c6a5d : JNC 0x006c6a9e
006c6a5f : MOV EDX,dword ptr [EBP + -0xc]
006c6a62 : MOVZX EAX,byte ptr [EDX]
006c6a65 : MOV ECX,dword ptr [EBP + -0x14]
006c6a68 : SAR EAX,CL
006c6a6a : AND EAX,0x1
006c6a6d : MOV ECX,dword ptr [EBP + -0x10]
006c6a70 : MOV byte ptr [ECX],AL
006c6a72 : CMP dword ptr [EBP + -0x14],0x7
006c6a76 : JNZ 0x006c6a8a
006c6a78 : MOV dword ptr [EBP + -0x14],0x0
006c6a7f : MOV EDX,dword ptr [EBP + -0xc]
006c6a82 : SUB EDX,0x1
006c6a85 : MOV dword ptr [EBP + -0xc],EDX
006c6a88 : JMP 0x006c6a93
006c6a8a : MOV EAX,dword ptr [EBP + -0x14]
006c6a8d : ADD EAX,0x1
006c6a90 : MOV dword ptr [EBP + -0x14],EAX
006c6a93 : MOV ECX,dword ptr [EBP + -0x10]
006c6a96 : SUB ECX,0x1
006c6a99 : MOV dword ptr [EBP + -0x10],ECX
006c6a9c : JMP 0x006c6a4e
006c6a9e : JMP 0x006c6bba
006c6aa3 : MOV EDX,dword ptr [EBP + -0x8]
006c6aa6 : SUB EDX,0x1
006c6aa9 : SHR EDX,0x2
006c6aac : ADD EDX,dword ptr [EBP + 0xc]
006c6aaf : MOV dword ptr [EBP + -0x18],EDX
006c6ab2 : MOV EAX,dword ptr [EBP + -0x8]
006c6ab5 : MOV ECX,dword ptr [EBP + 0xc]
006c6ab8 : LEA EDX,[ECX + EAX*0x1 + -0x1]
006c6abc : MOV dword ptr [EBP + -0x1c],EDX
006c6abf : MOV EAX,dword ptr [EBP + -0x8]
006c6ac2 : ADD EAX,0x3
006c6ac5 : AND EAX,0x3
006c6ac8 : MOV ECX,0x3
006c6acd : SUB ECX,EAX
006c6acf : SHL ECX,0x1
006c6ad1 : MOV dword ptr [EBP + -0x20],ECX
006c6ad4 : MOV dword ptr [EBP + -0x4],0x0
006c6adb : JMP 0x006c6ae6
006c6add : MOV EDX,dword ptr [EBP + -0x4]
006c6ae0 : ADD EDX,0x1
006c6ae3 : MOV dword ptr [EBP + -0x4],EDX
006c6ae6 : MOV EAX,dword ptr [EBP + -0x4]
006c6ae9 : CMP EAX,dword ptr [EBP + -0x8]
006c6aec : JNC 0x006c6b2d
006c6aee : MOV ECX,dword ptr [EBP + -0x18]
006c6af1 : MOVZX EDX,byte ptr [ECX]
006c6af4 : MOV ECX,dword ptr [EBP + -0x20]
006c6af7 : SAR EDX,CL
006c6af9 : AND EDX,0x3
006c6afc : MOV EAX,dword ptr [EBP + -0x1c]
006c6aff : MOV byte ptr [EAX],DL
006c6b01 : CMP dword ptr [EBP + -0x20],0x6
006c6b05 : JNZ 0x006c6b19
006c6b07 : MOV dword ptr [EBP + -0x20],0x0
006c6b0e : MOV ECX,dword ptr [EBP + -0x18]
006c6b11 : SUB ECX,0x1
006c6b14 : MOV dword ptr [EBP + -0x18],ECX
006c6b17 : JMP 0x006c6b22
006c6b19 : MOV EDX,dword ptr [EBP + -0x20]
006c6b1c : ADD EDX,0x2
006c6b1f : MOV dword ptr [EBP + -0x20],EDX
006c6b22 : MOV EAX,dword ptr [EBP + -0x1c]
006c6b25 : SUB EAX,0x1
006c6b28 : MOV dword ptr [EBP + -0x1c],EAX
006c6b2b : JMP 0x006c6add
006c6b2d : JMP 0x006c6bba
006c6b32 : MOV ECX,dword ptr [EBP + -0x8]
006c6b35 : SUB ECX,0x1
006c6b38 : SHR ECX,0x1
006c6b3a : ADD ECX,dword ptr [EBP + 0xc]
006c6b3d : MOV dword ptr [EBP + -0x24],ECX
006c6b40 : MOV EDX,dword ptr [EBP + -0x8]
006c6b43 : MOV EAX,dword ptr [EBP + 0xc]
006c6b46 : LEA ECX,[EAX + EDX*0x1 + -0x1]
006c6b4a : MOV dword ptr [EBP + -0x28],ECX
006c6b4d : MOV EDX,dword ptr [EBP + -0x8]
006c6b50 : ADD EDX,0x1
006c6b53 : AND EDX,0x1
006c6b56 : MOV EAX,0x1
006c6b5b : SUB EAX,EDX
006c6b5d : SHL EAX,0x2
006c6b60 : MOV dword ptr [EBP + -0x2c],EAX
006c6b63 : MOV dword ptr [EBP + -0x4],0x0
006c6b6a : JMP 0x006c6b75
006c6b6c : MOV ECX,dword ptr [EBP + -0x4]
006c6b6f : ADD ECX,0x1
006c6b72 : MOV dword ptr [EBP + -0x4],ECX
006c6b75 : MOV EDX,dword ptr [EBP + -0x4]
006c6b78 : CMP EDX,dword ptr [EBP + -0x8]
006c6b7b : JNC 0x006c6bba
006c6b7d : MOV EAX,dword ptr [EBP + -0x24]
006c6b80 : MOVZX EDX,byte ptr [EAX]
006c6b83 : MOV ECX,dword ptr [EBP + -0x2c]
006c6b86 : SAR EDX,CL
006c6b88 : AND EDX,0xf
006c6b8b : MOV EAX,dword ptr [EBP + -0x28]
006c6b8e : MOV byte ptr [EAX],DL
006c6b90 : CMP dword ptr [EBP + -0x2c],0x4
006c6b94 : JNZ 0x006c6ba8
006c6b96 : MOV dword ptr [EBP + -0x2c],0x0
006c6b9d : MOV ECX,dword ptr [EBP + -0x24]
006c6ba0 : SUB ECX,0x1
006c6ba3 : MOV dword ptr [EBP + -0x24],ECX
006c6ba6 : JMP 0x006c6baf
006c6ba8 : MOV dword ptr [EBP + -0x2c],0x4
006c6baf : MOV EDX,dword ptr [EBP + -0x28]
006c6bb2 : SUB EDX,0x1
006c6bb5 : MOV dword ptr [EBP + -0x28],EDX
006c6bb8 : JMP 0x006c6b6c
006c6bba : MOV EAX,dword ptr [EBP + 0x8]
006c6bbd : MOV byte ptr [EAX + 0x9],0x8
006c6bc1 : MOV ECX,dword ptr [EBP + 0x8]
006c6bc4 : MOVZX EDX,byte ptr [ECX + 0xa]
006c6bc8 : SHL EDX,0x3
006c6bcb : MOV EAX,dword ptr [EBP + 0x8]
006c6bce : MOV byte ptr [EAX + 0xb],DL
006c6bd1 : MOV ECX,dword ptr [EBP + 0x8]
006c6bd4 : MOVZX EDX,byte ptr [ECX + 0xa]
006c6bd8 : IMUL EDX,dword ptr [EBP + -0x8]
006c6bdc : MOV EAX,dword ptr [EBP + 0x8]
006c6bdf : MOV dword ptr [EAX + 0x4],EDX
006c6be2 : MOV ESP,EBP
006c6be4 : POP EBP
006c6be5 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0058d650
ENTRY    : 0058d650
BODY     : [[0058d650, 0058d824]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0058d650(int param_1)

{
  int *piVar1;
  undefined1 *puVar2;
  float fVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  GMatrix2D *this;
  float10 fVar7;
  int iStack_78;
  undefined8 uStack_74;
  float fStack_6c;
  undefined1 *puStack_68;
  char cStack_50;
  undefined1 auStack_44 [4];
  char cStack_40;
  undefined1 local_38;
  undefined1 auStack_30 [8];
  undefined1 local_28 [4];
  undefined1 auStack_24 [16];
  undefined1 auStack_14 [20];
  
  iVar4 = param_1;
  puVar2 = *(undefined1 **)(param_1 + 4);
  FUN_00526400();
  *puVar2 = 0;
  if (*(int **)(param_1 + 8) == (int *)0x0) {
    param_1 = *(int *)(*(int *)(param_1 + 0x18) + 0x74);
  }
  else {
    iVar5 = (**(code **)(**(int **)(param_1 + 8) + 8))();
    if (iVar5 != 2) {
      return;
    }
    if (*(int *)(param_1 + 8) == 0) {
      return;
    }
    param_1 = *(int *)(param_1 + 8) + -0x68;
  }
  if ((param_1 != 0) && (0 < *(int *)(iVar4 + 0x1c))) {
    puStack_68 = *(undefined1 **)(iVar4 + 0x18);
    fStack_6c = 0.0;
    piVar1 = (int *)(puStack_68 + 0x78);
    uStack_74 = (double)CONCAT44(0x58d6c1,(undefined4)uStack_74);
    FUN_00526260();
    fStack_6c = 8.158573e-39;
    piVar6 = (int *)FUN_005270f0();
    if (piVar6 != (int *)0x0) {
      local_28[0] = 0;
      local_38 = 0;
      puStack_68 = local_28;
      fStack_6c = (float)(*piVar1 + 0x1ec);
      uStack_74._0_4_ = 0x58d6f2;
      uStack_74._4_4_ = piVar1;
      (**(code **)(*piVar6 + 0x2c))();
      uStack_74 = (double)CONCAT44(uStack_74._4_4_,auStack_44);
      iStack_78 = *piVar1 + 0x1f0;
      (**(code **)(*piVar6 + 0x2c))(piVar1);
      if (((cStack_40 == '\x03') || (cStack_40 == '\x04')) &&
         ((cStack_50 == '\x03' || (cStack_50 == '\x04')))) {
        fVar7 = (float10)FUN_00527730(*(undefined4 *)(iVar4 + 0x18));
        puStack_68 = (undefined1 *)(float)fVar7;
        fVar7 = (float10)FUN_00527730(*(undefined4 *)(iVar4 + 0x18));
        fStack_6c = (float)fVar7;
        this = (GMatrix2D *)FUN_0050aa60(auStack_30);
        GMatrix2D::TransformByInverse
                  (this,(GPoint<float> *)&puStack_68,(GPoint<float> *)&stack0xffffffa8);
        fVar3 = (float)puStack_68 / 20.0;
        puStack_68 = (undefined1 *)CONCAT31(puStack_68._1_3_,3);
        auStack_14[0] = 0;
        (**(code **)(*piVar6 + 0x28))(piVar1,*piVar1 + 0x1ec,&puStack_68,auStack_14);
        FUN_00526bc0();
        iStack_78 = CONCAT31(iStack_78._1_3_,3);
        auStack_24[0] = 0;
        uStack_74 = (double)(SUB84((double)fVar3,0) / 20.0);
        (**(code **)(*piVar6 + 0x28))(piVar1,*piVar1 + 0x1f0,&iStack_78,auStack_24);
        FUN_00526bc0();
      }
      FUN_00526bc0();
      FUN_00526bc0();
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0058d650 : SUB ESP,0x54
0058d653 : PUSH EBX
0058d654 : PUSH EBP
0058d655 : MOV EBP,dword ptr [ESP + 0x60]
0058d659 : PUSH ESI
0058d65a : MOV ESI,dword ptr [EBP + 0x4]
0058d65d : MOV ECX,ESI
0058d65f : CALL 0x00526400
0058d664 : XOR EBX,EBX
0058d666 : MOV byte ptr [ESI],BL
0058d668 : MOV ECX,dword ptr [EBP + 0x8]
0058d66b : CMP ECX,EBX
0058d66d : JNZ 0x0058d67b
0058d66f : MOV EAX,dword ptr [EBP + 0x18]
0058d672 : MOV ECX,dword ptr [EAX + 0x74]
0058d675 : MOV dword ptr [ESP + 0x64],ECX
0058d679 : JMP 0x0058d69d
0058d67b : MOV EDX,dword ptr [ECX]
0058d67d : MOV EAX,dword ptr [EDX + 0x8]
0058d680 : CALL EAX
0058d682 : CMP EAX,0x2
0058d685 : JNZ 0x0058d81e
0058d68b : MOV EAX,dword ptr [EBP + 0x8]
0058d68e : CMP EAX,EBX
0058d690 : JZ 0x0058d81e
0058d696 : ADD EAX,-0x68
0058d699 : MOV dword ptr [ESP + 0x64],EAX
0058d69d : CMP dword ptr [ESP + 0x64],EBX
0058d6a1 : JZ 0x0058d81e
0058d6a7 : CMP dword ptr [EBP + 0x1c],0x1
0058d6ab : JL 0x0058d81e
0058d6b1 : MOV EAX,dword ptr [EBP + 0x18]
0058d6b4 : PUSH EDI
0058d6b5 : PUSH EAX
0058d6b6 : PUSH EBX
0058d6b7 : MOV ECX,EBP
0058d6b9 : LEA EDI,[EAX + 0x78]
0058d6bc : CALL 0x00526260
0058d6c1 : MOV ECX,EAX
0058d6c3 : CALL 0x005270f0
0058d6c8 : MOV ESI,EAX
0058d6ca : CMP ESI,EBX
0058d6cc : JZ 0x0058d81d
0058d6d2 : MOV byte ptr [ESP + 0x3c],BL
0058d6d6 : MOV byte ptr [ESP + 0x2c],BL
0058d6da : MOV ECX,dword ptr [EDI]
0058d6dc : MOV EDX,dword ptr [ESI]
0058d6de : MOV EDX,dword ptr [EDX + 0x2c]
0058d6e1 : LEA EAX,[ESP + 0x3c]
0058d6e5 : PUSH EAX
0058d6e6 : ADD ECX,0x1ec
0058d6ec : PUSH ECX
0058d6ed : PUSH EDI
0058d6ee : MOV ECX,ESI
0058d6f0 : CALL EDX
0058d6f2 : MOV EDX,dword ptr [EDI]
0058d6f4 : MOV EAX,dword ptr [ESI]
0058d6f6 : MOV EAX,dword ptr [EAX + 0x2c]
0058d6f9 : LEA ECX,[ESP + 0x2c]
0058d6fd : PUSH ECX
0058d6fe : ADD EDX,0x1f0
0058d704 : PUSH EDX
0058d705 : PUSH EDI
0058d706 : MOV ECX,ESI
0058d708 : CALL EAX
0058d70a : MOV AL,byte ptr [ESP + 0x3c]
0058d70e : CMP AL,0x3
0058d710 : JZ 0x0058d71a
0058d712 : CMP AL,0x4
0058d714 : JNZ 0x0058d80b
0058d71a : MOV AL,byte ptr [ESP + 0x2c]
0058d71e : CMP AL,0x3
0058d720 : JZ 0x0058d72a
0058d722 : CMP AL,0x4
0058d724 : JNZ 0x0058d80b
0058d72a : MOV ECX,dword ptr [EBP + 0x18]
0058d72d : PUSH ECX
0058d72e : LEA ECX,[ESP + 0x30]
0058d732 : CALL 0x00527730
0058d737 : FSTP float ptr [ESP + 0x14]
0058d73b : MOV EDX,dword ptr [EBP + 0x18]
0058d73e : PUSH EDX
0058d73f : LEA ECX,[ESP + 0x40]
0058d743 : CALL 0x00527730
0058d748 : FSTP float ptr [ESP + 0x10]
0058d74c : FLD float ptr [ESP + 0x10]
0058d750 : MOV ECX,dword ptr [ESP + 0x68]
0058d754 : FLD double ptr [0x00b86058]
0058d75a : LEA EAX,[ESP + 0x4c]
0058d75e : FMUL ST1
0058d760 : PUSH EAX
0058d761 : FXCH
0058d763 : FSTP float ptr [ESP + 0x28]
0058d767 : FMUL float ptr [ESP + 0x18]
0058d76b : FSTP float ptr [ESP + 0x2c]
0058d76f : CALL 0x0050aa60
0058d774 : LEA ECX,[ESP + 0x24]
0058d778 : PUSH ECX
0058d779 : LEA EDX,[ESP + 0x18]
0058d77d : PUSH EDX
0058d77e : MOV ECX,EAX
0058d780 : CALL 0x00522fa0
0058d785 : FLD float ptr [ESP + 0x14]
0058d789 : FST float ptr [ESP + 0x24]
0058d78d : LEA ECX,[ESP + 0x68]
0058d791 : FLD float ptr [ESP + 0x18]
0058d795 : PUSH ECX
0058d796 : FSTP float ptr [ESP + 0x2c]
0058d79a : MOV ECX,dword ptr [EDI]
0058d79c : MOV EAX,dword ptr [ESI]
0058d79e : FDIV double ptr [0x00b86058]
0058d7a4 : LEA EDX,[ESP + 0x18]
0058d7a8 : PUSH EDX
0058d7a9 : MOV EDX,dword ptr [EAX + 0x28]
0058d7ac : ADD ECX,0x1ec
0058d7b2 : PUSH ECX
0058d7b3 : PUSH EDI
0058d7b4 : MOV ECX,ESI
0058d7b6 : MOV byte ptr [ESP + 0x24],0x3
0058d7bb : MOV byte ptr [ESP + 0x78],BL
0058d7bf : FSTP double ptr [ESP + 0x28]
0058d7c3 : CALL EDX
0058d7c5 : LEA ECX,[ESP + 0x14]
0058d7c9 : CALL 0x00526bc0
0058d7ce : FLD float ptr [ESP + 0x28]
0058d7d2 : FDIV double ptr [0x00b86058]
0058d7d8 : MOV EAX,dword ptr [ESI]
0058d7da : LEA ECX,[ESP + 0x68]
0058d7de : PUSH ECX
0058d7df : MOV ECX,dword ptr [EDI]
0058d7e1 : LEA EDX,[ESP + 0x18]
0058d7e5 : PUSH EDX
0058d7e6 : MOV EDX,dword ptr [EAX + 0x28]
0058d7e9 : ADD ECX,0x1f0
0058d7ef : PUSH ECX
0058d7f0 : PUSH EDI
0058d7f1 : MOV ECX,ESI
0058d7f3 : MOV byte ptr [ESP + 0x24],0x3
0058d7f8 : MOV byte ptr [ESP + 0x78],BL
0058d7fc : FSTP double ptr [ESP + 0x28]
0058d800 : CALL EDX
0058d802 : LEA ECX,[ESP + 0x14]
0058d806 : CALL 0x00526bc0
0058d80b : LEA ECX,[ESP + 0x2c]
0058d80f : CALL 0x00526bc0
0058d814 : LEA ECX,[ESP + 0x3c]
0058d818 : CALL 0x00526bc0
0058d81d : POP EDI
0058d81e : POP ESI
0058d81f : POP EBP
0058d820 : POP EBX
0058d821 : ADD ESP,0x54
0058d824 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_009640a0
ENTRY    : 009640a0
BODY     : [[009640a0, 009646cd]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009640a0(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 ushort param_5)

{
  ushort uVar1;
  char cVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  undefined4 uVar7;
  int *piVar8;
  wchar_t *pwVar9;
  undefined1 auStack_e4 [4];
  uint uStack_e0;
  float fStack_dc;
  int *piStack_d8;
  undefined4 local_d4;
  undefined1 local_d0 [4];
  undefined2 local_cc;
  undefined4 uStack_bc;
  uint local_b8;
  undefined1 auStack_b4 [28];
  undefined1 auStack_98 [68];
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  undefined1 auStack_38 [4];
  undefined2 uStack_34;
  undefined4 uStack_24;
  undefined4 uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b53cdd;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_e4;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xffffff10;
  ExceptionList = &local_14;
  local_d4 = param_1;
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  FUN_00406360(&DAT_00c7a79c,0);
  local_c._0_1_ = 0;
  local_c._1_3_ = 0;
  piVar4 = (int *)FUN_008eb580(uVar3);
  if (piVar4 == (int *)0x0) {
    FUN_00406460(L"AvaGuiNpcShop::ShopItemSellCheckDlg  GetPocket ERROR ");
    local_c._0_1_ = 1;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaGuiNpcShop::ShopItemSellCheckDlg",0x6c9,local_d0);
    }
    local_c = (uint)local_c._1_3_ << 8;
    if (7 < local_b8) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_b8 = 7;
    uStack_bc = 0;
    local_cc = 0;
    local_c = 0xffffffff;
    if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_3c = 7;
    local_40 = 0;
    local_50 = 0;
    goto LAB_009646a8;
  }
  piVar4 = (int *)(**(code **)(*piVar4 + 0x74))(param_3,param_4);
  if (piVar4 == (int *)0x0) {
    FUN_008018d0(L"AvaGuiNpcShop::ShopItemSellCheckDlg pPocketView FindItem ERROR ");
    local_c = 0xffffffff;
    if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_3c = 7;
    local_40 = 0;
    local_50 = 0;
    goto LAB_009646a8;
  }
  iVar5 = piVar4[4];
  piStack_d8 = (int *)FUN_004049b0(iVar5);
  if (piStack_d8 == (int *)0x0) {
    pwVar9 = L"AvaGuiNpcShop::ShopItemSellCheckDlg GBD PROTO ERROR %d";
LAB_00964262:
    FUN_008018d0(pwVar9,iVar5);
  }
  else {
    FUN_00406460(L"IDS_SHOP_SELLITEM_INFOCHECK_BOX");
    local_c._0_1_ = 2;
    iVar5 = FUN_00824a20(DAT_0172491c,0);
    local_c._0_1_ = 3;
    iVar6 = FUN_0081d120(local_d0);
    local_c._0_1_ = 4;
    if (*(uint *)(iVar5 + 0x18) < 8) {
      iVar5 = iVar5 + 4;
    }
    else {
      iVar5 = *(int *)(iVar5 + 4);
    }
    if (*(uint *)(iVar6 + 0x18) < 8) {
      iVar6 = iVar6 + 4;
    }
    else {
      iVar6 = *(int *)(iVar6 + 4);
    }
    uVar7 = FUN_00404750(iVar6,iVar5);
    local_c._0_1_ = 5;
    FUN_00405eb0(uVar7,0,0xffffffff);
    local_c._0_1_ = 4;
    FUN_00406560();
    local_c._0_1_ = 3;
    FUN_00406560();
    local_c._0_1_ = 2;
    FUN_00406560();
    local_c._0_1_ = 0;
    FUN_00406560();
    iVar5 = piVar4[4];
    piVar8 = (int *)FUN_004049b0(iVar5);
    if (piVar8 == (int *)0x0) {
      pwVar9 = L"AvaGuiNpcShop::ShopItemSellCheckDlg EquipData GBD PROTO ERROR %d ";
      goto LAB_00964262;
    }
    iVar5 = (**(code **)(*piVar8 + 0x40))();
    if (iVar5 == 0) {
      FUN_0040e750(piVar4,auStack_98);
      local_c = CONCAT31(local_c._1_3_,8);
      fStack_dc = (float)(**(code **)(*piVar4 + 0x20))();
      (**(code **)(*piVar4 + 0x30))();
      uVar1 = *(ushort *)(piVar8 + 0x14);
      if (uVar1 < 3) {
        uStack_e0 = FUN_009e7fa0(uVar1,fStack_dc);
      }
      else {
        uStack_e0 = (uint)uVar1;
      }
      local_c._0_1_ = 0;
      FUN_0040f3f0(auStack_98);
    }
    else {
      uStack_e0 = piVar8[0x14];
    }
    if (uStack_e0 == 0) {
LAB_0096440d:
      uStack_e0 = 1;
    }
    else {
      iVar5 = (**(code **)(*piStack_d8 + 0x48))();
      if (iVar5 != 0) goto LAB_0096440d;
    }
    piStack_d8 = (int *)FUN_008eb260(DAT_00d6f0f4);
    if (piStack_d8 == (int *)0x0) {
      FUN_008018d0(L"AvaGuiNpcShop::ShopItemSellCheckDlg NpcShop OpenKey ERROR");
    }
    else {
      uStack_20 = 7;
      uStack_24 = 0;
      uStack_34 = 0;
      local_c = CONCAT31(local_c._1_3_,9);
      fStack_dc = 1.0;
      iVar5 = FUN_00702910(piVar8[0x15],10000);
      iVar6 = FUN_004049b0(piStack_d8[0x1c]);
      if (iVar6 != 0) {
        fStack_dc = (float)*(ushort *)(iVar6 + 0x44) * 0.0001;
        iVar6 = FUN_00962140(piVar4[4]);
        if (iVar6 != 0) {
          iVar5 = iVar6;
        }
      }
      if (iVar5 == 0) {
        iVar5 = 1;
      }
      cVar2 = (**(code **)(*piVar4 + 0x30))();
      if (cVar2 != '\0') {
        iVar5 = 10;
      }
      if (param_5 != 0) {
        iVar5 = iVar5 * (uint)param_5;
      }
      uVar7 = FUN_0070c2d0(iVar5,0);
      local_c._0_1_ = 10;
      FUN_00405eb0(uVar7,0,0xffffffff);
      local_c._0_1_ = 9;
      FUN_00406560();
      iVar5 = (int)ABS((1.0 - fStack_dc) * 100.0);
      if (0 < iVar5) {
        FUN_00406460(L"IDS_APPLY_SELL_TAX");
        local_c._0_1_ = 0xb;
        iVar6 = FUN_0081d120(local_d0);
        local_c._0_1_ = 0xc;
        if (*(uint *)(iVar6 + 0x18) < 8) {
          iVar6 = iVar6 + 4;
        }
        else {
          iVar6 = *(int *)(iVar6 + 4);
        }
        uVar7 = FUN_00404750(iVar6,iVar5);
        local_c._0_1_ = 0xd;
        uVar7 = FUN_00403380(auStack_b4,uVar7);
        local_c._0_1_ = 0xe;
        FUN_00405c30(uVar7,0,0xffffffff);
        local_c._0_1_ = 0xd;
        FUN_00406560();
        local_c._0_1_ = 0xc;
        FUN_00406560();
        local_c._0_1_ = 0xb;
        FUN_00406560();
        local_c._0_1_ = 9;
        FUN_00406560();
      }
      FUN_00405c30(auStack_38,0,0xffffffff);
      iVar5 = FUN_008ede80(local_54,2);
      if (iVar5 != 0) {
        *(undefined4 *)(iVar5 + 0x74) = 0x20;
        if (*(code **)(iVar5 + 0x60) != (code *)0x0) {
          (**(code **)(iVar5 + 0x60))(1,iVar5);
        }
        *(code **)(iVar5 + 0x60) = FUN_009639e0;
      }
      local_c = (uint)local_c._1_3_ << 8;
      FUN_00406560();
    }
  }
  local_c = 0xffffffff;
  FUN_00406560();
LAB_009646a8:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_e4);
  return;
}



============================================================
DISASSEMBLY
============================================================
009640a0 : PUSH EBP
009640a1 : MOV EBP,ESP
009640a3 : AND ESP,0xfffffff8
009640a6 : PUSH -0x1
009640a8 : PUSH 0xb53cdd
009640ad : MOV EAX,FS:[0x0]
009640b3 : PUSH EAX
009640b4 : SUB ESP,0xd0
009640ba : MOV EAX,[0x00d66fa0]
009640bf : XOR EAX,ESP
009640c1 : MOV dword ptr [ESP + 0xc8],EAX
009640c8 : PUSH EBX
009640c9 : PUSH ESI
009640ca : PUSH EDI
009640cb : MOV EAX,[0x00d66fa0]
009640d0 : XOR EAX,ESP
009640d2 : PUSH EAX
009640d3 : LEA EAX,[ESP + 0xe0]
009640da : MOV FS:[0x0],EAX
009640e0 : MOV EBX,dword ptr [EBP + 0x8]
009640e3 : XOR ESI,ESI
009640e5 : PUSH ESI
009640e6 : XOR EAX,EAX
009640e8 : PUSH 0xc7a79c
009640ed : LEA ECX,[ESP + 0xa8]
009640f4 : MOV dword ptr [ESP + 0x28],EBX
009640f8 : MOV dword ptr [ESP + 0xc0],0x7
00964103 : MOV dword ptr [ESP + 0xbc],ESI
0096410a : MOV word ptr [ESP + 0xac],AX
00964112 : CALL 0x00406360
00964117 : MOV dword ptr [ESP + 0xe8],ESI
0096411e : MOV EDI,dword ptr [EBP + 0xc]
00964121 : MOV EAX,dword ptr [EBX + 0x4]
00964124 : CALL 0x008eb580
00964129 : CMP EAX,ESI
0096412b : JNZ 0x009641d6
00964131 : PUSH 0xc7a7a0
00964136 : LEA ECX,[ESP + 0x28]
0096413a : CALL 0x00406460
0096413f : MOV byte ptr [ESP + 0xe8],0x1
00964147 : MOV ECX,dword ptr [0x00da98e8]
0096414d : MOV ECX,dword ptr [ECX]
0096414f : CMP ECX,ESI
00964151 : JZ 0x00964169
00964153 : MOV EDX,dword ptr [ECX]
00964155 : MOV EDX,dword ptr [EDX + 0x14]
00964158 : LEA EAX,[ESP + 0x24]
0096415c : PUSH EAX
0096415d : PUSH 0x6c9
00964162 : PUSH 0xc7a838
00964167 : CALL EDX
00964169 : MOV byte ptr [ESP + 0xe8],0x0
00964171 : MOV EBX,0x8
00964176 : CMP dword ptr [ESP + 0x3c],EBX
0096417a : JC 0x00964185
0096417c : MOV ECX,dword ptr [ESP + 0x28]
00964180 : CALL 0x006f04e0
00964185 : MOV EDI,0x7
0096418a : XOR EAX,EAX
0096418c : MOV dword ptr [ESP + 0x3c],EDI
00964190 : MOV dword ptr [ESP + 0x38],ESI
00964194 : MOV word ptr [ESP + 0x28],AX
00964199 : MOV dword ptr [ESP + 0xe8],0xffffffff
009641a4 : CMP dword ptr [ESP + 0xb8],EBX
009641ab : JC 0x009641b9
009641ad : MOV ECX,dword ptr [ESP + 0xa4]
009641b4 : CALL 0x006f04e0
009641b9 : XOR ECX,ECX
009641bb : MOV dword ptr [ESP + 0xb8],EDI
009641c2 : MOV dword ptr [ESP + 0xb4],ESI
009641c9 : MOV word ptr [ESP + 0xa4],CX
009641d1 : JMP 0x009646a8
009641d6 : MOV ECX,dword ptr [EBP + 0x14]
009641d9 : MOV EDX,dword ptr [EAX]
009641db : MOV EDX,dword ptr [EDX + 0x74]
009641de : PUSH ECX
009641df : MOV ECX,dword ptr [EBP + 0x10]
009641e2 : PUSH ECX
009641e3 : MOV ECX,EAX
009641e5 : CALL EDX
009641e7 : MOV EBX,EAX
009641e9 : CMP EBX,ESI
009641eb : JNZ 0x00964246
009641ed : MOV ESI,dword ptr [0x00da98e8]
009641f3 : PUSH 0xc7a880
009641f8 : CALL 0x008018d0
009641fd : ADD ESP,0x4
00964200 : MOV dword ptr [ESP + 0xe8],0xffffffff
0096420b : CMP dword ptr [ESP + 0xb8],0x8
00964213 : JC 0x00964221
00964215 : MOV ECX,dword ptr [ESP + 0xa4]
0096421c : CALL 0x006f04e0
00964221 : XOR EAX,EAX
00964223 : MOV dword ptr [ESP + 0xb8],0x7
0096422e : MOV dword ptr [ESP + 0xb4],0x0
00964239 : MOV word ptr [ESP + 0xa4],AX
00964241 : JMP 0x009646a8
00964246 : MOV ESI,dword ptr [EBX + 0x10]
00964249 : PUSH ESI
0096424a : CALL 0x004049b0
0096424f : MOV EDI,EAX
00964251 : ADD ESP,0x4
00964254 : MOV dword ptr [ESP + 0x1c],EDI
00964258 : TEST EDI,EDI
0096425a : JNZ 0x00964280
0096425c : PUSH ESI
0096425d : PUSH 0xc7a900
00964262 : MOV ESI,dword ptr [0x00da98e8]
00964268 : CALL 0x008018d0
0096426d : ADD ESP,0x8
00964270 : MOV dword ptr [ESP + 0xe8],0xffffffff
0096427b : JMP 0x0096469c
00964280 : PUSH 0xc7a970
00964285 : LEA ECX,[ESP + 0x28]
00964289 : CALL 0x00406460
0096428e : MOV byte ptr [ESP + 0xe8],0x2
00964296 : MOV ECX,dword ptr [0x0172491c]
0096429c : PUSH 0x0
0096429e : LEA EDX,[EDI + 0x18]
009642a1 : PUSH ECX
009642a2 : LEA ESI,[ESP + 0x48]
009642a6 : CALL 0x00824a20
009642ab : MOV ESI,EAX
009642ad : MOV byte ptr [ESP + 0xe8],0x3
009642b5 : MOV ECX,dword ptr [0x0172491c]
009642bb : LEA EDX,[ESP + 0x24]
009642bf : PUSH EDX
009642c0 : LEA EDI,[ESP + 0x88]
009642c7 : CALL 0x0081d120
009642cc : MOV byte ptr [ESP + 0xe8],0x4
009642d4 : MOV ECX,0x8
009642d9 : CMP dword ptr [ESI + 0x18],ECX
009642dc : JC 0x009642e3
009642de : MOV ESI,dword ptr [ESI + 0x4]
009642e1 : JMP 0x009642e6
009642e3 : ADD ESI,0x4
009642e6 : CMP dword ptr [EAX + 0x18],ECX
009642e9 : JC 0x009642f0
009642eb : MOV EAX,dword ptr [EAX + 0x4]
009642ee : JMP 0x009642f3
009642f0 : ADD EAX,0x4
009642f3 : PUSH ESI
009642f4 : PUSH EAX
009642f5 : LEA ESI,[ESP + 0x70]
009642f9 : CALL 0x00404750
009642fe : ADD ESP,0x8
00964301 : MOV byte ptr [ESP + 0xe8],0x5
00964309 : PUSH -0x1
0096430b : PUSH 0x0
0096430d : PUSH EAX
0096430e : LEA ECX,[ESP + 0xac]
00964315 : CALL 0x00405eb0
0096431a : MOV byte ptr [ESP + 0xe8],0x4
00964322 : MOV ECX,ESI
00964324 : CALL 0x00406560
00964329 : MOV byte ptr [ESP + 0xe8],0x3
00964331 : LEA ECX,[ESP + 0x84]
00964338 : CALL 0x00406560
0096433d : MOV byte ptr [ESP + 0xe8],0x2
00964345 : LEA ECX,[ESP + 0x40]
00964349 : CALL 0x00406560
0096434e : MOV byte ptr [ESP + 0xe8],0x0
00964356 : LEA ECX,[ESP + 0x24]
0096435a : CALL 0x00406560
0096435f : MOV ESI,dword ptr [EBX + 0x10]
00964362 : PUSH ESI
00964363 : CALL 0x004049b0
00964368 : MOV EDI,EAX
0096436a : ADD ESP,0x4
0096436d : TEST EDI,EDI
0096436f : JNZ 0x0096437c
00964371 : PUSH ESI
00964372 : PUSH 0xc7a9b0
00964377 : JMP 0x00964262
0096437c : MOV EAX,dword ptr [EDI]
0096437e : MOV EDX,dword ptr [EAX + 0x40]
00964381 : MOV ECX,EDI
00964383 : CALL EDX
00964385 : TEST EAX,EAX
00964387 : JZ 0x00964392
00964389 : MOV EAX,dword ptr [EDI + 0x50]
0096438c : MOV dword ptr [ESP + 0x14],EAX
00964390 : JMP 0x009643f7
00964392 : LEA ECX,[ESP + 0x5c]
00964396 : PUSH ECX
00964397 : PUSH EBX
00964398 : CALL 0x0040e750
0096439d : MOV byte ptr [ESP + 0xe8],0x8
009643a5 : MOV EDX,dword ptr [EBX]
009643a7 : MOV ESI,dword ptr [EAX + 0x8]
009643aa : MOV EAX,dword ptr [EDX + 0x20]
009643ad : MOV ECX,EBX
009643af : CALL EAX
009643b1 : MOV EDX,dword ptr [EBX]
009643b3 : MOV dword ptr [ESP + 0x18],EAX
009643b7 : MOV EAX,dword ptr [EDX + 0x30]
009643ba : MOV ECX,EBX
009643bc : CALL EAX
009643be : MOVZX EAX,word ptr [EDI + 0x50]
009643c2 : CMP AX,0x2
009643c6 : JA 0x009643de
009643c8 : MOV ECX,dword ptr [ESP + 0x18]
009643cc : PUSH ECX
009643cd : PUSH EAX
009643ce : MOV EAX,ESI
009643d0 : CALL 0x009e7fa0
009643d5 : ADD ESP,0x8
009643d8 : MOV dword ptr [ESP + 0x14],EAX
009643dc : JMP 0x009643e5
009643de : MOVZX EDX,AX
009643e1 : MOV dword ptr [ESP + 0x14],EDX
009643e5 : MOV byte ptr [ESP + 0xe8],0x0
009643ed : LEA EAX,[ESP + 0x5c]
009643f1 : PUSH EAX
009643f2 : CALL 0x0040f3f0
009643f7 : CMP dword ptr [ESP + 0x14],0x0
009643fc : JZ 0x0096440d
009643fe : MOV ECX,dword ptr [ESP + 0x1c]
00964402 : MOV EDX,dword ptr [ECX]
00964404 : MOV EAX,dword ptr [EDX + 0x48]
00964407 : CALL EAX
00964409 : TEST EAX,EAX
0096440b : JZ 0x00964415
0096440d : MOV dword ptr [ESP + 0x14],0x1
00964415 : MOV ECX,dword ptr [0x00da9894]
0096441b : MOV EDX,dword ptr [0x00d6f0f4]
00964421 : MOV ESI,dword ptr [ECX]
00964423 : PUSH EDX
00964424 : CALL 0x008eb260
00964429 : MOV dword ptr [ESP + 0x1c],EAX
0096442d : TEST EAX,EAX
0096442f : JNZ 0x00964454
00964431 : MOV ESI,dword ptr [0x00da98e8]
00964437 : PUSH 0xc7aa38
0096443c : CALL 0x008018d0
00964441 : ADD ESP,0x4
00964444 : MOV dword ptr [ESP + 0xe8],0xffffffff
0096444f : JMP 0x0096469c
00964454 : XOR EAX,EAX
00964456 : MOV dword ptr [ESP + 0xd4],0x7
00964461 : MOV dword ptr [ESP + 0xd0],0x0
0096446c : MOV word ptr [ESP + 0xc0],AX
00964474 : MOV byte ptr [ESP + 0xe8],0x9
0096447c : MOV ECX,dword ptr [EDI + 0x54]
0096447f : MOVSS XMM0,dword ptr [0x00c10fc4]
00964487 : MOV EAX,dword ptr [ESP + 0x14]
0096448b : PUSH 0x2710
00964490 : PUSH ECX
00964491 : MOVSS dword ptr [ESP + 0x20],XMM0
00964497 : CALL 0x00702910
0096449c : MOV EDX,dword ptr [ESP + 0x24]
009644a0 : MOV ESI,EAX
009644a2 : MOV EAX,dword ptr [EDX + 0x70]
009644a5 : PUSH EAX
009644a6 : CALL 0x004049b0
009644ab : ADD ESP,0xc
009644ae : TEST EAX,EAX
009644b0 : JZ 0x009644db
009644b2 : MOVZX EAX,word ptr [EAX + 0x44]
009644b6 : MOV EDI,dword ptr [ESP + 0x20]
009644ba : CVTSI2SS XMM0,EAX
009644be : MOV EAX,dword ptr [EBX + 0x10]
009644c1 : MULSS XMM0,dword ptr [0x00cdf398]
009644c9 : PUSH EAX
009644ca : MOVSS dword ptr [ESP + 0x1c],XMM0
009644d0 : CALL 0x00962140
009644d5 : TEST EAX,EAX
009644d7 : JBE 0x009644db
009644d9 : MOV ESI,EAX
009644db : TEST ESI,ESI
009644dd : JA 0x009644e4
009644df : MOV ESI,0x1
009644e4 : MOV EDX,dword ptr [EBX]
009644e6 : MOV EAX,dword ptr [EDX + 0x30]
009644e9 : MOV ECX,EBX
009644eb : CALL EAX
009644ed : TEST AL,AL
009644ef : JZ 0x009644f6
009644f1 : MOV ESI,0xa
009644f6 : MOV AX,word ptr [EBP + 0x18]
009644fa : XOR ECX,ECX
009644fc : CMP CX,AX
009644ff : JNC 0x00964507
00964501 : MOVZX EDX,AX
00964504 : IMUL ESI,EDX
00964507 : PUSH 0x0
00964509 : PUSH ESI
0096450a : LEA ECX,[ESP + 0x48]
0096450e : CALL 0x0070c2d0
00964513 : ADD ESP,0x8
00964516 : MOV byte ptr [ESP + 0xe8],0xa
0096451e : PUSH -0x1
00964520 : PUSH 0x0
00964522 : PUSH EAX
00964523 : LEA ECX,[ESP + 0xc8]
0096452a : CALL 0x00405eb0
0096452f : MOV byte ptr [ESP + 0xe8],0x9
00964537 : LEA ECX,[ESP + 0x40]
0096453b : CALL 0x00406560
00964540 : MOVSS XMM0,dword ptr [0x00c10fc4]
00964548 : SUBSS XMM0,dword ptr [ESP + 0x18]
0096454e : MULSS XMM0,dword ptr [0x00cdf230]
00964556 : MOVSS XMM1,dword ptr [0x00cdf350]
0096455e : ANDPS XMM0,XMM1
00964561 : CVTTSS2SI ESI,XMM0
00964565 : TEST ESI,ESI
00964567 : JLE 0x00964631
0096456d : PUSH 0xc7aaac
00964572 : LEA ECX,[ESP + 0x28]
00964576 : CALL 0x00406460
0096457b : MOV byte ptr [ESP + 0xe8],0xb
00964583 : MOV ECX,dword ptr [0x0172491c]
00964589 : LEA EAX,[ESP + 0x24]
0096458d : PUSH EAX
0096458e : LEA EDI,[ESP + 0x6c]
00964592 : CALL 0x0081d120
00964597 : MOV byte ptr [ESP + 0xe8],0xc
0096459f : CMP dword ptr [EAX + 0x18],0x8
009645a3 : JC 0x009645aa
009645a5 : MOV EAX,dword ptr [EAX + 0x4]
009645a8 : JMP 0x009645ad
009645aa : ADD EAX,0x4
009645ad : PUSH ESI
009645ae : PUSH EAX
009645af : LEA ESI,[ESP + 0x8c]
009645b6 : CALL 0x00404750
009645bb : MOV BL,0xd
009645bd : MOV byte ptr [ESP + 0xf0],BL
009645c4 : PUSH EAX
009645c5 : LEA ECX,[ESP + 0x4c]
009645c9 : PUSH ECX
009645ca : MOV EDX,0xc7aa34
009645cf : CALL 0x00403380
009645d4 : ADD ESP,0x10
009645d7 : MOV byte ptr [ESP + 0xe8],0xe
009645df : PUSH -0x1
009645e1 : PUSH 0x0
009645e3 : PUSH EAX
009645e4 : LEA ECX,[ESP + 0xc8]
009645eb : CALL 0x00405c30
009645f0 : MOV byte ptr [ESP + 0xe8],BL
009645f7 : LEA ECX,[ESP + 0x40]
009645fb : CALL 0x00406560
00964600 : MOV byte ptr [ESP + 0xe8],0xc
00964608 : MOV ECX,ESI
0096460a : CALL 0x00406560
0096460f : MOV byte ptr [ESP + 0xe8],0xb
00964617 : LEA ECX,[ESP + 0x68]
0096461b : CALL 0x00406560
00964620 : MOV byte ptr [ESP + 0xe8],0x9
00964628 : LEA ECX,[ESP + 0x24]
0096462c : CALL 0x00406560
00964631 : OR EDI,0xffffffff
00964634 : PUSH EDI
00964635 : PUSH 0x0
00964637 : LEA EDX,[ESP + 0xc4]
0096463e : PUSH EDX
0096463f : LEA ECX,[ESP + 0xac]
00964646 : CALL 0x00405c30
0096464b : MOV EAX,[0x00da9894]
00964650 : MOV ECX,dword ptr [EAX]
00964652 : PUSH 0x2
00964654 : LEA EDX,[ESP + 0xa4]
0096465b : PUSH EDX
0096465c : CALL 0x008ede80
00964661 : MOV ESI,EAX
00964663 : TEST ESI,ESI
00964665 : JZ 0x00964681
00964667 : MOV EAX,dword ptr [ESI + 0x60]
0096466a : MOV dword ptr [ESI + 0x74],0x20
00964671 : TEST EAX,EAX
00964673 : JZ 0x0096467a
00964675 : PUSH ESI
00964676 : PUSH 0x1
00964678 : CALL EAX
0096467a : MOV dword ptr [ESI + 0x60],0x9639e0
00964681 : MOV byte ptr [ESP + 0xe8],0x0
00964689 : LEA ECX,[ESP + 0xbc]
00964690 : CALL 0x00406560
00964695 : MOV dword ptr [ESP + 0xe8],EDI
0096469c : LEA ECX,[ESP + 0xa0]
009646a3 : CALL 0x00406560
009646a8 : MOV ECX,dword ptr [ESP + 0xe0]
009646af : MOV dword ptr FS:[0x0],ECX
009646b6 : POP ECX
009646b7 : POP EDI
009646b8 : POP ESI
009646b9 : POP EBX
009646ba : MOV ECX,dword ptr [ESP + 0xc8]
009646c1 : XOR ECX,ESP
009646c3 : CALL 0x00633e6b
009646c8 : MOV ESP,EBP
009646ca : POP EBP
009646cb : RET 0x14

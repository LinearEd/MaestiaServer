PROGRAM  : Maestia.exe
FUNCTION : FUN_006cc9b0
ENTRY    : 006cc9b0
BODY     : [[006cc9b0, 006cca2e]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006cc9b0(int param_1,uint param_2,uint param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  uVar1 = *(undefined4 *)(param_1 + 0x6c);
  if (param_1 == 0) {
    uVar2 = 0;
  }
  else if ((uint)(0xffffffff / (ulonglong)param_3) < param_2) {
    FUN_006c24c0(param_1,"Potential overflow in png_zalloc()");
    uVar2 = 0;
  }
  else {
    *(uint *)(param_1 + 0x6c) = *(uint *)(param_1 + 0x6c) | 0x100000;
    uVar2 = FUN_006cee20(param_1,param_2 * param_3);
    *(undefined4 *)(param_1 + 0x6c) = uVar1;
  }
  return uVar2;
}



============================================================
DISASSEMBLY
============================================================
006cc9b0 : PUSH EBP
006cc9b1 : MOV EBP,ESP
006cc9b3 : SUB ESP,0x10
006cc9b6 : MOV EAX,dword ptr [EBP + 0x8]
006cc9b9 : MOV dword ptr [EBP + -0x4],EAX
006cc9bc : MOV ECX,dword ptr [EBP + -0x4]
006cc9bf : MOV EDX,dword ptr [ECX + 0x6c]
006cc9c2 : MOV dword ptr [EBP + -0x10],EDX
006cc9c5 : CMP dword ptr [EBP + 0x8],0x0
006cc9c9 : JNZ 0x006cc9cf
006cc9cb : XOR EAX,EAX
006cc9cd : JMP 0x006cca2b
006cc9cf : OR EAX,0xffffffff
006cc9d2 : XOR EDX,EDX
006cc9d4 : DIV dword ptr [EBP + 0x10]
006cc9d7 : CMP dword ptr [EBP + 0xc],EAX
006cc9da : JBE 0x006cc9f1
006cc9dc : PUSH 0xbeda38
006cc9e1 : MOV EAX,dword ptr [EBP + -0x4]
006cc9e4 : PUSH EAX
006cc9e5 : CALL 0x006c24c0
006cc9ea : ADD ESP,0x8
006cc9ed : XOR EAX,EAX
006cc9ef : JMP 0x006cca2b
006cc9f1 : MOV ECX,dword ptr [EBP + 0xc]
006cc9f4 : IMUL ECX,dword ptr [EBP + 0x10]
006cc9f8 : MOV dword ptr [EBP + -0xc],ECX
006cc9fb : MOV EDX,dword ptr [EBP + -0x4]
006cc9fe : MOV EAX,dword ptr [EDX + 0x6c]
006cca01 : OR EAX,0x100000
006cca06 : MOV ECX,dword ptr [EBP + -0x4]
006cca09 : MOV dword ptr [ECX + 0x6c],EAX
006cca0c : MOV EDX,dword ptr [EBP + -0xc]
006cca0f : PUSH EDX
006cca10 : MOV EAX,dword ptr [EBP + 0x8]
006cca13 : PUSH EAX
006cca14 : CALL 0x006cee20
006cca19 : ADD ESP,0x8
006cca1c : MOV dword ptr [EBP + -0x8],EAX
006cca1f : MOV ECX,dword ptr [EBP + -0x4]
006cca22 : MOV EDX,dword ptr [EBP + -0x10]
006cca25 : MOV dword ptr [ECX + 0x6c],EDX
006cca28 : MOV EAX,dword ptr [EBP + -0x8]
006cca2b : MOV ESP,EBP
006cca2d : POP EBP
006cca2e : RET

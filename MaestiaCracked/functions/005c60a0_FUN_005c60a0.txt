PROGRAM  : Maestia.exe
FUNCTION : FUN_005c60a0
ENTRY    : 005c60a0
BODY     : [[005c60a0, 005c6604]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005c60a0(int param_1)

{
  undefined *puVar1;
  undefined4 uVar2;
  undefined1 *puVar3;
  char cVar4;
  undefined **ppuVar5;
  int iVar6;
  int *piVar7;
  LONG LVar8;
  int iVar9;
  int iVar10;
  GRefCountImpl *this;
  undefined **ppuVar11;
  int unaff_ESI;
  uint uVar12;
  code *pcVar13;
  uint uStack_54;
  uint local_50;
  uint local_4c;
  uint local_48;
  undefined **local_44;
  undefined4 *local_40;
  undefined **local_3c;
  int local_38;
  int iStack_34;
  int iStack_30;
  uint local_2c;
  int local_28;
  byte local_24;
  undefined **local_20;
  undefined4 local_1c;
  undefined4 local_18;
  int local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  GRefCountImpl *local_4;
  
  if (*(int *)(param_1 + 0x1c) < 1) {
    return;
  }
  uVar2 = *(undefined4 *)(param_1 + 0x18);
  FUN_00526260(0);
  FUN_005272e0(&local_40,uVar2,0xffffffff,0);
  ppuVar5 = (undefined **)FUN_00525380(&DAT_00cca874,0,0);
  ppuVar5[2] = ppuVar5[2] + 1;
  ppuVar11 = ppuVar5;
  local_44 = ppuVar5;
  if (1 < *(int *)(param_1 + 0x1c)) {
    uVar2 = *(undefined4 *)(param_1 + 0x18);
    FUN_00526260(1);
    FUN_005272e0(&local_3c,uVar2,0xffffffff,0);
    ppuVar11 = local_3c;
    local_3c[2] = local_3c[2] + 1;
    ppuVar5 = ppuVar5 + 2;
    *ppuVar5 = *ppuVar5 + -1;
    if (*ppuVar5 == (undefined *)0x0) {
      FUN_00525340();
    }
    local_3c[2] = local_3c[2] + -1;
    local_44 = ppuVar11;
    if (local_3c[2] == (undefined *)0x0) {
      FUN_00525340();
    }
  }
  FUN_0051c480(*local_40);
  FUN_0051c480(*ppuVar11);
  local_50 = FUN_00525450((local_4c & 0xfffffffc) + 8,*(uint *)(local_4c & 0xfffffffc) & 0x7fffffff)
  ;
  *(int *)(local_50 + 8) = *(int *)(local_50 + 8) + 1;
  FUN_00525970(&DAT_00b8eeb8);
  FUN_00525970((local_48 & 0xfffffffc) + 8);
  FUN_0052e7f0(&local_2c,0x2a);
  iVar9 = *(int *)(local_2c + 0x34);
  local_38 = local_2c + 0x34;
  if (iVar9 == 0) {
LAB_005c62b9:
    iVar9 = *(int *)(*(int *)(param_1 + 0x18) + 0x78);
    iVar9 = FUN_005324f0(*(undefined4 *)(iVar9 + 0x2a0),iVar9 + 0xb0,0,0xffffffff);
    cVar4 = FUN_005c3c30(&local_48,&local_4c);
    if (cVar4 != '\0') {
      iVar6 = *(int *)(*(int *)(param_1 + 0x18) + 0x78);
      iVar6 = FUN_005324f0(*(undefined4 *)(iVar6 + 0x2a0),iVar6 + 0xc,0,0xffffffff);
      local_18 = *(undefined4 *)(param_1 + 0x18);
      local_1c = 1;
      local_20 = &PTR_FUN_00b91d20;
      local_10 = 0;
      local_c = 0;
      local_8 = 0;
      local_4 = (GRefCountImpl *)((uint)local_4 & 0xffffff00);
      local_14 = iVar6;
      iVar10 = FUN_005296a0();
      (**(code **)(*(int *)(iVar10 + 8) + 0xc))(0x25);
      iVar10 = FUN_005296a0();
      this = (GRefCountImpl *)(**(code **)(*(int *)(iVar10 + 8) + 0xc))(10);
      if (this != (GRefCountImpl *)0x0) {
        GRefCountImpl::Release(this);
      }
      if ((local_4 == (GRefCountImpl *)0x0) ||
         (cVar4 = (**(code **)(*(int *)local_4 + 4))(&local_50,&uStack_54,&local_28,this),
         cVar4 == '\0')) {
        puVar3 = *(undefined1 **)(param_1 + 4);
        FUN_00526400();
        *puVar3 = 1;
        if (local_4 != (GRefCountImpl *)0x0) {
          GRefCountImpl::Release(local_4);
        }
        FUN_00515cf0(local_18);
        GRefCountImplCore::~GRefCountImplCore((GRefCountImplCore *)&local_28);
        if (iVar6 != 0) {
          FUN_00503db0();
        }
        if (iVar9 != 0) {
          FUN_00503db0();
        }
        if (((local_2c & 2) == 0) && (iStack_34 != 0)) {
          FUN_00503db0();
        }
        iStack_34 = 0;
        if (((local_2c & 1) == 0) && (iStack_30 != 0)) {
          FUN_00503db0();
        }
        piVar7 = (int *)(unaff_ESI + 8);
        iStack_30 = 0;
        *piVar7 = *piVar7 + -1;
        if (*piVar7 == 0) {
          FUN_00525340();
        }
        uVar12 = uStack_54 & 0xfffffffc;
        LVar8 = InterlockedExchangeAdd((LONG *)(uVar12 + 4),-1);
        if (LVar8 == 1) {
          FUN_00515cf0(uVar12);
        }
        uVar12 = local_50 & 0xfffffffc;
        LVar8 = InterlockedExchangeAdd((LONG *)(uVar12 + 4),-1);
        if (LVar8 == 1) {
          FUN_00515cf0(uVar12);
        }
      }
      else {
        FUN_005c3db0(*(undefined4 *)(param_1 + 0x18),iVar6);
        FUN_005271c0(iVar9);
        if (iVar9 != 0) {
          *(uint *)(iVar9 + 8) = *(int *)(iVar9 + 8) + 1U & 0x8fffffff;
        }
        local_3c = &PTR_FUN_00b91c9c;
        local_38 = iVar9;
        FUN_005c6070(&stack0xffffffa8,&local_3c);
        local_3c = &PTR_FUN_00b91c9c;
        if (local_38 != 0) {
          FUN_00503db0();
        }
        GRefCountImpl::Release(local_4);
        FUN_005c47b0();
        if (iVar6 != 0) {
          FUN_00503db0();
        }
        if (iVar9 != 0) {
          FUN_00503db0();
        }
        if (((local_2c & 2) == 0) && (iStack_34 != 0)) {
          FUN_00503db0();
        }
        iStack_34 = 0;
        if (((local_2c & 1) == 0) && (iStack_30 != 0)) {
          FUN_00503db0();
        }
        piVar7 = (int *)(unaff_ESI + 8);
        iStack_30 = 0;
        *piVar7 = *piVar7 + -1;
        if (*piVar7 == 0) {
          FUN_00525340();
        }
        FUN_0045b730();
        FUN_0045b730();
      }
      piVar7 = (int *)(local_4c + 8);
      *piVar7 = *piVar7 + -1;
      puVar1 = (undefined *)*piVar7;
      goto joined_r0x005c65e1;
    }
    puVar3 = *(undefined1 **)(param_1 + 4);
    FUN_00526400();
    *puVar3 = 1;
    if (iVar9 != 0) {
      FUN_00503db0();
    }
    if (((local_24 & 2) == 0) && (local_2c != 0)) {
      FUN_00503db0();
    }
    local_2c = 0;
    if (((local_24 & 1) == 0) && (local_28 != 0)) {
      FUN_00503db0();
    }
    piVar7 = (int *)(local_50 + 8);
    local_28 = 0;
    *piVar7 = *piVar7 + -1;
    if (*piVar7 == 0) {
      FUN_00525340();
    }
    pcVar13 = InterlockedExchangeAdd_exref;
    LVar8 = InterlockedExchangeAdd((LONG *)((local_4c & 0xfffffffc) + 4),-1);
    if (LVar8 == 1) {
      FUN_00515cf0(local_4c & 0xfffffffc);
    }
  }
  else {
    uStack_54 = uStack_54 & 0xffffff;
    iVar6 = FUN_00504190(&local_50,*(uint *)(iVar9 + 4) & *(uint *)(local_50 + 0xc));
    if (((iVar6 < 0) || (iVar9 = iVar6 * 0x10 + 0xc + iVar9, iVar9 == 0)) || (iVar9 == -4))
    goto LAB_005c62b9;
    FUN_005271c0(*(undefined4 *)(iVar9 + 8));
    if (((local_24 & 2) == 0) && (local_2c != 0)) {
      FUN_00503db0();
    }
    local_2c = 0;
    if (((local_24 & 1) == 0) && (local_28 != 0)) {
      FUN_00503db0();
    }
    piVar7 = (int *)(local_50 + 8);
    local_28 = 0;
    *piVar7 = *piVar7 + -1;
    if (*piVar7 == 0) {
      FUN_00525340();
    }
    pcVar13 = InterlockedExchangeAdd_exref;
    LVar8 = InterlockedExchangeAdd((LONG *)((local_4c & 0xfffffffc) + 4),-1);
    if (LVar8 == 1) {
      FUN_00515cf0(local_4c & 0xfffffffc);
    }
  }
  uVar12 = local_48 & 0xfffffffc;
  iVar9 = (*pcVar13)(uVar12 + 4,0xffffffff);
  if (iVar9 == 1) {
    FUN_00515cf0(uVar12);
  }
  ppuVar11 = ppuVar11 + 2;
  *ppuVar11 = *ppuVar11 + -1;
  puVar1 = *ppuVar11;
joined_r0x005c65e1:
  if (puVar1 == (undefined *)0x0) {
    FUN_00525340();
  }
  *(int *)(local_48 + 8) = *(int *)(local_48 + 8) + -1;
  if (*(int *)(local_48 + 8) == 0) {
    FUN_00525340();
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005c60a0 : SUB ESP,0x54
005c60a3 : PUSH ESI
005c60a4 : MOV ESI,dword ptr [ESP + 0x5c]
005c60a8 : CMP dword ptr [ESI + 0x1c],0x1
005c60ac : JL 0x005c6600
005c60b2 : PUSH EBX
005c60b3 : PUSH EBP
005c60b4 : PUSH EDI
005c60b5 : MOV EDI,dword ptr [ESI + 0x18]
005c60b8 : XOR EBP,EBP
005c60ba : PUSH EBP
005c60bb : MOV ECX,ESI
005c60bd : CALL 0x00526260
005c60c2 : PUSH EBP
005c60c3 : PUSH -0x1
005c60c5 : PUSH EDI
005c60c6 : LEA ECX,[ESP + 0x30]
005c60ca : PUSH ECX
005c60cb : MOV ECX,EAX
005c60cd : CALL 0x005272e0
005c60d2 : MOV EDX,dword ptr [ESI + 0x18]
005c60d5 : MOV EAX,dword ptr [EDX + 0x78]
005c60d8 : PUSH EBP
005c60d9 : PUSH EBP
005c60da : PUSH 0xcca874
005c60df : LEA ECX,[EAX + 0x254]
005c60e5 : CALL 0x00525380
005c60ea : MOV EBX,EAX
005c60ec : MOV EAX,0x1
005c60f1 : ADD dword ptr [EBX + 0x8],EAX
005c60f4 : CMP dword ptr [ESI + 0x1c],EAX
005c60f7 : MOV dword ptr [ESP + 0x20],EBX
005c60fb : JLE 0x005c6149
005c60fd : MOV EDI,dword ptr [ESI + 0x18]
005c6100 : PUSH EAX
005c6101 : MOV ECX,ESI
005c6103 : CALL 0x00526260
005c6108 : PUSH EBP
005c6109 : PUSH -0x1
005c610b : PUSH EDI
005c610c : LEA ECX,[ESP + 0x34]
005c6110 : PUSH ECX
005c6111 : MOV ECX,EAX
005c6113 : CALL 0x005272e0
005c6118 : MOV EAX,dword ptr [ESP + 0x28]
005c611c : INC dword ptr [EAX + 0x8]
005c611f : ADD dword ptr [EBX + 0x8],-0x1
005c6123 : MOV EDI,EAX
005c6125 : JNZ 0x005c612e
005c6127 : MOV ECX,EBX
005c6129 : CALL 0x00525340
005c612e : MOV EAX,dword ptr [ESP + 0x28]
005c6132 : DEC dword ptr [EAX + 0x8]
005c6135 : MOV ECX,EAX
005c6137 : ADD EAX,0x8
005c613a : MOV dword ptr [ESP + 0x20],EDI
005c613e : CMP dword ptr [EAX],EBP
005c6140 : JNZ 0x005c6147
005c6142 : CALL 0x00525340
005c6147 : MOV EBX,EDI
005c6149 : MOV EDX,dword ptr [ESP + 0x24]
005c614d : MOV EAX,dword ptr [EDX]
005c614f : PUSH EAX
005c6150 : LEA ECX,[ESP + 0x20]
005c6154 : CALL 0x0051c480
005c6159 : MOV ECX,dword ptr [EBX]
005c615b : PUSH ECX
005c615c : LEA ECX,[ESP + 0x1c]
005c6160 : CALL 0x0051c480
005c6165 : MOV EAX,dword ptr [ESP + 0x18]
005c6169 : MOV EDX,dword ptr [ESI + 0x18]
005c616c : MOV EDX,dword ptr [EDX + 0x78]
005c616f : MOV ECX,EAX
005c6171 : AND ECX,0xfffffffc
005c6174 : MOV ECX,dword ptr [ECX]
005c6176 : AND ECX,0x7fffffff
005c617c : AND EAX,0xfffffffc
005c617f : PUSH ECX
005c6180 : ADD EAX,0x8
005c6183 : PUSH EAX
005c6184 : LEA ECX,[EDX + 0x254]
005c618a : CALL 0x00525450
005c618f : MOV dword ptr [ESP + 0x14],EAX
005c6193 : INC dword ptr [EAX + 0x8]
005c6196 : PUSH 0xb8eeb8
005c619b : LEA ECX,[ESP + 0x18]
005c619f : CALL 0x00525970
005c61a4 : MOV EDX,dword ptr [ESP + 0x1c]
005c61a8 : AND EDX,0xfffffffc
005c61ab : ADD EDX,0x8
005c61ae : PUSH EDX
005c61af : LEA ECX,[ESP + 0x18]
005c61b3 : CALL 0x00525970
005c61b8 : MOV ECX,dword ptr [ESI + 0x18]
005c61bb : PUSH 0x2a
005c61bd : LEA EAX,[ESP + 0x3c]
005c61c1 : PUSH EAX
005c61c2 : CALL 0x0052e7f0
005c61c7 : MOV ECX,dword ptr [ESP + 0x38]
005c61cb : MOV EDI,dword ptr [ECX + 0x34]
005c61ce : ADD ECX,0x34
005c61d1 : MOV dword ptr [ESP + 0x2c],ECX
005c61d5 : CMP EDI,EBP
005c61d7 : JZ 0x005c62b9
005c61dd : MOV EAX,dword ptr [ESP + 0x14]
005c61e1 : MOV EDX,dword ptr [EDI + 0x4]
005c61e4 : AND EDX,dword ptr [EAX + 0xc]
005c61e7 : MOV byte ptr [ESP + 0x68],0x0
005c61ec : PUSH EDX
005c61ed : LEA EDX,[ESP + 0x18]
005c61f1 : PUSH EDX
005c61f2 : MOV byte ptr [ESP + 0x1b],0x0
005c61f7 : CALL 0x00504190
005c61fc : CMP EAX,EBP
005c61fe : JL 0x005c62b9
005c6204 : SHL EAX,0x4
005c6207 : LEA EDI,[EAX + EDI*0x1 + 0xc]
005c620b : CMP EDI,EBP
005c620d : JZ 0x005c62b9
005c6213 : LEA EAX,[EDI + 0x4]
005c6216 : CMP EAX,EBP
005c6218 : JZ 0x005c62b9
005c621e : MOV EAX,dword ptr [EAX + 0x4]
005c6221 : MOV ECX,dword ptr [ESI + 0x4]
005c6224 : PUSH EAX
005c6225 : CALL 0x005271c0
005c622a : TEST byte ptr [ESP + 0x40],0x2
005c622f : JNZ 0x005c623e
005c6231 : MOV ECX,dword ptr [ESP + 0x38]
005c6235 : CMP ECX,EBP
005c6237 : JZ 0x005c623e
005c6239 : CALL 0x00503db0
005c623e : TEST byte ptr [ESP + 0x40],0x1
005c6243 : MOV dword ptr [ESP + 0x38],EBP
005c6247 : JNZ 0x005c6256
005c6249 : MOV ECX,dword ptr [ESP + 0x3c]
005c624d : CMP ECX,EBP
005c624f : JZ 0x005c6256
005c6251 : CALL 0x00503db0
005c6256 : MOV EAX,dword ptr [ESP + 0x14]
005c625a : MOV ECX,EAX
005c625c : ADD EAX,0x8
005c625f : MOV dword ptr [ESP + 0x3c],EBP
005c6263 : DEC dword ptr [EAX]
005c6265 : CMP dword ptr [EAX],EBP
005c6267 : JNZ 0x005c626e
005c6269 : CALL 0x00525340
005c626e : MOV ESI,dword ptr [ESP + 0x18]
005c6272 : MOV EDI,dword ptr [0x00b851cc]
005c6278 : AND ESI,0xfffffffc
005c627b : PUSH -0x1
005c627d : LEA ECX,[ESI + 0x4]
005c6280 : PUSH ECX
005c6281 : CALL EDI
005c6283 : SUB EAX,0x1
005c6286 : JNZ 0x005c628e
005c6288 : PUSH ESI
005c6289 : CALL 0x00515cf0
005c628e : MOV ESI,dword ptr [ESP + 0x1c]
005c6292 : AND ESI,0xfffffffc
005c6295 : PUSH -0x1
005c6297 : LEA EDX,[ESI + 0x4]
005c629a : PUSH EDX
005c629b : CALL EDI
005c629d : SUB EAX,0x1
005c62a0 : JNZ 0x005c62a8
005c62a2 : PUSH ESI
005c62a3 : CALL 0x00515cf0
005c62a8 : ADD dword ptr [EBX + 0x8],-0x1
005c62ac : JNZ 0x005c65e8
005c62b2 : MOV ECX,EBX
005c62b4 : JMP 0x005c65e3
005c62b9 : MOV ECX,dword ptr [ESI + 0x18]
005c62bc : MOV EAX,dword ptr [ECX + 0x78]
005c62bf : PUSH -0x1
005c62c1 : MOV EDX,EAX
005c62c3 : MOV EDX,dword ptr [EDX + 0x2a0]
005c62c9 : PUSH EBP
005c62ca : ADD EAX,0xb0
005c62cf : PUSH EAX
005c62d0 : PUSH EDX
005c62d1 : CALL 0x005324f0
005c62d6 : MOV EDI,EAX
005c62d8 : LEA EAX,[ESP + 0x18]
005c62dc : PUSH EAX
005c62dd : LEA ECX,[ESP + 0x20]
005c62e1 : PUSH ECX
005c62e2 : MOV ECX,EDI
005c62e4 : CALL 0x005c3c30
005c62e9 : TEST AL,AL
005c62eb : JNZ 0x005c637f
005c62f1 : MOV ESI,dword ptr [ESI + 0x4]
005c62f4 : MOV ECX,ESI
005c62f6 : CALL 0x00526400
005c62fb : MOV byte ptr [ESI],0x1
005c62fe : CMP EDI,EBP
005c6300 : JZ 0x005c6309
005c6302 : MOV ECX,EDI
005c6304 : CALL 0x00503db0
005c6309 : TEST byte ptr [ESP + 0x40],0x2
005c630e : JNZ 0x005c631d
005c6310 : MOV ECX,dword ptr [ESP + 0x38]
005c6314 : CMP ECX,EBP
005c6316 : JZ 0x005c631d
005c6318 : CALL 0x00503db0
005c631d : TEST byte ptr [ESP + 0x40],0x1
005c6322 : MOV dword ptr [ESP + 0x38],EBP
005c6326 : JNZ 0x005c6335
005c6328 : MOV ECX,dword ptr [ESP + 0x3c]
005c632c : CMP ECX,EBP
005c632e : JZ 0x005c6335
005c6330 : CALL 0x00503db0
005c6335 : MOV EAX,dword ptr [ESP + 0x14]
005c6339 : MOV ECX,EAX
005c633b : ADD EAX,0x8
005c633e : MOV dword ptr [ESP + 0x3c],EBP
005c6342 : DEC dword ptr [EAX]
005c6344 : CMP dword ptr [EAX],EBP
005c6346 : JNZ 0x005c634d
005c6348 : CALL 0x00525340
005c634d : MOV ESI,dword ptr [ESP + 0x18]
005c6351 : MOV EDI,dword ptr [0x00b851cc]
005c6357 : AND ESI,0xfffffffc
005c635a : PUSH -0x1
005c635c : LEA EDX,[ESI + 0x4]
005c635f : PUSH EDX
005c6360 : CALL EDI
005c6362 : SUB EAX,0x1
005c6365 : JNZ 0x005c636d
005c6367 : PUSH ESI
005c6368 : CALL 0x00515cf0
005c636d : MOV ESI,dword ptr [ESP + 0x1c]
005c6371 : AND ESI,0xfffffffc
005c6374 : PUSH -0x1
005c6376 : LEA EAX,[ESI + 0x4]
005c6379 : PUSH EAX
005c637a : JMP 0x005c629b
005c637f : MOV ECX,dword ptr [ESI + 0x18]
005c6382 : MOV EAX,dword ptr [ECX + 0x78]
005c6385 : PUSH -0x1
005c6387 : MOV EDX,EAX
005c6389 : MOV EDX,dword ptr [EDX + 0x2a0]
005c638f : PUSH EBP
005c6390 : ADD EAX,0xc
005c6393 : PUSH EAX
005c6394 : PUSH EDX
005c6395 : CALL 0x005324f0
005c639a : MOV ECX,dword ptr [ESI + 0x18]
005c639d : MOV EBX,EAX
005c639f : MOV EAX,dword ptr [ESI + 0x18]
005c63a2 : MOV dword ptr [ESP + 0x44],0xcd3f2c
005c63aa : MOV dword ptr [ESP + 0x48],0x1
005c63b2 : MOV dword ptr [ESP + 0x44],0xb91d20
005c63ba : MOV dword ptr [ESP + 0x4c],EAX
005c63be : MOV dword ptr [ESP + 0x50],EBX
005c63c2 : MOV dword ptr [ESP + 0x54],EBP
005c63c6 : MOV dword ptr [ESP + 0x58],EBP
005c63ca : MOV dword ptr [ESP + 0x5c],EBP
005c63ce : MOV byte ptr [ESP + 0x60],0x0
005c63d3 : CALL 0x005296a0
005c63d8 : MOV EDX,dword ptr [EAX + 0x8]
005c63db : ADD EAX,0x8
005c63de : MOV ECX,EAX
005c63e0 : MOV EAX,dword ptr [EDX + 0xc]
005c63e3 : PUSH 0x25
005c63e5 : CALL EAX
005c63e7 : MOV ECX,dword ptr [ESI + 0x18]
005c63ea : MOV dword ptr [ESP + 0x68],EAX
005c63ee : CALL 0x005296a0
005c63f3 : MOV EDX,dword ptr [EAX + 0x8]
005c63f6 : ADD EAX,0x8
005c63f9 : MOV ECX,EAX
005c63fb : MOV EAX,dword ptr [EDX + 0xc]
005c63fe : PUSH 0xa
005c6400 : CALL EAX
005c6402 : MOV EBP,EAX
005c6404 : TEST EBP,EBP
005c6406 : JZ 0x005c640f
005c6408 : MOV ECX,EBP
005c640a : CALL 0x004ff7e0
005c640f : MOV ECX,dword ptr [ESP + 0x68]
005c6413 : TEST ECX,ECX
005c6415 : JZ 0x005c6516
005c641b : MOV EDX,dword ptr [ECX]
005c641d : MOV EDX,dword ptr [EDX + 0x4]
005c6420 : PUSH EBP
005c6421 : LEA EAX,[ESP + 0x48]
005c6425 : PUSH EAX
005c6426 : LEA EAX,[ESP + 0x20]
005c642a : PUSH EAX
005c642b : LEA EAX,[ESP + 0x28]
005c642f : PUSH EAX
005c6430 : CALL EDX
005c6432 : TEST AL,AL
005c6434 : JZ 0x005c6516
005c643a : MOV EAX,dword ptr [ESI + 0x18]
005c643d : PUSH EBX
005c643e : PUSH EAX
005c643f : MOV ECX,EDI
005c6441 : CALL 0x005c3db0
005c6446 : MOV ECX,dword ptr [ESI + 0x4]
005c6449 : PUSH EDI
005c644a : CALL 0x005271c0
005c644f : XOR EBP,EBP
005c6451 : CMP EDI,EBP
005c6453 : JZ 0x005c6462
005c6455 : MOV ECX,dword ptr [EDI + 0x8]
005c6458 : INC ECX
005c6459 : AND ECX,0x8fffffff
005c645f : MOV dword ptr [EDI + 0x8],ECX
005c6462 : MOV ECX,dword ptr [ESP + 0x2c]
005c6466 : LEA EDX,[ESP + 0x30]
005c646a : PUSH EDX
005c646b : LEA EAX,[ESP + 0x18]
005c646f : MOV ESI,0xb91c9c
005c6474 : PUSH EAX
005c6475 : MOV dword ptr [ESP + 0x3c],EDI
005c6479 : MOV dword ptr [ESP + 0x38],ESI
005c647d : CALL 0x005c6070
005c6482 : MOV ECX,dword ptr [ESP + 0x34]
005c6486 : MOV dword ptr [ESP + 0x30],ESI
005c648a : CMP ECX,EBP
005c648c : JZ 0x005c6493
005c648e : CALL 0x00503db0
005c6493 : MOV ECX,dword ptr [ESP + 0x68]
005c6497 : CALL 0x004ff7e0
005c649c : LEA ECX,[ESP + 0x44]
005c64a0 : CALL 0x005c47b0
005c64a5 : CMP EBX,EBP
005c64a7 : JZ 0x005c64b0
005c64a9 : MOV ECX,EBX
005c64ab : CALL 0x00503db0
005c64b0 : CMP EDI,EBP
005c64b2 : JZ 0x005c64bb
005c64b4 : MOV ECX,EDI
005c64b6 : CALL 0x00503db0
005c64bb : TEST byte ptr [ESP + 0x40],0x2
005c64c0 : JNZ 0x005c64cf
005c64c2 : MOV ECX,dword ptr [ESP + 0x38]
005c64c6 : CMP ECX,EBP
005c64c8 : JZ 0x005c64cf
005c64ca : CALL 0x00503db0
005c64cf : TEST byte ptr [ESP + 0x40],0x1
005c64d4 : MOV dword ptr [ESP + 0x38],EBP
005c64d8 : JNZ 0x005c64e7
005c64da : MOV ECX,dword ptr [ESP + 0x3c]
005c64de : CMP ECX,EBP
005c64e0 : JZ 0x005c64e7
005c64e2 : CALL 0x00503db0
005c64e7 : MOV EAX,dword ptr [ESP + 0x14]
005c64eb : MOV ECX,EAX
005c64ed : ADD EAX,0x8
005c64f0 : MOV dword ptr [ESP + 0x3c],EBP
005c64f4 : DEC dword ptr [EAX]
005c64f6 : CMP dword ptr [EAX],EBP
005c64f8 : JNZ 0x005c64ff
005c64fa : CALL 0x00525340
005c64ff : LEA ECX,[ESP + 0x18]
005c6503 : CALL 0x0045b730
005c6508 : LEA ECX,[ESP + 0x1c]
005c650c : CALL 0x0045b730
005c6511 : JMP 0x005c65d9
005c6516 : MOV ESI,dword ptr [ESI + 0x4]
005c6519 : MOV ECX,ESI
005c651b : CALL 0x00526400
005c6520 : MOV ECX,dword ptr [ESP + 0x68]
005c6524 : XOR EBP,EBP
005c6526 : MOV byte ptr [ESI],0x1
005c6529 : CMP ECX,EBP
005c652b : JZ 0x005c6532
005c652d : CALL 0x004ff7e0
005c6532 : MOV ECX,dword ptr [ESP + 0x54]
005c6536 : PUSH ECX
005c6537 : CALL 0x00515cf0
005c653c : LEA ECX,[ESP + 0x44]
005c6540 : CALL 0x004ff7b0
005c6545 : CMP EBX,EBP
005c6547 : JZ 0x005c6550
005c6549 : MOV ECX,EBX
005c654b : CALL 0x00503db0
005c6550 : CMP EDI,EBP
005c6552 : JZ 0x005c655b
005c6554 : MOV ECX,EDI
005c6556 : CALL 0x00503db0
005c655b : TEST byte ptr [ESP + 0x40],0x2
005c6560 : JNZ 0x005c656f
005c6562 : MOV ECX,dword ptr [ESP + 0x38]
005c6566 : CMP ECX,EBP
005c6568 : JZ 0x005c656f
005c656a : CALL 0x00503db0
005c656f : TEST byte ptr [ESP + 0x40],0x1
005c6574 : MOV dword ptr [ESP + 0x38],EBP
005c6578 : JNZ 0x005c6587
005c657a : MOV ECX,dword ptr [ESP + 0x3c]
005c657e : CMP ECX,EBP
005c6580 : JZ 0x005c6587
005c6582 : CALL 0x00503db0
005c6587 : MOV EAX,dword ptr [ESP + 0x14]
005c658b : MOV ECX,EAX
005c658d : ADD EAX,0x8
005c6590 : MOV dword ptr [ESP + 0x3c],EBP
005c6594 : DEC dword ptr [EAX]
005c6596 : CMP dword ptr [EAX],EBP
005c6598 : JNZ 0x005c659f
005c659a : CALL 0x00525340
005c659f : MOV ESI,dword ptr [ESP + 0x18]
005c65a3 : MOV EDI,dword ptr [0x00b851cc]
005c65a9 : AND ESI,0xfffffffc
005c65ac : PUSH -0x1
005c65ae : LEA EDX,[ESI + 0x4]
005c65b1 : PUSH EDX
005c65b2 : CALL EDI
005c65b4 : SUB EAX,0x1
005c65b7 : JNZ 0x005c65bf
005c65b9 : PUSH ESI
005c65ba : CALL 0x00515cf0
005c65bf : MOV ESI,dword ptr [ESP + 0x1c]
005c65c3 : AND ESI,0xfffffffc
005c65c6 : PUSH -0x1
005c65c8 : LEA EAX,[ESI + 0x4]
005c65cb : PUSH EAX
005c65cc : CALL EDI
005c65ce : SUB EAX,0x1
005c65d1 : JNZ 0x005c65d9
005c65d3 : PUSH ESI
005c65d4 : CALL 0x00515cf0
005c65d9 : MOV ECX,dword ptr [ESP + 0x20]
005c65dd : ADD dword ptr [ECX + 0x8],-0x1
005c65e1 : JNZ 0x005c65e8
005c65e3 : CALL 0x00525340
005c65e8 : MOV EAX,dword ptr [ESP + 0x24]
005c65ec : DEC dword ptr [EAX + 0x8]
005c65ef : MOV ECX,EAX
005c65f1 : ADD EAX,0x8
005c65f4 : CMP dword ptr [EAX],EBP
005c65f6 : JNZ 0x005c65fd
005c65f8 : CALL 0x00525340
005c65fd : POP EDI
005c65fe : POP EBP
005c65ff : POP EBX
005c6600 : POP ESI
005c6601 : ADD ESP,0x54
005c6604 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0097f4e0
ENTRY    : 0097f4e0
BODY     : [[0097f4e0, 0097f64f]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0097f61d) */
/* WARNING: Removing unreachable block (ram,0x0097f5b3) */

void FUN_0097f4e0(void)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  int in_EDX;
  int unaff_ESI;
  int iVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b607be;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar4 = 0;
  iVar2 = *(int *)(unaff_ESI + 0x44) - *(int *)(unaff_ESI + 0x40) >> 2;
  if (0 < iVar2) {
    piVar3 = *(int **)(unaff_ESI + 0x40);
    do {
      if (*(int *)(*piVar3 + 4) == in_EDX) {
        FUN_0096c1d0(*(undefined4 *)(*(int *)(unaff_ESI + 0x40) + iVar4 * 4),0,uVar1);
        FUN_00406360(&DAT_00c7f6c4,0);
        local_8 = 0;
        FUN_0096ce40(*(undefined4 *)(*(int *)(unaff_ESI + 0x40) + iVar4 * 4));
        goto LAB_0097f635;
      }
      iVar4 = iVar4 + 1;
      piVar3 = piVar3 + 1;
    } while (iVar4 < iVar2);
  }
  iVar4 = 0;
  iVar2 = *(int *)(unaff_ESI + 0x54) - *(int *)(unaff_ESI + 0x50) >> 2;
  if (0 < iVar2) {
    piVar3 = *(int **)(unaff_ESI + 0x50);
    do {
      if (*(int *)(*piVar3 + 4) == in_EDX) {
        FUN_0096c1d0(*(undefined4 *)(*(int *)(unaff_ESI + 0x50) + iVar4 * 4),0,uVar1);
        FUN_00406360(&DAT_00c7f6c8,0);
        local_8 = 1;
        FUN_0096ce40(*(undefined4 *)(*(int *)(unaff_ESI + 0x40) + iVar4 * 4));
        break;
      }
      iVar4 = iVar4 + 1;
      piVar3 = piVar3 + 1;
    } while (iVar4 < iVar2);
  }
LAB_0097f635:
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(uVar1 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0097f4e0 : PUSH EBP
0097f4e1 : MOV EBP,ESP
0097f4e3 : PUSH -0x1
0097f4e5 : PUSH 0xb607be
0097f4ea : MOV EAX,FS:[0x0]
0097f4f0 : PUSH EAX
0097f4f1 : SUB ESP,0x20
0097f4f4 : MOV EAX,[0x00d66fa0]
0097f4f9 : XOR EAX,EBP
0097f4fb : MOV dword ptr [EBP + -0x10],EAX
0097f4fe : PUSH EBX
0097f4ff : PUSH EDI
0097f500 : PUSH EAX
0097f501 : LEA EAX,[EBP + -0xc]
0097f504 : MOV FS:[0x0],EAX
0097f50a : MOV EAX,dword ptr [ESI + 0x44]
0097f50d : SUB EAX,dword ptr [ESI + 0x40]
0097f510 : XOR EDI,EDI
0097f512 : SAR EAX,0x2
0097f515 : TEST EAX,EAX
0097f517 : JLE 0x0097f52f
0097f519 : MOV ECX,dword ptr [ESI + 0x40]
0097f51c : LEA ESP,[ESP]
0097f520 : MOV EBX,dword ptr [ECX]
0097f522 : CMP dword ptr [EBX + 0x4],EDX
0097f525 : JZ 0x0097f559
0097f527 : INC EDI
0097f528 : ADD ECX,0x4
0097f52b : CMP EDI,EAX
0097f52d : JL 0x0097f520
0097f52f : MOV EAX,dword ptr [ESI + 0x54]
0097f532 : SUB EAX,dword ptr [ESI + 0x50]
0097f535 : XOR EDI,EDI
0097f537 : SAR EAX,0x2
0097f53a : TEST EAX,EAX
0097f53c : JLE 0x0097f635
0097f542 : MOV ECX,dword ptr [ESI + 0x50]
0097f545 : MOV EBX,dword ptr [ECX]
0097f547 : CMP dword ptr [EBX + 0x4],EDX
0097f54a : JZ 0x0097f5c3
0097f54c : INC EDI
0097f54d : ADD ECX,0x4
0097f550 : CMP EDI,EAX
0097f552 : JL 0x0097f545
0097f554 : JMP 0x0097f635
0097f559 : MOV EAX,dword ptr [ESI + 0x40]
0097f55c : MOV EAX,dword ptr [EAX + EDI*0x4]
0097f55f : PUSH 0x0
0097f561 : PUSH EAX
0097f562 : CALL 0x0096c1d0
0097f567 : XOR ECX,ECX
0097f569 : ADD ESP,0x8
0097f56c : PUSH ECX
0097f56d : MOV word ptr [EBP + -0x28],CX
0097f571 : MOV EBX,0x7
0097f576 : PUSH 0xc7f6c4
0097f57b : LEA ECX,[EBP + -0x2c]
0097f57e : MOV dword ptr [EBP + -0x14],EBX
0097f581 : MOV dword ptr [EBP + -0x18],0x0
0097f588 : CALL 0x00406360
0097f58d : MOV dword ptr [EBP + -0x4],0x0
0097f594 : MOV EDX,dword ptr [ESI + 0x40]
0097f597 : MOV EAX,dword ptr [EDX + EDI*0x4]
0097f59a : PUSH EAX
0097f59b : LEA ECX,[EBP + -0x2c]
0097f59e : CALL 0x0096ce40
0097f5a3 : ADD ESP,0x4
0097f5a6 : MOV dword ptr [EBP + -0x4],0xffffffff
0097f5ad : CMP dword ptr [EBP + -0x14],0x8
0097f5b1 : JC 0x0097f5bb
0097f5b3 : MOV ECX,dword ptr [EBP + -0x28]
0097f5b6 : CALL 0x006f04e0
0097f5bb : XOR ECX,ECX
0097f5bd : MOV word ptr [EBP + -0x28],CX
0097f5c1 : JMP 0x0097f62b
0097f5c3 : MOV EAX,dword ptr [ESI + 0x50]
0097f5c6 : MOV EDX,dword ptr [EAX + EDI*0x4]
0097f5c9 : PUSH 0x0
0097f5cb : PUSH EDX
0097f5cc : CALL 0x0096c1d0
0097f5d1 : ADD ESP,0x8
0097f5d4 : XOR EAX,EAX
0097f5d6 : PUSH EAX
0097f5d7 : MOV EBX,0x7
0097f5dc : PUSH 0xc7f6c8
0097f5e1 : LEA ECX,[EBP + -0x2c]
0097f5e4 : MOV dword ptr [EBP + -0x14],EBX
0097f5e7 : MOV dword ptr [EBP + -0x18],0x0
0097f5ee : MOV word ptr [EBP + -0x28],AX
0097f5f2 : CALL 0x00406360
0097f5f7 : MOV dword ptr [EBP + -0x4],0x1
0097f5fe : MOV ECX,dword ptr [ESI + 0x40]
0097f601 : MOV EDX,dword ptr [ECX + EDI*0x4]
0097f604 : PUSH EDX
0097f605 : LEA ECX,[EBP + -0x2c]
0097f608 : CALL 0x0096ce40
0097f60d : ADD ESP,0x4
0097f610 : MOV dword ptr [EBP + -0x4],0xffffffff
0097f617 : CMP dword ptr [EBP + -0x14],0x8
0097f61b : JC 0x0097f625
0097f61d : MOV ECX,dword ptr [EBP + -0x28]
0097f620 : CALL 0x006f04e0
0097f625 : XOR EAX,EAX
0097f627 : MOV word ptr [EBP + -0x28],AX
0097f62b : MOV dword ptr [EBP + -0x18],0x0
0097f632 : MOV dword ptr [EBP + -0x14],EBX
0097f635 : MOV ECX,dword ptr [EBP + -0xc]
0097f638 : MOV dword ptr FS:[0x0],ECX
0097f63f : POP ECX
0097f640 : POP EDI
0097f641 : POP EBX
0097f642 : MOV ECX,dword ptr [EBP + -0x10]
0097f645 : XOR ECX,EBP
0097f647 : CALL 0x00633e6b
0097f64c : MOV ESP,EBP
0097f64e : POP EBP
0097f64f : RET

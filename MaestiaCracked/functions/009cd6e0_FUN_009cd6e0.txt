PROGRAM  : Maestia.exe
FUNCTION : FUN_009cd6e0
ENTRY    : 009cd6e0
BODY     : [[009cd6e0, 009cd8a9] [009cd8b0, 009cd922]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009cd6e0(int *param_1)

{
  undefined1 *puVar1;
  short sVar2;
  wchar_t wVar3;
  short *psVar4;
  wchar_t *pwVar5;
  int iVar6;
  ushort *in_EDX;
  byte *pbVar7;
  uint uVar8;
  int iVar9;
  byte *pbVar10;
  int local_81c;
  short *local_818;
  byte local_812;
  byte local_811;
  wchar_t local_810;
  undefined1 local_80e [2050];
  uint local_c;
  
  local_c = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  uVar8 = *in_EDX & 0x1fff;
  if (((int *)((int)in_EDX + 5) == (int *)0x0) || (uVar8 - 5 < 4)) {
LAB_009cd77d:
    local_818 = (short *)0x0;
  }
  else {
    param_1[0xe] = *(int *)((int)in_EDX + 5);
    if (((undefined2 *)((int)in_EDX + 9) == (undefined2 *)0x0) || (uVar8 - 9 < 2))
    goto LAB_009cd77d;
    uVar8 = uVar8 - 0xb;
    *(undefined2 *)((int)param_1 + 0x3e) = *(undefined2 *)((int)in_EDX + 9);
    if (((((short *)((int)in_EDX + 0xb) == (short *)0x0) || (uVar8 < 2)) ||
        (sVar2 = *(short *)((int)in_EDX + 0xb), sVar2 < 0)) ||
       (iVar6 = (int)sVar2, (int)uVar8 < iVar6 + 2)) goto LAB_009cd77d;
    local_818 = (short *)((int)in_EDX + 0xd);
    iVar9 = uVar8 + (-2 - iVar6);
    puVar1 = (undefined1 *)((int)in_EDX + iVar6 + 0xd);
    if ((puVar1 != (undefined1 *)0x0) && (iVar9 != 0)) {
      uVar8 = iVar9 - 1;
      *(undefined1 *)(param_1 + 0xf) = *puVar1;
      pbVar10 = puVar1 + 1;
      goto LAB_009cd78b;
    }
  }
  uVar8 = 0;
  pbVar10 = (byte *)0x0;
LAB_009cd78b:
  local_810 = L'\0';
  local_81c = 0;
  if ((char)in_EDX[2] != '\0') {
    do {
      if (((pbVar10 == (byte *)0x0) || (uVar8 < 2)) ||
         ((*(short *)pbVar10 < 0 || (iVar6 = (int)*(short *)pbVar10, (int)uVar8 < iVar6 + 2)))) {
        pbVar7 = (byte *)0x0;
LAB_009cd7f6:
        uVar8 = 0;
        pbVar10 = (byte *)0x0;
      }
      else {
        pbVar7 = pbVar10 + 2;
        pbVar10 = pbVar10 + iVar6 + 2;
        iVar6 = uVar8 + (-2 - iVar6);
        if ((pbVar10 == (byte *)0x0) || (iVar6 == 0)) goto LAB_009cd7f6;
        local_811 = *pbVar10;
        if ((pbVar10 + 1 == (byte *)0x0) || (iVar6 == 1)) goto LAB_009cd7f6;
        local_812 = pbVar10[1];
        uVar8 = iVar6 - 2;
        pbVar10 = pbVar10 + 2;
      }
      pwVar5 = &local_810;
      do {
        wVar3 = *pwVar5;
        pwVar5 = pwVar5 + 1;
      } while (wVar3 != L'\0');
      iVar6 = (int)pwVar5 - (int)local_80e >> 1;
      __snwprintf((wchar_t *)(local_80e + iVar6 * 2 + -2),0x400 - iVar6,L"%d,%s,%d,%d,%d&",0,pbVar7,
                  (uint)local_811,local_812 & 0x7f,(uint)(local_812 >> 7));
      local_81c = local_81c + 1;
    } while (local_81c < (int)(uint)(byte)in_EDX[2]);
  }
  psVar4 = local_818;
  do {
    sVar2 = *psVar4;
    psVar4 = psVar4 + 1;
  } while (sVar2 != 0);
  FUN_00406360(local_818,(int)psVar4 - (int)(local_818 + 1) >> 1);
  pwVar5 = &local_810;
  do {
    wVar3 = *pwVar5;
    pwVar5 = pwVar5 + 1;
  } while (wVar3 != L'\0');
  FUN_00406360(&local_810,(int)pwVar5 - (int)local_80e >> 1);
  *(char *)((int)param_1 + 0x3d) = (char)in_EDX[2];
  if (*(char *)((int)param_1 + 0x32) == '\0') {
    (**(code **)(*param_1 + 0x18))(1,300);
    __security_check_cookie(local_c ^ (uint)&stack0xfffffffc);
    return;
  }
  FUN_009cd480(param_1);
  __security_check_cookie(local_c ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009cd6e0 : PUSH EBP
009cd6e1 : MOV EBP,ESP
009cd6e3 : SUB ESP,0x820
009cd6e9 : MOV EAX,[0x00d66fa0]
009cd6ee : XOR EAX,EBP
009cd6f0 : MOV dword ptr [EBP + -0x8],EAX
009cd6f3 : PUSH EBX
009cd6f4 : MOV EBX,dword ptr [EBP + 0x8]
009cd6f7 : PUSH ESI
009cd6f8 : MOVZX ESI,word ptr [EDX]
009cd6fb : AND ESI,0x1fff
009cd701 : LEA EAX,[EDX + 0x5]
009cd704 : SUB ESI,0x5
009cd707 : PUSH EDI
009cd708 : MOV dword ptr [EBP + 0xfffff7e0],EBX
009cd70e : MOV dword ptr [EBP + 0xfffff7e4],EDX
009cd714 : TEST EAX,EAX
009cd716 : JZ 0x009cd77d
009cd718 : CMP ESI,0x4
009cd71b : JC 0x009cd77d
009cd71d : MOV ECX,dword ptr [EAX]
009cd71f : SUB ESI,0x4
009cd722 : ADD EAX,0x4
009cd725 : MOV dword ptr [EBX + 0x38],ECX
009cd728 : JZ 0x009cd77d
009cd72a : CMP ESI,0x2
009cd72d : JC 0x009cd77d
009cd72f : MOV CX,word ptr [EAX]
009cd732 : SUB ESI,0x2
009cd735 : ADD EAX,0x2
009cd738 : MOV word ptr [EBX + 0x3e],CX
009cd73c : JZ 0x009cd77d
009cd73e : CMP ESI,0x2
009cd741 : JC 0x009cd77d
009cd743 : MOVZX ECX,word ptr [EAX]
009cd746 : TEST CX,CX
009cd749 : JL 0x009cd77d
009cd74b : MOVSX ECX,CX
009cd74e : LEA EDI,[ECX + 0x2]
009cd751 : CMP ESI,EDI
009cd753 : JL 0x009cd77d
009cd755 : LEA EDI,[EAX + 0x2]
009cd758 : MOV dword ptr [EBP + 0xfffff7ec],EDI
009cd75e : MOV EDI,0xfffffffe
009cd763 : SUB EDI,ECX
009cd765 : ADD ESI,EDI
009cd767 : LEA EDI,[EAX + ECX*0x1 + 0x2]
009cd76b : TEST EDI,EDI
009cd76d : JZ 0x009cd787
009cd76f : CMP ESI,0x1
009cd772 : JC 0x009cd787
009cd774 : MOV AL,byte ptr [EDI]
009cd776 : DEC ESI
009cd777 : MOV byte ptr [EBX + 0x3c],AL
009cd77a : INC EDI
009cd77b : JMP 0x009cd78b
009cd77d : MOV dword ptr [EBP + 0xfffff7ec],0x0
009cd787 : XOR ESI,ESI
009cd789 : XOR EDI,EDI
009cd78b : XOR ECX,ECX
009cd78d : MOV word ptr [EBP + 0xfffff7f4],CX
009cd794 : MOV dword ptr [EBP + 0xfffff7e8],ECX
009cd79a : CMP byte ptr [EDX + 0x4],CL
009cd79d : JBE 0x009cd870
009cd7a3 : TEST EDI,EDI
009cd7a5 : JZ 0x009cd7f4
009cd7a7 : CMP ESI,0x2
009cd7aa : JC 0x009cd7f4
009cd7ac : MOVZX EAX,word ptr [EDI]
009cd7af : TEST AX,AX
009cd7b2 : JL 0x009cd7f4
009cd7b4 : CWDE
009cd7b5 : LEA EDX,[EAX + 0x2]
009cd7b8 : CMP ESI,EDX
009cd7ba : JL 0x009cd7f4
009cd7bc : MOV ECX,0xfffffffe
009cd7c1 : SUB ECX,EAX
009cd7c3 : LEA EBX,[EDI + 0x2]
009cd7c6 : LEA EDI,[EDI + EAX*0x1 + 0x2]
009cd7ca : ADD ESI,ECX
009cd7cc : TEST EDI,EDI
009cd7ce : JZ 0x009cd7f6
009cd7d0 : CMP ESI,0x1
009cd7d3 : JC 0x009cd7f6
009cd7d5 : MOV DL,byte ptr [EDI]
009cd7d7 : DEC ESI
009cd7d8 : ADD EDI,0x1
009cd7db : MOV byte ptr [EBP + 0xfffff7f3],DL
009cd7e1 : JZ 0x009cd7f6
009cd7e3 : CMP ESI,0x1
009cd7e6 : JC 0x009cd7f6
009cd7e8 : MOV AL,byte ptr [EDI]
009cd7ea : DEC ESI
009cd7eb : MOV byte ptr [EBP + 0xfffff7f2],AL
009cd7f1 : INC EDI
009cd7f2 : JMP 0x009cd7fa
009cd7f4 : XOR EBX,EBX
009cd7f6 : XOR ESI,ESI
009cd7f8 : XOR EDI,EDI
009cd7fa : LEA EAX,[EBP + 0xfffff7f4]
009cd800 : LEA EDX,[EAX + 0x2]
009cd803 : MOV CX,word ptr [EAX]
009cd806 : ADD EAX,0x2
009cd809 : TEST CX,CX
009cd80c : JNZ 0x009cd803
009cd80e : MOVZX ECX,byte ptr [EBP + 0xfffff7f2]
009cd815 : SUB EAX,EDX
009cd817 : MOV EDX,ECX
009cd819 : SHR EDX,0x7
009cd81c : PUSH EDX
009cd81d : AND ECX,0x7f
009cd820 : PUSH ECX
009cd821 : MOVZX ECX,byte ptr [EBP + 0xfffff7f3]
009cd828 : PUSH ECX
009cd829 : PUSH EBX
009cd82a : SAR EAX,0x1
009cd82c : PUSH 0x0
009cd82e : MOV EDX,0x400
009cd833 : SUB EDX,EAX
009cd835 : PUSH 0xc95834
009cd83a : PUSH EDX
009cd83b : LEA EAX,[EBP + EAX*0x2 + 0xfffff7f4]
009cd842 : PUSH EAX
009cd843 : CALL 0x006343c8
009cd848 : MOV ECX,dword ptr [EBP + 0xfffff7e4]
009cd84e : MOV EAX,dword ptr [EBP + 0xfffff7e8]
009cd854 : MOVZX EDX,byte ptr [ECX + 0x4]
009cd858 : INC EAX
009cd859 : ADD ESP,0x20
009cd85c : CMP EAX,EDX
009cd85e : MOV dword ptr [EBP + 0xfffff7e8],EAX
009cd864 : JL 0x009cd7a3
009cd86a : MOV EBX,dword ptr [EBP + 0xfffff7e0]
009cd870 : MOV EAX,dword ptr [EBP + 0xfffff7ec]
009cd876 : LEA EDX,[EAX + 0x2]
009cd879 : LEA ESP,[ESP]
009cd880 : MOV CX,word ptr [EAX]
009cd883 : ADD EAX,0x2
009cd886 : TEST CX,CX
009cd889 : JNZ 0x009cd880
009cd88b : SUB EAX,EDX
009cd88d : SAR EAX,0x1
009cd88f : PUSH EAX
009cd890 : MOV EAX,dword ptr [EBP + 0xfffff7ec]
009cd896 : PUSH EAX
009cd897 : LEA ECX,[EBX + 0x40]
009cd89a : CALL 0x00406360
009cd89f : LEA EAX,[EBP + 0xfffff7f4]
009cd8a5 : LEA EDX,[EAX + 0x2]
009cd8a8 : JMP 0x009cd8b0
009cd8b0 : MOV CX,word ptr [EAX]
009cd8b3 : ADD EAX,0x2
009cd8b6 : TEST CX,CX
009cd8b9 : JNZ 0x009cd8b0
009cd8bb : MOV ESI,dword ptr [EBP + 0xfffff7e0]
009cd8c1 : SUB EAX,EDX
009cd8c3 : SAR EAX,0x1
009cd8c5 : PUSH EAX
009cd8c6 : LEA ECX,[EBP + 0xfffff7f4]
009cd8cc : PUSH ECX
009cd8cd : LEA ECX,[ESI + 0x5c]
009cd8d0 : CALL 0x00406360
009cd8d5 : CMP byte ptr [ESI + 0x32],0x0
009cd8d9 : MOV EDX,dword ptr [EBP + 0xfffff7e4]
009cd8df : MOV AL,byte ptr [EDX + 0x4]
009cd8e2 : MOV byte ptr [ESI + 0x3d],AL
009cd8e5 : JZ 0x009cd900
009cd8e7 : PUSH ESI
009cd8e8 : CALL 0x009cd480
009cd8ed : POP EDI
009cd8ee : POP ESI
009cd8ef : POP EBX
009cd8f0 : MOV ECX,dword ptr [EBP + -0x8]
009cd8f3 : XOR ECX,EBP
009cd8f5 : CALL 0x00633e6b
009cd8fa : MOV ESP,EBP
009cd8fc : POP EBP
009cd8fd : RET 0x4
009cd900 : MOV EDX,dword ptr [ESI]
009cd902 : MOV EAX,dword ptr [EDX + 0x18]
009cd905 : PUSH 0x12c
009cd90a : PUSH 0x1
009cd90c : MOV ECX,ESI
009cd90e : CALL EAX
009cd910 : MOV ECX,dword ptr [EBP + -0x8]
009cd913 : POP EDI
009cd914 : POP ESI
009cd915 : XOR ECX,EBP
009cd917 : POP EBX
009cd918 : CALL 0x00633e6b
009cd91d : MOV ESP,EBP
009cd91f : POP EBP
009cd920 : RET 0x4

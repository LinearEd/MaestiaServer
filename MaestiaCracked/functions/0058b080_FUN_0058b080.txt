PROGRAM  : Maestia.exe
FUNCTION : FUN_0058b080
ENTRY    : 0058b080
BODY     : [[0058b080, 0058b117]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0058b080(undefined4 param_1,int *param_2,int *param_3)

{
  uint *puVar1;
  int *piVar2;
  code *pcVar3;
  int iVar4;
  int *in_ECX;
  
  if (*(int *)(*param_3 + 0x10) != 0) {
    (**(code **)(*param_2 + 0x20))(param_3);
  }
  piVar2 = (int *)param_2[8];
  do {
    if (piVar2 == (int *)0x0) {
LAB_0058b0cb:
      FUN_005ed2d0(param_1,param_2);
      if ((*(int *)(*param_3 + 0x10) != 0) && ((*(byte *)((int)param_2 + 0x66) & 0x80) != 0)) {
        (**(code **)(*in_ECX + 0x40))(param_2);
        FUN_00576ae0(param_2);
      }
      iVar4 = in_ECX[0x28];
      puVar1 = (uint *)(iVar4 + 0xb00);
      *puVar1 = *puVar1 | 0x400;
      return iVar4 + 0xb00;
    }
    iVar4 = (**(code **)(*piVar2 + 0x38))();
    if (iVar4 != 0) {
      pcVar3 = *(code **)(*param_2 + 0x3c);
      *(byte *)((int)param_2 + 0x66) = *(byte *)((int)param_2 + 0x66) | 1;
      (*pcVar3)();
      goto LAB_0058b0cb;
    }
    piVar2 = (int *)piVar2[8];
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0058b080 : PUSH EBX
0058b081 : PUSH EBP
0058b082 : MOV EBP,dword ptr [ESP + 0x14]
0058b086 : MOV EAX,dword ptr [EBP]
0058b089 : CMP dword ptr [EAX + 0x10],0x0
0058b08d : PUSH EDI
0058b08e : MOV EDI,dword ptr [ESP + 0x14]
0058b092 : MOV EBX,ECX
0058b094 : JZ 0x0058b0a0
0058b096 : MOV EDX,dword ptr [EDI]
0058b098 : MOV EAX,dword ptr [EDX + 0x20]
0058b09b : PUSH EBP
0058b09c : MOV ECX,EDI
0058b09e : CALL EAX
0058b0a0 : PUSH ESI
0058b0a1 : MOV ESI,dword ptr [EDI + 0x20]
0058b0a4 : TEST ESI,ESI
0058b0a6 : JZ 0x0058b0cb
0058b0a8 : MOV EDX,dword ptr [ESI]
0058b0aa : MOV EAX,dword ptr [EDX + 0x38]
0058b0ad : MOV ECX,ESI
0058b0af : CALL EAX
0058b0b1 : TEST EAX,EAX
0058b0b3 : JNZ 0x0058b0be
0058b0b5 : MOV ESI,dword ptr [ESI + 0x20]
0058b0b8 : TEST ESI,ESI
0058b0ba : JNZ 0x0058b0a8
0058b0bc : JMP 0x0058b0cb
0058b0be : MOV EDX,dword ptr [EDI]
0058b0c0 : MOV EAX,dword ptr [EDX + 0x3c]
0058b0c3 : OR byte ptr [EDI + 0x66],0x1
0058b0c7 : MOV ECX,EDI
0058b0c9 : CALL EAX
0058b0cb : MOV ECX,dword ptr [ESP + 0x14]
0058b0cf : PUSH EDI
0058b0d0 : PUSH ECX
0058b0d1 : LEA ECX,[EBX + 0xa8]
0058b0d7 : CALL 0x005ed2d0
0058b0dc : MOV EDX,dword ptr [EBP]
0058b0df : CMP dword ptr [EDX + 0x10],0x0
0058b0e3 : POP ESI
0058b0e4 : JZ 0x0058b0fd
0058b0e6 : TEST byte ptr [EDI + 0x66],0x80
0058b0ea : JZ 0x0058b0fd
0058b0ec : MOV EAX,dword ptr [EBX]
0058b0ee : MOV EDX,dword ptr [EAX + 0x40]
0058b0f1 : PUSH EDI
0058b0f2 : MOV ECX,EBX
0058b0f4 : CALL EDX
0058b0f6 : MOV ECX,EAX
0058b0f8 : CALL 0x00576ae0
0058b0fd : MOV EAX,dword ptr [EBX + 0xa0]
0058b103 : OR dword ptr [EAX + 0xb00],0x400
0058b10d : POP EDI
0058b10e : ADD EAX,0xb00
0058b113 : POP EBP
0058b114 : POP EBX
0058b115 : RET 0xc

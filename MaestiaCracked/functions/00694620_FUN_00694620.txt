PROGRAM  : Maestia.exe
FUNCTION : FUN_00694620
ENTRY    : 00694620
BODY     : [[00694620, 00694772]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00694620(int param_1,undefined4 param_2,undefined4 param_3)

{
  undefined1 *puVar1;
  undefined1 *puVar2;
  undefined1 *puVar3;
  undefined1 uVar4;
  undefined1 uVar5;
  undefined1 uVar6;
  undefined1 uVar7;
  undefined1 uVar8;
  undefined1 uVar9;
  undefined1 uVar10;
  int iVar11;
  int iVar12;
  undefined1 *puVar13;
  undefined1 *puVar14;
  undefined1 *puVar15;
  int iVar16;
  uint *local_c;
  int local_4;
  
  local_4 = *(int *)(param_1 + 0x18);
  iVar12 = *(int *)(param_1 + 0x10);
  iVar11 = FUN_00693ea0();
  if (iVar11 == 0) {
    local_c = *(uint **)(param_1 + 0x20);
    if (local_4 != 0) {
      puVar13 = (undefined1 *)(iVar12 + 9);
      iVar11 = iVar12 + 8;
      iVar16 = iVar12 + 7;
      puVar14 = (undefined1 *)(iVar12 + 6);
      do {
        uVar4 = *(undefined1 *)(iVar16 + 3);
        uVar5 = *(undefined1 *)(iVar11 + 3);
        puVar1 = (undefined1 *)(iVar16 + 7);
        uVar6 = puVar13[3];
        puVar15 = puVar14 + 7;
        puVar2 = (undefined1 *)(iVar11 + 7);
        puVar3 = puVar13 + 7;
        puVar14 = puVar14 + 0xb;
        uVar7 = *puVar14;
        uVar8 = *(undefined1 *)(iVar16 + 0xb);
        iVar16 = iVar16 + 0xb;
        uVar9 = *(undefined1 *)(iVar11 + 0xb);
        iVar11 = iVar11 + 0xb;
        puVar13 = puVar13 + 0xb;
        uVar10 = *puVar13;
        if (((CONCAT31(CONCAT21(CONCAT11(*puVar15,*puVar1),*puVar2),*puVar3) != 0) &&
            (iVar12 = FUN_006942b0(), iVar12 != 0)) ||
           ((CONCAT31(CONCAT21(CONCAT11(uVar7,uVar8),uVar9),uVar10) != 0 &&
            (iVar12 = FUN_00694330(param_3), iVar12 != 0)))) {
          *local_c = (uint)CONCAT21(CONCAT11(uVar4,uVar5),uVar6);
          local_c = local_c + 1;
        }
        local_4 = local_4 + -1;
      } while (local_4 != 0);
    }
    *local_c = 0;
    return *(undefined4 *)(param_1 + 0x20);
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00694620 : SUB ESP,0x14
00694623 : MOV ECX,dword ptr [ESP + 0x1c]
00694627 : PUSH EBX
00694628 : PUSH EBP
00694629 : PUSH ESI
0069462a : MOV ESI,dword ptr [ESP + 0x24]
0069462e : MOV EBX,dword ptr [ESI + 0x18]
00694631 : MOV EBP,dword ptr [ESI + 0x10]
00694634 : PUSH EDI
00694635 : ADD EBP,0xa
00694638 : LEA EDI,[EBX + 0x1]
0069463b : MOV dword ptr [ESP + 0x20],EBX
0069463f : MOV dword ptr [ESP + 0x1c],EBP
00694643 : CALL 0x00693ea0
00694648 : TEST EAX,EAX
0069464a : JZ 0x00694656
0069464c : POP EDI
0069464d : POP ESI
0069464e : POP EBP
0069464f : XOR EAX,EAX
00694651 : POP EBX
00694652 : ADD ESP,0x14
00694655 : RET
00694656 : MOV EAX,dword ptr [ESI + 0x20]
00694659 : MOV dword ptr [ESP + 0x18],EAX
0069465d : TEST EBX,EBX
0069465f : JBE 0x0069475e
00694665 : MOV EDX,dword ptr [ESP + 0x1c]
00694669 : LEA ECX,[EBP + -0x1]
0069466c : LEA EBX,[EBP + -0x2]
0069466f : ADD EBP,-0x3
00694672 : ADD EDX,-0x4
00694675 : MOVZX ESI,byte ptr [EBP + 0x3]
00694679 : MOVZX EAX,byte ptr [EBX + 0x3]
0069467d : ADD EBP,0x3
00694680 : MOVZX EDI,byte ptr [EBP + 0x4]
00694684 : ADD EBX,0x3
00694687 : SHL ESI,0x8
0069468a : OR ESI,EAX
0069468c : MOVZX EAX,byte ptr [ECX + 0x3]
00694690 : ADD ECX,0x3
00694693 : ADD EDX,0x3
00694696 : ADD EDX,0x4
00694699 : SHL ESI,0x8
0069469c : OR ESI,EAX
0069469e : MOVZX EAX,byte ptr [EDX]
006946a1 : ADD EBP,0x4
006946a4 : SHL EAX,0x8
006946a7 : OR EAX,EDI
006946a9 : MOVZX EDI,byte ptr [EBX + 0x4]
006946ad : ADD EBX,0x4
006946b0 : SHL EAX,0x8
006946b3 : OR EAX,EDI
006946b5 : MOVZX EDI,byte ptr [ECX + 0x4]
006946b9 : ADD ECX,0x4
006946bc : ADD EDX,0x4
006946bf : SHL EAX,0x8
006946c2 : OR EAX,EDI
006946c4 : MOVZX EDI,byte ptr [EDX]
006946c7 : MOV dword ptr [ESP + 0x10],EDX
006946cb : MOVZX EDX,byte ptr [EBP + 0x4]
006946cf : ADD EBP,0x4
006946d2 : SHL EDI,0x8
006946d5 : OR EDI,EDX
006946d7 : MOVZX EDX,byte ptr [EBX + 0x4]
006946db : ADD EBX,0x4
006946de : SHL EDI,0x8
006946e1 : ADD ECX,0x4
006946e4 : OR EDI,EDX
006946e6 : MOVZX EDX,byte ptr [ECX]
006946e9 : SHL EDI,0x8
006946ec : OR EDI,EDX
006946ee : MOV dword ptr [ESP + 0x1c],EBX
006946f2 : MOV dword ptr [ESP + 0x14],ECX
006946f6 : TEST EAX,EAX
006946f8 : JZ 0x00694718
006946fa : MOV ECX,dword ptr [ESP + 0x28]
006946fe : MOV EDX,dword ptr [ECX + 0x10]
00694701 : MOV EBX,dword ptr [ESP + 0x30]
00694705 : ADD EDX,EAX
00694707 : CALL 0x006942b0
0069470c : MOV EBX,dword ptr [ESP + 0x1c]
00694710 : TEST EAX,EAX
00694712 : JNZ 0x0069473a
00694714 : MOV ECX,dword ptr [ESP + 0x14]
00694718 : MOV EDX,dword ptr [ESP + 0x10]
0069471c : TEST EDI,EDI
0069471e : JZ 0x0069474f
00694720 : MOV EAX,dword ptr [ESP + 0x28]
00694724 : MOV EDX,dword ptr [ESP + 0x30]
00694728 : MOV EAX,dword ptr [EAX + 0x10]
0069472b : PUSH EDX
0069472c : ADD EAX,EDI
0069472e : CALL 0x00694330
00694733 : ADD ESP,0x4
00694736 : TEST EAX,EAX
00694738 : JZ 0x00694747
0069473a : MOV EAX,dword ptr [ESP + 0x18]
0069473e : MOV dword ptr [EAX],ESI
00694740 : ADD EAX,0x4
00694743 : MOV dword ptr [ESP + 0x18],EAX
00694747 : MOV ECX,dword ptr [ESP + 0x14]
0069474b : MOV EDX,dword ptr [ESP + 0x10]
0069474f : SUB dword ptr [ESP + 0x20],0x1
00694754 : JNZ 0x00694675
0069475a : MOV ESI,dword ptr [ESP + 0x28]
0069475e : MOV ECX,dword ptr [ESP + 0x18]
00694762 : POP EDI
00694763 : MOV dword ptr [ECX],0x0
00694769 : MOV EAX,dword ptr [ESI + 0x20]
0069476c : POP ESI
0069476d : POP EBP
0069476e : POP EBX
0069476f : ADD ESP,0x14
00694772 : RET

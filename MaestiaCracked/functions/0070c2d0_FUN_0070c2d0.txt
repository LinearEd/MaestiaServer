PROGRAM  : Maestia.exe
FUNCTION : FUN_0070c2d0
ENTRY    : 0070c2d0
BODY     : [[0070c2d0, 0070c36c] [0070c370, 0070c511]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_0070c2d0(undefined4 param_1,undefined4 param_2)

{
  wchar_t wVar1;
  short sVar2;
  int iVar3;
  uint uVar4;
  wchar_t *pwVar5;
  int iVar6;
  short *psVar7;
  undefined4 uVar8;
  int in_ECX;
  int iVar9;
  undefined4 *puVar10;
  undefined1 local_248 [4];
  undefined2 local_244;
  undefined4 local_234;
  uint local_230;
  undefined4 local_228;
  undefined1 local_224 [4];
  undefined4 *local_220;
  short local_21c [3];
  char local_215;
  wchar_t local_214;
  undefined1 local_212 [510];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b176b0;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  local_228 = 0;
  local_214 = L'\0';
  local_14 = uVar4;
  _memset(local_212,0,0x1fe);
  _swprintf_s(&local_214,0x100,L"%I64d",param_1,param_2,uVar4);
  puVar10 = (undefined4 *)(in_ECX + 4);
  *(undefined4 *)(in_ECX + 0x18) = 7;
  *(undefined4 *)(in_ECX + 0x14) = 0;
  pwVar5 = &local_214;
  *(undefined2 *)puVar10 = 0;
  do {
    wVar1 = *pwVar5;
    pwVar5 = pwVar5 + 1;
  } while (wVar1 != L'\0');
  FUN_00406360(&local_214,(int)pwVar5 - (int)local_212 >> 1);
  local_8 = 0;
  local_228 = 1;
  local_215 = '\0';
  iVar6 = FUN_00403c70(&DAT_00bfd788,1);
  if (iVar6 != -1) {
    local_220 = puVar10;
    if (7 < *(uint *)(in_ECX + 0x18)) {
      local_220 = (undefined4 *)*puVar10;
    }
    if (7 < *(uint *)(in_ECX + 0x18)) {
      puVar10 = (undefined4 *)*puVar10;
    }
    FUN_00401b40(local_224,0xfffffffc,puVar10,0xfffffffc,(undefined2 *)((int)local_220 + 2));
    local_215 = '\x01';
  }
  iVar6 = *(int *)(in_ECX + 0x14);
  local_21c[1] = 0;
  local_21c[0] = (ushort)(DAT_00da9b34 == 5) * 2 + 0x2c;
  if (3 < iVar6) {
    iVar3 = iVar6 / 3;
    iVar9 = iVar3 + 1;
    if (iVar6 == iVar3 * 3) {
      iVar9 = iVar3;
    }
    if (1 < iVar9) {
      local_220 = (undefined4 *)(iVar9 + -1);
      do {
        psVar7 = local_21c;
        do {
          sVar2 = *psVar7;
          psVar7 = psVar7 + 1;
        } while (sVar2 != 0);
        FUN_00446e70(local_21c,(int)psVar7 - (int)(local_21c + 1) >> 1);
        local_220 = (undefined4 *)((int)local_220 + -1);
      } while (local_220 != (undefined4 *)0x0);
    }
  }
  if (local_215 != '\0') {
    uVar8 = FUN_00403380(local_248);
    local_8 = 1;
    FUN_00405eb0(uVar8,0,0xffffffff);
    local_8 = local_8 & 0xffffff00;
    if (7 < local_230) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_230 = 7;
    local_234 = 0;
    local_244 = 0;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0070c2d0 : PUSH EBP
0070c2d1 : MOV EBP,ESP
0070c2d3 : PUSH -0x1
0070c2d5 : PUSH 0xb176b0
0070c2da : MOV EAX,FS:[0x0]
0070c2e0 : PUSH EAX
0070c2e1 : SUB ESP,0x23c
0070c2e7 : MOV EAX,[0x00d66fa0]
0070c2ec : XOR EAX,EBP
0070c2ee : MOV dword ptr [EBP + -0x10],EAX
0070c2f1 : PUSH EBX
0070c2f2 : PUSH ESI
0070c2f3 : PUSH EDI
0070c2f4 : PUSH EAX
0070c2f5 : LEA EAX,[EBP + -0xc]
0070c2f8 : MOV FS:[0x0],EAX
0070c2fe : XOR EBX,EBX
0070c300 : MOV dword ptr [EBP + -0x4],EBX
0070c303 : MOV EDI,ECX
0070c305 : PUSH 0x1fe
0070c30a : LEA ECX,[EBP + 0xfffffdf2]
0070c310 : XOR EAX,EAX
0070c312 : PUSH EBX
0070c313 : MOV dword ptr [EBP + 0xfffffddc],EBX
0070c319 : PUSH ECX
0070c31a : MOV dword ptr [EBP + 0xfffffdd8],EDI
0070c320 : MOV word ptr [EBP + 0xfffffdf0],AX
0070c327 : CALL 0x0063b700
0070c32c : MOV EDX,dword ptr [EBP + 0xc]
0070c32f : MOV EAX,dword ptr [EBP + 0x8]
0070c332 : ADD ESP,0xc
0070c335 : PUSH EDX
0070c336 : PUSH EAX
0070c337 : PUSH 0xbfd77c
0070c33c : LEA ECX,[EBP + 0xfffffdf0]
0070c342 : PUSH 0x100
0070c347 : PUSH ECX
0070c348 : CALL 0x00635d51
0070c34d : ADD ESP,0x14
0070c350 : XOR EDX,EDX
0070c352 : LEA ESI,[EDI + 0x4]
0070c355 : MOV dword ptr [EDI + 0x18],0x7
0070c35c : MOV dword ptr [EDI + 0x14],EBX
0070c35f : LEA EAX,[EBP + 0xfffffdf0]
0070c365 : MOV word ptr [ESI],DX
0070c368 : LEA EDX,[EAX + 0x2]
0070c36b : JMP 0x0070c370
0070c370 : MOV CX,word ptr [EAX]
0070c373 : ADD EAX,0x2
0070c376 : CMP CX,BX
0070c379 : JNZ 0x0070c370
0070c37b : SUB EAX,EDX
0070c37d : SAR EAX,0x1
0070c37f : PUSH EAX
0070c380 : LEA EAX,[EBP + 0xfffffdf0]
0070c386 : PUSH EAX
0070c387 : MOV ECX,EDI
0070c389 : CALL 0x00406360
0070c38e : MOV dword ptr [EBP + -0x4],EBX
0070c391 : PUSH 0x1
0070c393 : PUSH 0xbfd788
0070c398 : XOR EDX,EDX
0070c39a : MOV EAX,EDI
0070c39c : MOV dword ptr [EBP + 0xfffffddc],0x1
0070c3a6 : MOV byte ptr [EBP + 0xfffffdef],0x0
0070c3ad : CALL 0x00403c70
0070c3b2 : CMP EAX,-0x1
0070c3b5 : JZ 0x0070c3f7
0070c3b7 : MOV EBX,dword ptr [EDI + 0x18]
0070c3ba : CMP EBX,0x8
0070c3bd : JC 0x0070c3c3
0070c3bf : MOV EAX,dword ptr [ESI]
0070c3c1 : JMP 0x0070c3c5
0070c3c3 : MOV EAX,ESI
0070c3c5 : MOV ECX,0xfffffffc
0070c3ca : MOV dword ptr [EBP + 0xfffffde4],EAX
0070c3d0 : LEA EDX,[EAX + 0x2]
0070c3d3 : CMP EBX,0x8
0070c3d6 : JC 0x0070c3dc
0070c3d8 : MOV EBX,dword ptr [ESI]
0070c3da : JMP 0x0070c3de
0070c3dc : MOV EBX,ESI
0070c3de : PUSH EDX
0070c3df : PUSH ECX
0070c3e0 : MOV EAX,ECX
0070c3e2 : PUSH EBX
0070c3e3 : PUSH EAX
0070c3e4 : LEA ECX,[EBP + 0xfffffde0]
0070c3ea : PUSH ECX
0070c3eb : CALL 0x00401b40
0070c3f0 : MOV byte ptr [EBP + 0xfffffdef],0x1
0070c3f7 : MOV EBX,dword ptr [EDI + 0x14]
0070c3fa : XOR EAX,EAX
0070c3fc : XOR EDX,EDX
0070c3fe : CMP word ptr [0x00da9b34],0x5
0070c406 : MOV word ptr [EBP + 0xfffffdea],DX
0070c40d : SETZ AL
0070c410 : CMP EBX,0x3
0070c413 : LEA EAX,[EAX + EAX*0x1 + 0x2c]
0070c417 : MOV word ptr [EBP + 0xfffffde8],AX
0070c41e : JLE 0x0070c48e
0070c420 : MOV EAX,0x55555556
0070c425 : IMUL EBX
0070c427 : MOV EAX,EDX
0070c429 : SHR EAX,0x1f
0070c42c : ADD EAX,EDX
0070c42e : LEA ECX,[EAX + 0x1]
0070c431 : LEA EDX,[EAX + EAX*0x2]
0070c434 : MOV EAX,EBX
0070c436 : SUB EAX,EDX
0070c438 : JNZ 0x0070c43b
0070c43a : DEC ECX
0070c43b : CMP ECX,0x1
0070c43e : JLE 0x0070c48e
0070c440 : DEC ECX
0070c441 : MOV ESI,0x3
0070c446 : MOV dword ptr [EBP + 0xfffffde4],ECX
0070c44c : LEA ESP,[ESP]
0070c450 : LEA EAX,[EBP + 0xfffffde8]
0070c456 : LEA EDX,[EAX + 0x2]
0070c459 : LEA ESP,[ESP]
0070c460 : MOV CX,word ptr [EAX]
0070c463 : ADD EAX,0x2
0070c466 : TEST CX,CX
0070c469 : JNZ 0x0070c460
0070c46b : SUB EAX,EDX
0070c46d : SAR EAX,0x1
0070c46f : PUSH EAX
0070c470 : LEA ECX,[EBP + 0xfffffde8]
0070c476 : PUSH ECX
0070c477 : MOV EAX,EBX
0070c479 : SUB EAX,ESI
0070c47b : MOV ECX,EDI
0070c47d : CALL 0x00446e70
0070c482 : ADD ESI,0x3
0070c485 : SUB dword ptr [EBP + 0xfffffde4],0x1
0070c48c : JNZ 0x0070c450
0070c48e : CMP byte ptr [EBP + 0xfffffdef],0x0
0070c495 : JZ 0x0070c4f4
0070c497 : LEA EDX,[EBP + 0xfffffdbc]
0070c49d : PUSH EDI
0070c49e : PUSH EDX
0070c49f : MOV EDX,0xbfd78c
0070c4a4 : CALL 0x00403380
0070c4a9 : ADD ESP,0x8
0070c4ac : MOV dword ptr [EBP + -0x4],0x1
0070c4b3 : PUSH -0x1
0070c4b5 : PUSH 0x0
0070c4b7 : PUSH EAX
0070c4b8 : MOV ECX,EDI
0070c4ba : CALL 0x00405eb0
0070c4bf : MOV byte ptr [EBP + -0x4],0x0
0070c4c3 : CMP dword ptr [EBP + 0xfffffdd4],0x8
0070c4ca : JC 0x0070c4d7
0070c4cc : MOV ECX,dword ptr [EBP + 0xfffffdc0]
0070c4d2 : CALL 0x006f04e0
0070c4d7 : XOR EAX,EAX
0070c4d9 : MOV dword ptr [EBP + 0xfffffdd4],0x7
0070c4e3 : MOV dword ptr [EBP + 0xfffffdd0],0x0
0070c4ed : MOV word ptr [EBP + 0xfffffdc0],AX
0070c4f4 : MOV EAX,EDI
0070c4f6 : MOV ECX,dword ptr [EBP + -0xc]
0070c4f9 : MOV dword ptr FS:[0x0],ECX
0070c500 : POP ECX
0070c501 : POP EDI
0070c502 : POP ESI
0070c503 : POP EBX
0070c504 : MOV ECX,dword ptr [EBP + -0x10]
0070c507 : XOR ECX,EBP
0070c509 : CALL 0x00633e6b
0070c50e : MOV ESP,EBP
0070c510 : POP EBP
0070c511 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00516610
ENTRY    : 00516610
BODY     : [[00516610, 0051664e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00516610(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int in_ECX;
  
  puVar2 = *(undefined4 **)(in_ECX + 0x18);
  while (puVar2 != (undefined4 *)0x0) {
    puVar1 = (undefined4 *)puVar2[1];
    CloseHandle((HANDLE)*puVar2);
    FUN_00515cf0(puVar2);
    puVar2 = puVar1;
  }
  *(undefined4 *)(in_ECX + 0x18) = 0;
  *(undefined4 *)(in_ECX + 0x20) = 0;
  *(undefined4 *)(in_ECX + 0x1c) = 0;
  FUN_005a20f0();
  return;
}



============================================================
DISASSEMBLY
============================================================
00516610 : PUSH EBX
00516611 : MOV EBX,ECX
00516613 : PUSH ESI
00516614 : MOV ESI,dword ptr [EBX + 0x18]
00516617 : XOR EAX,EAX
00516619 : CMP ESI,EAX
0051661b : JZ 0x0051663d
0051661d : PUSH EBP
0051661e : MOV EBP,dword ptr [0x00b85104]
00516624 : PUSH EDI
00516625 : MOV EDI,ESI
00516627 : MOV EAX,dword ptr [EDI]
00516629 : MOV ESI,dword ptr [ESI + 0x4]
0051662c : PUSH EAX
0051662d : CALL EBP
0051662f : PUSH EDI
00516630 : CALL 0x00515cf0
00516635 : TEST ESI,ESI
00516637 : JNZ 0x00516625
00516639 : POP EDI
0051663a : XOR EAX,EAX
0051663c : POP EBP
0051663d : POP ESI
0051663e : MOV dword ptr [EBX + 0x18],EAX
00516641 : MOV dword ptr [EBX + 0x20],EAX
00516644 : MOV dword ptr [EBX + 0x1c],EAX
00516647 : MOV ECX,EBX
00516649 : POP EBX
0051664a : JMP 0x005a20f0

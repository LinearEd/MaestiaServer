PROGRAM  : Maestia.exe
FUNCTION : FUN_0088e570
ENTRY    : 0088e570
BODY     : [[0088e570, 0088e99b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0088e570(int param_1)

{
  int iVar1;
  int *piVar2;
  char cVar3;
  short sVar4;
  undefined4 uVar5;
  int *in_ECX;
  undefined4 uStack_b4;
  int iStack_b0;
  undefined4 auStack_90 [8];
  int iStack_70;
  int iStack_6c;
  int iStack_68;
  undefined4 uStack_64;
  undefined4 uStack_60;
  undefined4 uStack_5c;
  undefined4 uStack_58;
  undefined4 uStack_54;
  undefined4 uStack_4c;
  undefined4 uStack_44;
  undefined1 auStack_38 [4];
  undefined2 uStack_34;
  undefined4 uStack_24;
  undefined4 uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  uint uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b2aa21;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&uStack_b4;
  ExceptionList = &local_14;
  cVar3 = (**(code **)(*in_ECX + 0x200))(DAT_00d66fa0 ^ (uint)&stack0xffffff40);
  if (cVar3 != '\0') goto LAB_0088e976;
  uStack_b4 = 0;
  sVar4 = (**(code **)(*in_ECX + 0x1e4))();
  if (sVar4 == 0) {
    sVar4 = (**(code **)(*in_ECX + 0x1e4))();
    if (sVar4 == 0) {
      uStack_b4 = 1;
    }
    else {
      sVar4 = (**(code **)(*in_ECX + 0x1e4))();
      if ((sVar4 == 0) || (in_ECX == *(int **)(DAT_0172491c + 0x17c))) {
        uStack_b4 = 2;
      }
    }
  }
  else {
    uStack_b4 = 0;
  }
  if (param_1 == 2) {
    uStack_b4 = 0;
  }
  FUN_00438c30(auStack_90);
  uStack_c = 0;
  FUN_00484470(&param_1);
  if (iStack_b0 == in_ECX[0x176]) {
    FUN_00484470(&param_1);
    if (iStack_b0 != in_ECX[0x179]) {
      auStack_90[0] = uStack_b4;
      uStack_20 = 7;
      uStack_24 = 0;
      uStack_34 = 0;
      uStack_c._0_1_ = 1;
      if (*(char *)((int)in_ECX + 0x7e) == '\0') {
        uVar5 = FUN_00404350(*(int *)(iStack_b0 + 0x10) + 0x1a);
        uStack_c._0_1_ = 2;
      }
      else {
        uVar5 = FUN_00404350(*(int *)(iStack_b0 + 0x10) + 0x5a);
        uStack_c._0_1_ = 3;
      }
      FUN_00405eb0(uVar5,0,0xffffffff);
      uStack_c = CONCAT31(uStack_c._1_3_,1);
      FUN_00406560();
      FUN_00405eb0(auStack_38,0,0xffffffff);
      piVar2 = (int *)in_ECX[0xfa];
      uStack_44 = 0;
      if (*(char *)((int)piVar2 + 0x5d) != '\0') {
        (**(code **)(*piVar2 + 0x14))();
      }
      iStack_70 = piVar2[0x2e];
      iStack_6c = piVar2[0x2f];
      iStack_68 = piVar2[0x30];
      uStack_64 = 0;
      uStack_60 = 0;
      uStack_5c = 0;
      uStack_58 = 0;
      uStack_54 = 0;
      uStack_4c = 0x3f800000;
      FUN_007be1c0(DAT_01725208,auStack_90);
      uStack_c = uStack_c & 0xffffff00;
      FUN_00406560();
      uStack_c = 0xffffffff;
      FUN_004427d0(auStack_90);
      goto LAB_0088e976;
    }
    FUN_00484470(&param_1);
    if (iStack_b0 == in_ECX[0x17c]) {
      uStack_c = 0xffffffff;
      FUN_004427d0(auStack_90);
      goto LAB_0088e976;
    }
    auStack_90[0] = uStack_b4;
    uVar5 = FUN_00404350(*(int *)(iStack_b0 + 0x10) + 0x1a);
    uStack_c._0_1_ = 4;
    FUN_00405eb0(uVar5,0,0xffffffff);
    uStack_c = (uint)uStack_c._1_3_ << 8;
    FUN_00406560();
    piVar2 = (int *)in_ECX[0xfa];
    uStack_44 = 0;
    if (*(char *)((int)piVar2 + 0x5d) != '\0') {
      (**(code **)(*piVar2 + 0x14))();
    }
    iStack_70 = piVar2[0x2e];
    iStack_6c = piVar2[0x2f];
    iStack_68 = piVar2[0x30];
    uStack_64 = 0;
    uStack_60 = 0;
    uStack_4c = 0x3f800000;
  }
  else {
    iVar1 = *(int *)(iStack_b0 + 0x10);
    auStack_90[0] = uStack_b4;
    FUN_00405eb0(iVar1,0,0xffffffff);
    piVar2 = (int *)in_ECX[0xfa];
    uStack_44 = 0;
    if (*(char *)((int)piVar2 + 0x5d) != '\0') {
      (**(code **)(*piVar2 + 0x14))();
    }
    iStack_70 = piVar2[0x2e];
    iStack_6c = piVar2[0x2f];
    iStack_68 = piVar2[0x30];
    uStack_64 = *(undefined4 *)(iVar1 + 0x1c);
    uStack_60 = *(undefined4 *)(iVar1 + 0x20);
    uStack_4c = *(undefined4 *)(iVar1 + 0x24);
  }
  uStack_54 = 0;
  uStack_58 = 0;
  uStack_5c = 0;
  FUN_007be1c0(DAT_01725208,auStack_90);
  uStack_c = 0xffffffff;
  FUN_004427d0(auStack_90);
LAB_0088e976:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&uStack_b4);
  return;
}



============================================================
DISASSEMBLY
============================================================
0088e570 : PUSH EBP
0088e571 : MOV EBP,ESP
0088e573 : AND ESP,0xfffffff8
0088e576 : PUSH -0x1
0088e578 : PUSH 0xb2aa21
0088e57d : MOV EAX,FS:[0x0]
0088e583 : PUSH EAX
0088e584 : SUB ESP,0xa0
0088e58a : MOV EAX,[0x00d66fa0]
0088e58f : XOR EAX,ESP
0088e591 : MOV dword ptr [ESP + 0x98],EAX
0088e598 : PUSH EBX
0088e599 : PUSH ESI
0088e59a : PUSH EDI
0088e59b : MOV EAX,[0x00d66fa0]
0088e5a0 : XOR EAX,ESP
0088e5a2 : PUSH EAX
0088e5a3 : LEA EAX,[ESP + 0xb0]
0088e5aa : MOV FS:[0x0],EAX
0088e5b0 : MOV EDI,ECX
0088e5b2 : MOV EAX,dword ptr [EDI]
0088e5b4 : MOV EDX,dword ptr [EAX + 0x200]
0088e5ba : CALL EDX
0088e5bc : TEST AL,AL
0088e5be : JNZ 0x0088e715
0088e5c4 : MOV EAX,dword ptr [EDI]
0088e5c6 : MOV EDX,dword ptr [EAX + 0x1e4]
0088e5cc : XOR EBX,EBX
0088e5ce : MOV ECX,EDI
0088e5d0 : MOV dword ptr [ESP + 0x10],EBX
0088e5d4 : CALL EDX
0088e5d6 : TEST AX,AX
0088e5d9 : JZ 0x0088e5e1
0088e5db : MOV dword ptr [ESP + 0x10],EBX
0088e5df : JMP 0x0088e622
0088e5e1 : MOV EAX,dword ptr [EDI]
0088e5e3 : MOV EDX,dword ptr [EAX + 0x1e4]
0088e5e9 : MOV ECX,EDI
0088e5eb : CALL EDX
0088e5ed : TEST AX,AX
0088e5f0 : JNZ 0x0088e5fc
0088e5f2 : MOV dword ptr [ESP + 0x10],0x1
0088e5fa : JMP 0x0088e622
0088e5fc : MOV EAX,dword ptr [EDI]
0088e5fe : MOV EDX,dword ptr [EAX + 0x1e4]
0088e604 : MOV ECX,EDI
0088e606 : CALL EDX
0088e608 : TEST AX,AX
0088e60b : JZ 0x0088e61a
0088e60d : MOV EAX,[0x0172491c]
0088e612 : CMP EDI,dword ptr [EAX + 0x17c]
0088e618 : JNZ 0x0088e622
0088e61a : MOV dword ptr [ESP + 0x10],0x2
0088e622 : CMP dword ptr [EBP + 0x8],0x2
0088e626 : JNZ 0x0088e62c
0088e628 : MOV dword ptr [ESP + 0x10],EBX
0088e62c : LEA ECX,[ESP + 0x34]
0088e630 : PUSH ECX
0088e631 : CALL 0x00438c30
0088e636 : MOV dword ptr [ESP + 0xb8],EBX
0088e63d : LEA EDX,[EBP + 0x8]
0088e640 : PUSH EDX
0088e641 : LEA ECX,[EDI + 0x5d4]
0088e647 : LEA EAX,[ESP + 0x18]
0088e64b : CALL 0x00484470
0088e650 : MOV ECX,dword ptr [EDI + 0x5d8]
0088e656 : MOV EAX,dword ptr [ESP + 0x14]
0088e65a : CMP EAX,ECX
0088e65c : JZ 0x0088e71f
0088e662 : MOV ESI,dword ptr [EAX + 0x10]
0088e665 : MOV EAX,dword ptr [ESP + 0x10]
0088e669 : PUSH -0x1
0088e66b : PUSH EBX
0088e66c : PUSH ESI
0088e66d : LEA ECX,[ESP + 0x44]
0088e671 : MOV dword ptr [ESP + 0x40],EAX
0088e675 : CALL 0x00405eb0
0088e67a : MOV EDI,dword ptr [EDI + 0x3e8]
0088e680 : MOV dword ptr [ESP + 0x80],EBX
0088e687 : CMP byte ptr [EDI + 0x5d],BL
0088e68a : JZ 0x0088e695
0088e68c : MOV EDX,dword ptr [EDI]
0088e68e : MOV EAX,dword ptr [EDX + 0x14]
0088e691 : MOV ECX,EDI
0088e693 : CALL EAX
0088e695 : MOVSS XMM0,dword ptr [EDI + 0xb8]
0088e69d : MOVSS dword ptr [ESP + 0x54],XMM0
0088e6a3 : MOVSS XMM0,dword ptr [EDI + 0xbc]
0088e6ab : MOVSS dword ptr [ESP + 0x58],XMM0
0088e6b1 : MOVSS XMM0,dword ptr [EDI + 0xc0]
0088e6b9 : MOVSS dword ptr [ESP + 0x5c],XMM0
0088e6bf : MOVSS XMM0,dword ptr [ESI + 0x1c]
0088e6c4 : MOVSS dword ptr [ESP + 0x60],XMM0
0088e6ca : MOVSS XMM0,dword ptr [ESI + 0x20]
0088e6cf : MOVSS dword ptr [ESP + 0x64],XMM0
0088e6d5 : MOV dword ptr [ESP + 0x68],EBX
0088e6d9 : MOV dword ptr [ESP + 0x6c],EBX
0088e6dd : MOV dword ptr [ESP + 0x70],EBX
0088e6e1 : MOVSS XMM0,dword ptr [ESI + 0x24]
0088e6e6 : MOV EDX,dword ptr [0x01725208]
0088e6ec : LEA ECX,[ESP + 0x34]
0088e6f0 : PUSH ECX
0088e6f1 : PUSH EDX
0088e6f2 : MOVSS dword ptr [ESP + 0x80],XMM0
0088e6fb : CALL 0x007be1c0
0088e700 : MOV dword ptr [ESP + 0xb8],0xffffffff
0088e70b : LEA EAX,[ESP + 0x34]
0088e70f : PUSH EAX
0088e710 : CALL 0x004427d0
0088e715 : MOV EAX,0x1
0088e71a : JMP 0x0088e976
0088e71f : LEA ECX,[EBP + 0x8]
0088e722 : PUSH ECX
0088e723 : LEA ECX,[EDI + 0x5e0]
0088e729 : LEA EAX,[ESP + 0x18]
0088e72d : CALL 0x00484470
0088e732 : MOV ECX,dword ptr [EDI + 0x5e4]
0088e738 : MOV EAX,dword ptr [ESP + 0x14]
0088e73c : CMP EAX,ECX
0088e73e : JZ 0x0088e88f
0088e744 : MOV EAX,dword ptr [EAX + 0x10]
0088e747 : MOV EDX,dword ptr [ESP + 0x10]
0088e74b : XOR ECX,ECX
0088e74d : MOV dword ptr [ESP + 0x34],EDX
0088e751 : MOV dword ptr [ESP + 0xa4],0x7
0088e75c : MOV dword ptr [ESP + 0xa0],EBX
0088e763 : MOV word ptr [ESP + 0x90],CX
0088e76b : MOV byte ptr [ESP + 0xb8],0x1
0088e773 : LEA ESI,[ESP + 0x18]
0088e777 : CMP byte ptr [EDI + 0x7e],BL
0088e77a : JNZ 0x0088e792
0088e77c : ADD EAX,0x1a
0088e77f : PUSH EAX
0088e780 : CALL 0x00404350
0088e785 : ADD ESP,0x4
0088e788 : MOV byte ptr [ESP + 0xb8],0x2
0088e790 : JMP 0x0088e7a6
0088e792 : ADD EAX,0x5a
0088e795 : PUSH EAX
0088e796 : CALL 0x00404350
0088e79b : ADD ESP,0x4
0088e79e : MOV byte ptr [ESP + 0xb8],0x3
0088e7a6 : PUSH -0x1
0088e7a8 : PUSH EBX
0088e7a9 : PUSH EAX
0088e7aa : LEA ECX,[ESP + 0x98]
0088e7b1 : CALL 0x00405eb0
0088e7b6 : MOV byte ptr [ESP + 0xb8],0x1
0088e7be : LEA ECX,[ESP + 0x18]
0088e7c2 : CALL 0x00406560
0088e7c7 : PUSH -0x1
0088e7c9 : PUSH EBX
0088e7ca : LEA EDX,[ESP + 0x94]
0088e7d1 : PUSH EDX
0088e7d2 : LEA ECX,[ESP + 0x44]
0088e7d6 : CALL 0x00405eb0
0088e7db : MOV EDI,dword ptr [EDI + 0x3e8]
0088e7e1 : MOV dword ptr [ESP + 0x80],EBX
0088e7e8 : CMP byte ptr [EDI + 0x5d],BL
0088e7eb : JZ 0x0088e7f6
0088e7ed : MOV EAX,dword ptr [EDI]
0088e7ef : MOV EDX,dword ptr [EAX + 0x14]
0088e7f2 : MOV ECX,EDI
0088e7f4 : CALL EDX
0088e7f6 : MOVSS XMM0,dword ptr [EDI + 0xb8]
0088e7fe : MOV ECX,dword ptr [0x01725208]
0088e804 : MOVSS dword ptr [ESP + 0x54],XMM0
0088e80a : MOVSS XMM0,dword ptr [EDI + 0xbc]
0088e812 : MOVSS dword ptr [ESP + 0x58],XMM0
0088e818 : MOVSS XMM0,dword ptr [EDI + 0xc0]
0088e820 : MOVSS dword ptr [ESP + 0x5c],XMM0
0088e826 : XORPS XMM0,XMM0
0088e829 : LEA EAX,[ESP + 0x34]
0088e82d : PUSH EAX
0088e82e : MOVSS dword ptr [ESP + 0x64],XMM0
0088e834 : MOVSS dword ptr [ESP + 0x68],XMM0
0088e83a : MOVSS XMM0,dword ptr [0x00c10fc4]
0088e842 : PUSH ECX
0088e843 : MOV dword ptr [ESP + 0x70],EBX
0088e847 : MOV dword ptr [ESP + 0x74],EBX
0088e84b : MOV dword ptr [ESP + 0x78],EBX
0088e84f : MOVSS dword ptr [ESP + 0x80],XMM0
0088e858 : CALL 0x007be1c0
0088e85d : MOV byte ptr [ESP + 0xb8],BL
0088e864 : LEA ECX,[ESP + 0x8c]
0088e86b : CALL 0x00406560
0088e870 : MOV dword ptr [ESP + 0xb8],0xffffffff
0088e87b : LEA EDX,[ESP + 0x34]
0088e87f : PUSH EDX
0088e880 : CALL 0x004427d0
0088e885 : MOV EAX,0x1
0088e88a : JMP 0x0088e976
0088e88f : LEA EAX,[EBP + 0x8]
0088e892 : PUSH EAX
0088e893 : LEA ECX,[EDI + 0x5ec]
0088e899 : LEA EAX,[ESP + 0x18]
0088e89d : CALL 0x00484470
0088e8a2 : MOV ECX,dword ptr [EDI + 0x5f0]
0088e8a8 : MOV EAX,dword ptr [ESP + 0x14]
0088e8ac : CMP EAX,ECX
0088e8ae : JZ 0x0088e95f
0088e8b4 : MOV EAX,dword ptr [EAX + 0x10]
0088e8b7 : MOV ECX,dword ptr [ESP + 0x10]
0088e8bb : ADD EAX,0x1a
0088e8be : PUSH EAX
0088e8bf : LEA ESI,[ESP + 0x1c]
0088e8c3 : MOV dword ptr [ESP + 0x38],ECX
0088e8c7 : CALL 0x00404350
0088e8cc : ADD ESP,0x4
0088e8cf : MOV byte ptr [ESP + 0xb8],0x4
0088e8d7 : PUSH -0x1
0088e8d9 : PUSH EBX
0088e8da : PUSH EAX
0088e8db : LEA ECX,[ESP + 0x44]
0088e8df : CALL 0x00405eb0
0088e8e4 : MOV byte ptr [ESP + 0xb8],BL
0088e8eb : MOV ECX,ESI
0088e8ed : CALL 0x00406560
0088e8f2 : MOV EDI,dword ptr [EDI + 0x3e8]
0088e8f8 : MOV dword ptr [ESP + 0x80],EBX
0088e8ff : CMP byte ptr [EDI + 0x5d],BL
0088e902 : JZ 0x0088e90d
0088e904 : MOV EDX,dword ptr [EDI]
0088e906 : MOV EAX,dword ptr [EDX + 0x14]
0088e909 : MOV ECX,EDI
0088e90b : CALL EAX
0088e90d : MOVSS XMM0,dword ptr [EDI + 0xb8]
0088e915 : MOVSS dword ptr [ESP + 0x54],XMM0
0088e91b : MOVSS XMM0,dword ptr [EDI + 0xbc]
0088e923 : MOVSS dword ptr [ESP + 0x58],XMM0
0088e929 : MOVSS XMM0,dword ptr [EDI + 0xc0]
0088e931 : MOVSS dword ptr [ESP + 0x5c],XMM0
0088e937 : XORPS XMM0,XMM0
0088e93a : MOVSS dword ptr [ESP + 0x60],XMM0
0088e940 : MOVSS dword ptr [ESP + 0x64],XMM0
0088e946 : MOVSS XMM0,dword ptr [0x00c10fc4]
0088e94e : MOV dword ptr [ESP + 0x68],EBX
0088e952 : MOV dword ptr [ESP + 0x6c],EBX
0088e956 : MOV dword ptr [ESP + 0x70],EBX
0088e95a : JMP 0x0088e6e6
0088e95f : MOV dword ptr [ESP + 0xb8],0xffffffff
0088e96a : LEA ECX,[ESP + 0x34]
0088e96e : PUSH ECX
0088e96f : CALL 0x004427d0
0088e974 : XOR EAX,EAX
0088e976 : MOV ECX,dword ptr [ESP + 0xb0]
0088e97d : MOV dword ptr FS:[0x0],ECX
0088e984 : POP ECX
0088e985 : POP EDI
0088e986 : POP ESI
0088e987 : POP EBX
0088e988 : MOV ECX,dword ptr [ESP + 0x98]
0088e98f : XOR ECX,ESP
0088e991 : CALL 0x00633e6b
0088e996 : MOV ESP,EBP
0088e998 : POP EBP
0088e999 : RET 0x4

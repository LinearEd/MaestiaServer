PROGRAM  : Maestia.exe
FUNCTION : FUN_0044b6c0
ENTRY    : 0044b6c0
BODY     : [[0044b6c0, 0044b778]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0044b705) */

undefined4 * FUN_0044b6c0(void)

{
  uint uVar1;
  uint uVar2;
  int in_EAX;
  int in_ECX;
  ushort *puVar3;
  ushort *puVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *local_c;
  
  local_c = *(undefined4 **)(in_EAX + 4);
  if (*(char *)((int)local_c[1] + 0x99) == '\0') {
    uVar1 = *(uint *)(in_ECX + 0x14);
    puVar6 = (undefined4 *)local_c[1];
    do {
      puVar3 = (ushort *)(in_ECX + 4);
      if (7 < *(uint *)(in_ECX + 0x18)) {
        puVar3 = *(ushort **)(in_ECX + 4);
      }
      uVar2 = puVar6[8];
      uVar5 = uVar2;
      if (uVar1 <= uVar2) {
        uVar5 = uVar1;
      }
      if ((uint)puVar6[9] < 8) {
        puVar4 = (ushort *)(puVar6 + 4);
      }
      else {
        puVar4 = (ushort *)puVar6[4];
      }
      for (; uVar5 != 0; uVar5 = uVar5 - 1) {
        if (*puVar4 != *puVar3) {
          uVar5 = (-(uint)(*puVar4 < *puVar3) & 0xfffffffe) + 1;
          if (uVar5 != 0) goto LAB_0044b743;
          break;
        }
        puVar4 = puVar4 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar2 < uVar1) {
LAB_0044b747:
        puVar7 = (undefined4 *)puVar6[2];
      }
      else {
        uVar5 = (uint)(uVar2 != uVar1);
LAB_0044b743:
        if ((int)uVar5 < 0) goto LAB_0044b747;
        puVar7 = (undefined4 *)*puVar6;
        local_c = puVar6;
      }
      puVar6 = puVar7;
    } while (*(char *)((int)puVar7 + 0x99) == '\0');
  }
  return local_c;
}



============================================================
DISASSEMBLY
============================================================
0044b6c0 : PUSH EBP
0044b6c1 : MOV EBP,ESP
0044b6c3 : SUB ESP,0x10
0044b6c6 : MOV EAX,dword ptr [EAX + 0x4]
0044b6c9 : PUSH EDI
0044b6ca : MOV EDI,dword ptr [EAX + 0x4]
0044b6cd : CMP byte ptr [EDI + 0x99],0x0
0044b6d4 : MOV dword ptr [EBP + -0x8],EAX
0044b6d7 : JNZ 0x0044b774
0044b6dd : MOV EAX,dword ptr [ECX + 0x14]
0044b6e0 : MOV EDX,dword ptr [ECX + 0x18]
0044b6e3 : PUSH EBX
0044b6e4 : ADD ECX,0x4
0044b6e7 : PUSH ESI
0044b6e8 : MOV dword ptr [EBP + -0x4],EAX
0044b6eb : MOV dword ptr [EBP + -0x10],EDX
0044b6ee : MOV dword ptr [EBP + -0xc],ECX
0044b6f1 : JMP 0x0044b6f6
0044b6f3 : MOV ECX,dword ptr [EBP + -0xc]
0044b6f6 : CMP dword ptr [EBP + -0x10],0x8
0044b6fa : JC 0x0044b6fe
0044b6fc : MOV ECX,dword ptr [ECX]
0044b6fe : MOV EBX,dword ptr [EDI + 0x20]
0044b701 : MOV EDX,EBX
0044b703 : CMP EDX,EBX
0044b705 : CMOVC EBX,EDX
0044b708 : MOV ESI,EBX
0044b70a : CMP EBX,EAX
0044b70c : JC 0x0044b710
0044b70e : MOV ESI,EAX
0044b710 : CMP dword ptr [EDI + 0x24],0x8
0044b714 : JC 0x0044b71b
0044b716 : MOV EDX,dword ptr [EDI + 0x10]
0044b719 : JMP 0x0044b71e
0044b71b : LEA EDX,[EDI + 0x10]
0044b71e : TEST ESI,ESI
0044b720 : JBE 0x0044b738
0044b722 : MOV AX,word ptr [EDX]
0044b725 : CMP AX,word ptr [ECX]
0044b728 : JNZ 0x0044b74c
0044b72a : ADD EDX,0x2
0044b72d : ADD ECX,0x2
0044b730 : SUB ESI,0x1
0044b733 : JNZ 0x0044b722
0044b735 : MOV EAX,dword ptr [EBP + -0x4]
0044b738 : CMP EBX,EAX
0044b73a : JC 0x0044b747
0044b73c : XOR ECX,ECX
0044b73e : CMP EBX,EAX
0044b740 : SETNZ CL
0044b743 : TEST ECX,ECX
0044b745 : JGE 0x0044b761
0044b747 : MOV EDI,dword ptr [EDI + 0x8]
0044b74a : JMP 0x0044b766
0044b74c : MOV DX,AX
0044b74f : CMP DX,word ptr [ECX]
0044b752 : SBB ECX,ECX
0044b754 : AND ECX,0xfffffffe
0044b757 : ADD ECX,0x1
0044b75a : JZ 0x0044b735
0044b75c : MOV EAX,dword ptr [EBP + -0x4]
0044b75f : JMP 0x0044b743
0044b761 : MOV dword ptr [EBP + -0x8],EDI
0044b764 : MOV EDI,dword ptr [EDI]
0044b766 : CMP byte ptr [EDI + 0x99],0x0
0044b76d : JZ 0x0044b6f3
0044b76f : MOV EAX,dword ptr [EBP + -0x8]
0044b772 : POP ESI
0044b773 : POP EBX
0044b774 : POP EDI
0044b775 : MOV ESP,EBP
0044b777 : POP EBP
0044b778 : RET

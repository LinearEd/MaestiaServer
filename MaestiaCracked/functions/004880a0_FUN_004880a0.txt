PROGRAM  : Maestia.exe
FUNCTION : FUN_004880a0
ENTRY    : 004880a0
BODY     : [[004880a0, 004881f5] [004881fc, 00488227] [00488269, 004882f7] [00488315, 0048838d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004880a0(int param_1,int param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  uint extraout_ECX;
  int iVar5;
  uint uStack_48;
  undefined1 local_34 [20];
  int local_20;
  undefined4 local_1c;
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b80694;
  local_10 = ExceptionList;
  uStack_48 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_48;
  ExceptionList = &local_10;
  iVar2 = *(int *)(param_1 + 4);
  if (iVar2 == 0) {
    local_18 = 0;
  }
  else {
    local_18 = (*(int *)(param_1 + 0xc) - iVar2) / 0x14;
  }
  iVar5 = *(int *)(param_1 + 8);
  iVar2 = (iVar5 - iVar2) / 0x14;
  puVar1 = &uStack_48;
  if (iVar2 == 0xccccccc) {
    iVar2 = FUN_00452880();
    local_18 = extraout_ECX;
    puVar1 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar1;
  uVar3 = iVar2 + 1;
  if (local_18 < uVar3) {
    if (0xccccccc - (local_18 >> 1) < local_18) {
      local_18 = 0;
    }
    else {
      local_18 = local_18 + (local_18 >> 1);
    }
    if (local_18 < uVar3) {
      local_18 = uVar3;
    }
    iVar2 = FUN_00488520();
    local_20 = (param_2 - *(int *)(param_1 + 4)) / 0x14;
    local_1c = 0;
    local_8 = 0;
    FUN_00487da0();
    local_1c = 1;
    FUN_004884c0(*(undefined4 *)(param_1 + 4),param_2);
    local_1c = 2;
    FUN_004884c0(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = 0xffffffff;
    if (*(int *)(param_1 + 4) != 0) {
      FUN_00488080();
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = iVar2 + local_18 * 0x14;
    *(int *)(param_1 + 8) =
         iVar2 + ((*(int *)(param_1 + 8) - *(int *)(param_1 + 4)) / 0x14 + 1) * 0x14;
    *(int *)(param_1 + 4) = iVar2;
    ExceptionList = local_10;
    return;
  }
  iVar5 = iVar5 - param_2;
  iVar2 = iVar5 >> 0x1f;
  if (iVar5 / 0x14 + iVar2 == iVar2) {
    FUN_00488390(local_34,param_3);
    local_8 = 2;
    FUN_004884c0(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = CONCAT31(local_8._1_3_,3);
    FUN_00487da0();
    local_8 = 2;
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x14;
    FUN_004884f0(local_34);
  }
  else {
    FUN_00488390(local_34,param_3);
    local_8 = 5;
    uVar4 = FUN_004884c0(*(int *)(param_1 + 8) + -0x14,*(int *)(param_1 + 8));
    *(undefined4 *)(param_1 + 8) = uVar4;
    param_3 = param_3 & 0xffffff00;
    FUN_004888d0(param_2,param_2,param_2,param_3);
    FUN_004884f0(local_34);
  }
  local_8 = 0xffffffff;
  FUN_00446650(local_34);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
004880a0 : PUSH EBP
004880a1 : MOV EBP,ESP
004880a3 : PUSH -0x1
004880a5 : PUSH 0xb80694
004880aa : MOV EAX,FS:[0x0]
004880b0 : PUSH EAX
004880b1 : SUB ESP,0x28
004880b4 : PUSH EBX
004880b5 : PUSH ESI
004880b6 : PUSH EDI
004880b7 : MOV EAX,[0x00d66fa0]
004880bc : XOR EAX,EBP
004880be : PUSH EAX
004880bf : LEA EAX,[EBP + -0xc]
004880c2 : MOV FS:[0x0],EAX
004880c8 : MOV dword ptr [EBP + -0x10],ESP
004880cb : MOV EBX,dword ptr [EBP + 0x8]
004880ce : MOV ESI,dword ptr [EBX + 0x4]
004880d1 : TEST ESI,ESI
004880d3 : JNZ 0x004880d9
004880d5 : XOR ECX,ECX
004880d7 : JMP 0x004880f1
004880d9 : MOV ECX,dword ptr [EBX + 0xc]
004880dc : SUB ECX,ESI
004880de : MOV EAX,0x66666667
004880e3 : IMUL ECX
004880e5 : SAR EDX,0x3
004880e8 : MOV EAX,EDX
004880ea : SHR EAX,0x1f
004880ed : ADD EAX,EDX
004880ef : MOV ECX,EAX
004880f1 : MOV EDI,dword ptr [EBX + 0x8]
004880f4 : MOV EDX,EDI
004880f6 : SUB EDX,ESI
004880f8 : MOV EAX,0x66666667
004880fd : IMUL EDX
004880ff : SAR EDX,0x3
00488102 : MOV EAX,EDX
00488104 : SHR EAX,0x1f
00488107 : ADD EAX,EDX
00488109 : MOV EDX,0xccccccc
0048810e : SUB EDX,EAX
00488110 : CMP EDX,0x1
00488113 : JNC 0x0048811a
00488115 : CALL 0x00452880
0048811a : INC EAX
0048811b : CMP ECX,EAX
0048811d : JNC 0x00488269
00488123 : MOV EDX,ECX
00488125 : SHR EDX,0x1
00488127 : MOV ESI,0xccccccc
0048812c : SUB ESI,EDX
0048812e : CMP ESI,ECX
00488130 : JNC 0x0048813b
00488132 : XOR EDI,EDI
00488134 : MOV dword ptr [EBP + -0x14],EDI
00488137 : MOV ECX,EDI
00488139 : JMP 0x00488142
0048813b : ADD ECX,EDX
0048813d : MOV dword ptr [EBP + -0x14],ECX
00488140 : XOR EDI,EDI
00488142 : CMP ECX,EAX
00488144 : JNC 0x0048814b
00488146 : MOV dword ptr [EBP + -0x14],EAX
00488149 : MOV ECX,EAX
0048814b : CALL 0x00488520
00488150 : MOV ESI,EAX
00488152 : MOV dword ptr [EBP + 0x8],ESI
00488155 : MOV ECX,dword ptr [EBP + 0xc]
00488158 : SUB ECX,dword ptr [EBX + 0x4]
0048815b : MOV EAX,0x66666667
00488160 : IMUL ECX
00488162 : SAR EDX,0x3
00488165 : MOV EAX,EDX
00488167 : SHR EAX,0x1f
0048816a : ADD EAX,EDX
0048816c : MOV dword ptr [EBP + -0x1c],EAX
0048816f : MOV dword ptr [EBP + -0x18],EDI
00488172 : MOV dword ptr [EBP + -0x4],EDI
00488175 : LEA EAX,[EAX + EAX*0x4]
00488178 : LEA EDI,[ESI + EAX*0x4]
0048817b : MOV EDX,dword ptr [EBP + 0x10]
0048817e : MOV ESI,0x1
00488183 : CALL 0x00487da0
00488188 : MOV dword ptr [EBP + -0x18],ESI
0048818b : MOV ECX,dword ptr [EBP + 0xc]
0048818e : PUSH ECX
0048818f : MOV EDX,dword ptr [EBX + 0x4]
00488192 : PUSH EDX
00488193 : MOV EDI,dword ptr [EBP + 0x8]
00488196 : MOV EDX,EDI
00488198 : CALL 0x004884c0
0048819d : MOV dword ptr [EBP + -0x18],0x2
004881a4 : MOV EAX,dword ptr [EBP + -0x1c]
004881a7 : LEA EAX,[EAX + EAX*0x4 + 0x5]
004881ab : LEA EDX,[EDI + EAX*0x4]
004881ae : MOV ECX,dword ptr [EBX + 0x8]
004881b1 : PUSH ECX
004881b2 : MOV EAX,dword ptr [EBP + 0xc]
004881b5 : PUSH EAX
004881b6 : CALL 0x004884c0
004881bb : MOV dword ptr [EBP + -0x4],0xffffffff
004881c2 : MOV ECX,dword ptr [EBX + 0x8]
004881c5 : MOV ESI,dword ptr [EBX + 0x4]
004881c8 : SUB ECX,ESI
004881ca : MOV EAX,0x66666667
004881cf : IMUL ECX
004881d1 : SAR EDX,0x3
004881d4 : MOV ECX,EDX
004881d6 : SHR ECX,0x1f
004881d9 : LEA EDX,[EDX + ECX*0x1 + 0x1]
004881dd : MOV dword ptr [EBP + 0x10],EDX
004881e0 : TEST ESI,ESI
004881e2 : JZ 0x004881fc
004881e4 : MOV EDI,dword ptr [EBX + 0x8]
004881e7 : MOV EAX,ESI
004881e9 : CALL 0x00488080
004881ee : MOV ECX,dword ptr [EBX + 0x4]
004881f1 : CALL 0x006f04e0
004881fc : MOV EAX,dword ptr [EBP + -0x14]
004881ff : LEA EAX,[EAX + EAX*0x4]
00488202 : LEA ECX,[EDI + EAX*0x4]
00488205 : MOV dword ptr [EBX + 0xc],ECX
00488208 : LEA EDX,[EDX + EDX*0x4]
0048820b : LEA EAX,[EDI + EDX*0x4]
0048820e : MOV dword ptr [EBX + 0x8],EAX
00488211 : MOV dword ptr [EBX + 0x4],EDI
00488214 : MOV ECX,dword ptr [EBP + -0xc]
00488217 : MOV dword ptr FS:[0x0],ECX
0048821e : POP ECX
0048821f : POP EDI
00488220 : POP ESI
00488221 : POP EBX
00488222 : MOV ESP,EBP
00488224 : POP EBP
00488225 : RET 0xc
00488269 : SUB EDI,dword ptr [EBP + 0xc]
0048826c : MOV EAX,0x66666667
00488271 : IMUL EDI
00488273 : SAR EDX,0x3
00488276 : MOV ECX,EDX
00488278 : SHR ECX,0x1f
0048827b : ADD ECX,EDX
0048827d : CMP ECX,0x1
00488280 : JNC 0x00488315
00488286 : MOV EDX,dword ptr [EBP + 0x10]
00488289 : PUSH EDX
0048828a : LEA EAX,[EBP + -0x30]
0048828d : PUSH EAX
0048828e : CALL 0x00488390
00488293 : MOV dword ptr [EBP + -0x4],0x2
0048829a : MOV EAX,dword ptr [EBP + 0xc]
0048829d : LEA EDX,[EAX + 0x14]
004882a0 : MOV ECX,dword ptr [EBX + 0x8]
004882a3 : PUSH ECX
004882a4 : PUSH EAX
004882a5 : CALL 0x004884c0
004882aa : MOV byte ptr [EBP + -0x4],0x3
004882ae : MOV EDI,dword ptr [EBX + 0x8]
004882b1 : MOV ECX,EDI
004882b3 : SUB ECX,dword ptr [EBP + 0xc]
004882b6 : MOV EAX,0x66666667
004882bb : IMUL ECX
004882bd : SAR EDX,0x3
004882c0 : MOV EAX,EDX
004882c2 : SHR EAX,0x1f
004882c5 : ADD EAX,EDX
004882c7 : MOV ESI,0x1
004882cc : SUB ESI,EAX
004882ce : LEA EDX,[EBP + -0x30]
004882d1 : CALL 0x00487da0
004882d6 : MOV dword ptr [EBP + -0x4],0x2
004882dd : ADD dword ptr [EBX + 0x8],0x14
004882e1 : MOV EBX,dword ptr [EBX + 0x8]
004882e4 : LEA ECX,[EBP + -0x30]
004882e7 : PUSH ECX
004882e8 : LEA EDI,[EBX + -0x14]
004882eb : MOV EAX,dword ptr [EBP + 0xc]
004882ee : CALL 0x004884f0
004882f3 : ADD ESP,0x4
004882f6 : JMP 0x0048836a
00488315 : MOV ECX,dword ptr [EBP + 0x10]
00488318 : PUSH ECX
00488319 : LEA EDX,[EBP + -0x30]
0048831c : PUSH EDX
0048831d : CALL 0x00488390
00488322 : MOV dword ptr [EBP + -0x4],0x5
00488329 : MOV ESI,dword ptr [EBX + 0x8]
0048832c : LEA EDI,[ESI + -0x14]
0048832f : PUSH ESI
00488330 : PUSH EDI
00488331 : MOV EDX,ESI
00488333 : CALL 0x004884c0
00488338 : MOV dword ptr [EBX + 0x8],EAX
0048833b : MOV byte ptr [EBP + 0x10],0x0
0048833f : MOV EAX,dword ptr [EBP + 0x10]
00488342 : PUSH EAX
00488343 : MOV ECX,dword ptr [EBP + 0xc]
00488346 : PUSH ECX
00488347 : MOV EDX,dword ptr [EBP + 0xc]
0048834a : PUSH EDX
0048834b : MOV EAX,dword ptr [EBP + 0xc]
0048834e : PUSH EAX
0048834f : MOV EAX,ESI
00488351 : MOV ECX,EDI
00488353 : CALL 0x004888d0
00488358 : LEA ECX,[EBP + -0x30]
0048835b : PUSH ECX
0048835c : MOV EAX,dword ptr [EBP + 0xc]
0048835f : LEA EDI,[EAX + 0x14]
00488362 : CALL 0x004884f0
00488367 : ADD ESP,0x14
0048836a : MOV dword ptr [EBP + -0x4],0xffffffff
00488371 : LEA EDX,[EBP + -0x30]
00488374 : PUSH EDX
00488375 : CALL 0x00446650
0048837a : MOV ECX,dword ptr [EBP + -0xc]
0048837d : MOV dword ptr FS:[0x0],ECX
00488384 : POP ECX
00488385 : POP EDI
00488386 : POP ESI
00488387 : POP EBX
00488388 : MOV ESP,EBP
0048838a : POP EBP
0048838b : RET 0xc

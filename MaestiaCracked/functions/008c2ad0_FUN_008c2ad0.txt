PROGRAM  : Maestia.exe
FUNCTION : FUN_008c2ad0
ENTRY    : 008c2ad0
BODY     : [[008c2ad0, 008c2c9b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008c2ad0(int param_1)

{
  undefined4 uVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  uint8_t *packet;
  undefined4 in_EDX;
  undefined1 local_50 [28];
  uint8_t *local_34;
  undefined1 local_30 [8];
  undefined4 local_28;
  short local_1c;
  short local_1a;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b45021;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar3;
  if (*(char *)(param_1 + 8) != '\0') {
    local_1a = 6;
    local_28 = 0;
    local_1c = 0;
    cVar2 = FUN_008c1190(in_EDX);
    uVar1 = local_28;
    if (cVar2 != '\0') {
      iVar4 = FUN_004049b0(local_28,uVar3);
      if (iVar4 != 0) {
        if ((((*(uint *)(iVar4 + 0x40) & 0x200) == 0) || (local_1c == 0)) &&
           (((*(uint *)(iVar4 + 0x40) & 0x100) == 0 || (local_1c != 0)))) {
          if (*(char *)(param_1 + 0x74) == '\0') {
            *(undefined4 *)(param_1 + 0x68) = uVar1;
            *(undefined2 *)(param_1 + 0x72) = 1;
            if (*(char *)(param_1 + 0x70) == '\0') {
              FUN_008c2650();
              local_34 = (uint8_t *)FUN_006f4590();
              if (local_34 == (uint8_t *)0x0) {
                packet = (uint8_t *)0x0;
              }
              else {
                local_34[0] = '\0';
                local_34[1] = '\0';
                local_34[2] = ':';
                local_34[3] = 'N';
                packet = local_34;
              }
              local_8 = 0xffffffff;
              if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
                FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),4,packet);
              }
            }
            else {
              FUN_00406460(L"IDS_SKILLTREE_LEARNSKILL_WARNING");
              local_8 = 0;
              FUN_0081d120(local_50);
              local_8 = CONCAT31(local_8._1_3_,2);
              FUN_00406560();
              iVar4 = FUN_008ede80(local_30,2);
              if (iVar4 != 0) {
                if (*(code **)(iVar4 + 0x60) != (code *)0x0) {
                  (**(code **)(iVar4 + 0x60))(1,iVar4);
                }
                *(code **)(iVar4 + 0x60) = FUN_008c2840;
              }
              local_8 = 0xffffffff;
              FUN_00406560();
            }
          }
          else if ((local_1c != local_1a) && (*(short *)(param_1 + 0x60) != 0)) {
            cVar2 = FUN_008c16b0(param_1,uVar1);
            if (cVar2 == '\0') {
              FUN_008c1620();
              FUN_008c1af0(param_1);
            }
          }
        }
      }
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008c2ad0 : PUSH EBP
008c2ad1 : MOV EBP,ESP
008c2ad3 : PUSH -0x1
008c2ad5 : PUSH 0xb45021
008c2ada : MOV EAX,FS:[0x0]
008c2ae0 : PUSH EAX
008c2ae1 : SUB ESP,0x44
008c2ae4 : MOV EAX,[0x00d66fa0]
008c2ae9 : XOR EAX,EBP
008c2aeb : MOV dword ptr [EBP + -0x10],EAX
008c2aee : PUSH EBX
008c2aef : PUSH ESI
008c2af0 : PUSH EDI
008c2af1 : PUSH EAX
008c2af2 : LEA EAX,[EBP + -0xc]
008c2af5 : MOV FS:[0x0],EAX
008c2afb : MOV EBX,dword ptr [EBP + 0x8]
008c2afe : MOV AL,byte ptr [EBX + 0x8]
008c2b01 : TEST AL,AL
008c2b03 : JZ 0x008c2c7e
008c2b09 : MOV EDI,dword ptr [EBP + 0xc]
008c2b0c : MOV ECX,0x6
008c2b11 : XOR EAX,EAX
008c2b13 : MOV word ptr [EBP + -0x16],CX
008c2b17 : MOV ECX,dword ptr [EBX + 0x5c]
008c2b1a : PUSH EDX
008c2b1b : LEA ESI,[EBP + -0x28]
008c2b1e : MOV dword ptr [EBP + -0x24],0x0
008c2b25 : MOV word ptr [EBP + -0x18],AX
008c2b29 : CALL 0x008c1190
008c2b2e : TEST AL,AL
008c2b30 : JZ 0x008c2c7e
008c2b36 : MOV ESI,dword ptr [EBP + -0x24]
008c2b39 : PUSH ESI
008c2b3a : CALL 0x004049b0
008c2b3f : ADD ESP,0x4
008c2b42 : TEST EAX,EAX
008c2b44 : JZ 0x008c2c7e
008c2b4a : MOV EAX,dword ptr [EAX + 0x40]
008c2b4d : MOV CX,word ptr [EBP + -0x18]
008c2b51 : TEST EAX,0x200
008c2b56 : JZ 0x008c2b61
008c2b58 : TEST CX,CX
008c2b5b : JNZ 0x008c2c7e
008c2b61 : TEST EAX,0x100
008c2b66 : JZ 0x008c2b71
008c2b68 : TEST CX,CX
008c2b6b : JZ 0x008c2c7e
008c2b71 : CMP byte ptr [EBX + 0x74],0x0
008c2b75 : JZ 0x008c2baf
008c2b77 : CMP CX,word ptr [EBP + -0x16]
008c2b7b : JZ 0x008c2c7e
008c2b81 : CMP word ptr [EBX + 0x60],0x0
008c2b86 : JZ 0x008c2c7e
008c2b8c : PUSH ESI
008c2b8d : PUSH EBX
008c2b8e : CALL 0x008c16b0
008c2b93 : TEST AL,AL
008c2b95 : JNZ 0x008c2c7e
008c2b9b : MOV EAX,ESI
008c2b9d : MOV EDI,EBX
008c2b9f : CALL 0x008c1620
008c2ba4 : PUSH EBX
008c2ba5 : CALL 0x008c1af0
008c2baa : JMP 0x008c2c7e
008c2baf : CMP byte ptr [EBX + 0x70],0x0
008c2bb3 : MOV EAX,0x1
008c2bb8 : MOV dword ptr [EBX + 0x68],ESI
008c2bbb : MOV word ptr [EBX + 0x72],AX
008c2bbf : JZ 0x008c2c2f
008c2bc1 : PUSH 0xc4ef78
008c2bc6 : LEA ECX,[EBP + -0x4c]
008c2bc9 : CALL 0x00406460
008c2bce : MOV dword ptr [EBP + -0x4],0x0
008c2bd5 : LEA ECX,[EBP + -0x4c]
008c2bd8 : PUSH ECX
008c2bd9 : MOV ECX,dword ptr [0x0172491c]
008c2bdf : LEA EDI,[EBP + -0x2c]
008c2be2 : CALL 0x0081d120
008c2be7 : MOV byte ptr [EBP + -0x4],0x2
008c2beb : LEA ECX,[EBP + -0x4c]
008c2bee : CALL 0x00406560
008c2bf3 : MOV EDX,dword ptr [0x00da9894]
008c2bf9 : MOV ECX,dword ptr [EDX]
008c2bfb : PUSH 0x2
008c2bfd : MOV EAX,EDI
008c2bff : PUSH EAX
008c2c00 : CALL 0x008ede80
008c2c05 : MOV ESI,EAX
008c2c07 : TEST ESI,ESI
008c2c09 : JZ 0x008c2c1e
008c2c0b : MOV EAX,dword ptr [ESI + 0x60]
008c2c0e : TEST EAX,EAX
008c2c10 : JZ 0x008c2c17
008c2c12 : PUSH ESI
008c2c13 : PUSH 0x1
008c2c15 : CALL EAX
008c2c17 : MOV dword ptr [ESI + 0x60],0x8c2840
008c2c1e : MOV dword ptr [EBP + -0x4],0xffffffff
008c2c25 : LEA ECX,[EBP + -0x2c]
008c2c28 : CALL 0x00406560
008c2c2d : JMP 0x008c2c7e
008c2c2f : MOV ECX,EBX
008c2c31 : CALL 0x008c2650
008c2c36 : CALL 0x006f4590
008c2c3b : MOV dword ptr [EBP + -0x30],EAX
008c2c3e : MOV dword ptr [EBP + -0x4],0x3
008c2c45 : TEST EAX,EAX
008c2c47 : JZ 0x008c2c58
008c2c49 : XOR ECX,ECX
008c2c4b : MOV word ptr [EAX],CX
008c2c4e : MOV byte ptr [EAX + 0x2],0x3a
008c2c52 : MOV byte ptr [EAX + 0x3],0x4e
008c2c56 : JMP 0x008c2c5a
008c2c58 : XOR EAX,EAX
008c2c5a : MOV dword ptr [EBP + -0x4],0xffffffff
008c2c61 : MOV EDX,dword ptr [0x017247d4]
008c2c67 : MOV ECX,dword ptr [EDX + 0x4]
008c2c6a : TEST ECX,ECX
008c2c6c : JZ 0x008c2c7e
008c2c6e : CMP byte ptr [EDX + 0x8],0x0
008c2c72 : JZ 0x008c2c7e
008c2c74 : PUSH 0x4
008c2c76 : PUSH ECX
008c2c77 : MOV EDI,EAX
008c2c79 : CALL 0x00a0dd40
008c2c7e : MOV ECX,dword ptr [EBP + -0xc]
008c2c81 : MOV dword ptr FS:[0x0],ECX
008c2c88 : POP ECX
008c2c89 : POP EDI
008c2c8a : POP ESI
008c2c8b : POP EBX
008c2c8c : MOV ECX,dword ptr [EBP + -0x10]
008c2c8f : XOR ECX,EBP
008c2c91 : CALL 0x00633e6b
008c2c96 : MOV ESP,EBP
008c2c98 : POP EBP
008c2c99 : RET 0x8

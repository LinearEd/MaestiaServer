PROGRAM  : Maestia.exe
FUNCTION : FUN_00681120
ENTRY    : 00681120
BODY     : [[00681120, 006811b8]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00681120(int *param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  int *piVar2;
  
  if (param_3 == (undefined4 *)0x0) {
    return 0x80070057;
  }
  *param_3 = 0;
  iVar1 = FID_conflict_operator__(param_2,&DAT_00bef240);
  if ((iVar1 == 0) && (iVar1 = FID_conflict_operator__(param_2,&DAT_00bd8178), iVar1 == 0)) {
    iVar1 = FID_conflict_operator__(param_2,&DAT_00bef9a0);
    if (iVar1 == 0) {
      return 0x80004002;
    }
    piVar2 = (int *)(-(uint)(param_1 != (int *)0xc0) & (uint)param_1);
  }
  else if (param_1 == (int *)0xc0) {
    piVar2 = (int *)0x0;
  }
  else {
    piVar2 = param_1 + 1;
  }
  *param_3 = piVar2;
  if (piVar2 == (int *)0x0) {
    return 0x80004002;
  }
  (**(code **)(*param_1 + 4))(param_1);
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00681120 : PUSH ESI
00681121 : MOV ESI,dword ptr [ESP + 0x10]
00681125 : TEST ESI,ESI
00681127 : JNZ 0x00681132
00681129 : MOV EAX,0x80070057
0068112e : POP ESI
0068112f : RET 0xc
00681132 : PUSH EDI
00681133 : MOV EDI,dword ptr [ESP + 0x10]
00681137 : PUSH 0xbef240
0068113c : PUSH EDI
0068113d : MOV dword ptr [ESI],0x0
00681143 : CALL 0x006810b0
00681148 : ADD ESP,0x8
0068114b : TEST EAX,EAX
0068114d : JNZ 0x00681185
0068114f : PUSH 0xbd8178
00681154 : PUSH EDI
00681155 : CALL 0x006810b0
0068115a : ADD ESP,0x8
0068115d : TEST EAX,EAX
0068115f : JNZ 0x00681185
00681161 : PUSH 0xbef9a0
00681166 : PUSH EDI
00681167 : CALL 0x006810b0
0068116c : ADD ESP,0x8
0068116f : TEST EAX,EAX
00681171 : JZ 0x006811af
00681173 : MOV ECX,dword ptr [ESP + 0xc]
00681177 : LEA EAX,[ECX + 0xffffff40]
0068117d : NEG EAX
0068117f : SBB EAX,EAX
00681181 : AND EAX,ECX
00681183 : JMP 0x0068119a
00681185 : MOV ECX,dword ptr [ESP + 0xc]
00681189 : LEA EAX,[ECX + 0xffffff40]
0068118f : TEST EAX,EAX
00681191 : JZ 0x00681198
00681193 : LEA EAX,[ECX + 0x4]
00681196 : JMP 0x0068119a
00681198 : XOR EAX,EAX
0068119a : MOV dword ptr [ESI],EAX
0068119c : TEST EAX,EAX
0068119e : JZ 0x006811af
006811a0 : MOV EDX,dword ptr [ECX]
006811a2 : MOV EAX,dword ptr [EDX + 0x4]
006811a5 : PUSH ECX
006811a6 : CALL EAX
006811a8 : POP EDI
006811a9 : XOR EAX,EAX
006811ab : POP ESI
006811ac : RET 0xc
006811af : POP EDI
006811b0 : MOV EAX,0x80004002
006811b5 : POP ESI
006811b6 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_006b9970
ENTRY    : 006b9970
BODY     : [[006b9970, 006b9b6b]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_006b9970(int *param_1)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  undefined4 *puVar7;
  int local_c;
  undefined4 local_8;
  undefined4 *local_4;
  
  piVar3 = param_1;
  iVar2 = param_1[3];
  iVar4 = *(int *)(iVar2 + 0x3c);
  iVar6 = (int)*(short *)(iVar2 + 0x3a);
  *(int *)(iVar4 + iVar6 * 8) = param_1[0x11];
  *(int *)(iVar4 + 4 + iVar6 * 8) = param_1[0x12];
  iVar4 = *(int *)(iVar2 + 0x3c);
  *(int *)(iVar4 + 8 + iVar6 * 8) = param_1[0x13];
  *(int *)(iVar4 + 0xc + iVar6 * 8) = param_1[0x14];
  iVar4 = *(int *)(iVar2 + 0x3c);
  *(int *)(iVar4 + 0x10 + iVar6 * 8) = param_1[0x2e];
  *(int *)(iVar4 + 0x14 + iVar6 * 8) = param_1[0x2f];
  iVar4 = *(int *)(iVar2 + 0x3c);
  *(int *)(iVar4 + 0x18 + iVar6 * 8) = param_1[0x30];
  *(int *)(iVar4 + 0x1c + iVar6 * 8) = param_1[0x31];
  *(undefined1 *)(iVar6 + *(int *)(iVar2 + 0x40)) = 0;
  *(undefined1 *)(iVar6 + 1 + *(int *)(iVar2 + 0x40)) = 0;
  *(undefined1 *)(iVar6 + 2 + *(int *)(iVar2 + 0x40)) = 0;
  *(undefined1 *)(iVar6 + 3 + *(int *)(iVar2 + 0x40)) = 0;
  iVar6 = iVar6 + 4;
  if (*(char *)(*param_1 + 0x2c8) != '\0') {
    local_8 = *(undefined4 *)(*param_1 + 100);
    iVar4 = FUN_006b9040(param_1[5],&local_c,iVar6);
    if (iVar4 != 0) {
      return (int *)iVar4;
    }
    iVar4 = 0;
    if (0 < iVar6) {
      do {
        piVar1 = (int *)(*(int *)(iVar2 + 0x3c) + iVar4 * 8);
        *piVar1 = *piVar1 + *(int *)(local_c + iVar4 * 8);
        piVar1 = (int *)(*(int *)(iVar2 + 0x3c) + 4 + iVar4 * 8);
        *piVar1 = *piVar1 + *(int *)(local_c + 4 + iVar4 * 8);
        iVar4 = iVar4 + 1;
      } while (iVar4 < iVar6);
    }
    FUN_00687f30(local_8,local_c);
  }
  param_1 = (int *)0x0;
  if ((*(byte *)(piVar3 + 4) & 2) == 0) {
    FUN_006b3180();
    _memcpy((void *)piVar3[0x24],(void *)piVar3[0x23],(uint)*(ushort *)(piVar3 + 0x21) * 8 + 0x20);
  }
  if ((*(byte *)(piVar3 + 4) & 1) == 0) {
    puVar7 = *(undefined4 **)(iVar2 + 0x3c);
    local_8 = *(undefined4 *)(piVar3[1] + 0x30);
    local_c = *(int *)(piVar3[1] + 0x34);
    local_4 = puVar7 + iVar6 * 2;
    if (puVar7 < local_4) {
      do {
        uVar5 = FUN_00685ea0(*puVar7,local_8);
        *puVar7 = uVar5;
        uVar5 = FUN_00685ea0(puVar7[1],local_c);
        puVar7[1] = uVar5;
        puVar7 = puVar7 + 2;
      } while (puVar7 < local_4);
    }
    iVar4 = *(int *)(iVar2 + 0x3c);
    piVar3[0x11] = *(int *)(iVar4 + -0x20 + iVar6 * 8);
    piVar3[0x12] = *(int *)(iVar4 + -0x1c + iVar6 * 8);
    iVar4 = *(int *)(iVar2 + 0x3c);
    piVar3[0x13] = *(int *)(iVar4 + -0x18 + iVar6 * 8);
    piVar3[0x14] = *(int *)(iVar4 + -0x14 + iVar6 * 8);
    iVar4 = *(int *)(iVar2 + 0x3c);
    piVar3[0x2e] = *(int *)(iVar4 + -0x10 + iVar6 * 8);
    piVar3[0x2f] = *(int *)(iVar4 + -0xc + iVar6 * 8);
    iVar2 = *(int *)(iVar2 + 0x3c);
    piVar3[0x30] = *(int *)(iVar2 + -8 + iVar6 * 8);
    piVar3[0x31] = *(int *)(iVar2 + -4 + iVar6 * 8);
  }
  if ((*(byte *)(piVar3 + 4) & 2) == 0) {
    *(short *)(piVar3 + 0x21) = (short)piVar3[0x21] + 4;
    param_1 = (int *)FUN_006b9780(piVar3,0);
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
006b9970 : SUB ESP,0xc
006b9973 : PUSH EBX
006b9974 : PUSH EBP
006b9975 : MOV EBP,dword ptr [ESP + 0x18]
006b9979 : MOV EBX,dword ptr [EBP + 0xc]
006b997c : MOV EAX,dword ptr [EBX + 0x3c]
006b997f : MOV ECX,dword ptr [EBP + 0x44]
006b9982 : ADD EBX,0x38
006b9985 : PUSH ESI
006b9986 : MOVSX ESI,word ptr [EBX + 0x2]
006b998a : MOV dword ptr [EAX + ESI*0x8],ECX
006b998d : MOV EDX,dword ptr [EBP + 0x48]
006b9990 : MOV dword ptr [EAX + ESI*0x8 + 0x4],EDX
006b9994 : MOV EAX,dword ptr [EBX + 0x4]
006b9997 : MOV ECX,dword ptr [EBP + 0x4c]
006b999a : MOV dword ptr [EAX + ESI*0x8 + 0x8],ECX
006b999e : MOV EDX,dword ptr [EBP + 0x50]
006b99a1 : MOV dword ptr [EAX + ESI*0x8 + 0xc],EDX
006b99a5 : MOV EAX,dword ptr [EBX + 0x4]
006b99a8 : MOV ECX,dword ptr [EBP + 0xb8]
006b99ae : MOV dword ptr [EAX + ESI*0x8 + 0x10],ECX
006b99b2 : MOV EDX,dword ptr [EBP + 0xbc]
006b99b8 : MOV dword ptr [EAX + ESI*0x8 + 0x14],EDX
006b99bc : MOV EAX,dword ptr [EBX + 0x4]
006b99bf : MOV ECX,dword ptr [EBP + 0xc0]
006b99c5 : MOV dword ptr [EAX + ESI*0x8 + 0x18],ECX
006b99c9 : MOV EDX,dword ptr [EBP + 0xc4]
006b99cf : MOV dword ptr [EAX + ESI*0x8 + 0x1c],EDX
006b99d3 : MOV EAX,dword ptr [EBX + 0x8]
006b99d6 : MOV byte ptr [ESI + EAX*0x1],0x0
006b99da : MOV ECX,dword ptr [EBX + 0x8]
006b99dd : MOV byte ptr [ESI + ECX*0x1 + 0x1],0x0
006b99e2 : MOV EDX,dword ptr [EBX + 0x8]
006b99e5 : MOV byte ptr [ESI + EDX*0x1 + 0x2],0x0
006b99ea : MOV EAX,dword ptr [EBX + 0x8]
006b99ed : MOV byte ptr [ESI + EAX*0x1 + 0x3],0x0
006b99f2 : MOV EAX,dword ptr [EBP]
006b99f5 : ADD ESI,0x4
006b99f8 : CMP byte ptr [EAX + 0x2c8],0x0
006b99ff : PUSH EDI
006b9a00 : MOV dword ptr [ESP + 0x20],0x0
006b9a08 : JZ 0x006b9a65
006b9a0a : MOV ECX,dword ptr [EAX + 0x64]
006b9a0d : PUSH ESI
006b9a0e : LEA EDX,[ESP + 0x14]
006b9a12 : MOV dword ptr [ESP + 0x18],ECX
006b9a16 : MOV ECX,dword ptr [EBP + 0x14]
006b9a19 : PUSH EDX
006b9a1a : PUSH ECX
006b9a1b : CALL 0x006b9040
006b9a20 : ADD ESP,0xc
006b9a23 : MOV dword ptr [ESP + 0x20],EAX
006b9a27 : TEST EAX,EAX
006b9a29 : JNZ 0x006b9b64
006b9a2f : MOV EDX,dword ptr [ESP + 0x10]
006b9a33 : TEST ESI,ESI
006b9a35 : JLE 0x006b9a57
006b9a37 : MOV ECX,dword ptr [EBX + 0x4]
006b9a3a : MOV EDI,dword ptr [EDX + EAX*0x8]
006b9a3d : ADD dword ptr [ECX + EAX*0x8],EDI
006b9a40 : MOV EDI,dword ptr [EDX + EAX*0x8 + 0x4]
006b9a44 : LEA ECX,[ECX + EAX*0x8]
006b9a47 : MOV ECX,dword ptr [EBX + 0x4]
006b9a4a : ADD dword ptr [ECX + EAX*0x8 + 0x4],EDI
006b9a4e : LEA ECX,[ECX + EAX*0x8 + 0x4]
006b9a52 : INC EAX
006b9a53 : CMP EAX,ESI
006b9a55 : JL 0x006b9a37
006b9a57 : PUSH EDX
006b9a58 : MOV EDX,dword ptr [ESP + 0x18]
006b9a5c : PUSH EDX
006b9a5d : CALL 0x00687f30
006b9a62 : ADD ESP,0x8
006b9a65 : TEST byte ptr [EBP + 0x10],0x2
006b9a69 : JNZ 0x006b9a9e
006b9a6b : LEA EAX,[EBP + 0x7c]
006b9a6e : XOR EDI,EDI
006b9a70 : XOR EDX,EDX
006b9a72 : MOV ECX,EBX
006b9a74 : CALL 0x006b3180
006b9a79 : MOVZX EAX,word ptr [EBP + 0x84]
006b9a80 : MOV EDX,dword ptr [EBP + 0x8c]
006b9a86 : LEA ECX,[EAX*0x8 + 0x20]
006b9a8d : MOV EAX,dword ptr [EBP + 0x90]
006b9a93 : PUSH ECX
006b9a94 : PUSH EDX
006b9a95 : PUSH EAX
006b9a96 : CALL 0x0063ae40
006b9a9b : ADD ESP,0xc
006b9a9e : TEST byte ptr [EBP + 0x10],0x1
006b9aa2 : JNZ 0x006b9b43
006b9aa8 : MOV EDI,dword ptr [EBX + 0x4]
006b9aab : MOV EAX,dword ptr [EBP + 0x4]
006b9aae : MOV EDX,dword ptr [EAX + 0x30]
006b9ab1 : MOV EAX,dword ptr [EAX + 0x34]
006b9ab4 : LEA ECX,[EDI + ESI*0x8]
006b9ab7 : MOV dword ptr [ESP + 0x18],ECX
006b9abb : MOV dword ptr [ESP + 0x14],EDX
006b9abf : MOV dword ptr [ESP + 0x10],EAX
006b9ac3 : CMP EDI,ECX
006b9ac5 : JNC 0x006b9af3
006b9ac7 : MOV ECX,dword ptr [ESP + 0x14]
006b9acb : MOV EDX,dword ptr [EDI]
006b9acd : PUSH ECX
006b9ace : PUSH EDX
006b9acf : CALL 0x00685ea0
006b9ad4 : MOV ECX,dword ptr [EDI + 0x4]
006b9ad7 : MOV dword ptr [EDI],EAX
006b9ad9 : MOV EAX,dword ptr [ESP + 0x18]
006b9add : PUSH EAX
006b9ade : PUSH ECX
006b9adf : CALL 0x00685ea0
006b9ae4 : MOV dword ptr [EDI + 0x4],EAX
006b9ae7 : ADD EDI,0x8
006b9aea : ADD ESP,0x10
006b9aed : CMP EDI,dword ptr [ESP + 0x18]
006b9af1 : JC 0x006b9ac7
006b9af3 : MOV EAX,dword ptr [EBX + 0x4]
006b9af6 : MOV EDX,dword ptr [EAX + ESI*0x8 + -0x20]
006b9afa : MOV dword ptr [EBP + 0x44],EDX
006b9afd : MOV EAX,dword ptr [EAX + ESI*0x8 + -0x1c]
006b9b01 : MOV dword ptr [EBP + 0x48],EAX
006b9b04 : MOV EAX,dword ptr [EBX + 0x4]
006b9b07 : MOV ECX,dword ptr [EAX + ESI*0x8 + -0x18]
006b9b0b : MOV dword ptr [EBP + 0x4c],ECX
006b9b0e : MOV EDX,dword ptr [EAX + ESI*0x8 + -0x14]
006b9b12 : MOV dword ptr [EBP + 0x50],EDX
006b9b15 : MOV EAX,dword ptr [EBX + 0x4]
006b9b18 : MOV ECX,dword ptr [EAX + ESI*0x8 + -0x10]
006b9b1c : MOV dword ptr [EBP + 0xb8],ECX
006b9b22 : MOV EDX,dword ptr [EAX + ESI*0x8 + -0xc]
006b9b26 : MOV dword ptr [EBP + 0xbc],EDX
006b9b2c : MOV EBX,dword ptr [EBX + 0x4]
006b9b2f : MOV EAX,dword ptr [EBX + ESI*0x8 + -0x8]
006b9b33 : MOV dword ptr [EBP + 0xc0],EAX
006b9b39 : MOV ECX,dword ptr [EBX + ESI*0x8 + -0x4]
006b9b3d : MOV dword ptr [EBP + 0xc4],ECX
006b9b43 : TEST byte ptr [EBP + 0x10],0x2
006b9b47 : JNZ 0x006b9b60
006b9b49 : ADD word ptr [EBP + 0x84],0x4
006b9b51 : PUSH 0x0
006b9b53 : PUSH EBP
006b9b54 : CALL 0x006b9780
006b9b59 : ADD ESP,0x8
006b9b5c : MOV dword ptr [ESP + 0x20],EAX
006b9b60 : MOV EAX,dword ptr [ESP + 0x20]
006b9b64 : POP EDI
006b9b65 : POP ESI
006b9b66 : POP EBP
006b9b67 : POP EBX
006b9b68 : ADD ESP,0xc
006b9b6b : RET

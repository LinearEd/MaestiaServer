PROGRAM  : Maestia.exe
FUNCTION : FUN_00431ea0
ENTRY    : 00431ea0
BODY     : [[00431ea0, 0043217f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00431ea0(code *param_1,int *param_2,uint param_3,int *param_4,uint param_5)

{
  undefined4 *puVar1;
  char cVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  int *piVar9;
  undefined4 *puVar10;
  undefined1 local_70 [12];
  uint local_64;
  int *local_60;
  uint local_5c;
  code *local_58;
  uint local_54;
  int *local_50;
  uint local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined1 local_40 [28];
  undefined4 local_24;
  undefined1 local_20;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b78faa;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_58 = param_1;
  local_18 = uVar3;
  if ((param_2 != param_4) || (param_3 != param_5)) {
    local_60 = param_2;
    uVar5 = param_3;
    piVar9 = param_2;
    while ((uVar8 = uVar5 + 1, local_5c = uVar8, piVar9 != param_4 || (uVar8 != param_5))) {
      local_50 = piVar9;
      local_4c = uVar8;
      FUN_00430d40(&local_48);
      local_8 = 0;
      if (param_2 == (int *)0x0) {
        iVar7 = 0;
      }
      else {
        iVar7 = *param_2;
      }
      uVar4 = param_3;
      if (*(uint *)(iVar7 + 0x14) <= param_3) {
        if (param_2 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *param_2;
        }
        uVar4 = param_3 - *(int *)(iVar7 + 0x14);
      }
      if (param_2 == (int *)0x0) {
        iVar7 = 0;
      }
      else {
        iVar7 = *param_2;
      }
      cVar2 = (*local_58)(&local_48,*(undefined4 *)(*(int *)(iVar7 + 0x10) + uVar4 * 4),uVar3);
      uVar4 = local_5c;
      if (cVar2 == '\0') {
        while( true ) {
          uVar4 = uVar4 - 1;
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *piVar9;
          }
          uVar5 = uVar4;
          if (*(uint *)(iVar7 + 0x14) <= uVar4) {
            if (piVar9 == (int *)0x0) {
              iVar7 = 0;
            }
            else {
              iVar7 = *piVar9;
            }
            uVar5 = uVar4 - *(int *)(iVar7 + 0x14);
          }
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *piVar9;
          }
          local_64 = uVar4;
          cVar2 = (*local_58)(&local_48,*(undefined4 *)(*(int *)(iVar7 + 0x10) + uVar5 * 4));
          if (cVar2 == '\0') break;
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *piVar9;
          }
          if (*(uint *)(iVar7 + 0x14) <= uVar4) {
            if (piVar9 == (int *)0x0) {
              iVar7 = 0;
            }
            else {
              iVar7 = *piVar9;
            }
            uVar4 = uVar4 - *(int *)(iVar7 + 0x14);
          }
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
            iVar6 = 0;
          }
          else {
            iVar7 = *piVar9;
            iVar6 = *piVar9;
          }
          uVar5 = local_4c;
          if (*(uint *)(iVar6 + 0x14) <= local_4c) {
            if (local_50 == (int *)0x0) {
              iVar6 = 0;
            }
            else {
              iVar6 = *local_50;
            }
            uVar5 = local_4c - *(int *)(iVar6 + 0x14);
          }
          if (local_50 == (int *)0x0) {
            iVar6 = 0;
          }
          else {
            iVar6 = *local_50;
          }
          puVar10 = *(undefined4 **)(*(int *)(iVar7 + 0x10) + uVar4 * 4);
          puVar1 = *(undefined4 **)(*(int *)(iVar6 + 0x10) + uVar5 * 4);
          *puVar1 = *puVar10;
          puVar1[1] = puVar10[1];
          FUN_00405eb0(puVar10 + 2,0,0xffffffff);
          local_4c = local_64;
          puVar1[9] = puVar10[9];
          *(undefined1 *)(puVar1 + 10) = *(undefined1 *)(puVar10 + 10);
          uVar4 = local_64;
          local_50 = piVar9;
        }
        if (piVar9 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *piVar9;
        }
        uVar5 = local_4c;
        if (*(uint *)(iVar7 + 0x14) <= local_4c) {
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *piVar9;
          }
          uVar5 = local_4c - *(int *)(iVar7 + 0x14);
        }
        if (piVar9 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *piVar9;
        }
        puVar10 = *(undefined4 **)(*(int *)(iVar7 + 0x10) + uVar5 * 4);
        *puVar10 = local_48;
        puVar10[1] = local_44;
        FUN_00405eb0(local_40,0,0xffffffff);
        uVar5 = local_5c;
        piVar9 = local_60;
      }
      else {
        local_54 = local_54 & 0xffffff00;
        FUN_00433300(local_70,param_2,param_3,piVar9,uVar8,piVar9,uVar5 + 2,local_54,local_54,
                     local_54);
        if (param_2 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *param_2;
        }
        uVar5 = param_3;
        if (*(uint *)(iVar7 + 0x14) <= param_3) {
          if (param_2 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *param_2;
          }
          uVar5 = param_3 - *(int *)(iVar7 + 0x14);
        }
        if (param_2 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *param_2;
        }
        puVar10 = *(undefined4 **)(*(int *)(iVar7 + 0x10) + uVar5 * 4);
        *puVar10 = local_48;
        puVar10[1] = local_44;
        FUN_00405eb0(local_40,0,0xffffffff);
        uVar5 = uVar8;
      }
      puVar10[9] = local_24;
      *(undefined1 *)(puVar10 + 10) = local_20;
      local_8 = 0xffffffff;
      FUN_00401300(&local_48);
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00431ea0 : PUSH EBP
00431ea1 : MOV EBP,ESP
00431ea3 : PUSH -0x1
00431ea5 : PUSH 0xb78faa
00431eaa : MOV EAX,FS:[0x0]
00431eb0 : PUSH EAX
00431eb1 : SUB ESP,0x60
00431eb4 : MOV EAX,[0x00d66fa0]
00431eb9 : XOR EAX,EBP
00431ebb : MOV dword ptr [EBP + -0x14],EAX
00431ebe : PUSH EBX
00431ebf : PUSH ESI
00431ec0 : PUSH EDI
00431ec1 : PUSH EAX
00431ec2 : LEA EAX,[EBP + -0xc]
00431ec5 : MOV FS:[0x0],EAX
00431ecb : MOV EAX,dword ptr [EBP + 0x8]
00431ece : MOV ECX,dword ptr [EBP + 0x10]
00431ed1 : MOV dword ptr [EBP + -0x54],EAX
00431ed4 : MOV EAX,dword ptr [EBP + 0xc]
00431ed7 : CMP EAX,dword ptr [EBP + 0x14]
00431eda : JNZ 0x00431ee5
00431edc : CMP ECX,dword ptr [EBP + 0x18]
00431edf : JZ 0x00432164
00431ee5 : MOV ESI,EAX
00431ee7 : MOV dword ptr [EBP + -0x5c],ESI
00431eea : MOV EBX,ECX
00431eec : LEA ESP,[ESP]
00431ef0 : INC EBX
00431ef1 : MOV dword ptr [EBP + -0x58],EBX
00431ef4 : CMP ESI,dword ptr [EBP + 0x14]
00431ef7 : JNZ 0x00431f02
00431ef9 : CMP EBX,dword ptr [EBP + 0x18]
00431efc : JZ 0x00432164
00431f02 : MOV dword ptr [EBP + -0x4c],ESI
00431f05 : MOV dword ptr [EBP + -0x48],EBX
00431f08 : MOV EAX,EBX
00431f0a : TEST ESI,ESI
00431f0c : JZ 0x00431f12
00431f0e : MOV ECX,dword ptr [ESI]
00431f10 : JMP 0x00431f14
00431f12 : XOR ECX,ECX
00431f14 : CMP dword ptr [ECX + 0x14],EBX
00431f17 : JA 0x00431f28
00431f19 : TEST ESI,ESI
00431f1b : JZ 0x00431f21
00431f1d : MOV ECX,dword ptr [ESI]
00431f1f : JMP 0x00431f23
00431f21 : XOR ECX,ECX
00431f23 : MOV EAX,EBX
00431f25 : SUB EAX,dword ptr [ECX + 0x14]
00431f28 : TEST ESI,ESI
00431f2a : JZ 0x00431f30
00431f2c : MOV ECX,dword ptr [ESI]
00431f2e : JMP 0x00431f32
00431f30 : XOR ECX,ECX
00431f32 : MOV ECX,dword ptr [ECX + 0x10]
00431f35 : MOV EAX,dword ptr [ECX + EAX*0x4]
00431f38 : LEA EDX,[EBP + -0x44]
00431f3b : PUSH EDX
00431f3c : MOV EDI,EAX
00431f3e : CALL 0x00430d40
00431f43 : MOV dword ptr [EBP + -0x4],0x0
00431f4a : MOV ECX,dword ptr [EBP + 0xc]
00431f4d : MOV EAX,dword ptr [EBP + 0x10]
00431f50 : TEST ECX,ECX
00431f52 : JZ 0x00431f58
00431f54 : MOV EDX,dword ptr [ECX]
00431f56 : JMP 0x00431f5a
00431f58 : XOR EDX,EDX
00431f5a : CMP dword ptr [EDX + 0x14],EAX
00431f5d : JA 0x00431f6c
00431f5f : TEST ECX,ECX
00431f61 : JZ 0x00431f67
00431f63 : MOV EDX,dword ptr [ECX]
00431f65 : JMP 0x00431f69
00431f67 : XOR EDX,EDX
00431f69 : SUB EAX,dword ptr [EDX + 0x14]
00431f6c : TEST ECX,ECX
00431f6e : JZ 0x00431f74
00431f70 : MOV ECX,dword ptr [ECX]
00431f72 : JMP 0x00431f76
00431f74 : XOR ECX,ECX
00431f76 : MOV ECX,dword ptr [ECX + 0x10]
00431f79 : MOV EAX,dword ptr [ECX + EAX*0x4]
00431f7c : PUSH EAX
00431f7d : LEA EDX,[EBP + -0x44]
00431f80 : PUSH EDX
00431f81 : CALL dword ptr [EBP + -0x54]
00431f84 : ADD ESP,0x8
00431f87 : TEST AL,AL
00431f89 : JZ 0x00432008
00431f8b : MOV byte ptr [EBP + -0x50],0x0
00431f8f : MOV ECX,dword ptr [EBP + -0x50]
00431f92 : MOV EDX,dword ptr [EBP + -0x50]
00431f95 : PUSH ECX
00431f96 : MOV ECX,dword ptr [EBP + -0x50]
00431f99 : PUSH EDX
00431f9a : MOV EDX,dword ptr [EBP + 0x10]
00431f9d : PUSH ECX
00431f9e : LEA EAX,[EBX + 0x1]
00431fa1 : PUSH EAX
00431fa2 : MOV EAX,dword ptr [EBP + 0xc]
00431fa5 : PUSH ESI
00431fa6 : PUSH EBX
00431fa7 : PUSH ESI
00431fa8 : PUSH EDX
00431fa9 : PUSH EAX
00431faa : LEA ECX,[EBP + -0x6c]
00431fad : PUSH ECX
00431fae : CALL 0x00433300
00431fb3 : MOV ECX,dword ptr [EBP + 0xc]
00431fb6 : MOV EAX,dword ptr [EBP + 0x10]
00431fb9 : ADD ESP,0x28
00431fbc : TEST ECX,ECX
00431fbe : JZ 0x00431fc4
00431fc0 : MOV EDX,dword ptr [ECX]
00431fc2 : JMP 0x00431fc6
00431fc4 : XOR EDX,EDX
00431fc6 : CMP dword ptr [EDX + 0x14],EAX
00431fc9 : JA 0x00431fd8
00431fcb : TEST ECX,ECX
00431fcd : JZ 0x00431fd3
00431fcf : MOV EDX,dword ptr [ECX]
00431fd1 : JMP 0x00431fd5
00431fd3 : XOR EDX,EDX
00431fd5 : SUB EAX,dword ptr [EDX + 0x14]
00431fd8 : TEST ECX,ECX
00431fda : JZ 0x00431fe0
00431fdc : MOV ECX,dword ptr [ECX]
00431fde : JMP 0x00431fe2
00431fe0 : XOR ECX,ECX
00431fe2 : MOV EDX,dword ptr [ECX + 0x10]
00431fe5 : MOV EDI,dword ptr [EDX + EAX*0x4]
00431fe8 : MOV EAX,dword ptr [EBP + -0x44]
00431feb : PUSH -0x1
00431fed : MOV dword ptr [EDI],EAX
00431fef : MOV ECX,dword ptr [EBP + -0x40]
00431ff2 : PUSH 0x0
00431ff4 : LEA EDX,[EBP + -0x3c]
00431ff7 : MOV dword ptr [EDI + 0x4],ECX
00431ffa : PUSH EDX
00431ffb : LEA ECX,[EDI + 0x8]
00431ffe : CALL 0x00405eb0
00432003 : JMP 0x00432143
00432008 : MOV EDI,dword ptr [EBP + -0x58]
0043200b : MOV EBX,ESI
0043200d : LEA ECX,[ECX]
00432010 : DEC EDI
00432011 : MOV dword ptr [EBP + -0x60],EDI
00432014 : MOV EAX,EDI
00432016 : TEST EBX,EBX
00432018 : JZ 0x0043201e
0043201a : MOV ECX,dword ptr [EBX]
0043201c : JMP 0x00432020
0043201e : XOR ECX,ECX
00432020 : CMP dword ptr [ECX + 0x14],EDI
00432023 : JA 0x00432034
00432025 : TEST EBX,EBX
00432027 : JZ 0x0043202d
00432029 : MOV ECX,dword ptr [EBX]
0043202b : JMP 0x0043202f
0043202d : XOR ECX,ECX
0043202f : MOV EAX,EDI
00432031 : SUB EAX,dword ptr [ECX + 0x14]
00432034 : TEST EBX,EBX
00432036 : JZ 0x0043203c
00432038 : MOV ECX,dword ptr [EBX]
0043203a : JMP 0x0043203e
0043203c : XOR ECX,ECX
0043203e : MOV EDX,dword ptr [ECX + 0x10]
00432041 : MOV EAX,dword ptr [EDX + EAX*0x4]
00432044 : PUSH EAX
00432045 : LEA EAX,[EBP + -0x44]
00432048 : PUSH EAX
00432049 : CALL dword ptr [EBP + -0x54]
0043204c : ADD ESP,0x8
0043204f : TEST AL,AL
00432051 : JZ 0x004320f3
00432057 : TEST EBX,EBX
00432059 : JZ 0x0043205f
0043205b : MOV EAX,dword ptr [EBX]
0043205d : JMP 0x00432061
0043205f : XOR EAX,EAX
00432061 : CMP dword ptr [EAX + 0x14],EDI
00432064 : JA 0x00432073
00432066 : TEST EBX,EBX
00432068 : JZ 0x0043206e
0043206a : MOV EAX,dword ptr [EBX]
0043206c : JMP 0x00432070
0043206e : XOR EAX,EAX
00432070 : SUB EDI,dword ptr [EAX + 0x14]
00432073 : TEST EBX,EBX
00432075 : JZ 0x0043207b
00432077 : MOV EDX,dword ptr [EBX]
00432079 : JMP 0x0043207d
0043207b : XOR EDX,EDX
0043207d : MOV ECX,dword ptr [EBP + -0x48]
00432080 : TEST ESI,ESI
00432082 : JZ 0x00432088
00432084 : MOV EAX,dword ptr [ESI]
00432086 : JMP 0x0043208a
00432088 : XOR EAX,EAX
0043208a : MOV ESI,dword ptr [EBP + -0x48]
0043208d : CMP dword ptr [EAX + 0x14],ESI
00432090 : MOV ESI,dword ptr [EBP + -0x4c]
00432093 : JA 0x004320a5
00432095 : TEST ESI,ESI
00432097 : JZ 0x0043209d
00432099 : MOV EAX,dword ptr [ESI]
0043209b : JMP 0x0043209f
0043209d : XOR EAX,EAX
0043209f : MOV ECX,dword ptr [EBP + -0x48]
004320a2 : SUB ECX,dword ptr [EAX + 0x14]
004320a5 : TEST ESI,ESI
004320a7 : JZ 0x004320ad
004320a9 : MOV EAX,dword ptr [ESI]
004320ab : JMP 0x004320af
004320ad : XOR EAX,EAX
004320af : MOV EDX,dword ptr [EDX + 0x10]
004320b2 : MOV ESI,dword ptr [EDX + EDI*0x4]
004320b5 : MOV EAX,dword ptr [EAX + 0x10]
004320b8 : MOV EDI,dword ptr [EAX + ECX*0x4]
004320bb : MOV ECX,dword ptr [ESI]
004320bd : PUSH -0x1
004320bf : MOV dword ptr [EDI],ECX
004320c1 : MOV EDX,dword ptr [ESI + 0x4]
004320c4 : PUSH 0x0
004320c6 : LEA EAX,[ESI + 0x8]
004320c9 : PUSH EAX
004320ca : LEA ECX,[EDI + 0x8]
004320cd : MOV dword ptr [EDI + 0x4],EDX
004320d0 : CALL 0x00405eb0
004320d5 : MOV ECX,dword ptr [ESI + 0x24]
004320d8 : MOV EAX,dword ptr [EBP + -0x60]
004320db : MOV dword ptr [EDI + 0x24],ECX
004320de : MOV DL,byte ptr [ESI + 0x28]
004320e1 : MOV ESI,EBX
004320e3 : MOV byte ptr [EDI + 0x28],DL
004320e6 : MOV dword ptr [EBP + -0x4c],ESI
004320e9 : MOV dword ptr [EBP + -0x48],EAX
004320ec : MOV EDI,EAX
004320ee : JMP 0x00432010
004320f3 : MOV ECX,dword ptr [EBP + -0x48]
004320f6 : TEST ESI,ESI
004320f8 : JZ 0x004320fe
004320fa : MOV EAX,dword ptr [ESI]
004320fc : JMP 0x00432100
004320fe : XOR EAX,EAX
00432100 : CMP dword ptr [EAX + 0x14],ECX
00432103 : JA 0x00432112
00432105 : TEST ESI,ESI
00432107 : JZ 0x0043210d
00432109 : MOV EAX,dword ptr [ESI]
0043210b : JMP 0x0043210f
0043210d : XOR EAX,EAX
0043210f : SUB ECX,dword ptr [EAX + 0x14]
00432112 : TEST ESI,ESI
00432114 : JZ 0x0043211a
00432116 : MOV EAX,dword ptr [ESI]
00432118 : JMP 0x0043211c
0043211a : XOR EAX,EAX
0043211c : MOV EDX,dword ptr [EAX + 0x10]
0043211f : MOV EDI,dword ptr [EDX + ECX*0x4]
00432122 : MOV EAX,dword ptr [EBP + -0x44]
00432125 : PUSH -0x1
00432127 : MOV dword ptr [EDI],EAX
00432129 : MOV ECX,dword ptr [EBP + -0x40]
0043212c : PUSH 0x0
0043212e : LEA EDX,[EBP + -0x3c]
00432131 : MOV dword ptr [EDI + 0x4],ECX
00432134 : PUSH EDX
00432135 : LEA ECX,[EDI + 0x8]
00432138 : CALL 0x00405eb0
0043213d : MOV ESI,dword ptr [EBP + -0x5c]
00432140 : MOV EBX,dword ptr [EBP + -0x58]
00432143 : MOV EAX,dword ptr [EBP + -0x20]
00432146 : MOV dword ptr [EDI + 0x24],EAX
00432149 : MOV CL,byte ptr [EBP + -0x1c]
0043214c : MOV byte ptr [EDI + 0x28],CL
0043214f : MOV dword ptr [EBP + -0x4],0xffffffff
00432156 : LEA EDX,[EBP + -0x44]
00432159 : PUSH EDX
0043215a : CALL 0x00401300
0043215f : JMP 0x00431ef0
00432164 : MOV ECX,dword ptr [EBP + -0xc]
00432167 : MOV dword ptr FS:[0x0],ECX
0043216e : POP ECX
0043216f : POP EDI
00432170 : POP ESI
00432171 : POP EBX
00432172 : MOV ECX,dword ptr [EBP + -0x14]
00432175 : XOR ECX,EBP
00432177 : CALL 0x00633e6b
0043217c : MOV ESP,EBP
0043217e : POP EBP
0043217f : RET

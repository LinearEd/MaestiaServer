PROGRAM  : Maestia.exe
FUNCTION : FUN_0056fbd0
ENTRY    : 0056fbd0
BODY     : [[0056fbd0, 0056fcde]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0056fbd0(GRefCountNTSImpl *param_1,undefined4 param_2)

{
  char cVar1;
  GRefCountImpl *this;
  int *piVar2;
  undefined4 uVar3;
  int in_ECX;
  GRefCountNTSImpl *this_00;
  
  piVar2 = *(int **)(in_ECX + 0xad8);
  this_00 = (GRefCountNTSImpl *)0x0;
  if (piVar2 != (int *)0x0) {
    if (piVar2[1] == 0) {
      *piVar2 = *piVar2 + -1;
      if (*piVar2 == 0) {
        FUN_00515cf0(piVar2);
      }
      *(undefined4 *)(in_ECX + 0xad8) = 0;
    }
    else {
      this_00 = (GRefCountNTSImpl *)piVar2[1];
      if (this_00 != (GRefCountNTSImpl *)0x0) {
        *(int *)(this_00 + 4) = *(int *)(this_00 + 4) + 1;
        *(int *)(this_00 + 4) = *(int *)(this_00 + 4) + 1;
        GRefCountNTSImpl::Release(this_00);
      }
    }
  }
  if (this_00 == param_1) {
    if (this_00 == (GRefCountNTSImpl *)0x0) {
      return;
    }
    GRefCountNTSImpl::Release(this_00);
    return;
  }
  this = (GRefCountImpl *)(**(code **)(*(int *)(in_ECX + 8) + 0xc))(0x1b);
  if ((this == (GRefCountImpl *)0x0) ||
     (param_1 = (GRefCountNTSImpl *)FUN_00597840(in_ECX,this_00,param_1,param_1), this_00 != param_1
     )) {
    if ((this_00 != (GRefCountNTSImpl *)0x0) &&
       ((*(int *)(this_00 + 0x20) != 0 &&
        (cVar1 = (**(code **)(*(int *)this_00 + 0xd0))(param_1,param_2), cVar1 == '\0')))) {
      if (this != (GRefCountImpl *)0x0) {
        GRefCountImpl::Release(this);
        GRefCountNTSImpl::Release(this_00);
        return;
      }
      goto LAB_0056fcd1;
    }
    if (param_1 != (GRefCountNTSImpl *)0x0) {
      (**(code **)(*(int *)param_1 + 0xcc))();
    }
    piVar2 = (int *)FUN_0056b260(0);
    uVar3 = (**(code **)(*piVar2 + 0x5c))(param_1,param_2);
    FUN_005bddb0(uVar3);
    if (this != (GRefCountImpl *)0x0) goto LAB_0056fcc6;
  }
  else {
LAB_0056fcc6:
    GRefCountImpl::Release(this);
  }
  if (this_00 == (GRefCountNTSImpl *)0x0) {
    return;
  }
LAB_0056fcd1:
  GRefCountNTSImpl::Release(this_00);
  return;
}



============================================================
DISASSEMBLY
============================================================
0056fbd0 : PUSH EBP
0056fbd1 : MOV EBP,ECX
0056fbd3 : MOV EAX,dword ptr [EBP + 0xad8]
0056fbd9 : PUSH ESI
0056fbda : XOR ESI,ESI
0056fbdc : PUSH EDI
0056fbdd : TEST EAX,EAX
0056fbdf : JZ 0x0056fbff
0056fbe1 : CMP dword ptr [EAX + 0x4],ESI
0056fbe4 : JZ 0x0056fc1c
0056fbe6 : MOV ESI,dword ptr [EAX + 0x4]
0056fbe9 : TEST ESI,ESI
0056fbeb : JZ 0x0056fbff
0056fbed : MOV EAX,0x1
0056fbf2 : ADD dword ptr [ESI + 0x4],EAX
0056fbf5 : ADD dword ptr [ESI + 0x4],EAX
0056fbf8 : MOV ECX,ESI
0056fbfa : CALL 0x004ff7c0
0056fbff : MOV EDI,dword ptr [ESP + 0x10]
0056fc03 : CMP ESI,EDI
0056fc05 : JNZ 0x0056fc2f
0056fc07 : TEST ESI,ESI
0056fc09 : JZ 0x0056fcd9
0056fc0f : MOV ECX,ESI
0056fc11 : CALL 0x004ff7c0
0056fc16 : POP EDI
0056fc17 : POP ESI
0056fc18 : POP EBP
0056fc19 : RET 0xc
0056fc1c : ADD dword ptr [EAX],-0x1
0056fc1f : JNZ 0x0056fc27
0056fc21 : PUSH EAX
0056fc22 : CALL 0x00515cf0
0056fc27 : MOV dword ptr [EBP + 0xad8],ESI
0056fc2d : JMP 0x0056fbff
0056fc2f : MOV EAX,dword ptr [EBP + 0x8]
0056fc32 : MOV EDX,dword ptr [EAX + 0xc]
0056fc35 : LEA ECX,[EBP + 0x8]
0056fc38 : PUSH EBX
0056fc39 : PUSH 0x1b
0056fc3b : CALL EDX
0056fc3d : MOV EBX,EAX
0056fc3f : TEST EBX,EBX
0056fc41 : JZ 0x0056fc58
0056fc43 : MOV EAX,dword ptr [ESP + 0x18]
0056fc47 : PUSH EAX
0056fc48 : PUSH EDI
0056fc49 : PUSH ESI
0056fc4a : PUSH EBP
0056fc4b : MOV ECX,EBX
0056fc4d : CALL 0x00597840
0056fc52 : MOV EDI,EAX
0056fc54 : CMP ESI,EDI
0056fc56 : JZ 0x0056fcc6
0056fc58 : TEST ESI,ESI
0056fc5a : JZ 0x0056fc91
0056fc5c : CMP dword ptr [ESI + 0x20],0x0
0056fc60 : JZ 0x0056fc91
0056fc62 : MOV EAX,dword ptr [ESP + 0x1c]
0056fc66 : MOV EDX,dword ptr [ESI]
0056fc68 : MOV EDX,dword ptr [EDX + 0xd0]
0056fc6e : PUSH EAX
0056fc6f : PUSH EDI
0056fc70 : MOV ECX,ESI
0056fc72 : CALL EDX
0056fc74 : TEST AL,AL
0056fc76 : JNZ 0x0056fc91
0056fc78 : TEST EBX,EBX
0056fc7a : JZ 0x0056fcd1
0056fc7c : MOV ECX,EBX
0056fc7e : CALL 0x004ff7e0
0056fc83 : MOV ECX,ESI
0056fc85 : CALL 0x004ff7c0
0056fc8a : POP EBX
0056fc8b : POP EDI
0056fc8c : POP ESI
0056fc8d : POP EBP
0056fc8e : RET 0xc
0056fc91 : TEST EDI,EDI
0056fc93 : JZ 0x0056fca1
0056fc95 : MOV EAX,dword ptr [EDI]
0056fc97 : MOV EDX,dword ptr [EAX + 0xcc]
0056fc9d : MOV ECX,EDI
0056fc9f : CALL EDX
0056fca1 : PUSH 0x0
0056fca3 : MOV ECX,EBP
0056fca5 : CALL 0x0056b260
0056fcaa : MOV ECX,dword ptr [ESP + 0x1c]
0056fcae : MOV EDX,dword ptr [EAX]
0056fcb0 : PUSH ECX
0056fcb1 : MOV ECX,EAX
0056fcb3 : MOV EAX,dword ptr [EDX + 0x5c]
0056fcb6 : PUSH EDI
0056fcb7 : CALL EAX
0056fcb9 : PUSH EAX
0056fcba : CALL 0x005bddb0
0056fcbf : ADD ESP,0xc
0056fcc2 : TEST EBX,EBX
0056fcc4 : JZ 0x0056fccd
0056fcc6 : MOV ECX,EBX
0056fcc8 : CALL 0x004ff7e0
0056fccd : TEST ESI,ESI
0056fccf : JZ 0x0056fcd8
0056fcd1 : MOV ECX,ESI
0056fcd3 : CALL 0x004ff7c0
0056fcd8 : POP EBX
0056fcd9 : POP EDI
0056fcda : POP ESI
0056fcdb : POP EBP
0056fcdc : RET 0xc

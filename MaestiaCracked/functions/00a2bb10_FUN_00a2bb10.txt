PROGRAM  : Maestia.exe
FUNCTION : FUN_00a2bb10
ENTRY    : 00a2bb10
BODY     : [[00a2bb10, 00a2be7d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a2bb10(int param_1)

{
  char cVar1;
  uint uVar2;
  undefined4 *puVar3;
  int iVar4;
  float *pfVar5;
  int *piVar6;
  float fVar7;
  float *pfVar8;
  int iStack_50;
  undefined4 uStack_4c;
  float fStack_48;
  float fStack_44;
  undefined4 uStack_40;
  float fStack_34;
  float fStack_30;
  float fStack_2c;
  undefined1 auStack_28 [4];
  int iStack_24;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b4280d;
  local_14 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffffa0;
  ExceptionList = &local_14;
  if ((*(char *)(*(int *)(param_1 + 0x41c) + 0x6a) != '\0') &&
     ((char)(*(int **)(param_1 + 0xac))[0x7f9] == '\0')) {
    (**(code **)(**(int **)(param_1 + 0xac) + 0x264))();
  }
  puVar3 = (undefined4 *)(**(code **)(**(int **)(param_1 + 0x74) + 0x14))(uVar2);
  uStack_4c = *puVar3;
  fStack_48 = (float)puVar3[1];
  fStack_44 = (float)puVar3[2];
  iVar4 = (**(code **)(**(int **)(param_1 + 0x74) + 0x18))();
  iStack_24 = *(undefined4 *)(iVar4 + 4);
  fStack_34 = 0.0;
  fStack_30 = 0.0;
  fStack_2c = 0.0;
  if (*(int *)(param_1 + 0xc) == 0) {
    ExceptionList = local_14;
    return;
  }
  piVar6 = *(int **)(param_1 + 0x74);
  pfVar5 = (float *)(**(code **)(*piVar6 + 0x14))();
  fStack_34 = (float)piVar6[0x5c] - *pfVar5;
  fStack_30 = (float)piVar6[0x5d] - pfVar5[1];
  fStack_2c = (float)piVar6[0x5e] - pfVar5[2];
  pfVar5 = &fStack_34;
  pfVar8 = pfVar5;
  D3DXVec3Normalize();
  piVar6 = *(int **)(param_1 + 0x74);
  fStack_48 = *(float *)(param_1 + 0x7c);
  uStack_40 = *(undefined4 *)(param_1 + 0x84);
  fVar7 = (((float)piVar6[0x82] - (float)piVar6[0x7d]) / ((float)piVar6[0x7e] - (float)piVar6[0x7d])
          ) * 0.19999999 + 0.8;
  if (0.8 <= fVar7) {
    if (1.0 <= fVar7) {
      fVar7 = 1.0;
      goto LAB_00a2bca0;
    }
    if (0.8 <= fVar7) goto LAB_00a2bca0;
  }
  fVar7 = 0.8;
LAB_00a2bca0:
  fStack_44 = *(float *)(param_1 + 0x88) * fVar7 + *(float *)(param_1 + 0x80);
  if ((0.01 < ABS(fStack_44 - fStack_2c)) || ((float)piVar6[0x7c] != *(float *)(param_1 + 0x1fc))) {
    *(int *)(param_1 + 0x1fc) = piVar6[0x7c];
    if (*(char *)(param_1 + 0x514) == '\0') {
      (**(code **)(*piVar6 + 0x10))(&fStack_48,pfVar8,pfVar5);
    }
    FUN_007dee30();
    iVar4 = *(int *)(param_1 + 0xc);
    *(float *)(iVar4 + 0x200) = fStack_48;
    *(float *)(iVar4 + 0x204) = fStack_44;
    *(undefined4 *)(iVar4 + 0x208) = uStack_40;
  }
  puVar3 = (undefined4 *)(**(code **)(**(int **)(param_1 + 0x74) + 0x14))();
  iVar4 = *(int *)(param_1 + 0xc);
  *(undefined4 *)(iVar4 + 0x20c) = *puVar3;
  *(undefined4 *)(iVar4 + 0x210) = puVar3[1];
  *(undefined4 *)(iVar4 + 0x214) = puVar3[2];
  if (*(char *)(param_1 + 0x514) != '\0') {
    if (*(char *)(param_1 + 0x418) == '\0') {
      piVar6 = *(int **)(param_1 + 0x78);
    }
    else {
      piVar6 = *(int **)(param_1 + 0x74);
    }
    uVar2 = 0xa2bd91;
    puVar3 = (undefined4 *)(**(code **)(*piVar6 + 0x14))();
    uStack_4c = *puVar3;
    fStack_48 = (float)puVar3[1];
    fStack_44 = (float)puVar3[2];
    iStack_50 = 0;
    iStack_24 = 0;
    uStack_20 = 0;
    uStack_1c = 0;
    uStack_c = 0;
    FUN_004084e0(0,uVar2 & 0xffffff00);
    cVar1 = FUN_007e7c00(uStack_4c,fStack_44,&iStack_50,auStack_28);
    iVar4 = iStack_24;
    if ((cVar1 != '\0') &&
       (fVar7 = *(float *)(iStack_50 * 9 + -4 + iStack_24), fStack_48 < fVar7 + 0.1)) {
      fStack_48 = fVar7 + 10.0;
      (**(code **)(**(int **)(param_1 + 0x78) + 0xc))(&uStack_4c);
    }
    uStack_c = 0xffffffff;
    if (iVar4 != 0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a2bb10 : PUSH EBP
00a2bb11 : MOV EBP,ESP
00a2bb13 : AND ESP,0xfffffff8
00a2bb16 : PUSH -0x1
00a2bb18 : PUSH 0xb4280d
00a2bb1d : MOV EAX,FS:[0x0]
00a2bb23 : PUSH EAX
00a2bb24 : SUB ESP,0x40
00a2bb27 : PUSH EBX
00a2bb28 : PUSH ESI
00a2bb29 : PUSH EDI
00a2bb2a : MOV EAX,[0x00d66fa0]
00a2bb2f : XOR EAX,ESP
00a2bb31 : PUSH EAX
00a2bb32 : LEA EAX,[ESP + 0x50]
00a2bb36 : MOV FS:[0x0],EAX
00a2bb3c : MOV EBX,dword ptr [EBP + 0x8]
00a2bb3f : MOV EAX,dword ptr [EBX + 0x41c]
00a2bb45 : MOV AL,byte ptr [EAX + 0x6a]
00a2bb48 : TEST AL,AL
00a2bb4a : JZ 0x00a2bb6c
00a2bb4c : MOV ECX,dword ptr [EBX + 0xac]
00a2bb52 : CMP byte ptr [ECX + 0x1fe4],0x0
00a2bb59 : JNZ 0x00a2bb6c
00a2bb5b : MOV EDX,dword ptr [ECX]
00a2bb5d : MOV EAX,dword ptr [EDX + 0x264]
00a2bb63 : XOR EDI,EDI
00a2bb65 : PUSH EDI
00a2bb66 : PUSH 0x1
00a2bb68 : CALL EAX
00a2bb6a : JMP 0x00a2bb6e
00a2bb6c : XOR EDI,EDI
00a2bb6e : MOV ECX,dword ptr [EBX + 0x74]
00a2bb71 : MOV EDX,dword ptr [ECX]
00a2bb73 : MOV EAX,dword ptr [EDX + 0x14]
00a2bb76 : CALL EAX
00a2bb78 : MOVSS XMM0,dword ptr [EAX]
00a2bb7c : MOVSS XMM1,dword ptr [EAX + 0x4]
00a2bb81 : MOVSS XMM2,dword ptr [EAX + 0x8]
00a2bb86 : MOV ECX,dword ptr [EBX + 0x74]
00a2bb89 : MOVSS dword ptr [ESP + 0x18],XMM0
00a2bb8f : MOVSS dword ptr [ESP + 0x1c],XMM1
00a2bb95 : MOVSS dword ptr [ESP + 0x20],XMM2
00a2bb9b : MOV EDX,dword ptr [ECX]
00a2bb9d : MOV EAX,dword ptr [EDX + 0x18]
00a2bba0 : CALL EAX
00a2bba2 : MOVSS XMM0,dword ptr [EAX + 0x4]
00a2bba7 : MOVSS dword ptr [ESP + 0x40],XMM0
00a2bbad : XORPS XMM0,XMM0
00a2bbb0 : MOVSS dword ptr [ESP + 0x30],XMM0
00a2bbb6 : MOVSS dword ptr [ESP + 0x34],XMM0
00a2bbbc : MOVSS dword ptr [ESP + 0x38],XMM0
00a2bbc2 : CMP dword ptr [EBX + 0xc],EDI
00a2bbc5 : JZ 0x00a2be69
00a2bbcb : MOV ESI,dword ptr [EBX + 0x74]
00a2bbce : MOV EDX,dword ptr [ESI]
00a2bbd0 : MOV EAX,dword ptr [EDX + 0x14]
00a2bbd3 : MOV ECX,ESI
00a2bbd5 : CALL EAX
00a2bbd7 : MOVSS XMM0,dword ptr [ESI + 0x170]
00a2bbdf : MOVSS XMM1,dword ptr [ESI + 0x174]
00a2bbe7 : MOVSS XMM2,dword ptr [ESI + 0x178]
00a2bbef : SUBSS XMM0,dword ptr [EAX]
00a2bbf3 : SUBSS XMM1,dword ptr [EAX + 0x4]
00a2bbf8 : SUBSS XMM2,dword ptr [EAX + 0x8]
00a2bbfd : LEA ECX,[ESP + 0x30]
00a2bc01 : PUSH ECX
00a2bc02 : MOV EDX,ECX
00a2bc04 : PUSH EDX
00a2bc05 : MOVSS dword ptr [ESP + 0x38],XMM0
00a2bc0b : MOVSS dword ptr [ESP + 0x3c],XMM1
00a2bc11 : MOVSS dword ptr [ESP + 0x40],XMM2
00a2bc17 : CALL 0x004ff722
00a2bc1c : MOV ECX,dword ptr [EBX + 0x74]
00a2bc1f : MOVSS XMM0,dword ptr [ECX + 0x208]
00a2bc27 : MOVSS XMM1,dword ptr [EBX + 0x7c]
00a2bc2c : MOVSS XMM2,dword ptr [EBX + 0x84]
00a2bc34 : MOVSS XMM3,dword ptr [EBX + 0x80]
00a2bc3c : MOVSS dword ptr [ESP + 0x24],XMM1
00a2bc42 : MOVSS dword ptr [ESP + 0x28],XMM3
00a2bc48 : MOVSS dword ptr [ESP + 0x2c],XMM2
00a2bc4e : MOVSS XMM2,dword ptr [ECX + 0x1f4]
00a2bc56 : MOVSS XMM1,dword ptr [ECX + 0x1f8]
00a2bc5e : MOVAPS XMM4,XMM2
00a2bc61 : SUBSS XMM0,XMM4
00a2bc65 : SUBSS XMM1,XMM2
00a2bc69 : DIVSS XMM0,XMM1
00a2bc6d : MOVSS XMM1,dword ptr [0x00cdf138]
00a2bc75 : MULSS XMM0,dword ptr [0x00cdf4b4]
00a2bc7d : ADDSS XMM0,XMM1
00a2bc81 : COMISS XMM1,XMM0
00a2bc84 : JA 0x00a2bc98
00a2bc86 : MOVSS XMM2,dword ptr [0x00c10fc4]
00a2bc8e : COMISS XMM2,XMM0
00a2bc91 : JBE 0x00a2bc9d
00a2bc93 : COMISS XMM1,XMM0
00a2bc96 : JBE 0x00a2bca0
00a2bc98 : MOVAPS XMM0,XMM1
00a2bc9b : JMP 0x00a2bca0
00a2bc9d : MOVAPS XMM0,XMM2
00a2bca0 : MOVSS XMM1,dword ptr [EBX + 0x88]
00a2bca8 : MULSS XMM1,XMM0
00a2bcac : MOVSS XMM0,dword ptr [0x00cdf350]
00a2bcb4 : ADDSS XMM1,XMM3
00a2bcb8 : MOVSS dword ptr [ESP + 0x28],XMM1
00a2bcbe : SUBSS XMM1,dword ptr [ESP + 0x40]
00a2bcc4 : ANDPS XMM1,XMM0
00a2bcc7 : COMISS XMM1,dword ptr [0x00cdf23c]
00a2bcce : JA 0x00a2bce5
00a2bcd0 : MOVSS XMM0,dword ptr [ECX + 0x1f0]
00a2bcd8 : UCOMISS XMM0,dword ptr [EBX + 0x1fc]
00a2bcdf : LAHF
00a2bce0 : TEST AH,0x44
00a2bce3 : JNP 0x00a2bd45
00a2bce5 : CMP byte ptr [EBX + 0x514],0x0
00a2bcec : MOVSS XMM0,dword ptr [ECX + 0x1f0]
00a2bcf4 : MOVSS dword ptr [EBX + 0x1fc],XMM0
00a2bcfc : JNZ 0x00a2bd0a
00a2bcfe : MOV EAX,dword ptr [ECX]
00a2bd00 : MOV EAX,dword ptr [EAX + 0x10]
00a2bd03 : LEA EDX,[ESP + 0x24]
00a2bd07 : PUSH EDX
00a2bd08 : CALL EAX
00a2bd0a : MOV ESI,dword ptr [EBX + 0xc]
00a2bd0d : LEA EDI,[ESP + 0x24]
00a2bd11 : CALL 0x007dee30
00a2bd16 : MOV EAX,dword ptr [EBX + 0xc]
00a2bd19 : MOVSS XMM0,dword ptr [ESP + 0x24]
00a2bd1f : MOVSS dword ptr [EAX + 0x200],XMM0
00a2bd27 : MOVSS XMM0,dword ptr [ESP + 0x28]
00a2bd2d : MOVSS dword ptr [EAX + 0x204],XMM0
00a2bd35 : MOVSS XMM0,dword ptr [ESP + 0x2c]
00a2bd3b : MOVSS dword ptr [EAX + 0x208],XMM0
00a2bd43 : XOR EDI,EDI
00a2bd45 : MOV ECX,dword ptr [EBX + 0x74]
00a2bd48 : MOV EDX,dword ptr [ECX]
00a2bd4a : MOV EAX,dword ptr [EDX + 0x14]
00a2bd4d : CALL EAX
00a2bd4f : FLD float ptr [EAX]
00a2bd51 : MOV ECX,dword ptr [EBX + 0xc]
00a2bd54 : FSTP float ptr [ECX + 0x20c]
00a2bd5a : FLD float ptr [EAX + 0x4]
00a2bd5d : FSTP float ptr [ECX + 0x210]
00a2bd63 : FLD float ptr [EAX + 0x8]
00a2bd66 : FSTP float ptr [ECX + 0x214]
00a2bd6c : CMP byte ptr [EBX + 0x514],0x0
00a2bd73 : JZ 0x00a2be69
00a2bd79 : CMP byte ptr [EBX + 0x418],0x0
00a2bd80 : JZ 0x00a2bd87
00a2bd82 : MOV ECX,dword ptr [EBX + 0x74]
00a2bd85 : JMP 0x00a2bd8a
00a2bd87 : MOV ECX,dword ptr [EBX + 0x78]
00a2bd8a : MOV EDX,dword ptr [ECX]
00a2bd8c : MOV EAX,dword ptr [EDX + 0x14]
00a2bd8f : CALL EAX
00a2bd91 : MOVSS XMM0,dword ptr [EAX]
00a2bd95 : MOVSS dword ptr [ESP + 0x18],XMM0
00a2bd9b : MOVSS XMM0,dword ptr [EAX + 0x4]
00a2bda0 : MOVSS dword ptr [ESP + 0x1c],XMM0
00a2bda6 : MOVSS XMM0,dword ptr [EAX + 0x8]
00a2bdab : MOVSS dword ptr [ESP + 0x20],XMM0
00a2bdb1 : MOV dword ptr [ESP + 0x14],EDI
00a2bdb5 : MOV dword ptr [ESP + 0x40],EDI
00a2bdb9 : MOV dword ptr [ESP + 0x44],EDI
00a2bdbd : MOV dword ptr [ESP + 0x48],EDI
00a2bdc1 : MOV dword ptr [ESP + 0x58],EDI
00a2bdc5 : SUB ESP,0xc
00a2bdc8 : MOV EAX,ESP
00a2bdca : PXOR XMM0,XMM0
00a2bdce : XOR CL,CL
00a2bdd0 : MOVQ qword ptr [EAX],XMM0
00a2bdd4 : MOV byte ptr [EAX + 0x8],CL
00a2bdd7 : LEA EAX,[ESP + 0x48]
00a2bddb : CALL 0x004084e0
00a2bde0 : FLD float ptr [ESP + 0x20]
00a2bde4 : MOV EAX,dword ptr [EBX + 0xc]
00a2bde7 : LEA ECX,[ESP + 0x3c]
00a2bdeb : PUSH ECX
00a2bdec : LEA EDX,[ESP + 0x18]
00a2bdf0 : PUSH EDX
00a2bdf1 : SUB ESP,0x8
00a2bdf4 : FSTP float ptr [ESP + 0x4]
00a2bdf8 : FLD float ptr [ESP + 0x28]
00a2bdfc : FSTP float ptr [ESP]
00a2bdff : CALL 0x007e7c00
00a2be04 : MOV ESI,dword ptr [ESP + 0x40]
00a2be08 : TEST AL,AL
00a2be0a : JZ 0x00a2be4a
00a2be0c : MOV EAX,dword ptr [ESP + 0x14]
00a2be10 : LEA ECX,[ESI + EAX*0x8]
00a2be13 : MOVSS XMM0,dword ptr [EAX + ECX*0x1 + -0x4]
00a2be19 : MOVAPS XMM1,XMM0
00a2be1c : ADDSS XMM1,dword ptr [0x00cdf0f0]
00a2be24 : COMISS XMM1,dword ptr [ESP + 0x1c]
00a2be29 : JBE 0x00a2be4a
00a2be2b : MOV EBX,dword ptr [EBX + 0x78]
00a2be2e : ADDSS XMM0,dword ptr [0x00c18874]
00a2be36 : MOVSS dword ptr [ESP + 0x1c],XMM0
00a2be3c : MOV EDX,dword ptr [EBX]
00a2be3e : MOV EDX,dword ptr [EDX + 0xc]
00a2be41 : LEA EAX,[ESP + 0x18]
00a2be45 : PUSH EAX
00a2be46 : MOV ECX,EBX
00a2be48 : CALL EDX
00a2be4a : MOV dword ptr [ESP + 0x58],0xffffffff
00a2be52 : CMP ESI,EDI
00a2be54 : JZ 0x00a2be5d
00a2be56 : MOV ECX,ESI
00a2be58 : CALL 0x006f04e0
00a2be5d : MOV dword ptr [ESP + 0x40],EDI
00a2be61 : MOV dword ptr [ESP + 0x44],EDI
00a2be65 : MOV dword ptr [ESP + 0x48],EDI
00a2be69 : MOV ECX,dword ptr [ESP + 0x50]
00a2be6d : MOV dword ptr FS:[0x0],ECX
00a2be74 : POP ECX
00a2be75 : POP EDI
00a2be76 : POP ESI
00a2be77 : POP EBX
00a2be78 : MOV ESP,EBP
00a2be7a : POP EBP
00a2be7b : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_005fbf60
ENTRY    : 005fbf60
BODY     : [[005fbf60, 005fc109]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005fbf60(int *param_1,int param_2)

{
  uint *puVar1;
  uint *puVar2;
  undefined4 uVar3;
  int iVar4;
  float fVar5;
  float fVar6;
  int iVar7;
  int *piVar8;
  uint uVar9;
  undefined4 *puVar10;
  int in_ECX;
  uint uVar11;
  
  piVar8 = param_1;
  puVar2 = (uint *)(param_1 + 1);
  if (1 < *puVar2) {
    uVar3 = *(undefined4 *)(in_ECX + 0x30);
    puVar1 = (uint *)(in_ECX + 0x30);
    param_1 = (int *)0x0;
    if (*puVar2 != 0) {
      puVar2 = (uint *)(in_ECX + 0x7c);
      do {
        iVar4 = *(int *)(*(int *)(*piVar8 + 0x14) + ((uint)(piVar8[2] + (int)param_1) >> 8) * 4);
        uVar9 = piVar8[2] + (int)param_1 & 0xff;
        fVar5 = *(float *)(iVar4 + uVar9 * 8);
        fVar6 = *(float *)(iVar4 + 4 + uVar9 * 8);
        uVar9 = *puVar1;
        uVar11 = *puVar2 >> 10;
        if (*(uint *)(in_ECX + 0x80) <= uVar11) {
          FUN_005fa2a0(uVar11);
        }
        *(uint *)(*(int *)(*(int *)(in_ECX + 0x88) + uVar11 * 4) + (*puVar2 & 0x3ff) * 4) = uVar9;
        *puVar2 = *puVar2 + 1;
        uVar9 = *puVar1 >> 10;
        if (*(uint *)(in_ECX + 0x34) <= uVar9) {
          FUN_005fa460(uVar9);
        }
        uVar11 = *puVar1;
        iVar4 = *(int *)(*(int *)(in_ECX + 0x3c) + uVar9 * 4);
        *(float *)(iVar4 + (uVar11 & 0x3ff) * 8) = fVar5;
        *(float *)(iVar4 + 4 + (uVar11 & 0x3ff) * 8) = fVar6;
        *puVar1 = *puVar1 + 1;
        if (fVar5 < *(float *)(in_ECX + 0xe0)) {
          *(float *)(in_ECX + 0xe0) = fVar5;
        }
        if (fVar6 < *(float *)(in_ECX + 0xe4)) {
          *(float *)(in_ECX + 0xe4) = fVar6;
        }
        if (*(float *)(in_ECX + 0xe8) < fVar5) {
          *(float *)(in_ECX + 0xe8) = fVar5;
        }
        if (*(float *)(in_ECX + 0xec) < fVar6) {
          *(float *)(in_ECX + 0xec) = fVar6;
        }
        param_1 = (int *)((int)param_1 + 1);
      } while (param_1 < (uint)piVar8[1]);
    }
    iVar4 = piVar8[3];
    uVar9 = *puVar1;
    iVar7 = piVar8[4];
    puVar2 = (uint *)(in_ECX + 0x40);
    uVar11 = *(uint *)(in_ECX + 0x40) >> 6;
    if (*(uint *)(in_ECX + 0x44) <= uVar11) {
      FUN_005fa150(uVar11);
    }
    puVar10 = (undefined4 *)
              (*(int *)(*(int *)(in_ECX + 0x4c) + uVar11 * 4) + (*puVar2 & 0x3f) * 0x10);
    *puVar10 = uVar3;
    puVar10[1] = uVar9 - 1;
    puVar10[2] = iVar4 + param_2;
    puVar10[3] = iVar7 + param_2;
    *puVar2 = *puVar2 + 1;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005fbf60 : SUB ESP,0x20
005fbf63 : PUSH EBP
005fbf64 : MOV EBP,dword ptr [ESP + 0x28]
005fbf68 : MOV EAX,dword ptr [EBP + 0x4]
005fbf6b : MOV EDX,ECX
005fbf6d : MOV dword ptr [ESP + 0x4],EDX
005fbf71 : CMP EAX,0x2
005fbf74 : JC 0x005fc103
005fbf7a : MOV ECX,dword ptr [EDX + 0x30]
005fbf7d : PUSH EBX
005fbf7e : PUSH ESI
005fbf7f : LEA ESI,[EDX + 0x30]
005fbf82 : PUSH EDI
005fbf83 : MOV dword ptr [ESP + 0x20],ECX
005fbf87 : MOV dword ptr [ESP + 0x34],0x0
005fbf8f : TEST EAX,EAX
005fbf91 : JBE 0x005fc0a8
005fbf97 : LEA EBX,[EDX + 0x7c]
005fbf9a : LEA EBX,[EBX]
005fbfa0 : MOV EAX,dword ptr [EBP + 0x8]
005fbfa3 : ADD EAX,dword ptr [ESP + 0x34]
005fbfa7 : MOV EDI,dword ptr [EBP]
005fbfaa : MOV EDI,dword ptr [EDI + 0x14]
005fbfad : MOV ECX,EAX
005fbfaf : SHR ECX,0x8
005fbfb2 : MOV ECX,dword ptr [EDI + ECX*0x4]
005fbfb5 : AND EAX,0xff
005fbfba : MOV EDI,dword ptr [ECX + EAX*0x8]
005fbfbd : MOV EAX,dword ptr [ECX + EAX*0x8 + 0x4]
005fbfc1 : MOV ECX,dword ptr [ESI]
005fbfc3 : MOV dword ptr [ESP + 0x18],EDI
005fbfc7 : MOV EDI,dword ptr [EBX]
005fbfc9 : SHR EDI,0xa
005fbfcc : MOV dword ptr [ESP + 0x1c],EAX
005fbfd0 : MOV dword ptr [ESP + 0x14],ECX
005fbfd4 : CMP EDI,dword ptr [EBX + 0x4]
005fbfd7 : JC 0x005fbfe5
005fbfd9 : PUSH EDI
005fbfda : MOV ECX,EBX
005fbfdc : CALL 0x005fa2a0
005fbfe1 : MOV EDX,dword ptr [ESP + 0x10]
005fbfe5 : MOV EAX,dword ptr [EBX + 0xc]
005fbfe8 : MOV EAX,dword ptr [EAX + EDI*0x4]
005fbfeb : MOV ECX,dword ptr [EBX]
005fbfed : MOV EDI,dword ptr [ESP + 0x14]
005fbff1 : AND ECX,0x3ff
005fbff7 : MOV dword ptr [EAX + ECX*0x4],EDI
005fbffa : INC dword ptr [EBX]
005fbffc : MOV EDI,dword ptr [ESI]
005fbffe : SHR EDI,0xa
005fc001 : CMP EDI,dword ptr [ESI + 0x4]
005fc004 : JC 0x005fc012
005fc006 : PUSH EDI
005fc007 : MOV ECX,ESI
005fc009 : CALL 0x005fa460
005fc00e : MOV EDX,dword ptr [ESP + 0x10]
005fc012 : MOV ECX,dword ptr [ESI + 0xc]
005fc015 : FLD float ptr [ESP + 0x18]
005fc019 : MOV EAX,dword ptr [ESI]
005fc01b : MOV EDI,dword ptr [ECX + EDI*0x4]
005fc01e : MOV ECX,dword ptr [ESP + 0x18]
005fc022 : AND EAX,0x3ff
005fc027 : MOV dword ptr [EDI + EAX*0x8],ECX
005fc02a : MOV ECX,dword ptr [ESP + 0x1c]
005fc02e : MOV dword ptr [EDI + EAX*0x8 + 0x4],ECX
005fc032 : INC dword ptr [ESI]
005fc034 : FLD float ptr [EDX + 0xe0]
005fc03a : FCOMP
005fc03c : FNSTSW AX
005fc03e : TEST AH,0x41
005fc041 : JNZ 0x005fc049
005fc043 : FST float ptr [EDX + 0xe0]
005fc049 : FLD float ptr [ESP + 0x1c]
005fc04d : FLD float ptr [EDX + 0xe4]
005fc053 : FCOMP
005fc055 : FNSTSW AX
005fc057 : TEST AH,0x41
005fc05a : JNZ 0x005fc062
005fc05c : FST float ptr [EDX + 0xe4]
005fc062 : FLD float ptr [EDX + 0xe8]
005fc068 : FCOMP ST2
005fc06a : FNSTSW AX
005fc06c : TEST AH,0x5
005fc06f : JP 0x005fc07b
005fc071 : FXCH
005fc073 : FSTP float ptr [EDX + 0xe8]
005fc079 : JMP 0x005fc07d
005fc07b : FSTP ST1
005fc07d : FLD float ptr [EDX + 0xec]
005fc083 : FCOMP
005fc085 : FNSTSW AX
005fc087 : TEST AH,0x5
005fc08a : JP 0x005fc094
005fc08c : FSTP float ptr [EDX + 0xec]
005fc092 : JMP 0x005fc096
005fc094 : FSTP ST0
005fc096 : MOV EAX,dword ptr [ESP + 0x34]
005fc09a : INC EAX
005fc09b : MOV dword ptr [ESP + 0x34],EAX
005fc09f : CMP EAX,dword ptr [EBP + 0x4]
005fc0a2 : JC 0x005fbfa0
005fc0a8 : MOV ECX,dword ptr [EBP + 0xc]
005fc0ab : MOV EAX,dword ptr [ESP + 0x38]
005fc0af : MOV EBX,dword ptr [EDX + 0x40]
005fc0b2 : MOV ESI,dword ptr [ESI]
005fc0b4 : MOV EBP,dword ptr [EBP + 0x10]
005fc0b7 : LEA EDI,[EDX + 0x40]
005fc0ba : ADD ECX,EAX
005fc0bc : SHR EBX,0x6
005fc0bf : DEC ESI
005fc0c0 : ADD EBP,EAX
005fc0c2 : MOV dword ptr [ESP + 0x28],ECX
005fc0c6 : CMP EBX,dword ptr [EDI + 0x4]
005fc0c9 : JC 0x005fc0d7
005fc0cb : PUSH EBX
005fc0cc : MOV ECX,EDI
005fc0ce : CALL 0x005fa150
005fc0d3 : MOV ECX,dword ptr [ESP + 0x28]
005fc0d7 : MOV EAX,dword ptr [EDI]
005fc0d9 : MOV EDX,dword ptr [EDI + 0xc]
005fc0dc : AND EAX,0x3f
005fc0df : SHL EAX,0x4
005fc0e2 : MOV dword ptr [ESP + 0x34],EAX
005fc0e6 : MOV EAX,dword ptr [EDX + EBX*0x4]
005fc0e9 : MOV EDX,dword ptr [ESP + 0x34]
005fc0ed : ADD EAX,EDX
005fc0ef : MOV EDX,dword ptr [ESP + 0x20]
005fc0f3 : MOV dword ptr [EAX],EDX
005fc0f5 : MOV dword ptr [EAX + 0x4],ESI
005fc0f8 : MOV dword ptr [EAX + 0x8],ECX
005fc0fb : MOV dword ptr [EAX + 0xc],EBP
005fc0fe : INC dword ptr [EDI]
005fc100 : POP EDI
005fc101 : POP ESI
005fc102 : POP EBX
005fc103 : POP EBP
005fc104 : ADD ESP,0x20
005fc107 : RET 0x8

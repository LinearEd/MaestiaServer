PROGRAM  : Maestia.exe
FUNCTION : FUN_0089edf0
ENTRY    : 0089edf0
BODY     : [[0089edf0, 0089f065]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0089edf0(undefined4 param_1,int param_2)

{
  ushort uVar1;
  int *piVar2;
  int iVar3;
  short *psVar4;
  undefined4 uVar5;
  int iVar6;
  int in_ECX;
  ushort *****pppppuVar7;
  undefined4 extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int iVar8;
  ushort *puVar9;
  bool bVar10;
  undefined8 uVar11;
  undefined1 local_40 [4];
  int local_3c;
  char local_35;
  int local_34 [2];
  ushort ****local_2c [4];
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b16857;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_3c = in_ECX;
  uVar11 = FUN_0089e610(local_34);
  iVar6 = (int)((ulonglong)uVar11 >> 0x20);
  piVar2 = (int *)uVar11;
  if (piVar2 != (int *)0x0) {
    if ((short)*piVar2 == 0x3c) {
      iVar6 = local_34[0];
      if ((*piVar2 != 0x3f003c) &&
         (((*piVar2 != 0x21003c || ((char)piVar2[1] != '-')) || (*(char *)((int)piVar2 + 5) != '\0')
          ))) {
        uVar11 = FUN_0089eb90(in_ECX,(short *)((int)piVar2 + 2),&local_35);
        iVar6 = (int)((ulonglong)uVar11 >> 0x20);
        iVar3 = (int)uVar11;
        if (iVar3 != 0) {
          if (*(int *)(param_2 + 0x40) == 0) {
            *(int *)(param_2 + 0x40) = iVar3;
            *(int *)(iVar3 + 0x3c) = iVar3;
            *(int *)(iVar3 + 0x38) = iVar3;
          }
          else {
            *(int *)(iVar3 + 0x38) = *(int *)(param_2 + 0x40);
            *(undefined4 *)(iVar3 + 0x3c) = *(undefined4 *)(*(int *)(param_2 + 0x40) + 0x3c);
            iVar6 = *(int *)(*(int *)(param_2 + 0x40) + 0x3c);
            *(int *)(iVar6 + 0x38) = iVar3;
            *(int *)(*(int *)(param_2 + 0x40) + 0x3c) = iVar3;
          }
          if (local_35 != '\x01') {
            psVar4 = (short *)FUN_0089e610(local_34);
            if (*psVar4 == 0x3c) {
              FUN_00405c00(iVar3 + 0x1c);
              uVar11 = CONCAT44(extraout_EDX,psVar4);
            }
            else {
              uVar5 = FUN_0089e8a0(psVar4);
              local_8 = 0;
              FUN_00405d70(uVar5);
              local_8 = 0xffffffff;
              FUN_00406560();
              uVar11 = FUN_0089e610(local_34);
            }
            iVar8 = (int)uVar11;
            while( true ) {
              iVar6 = (int)((ulonglong)uVar11 >> 0x20);
              psVar4 = (short *)uVar11;
              if (iVar8 == 0) break;
              if ((*psVar4 == 0x3c) && (psVar4[1] == 0x2f)) {
                local_18 = 7;
                local_1c = 0;
                local_2c[0] = (ushort ****)((uint)local_2c[0] & 0xffff0000);
                local_8 = 1;
                uVar5 = FUN_0089e520(local_34[0] + -3,local_34,local_40,&DAT_00c48510);
                uVar5 = FUN_0089e8a0(uVar5);
                local_8._0_1_ = 2;
                FUN_00405eb0(uVar5,0,0xffffffff);
                local_8 = CONCAT31(local_8._1_3_,1);
                FUN_00406560();
                pppppuVar7 = (ushort *****)local_2c[0];
                if (local_18 < 8) {
                  pppppuVar7 = local_2c;
                }
                if (*(uint *)(iVar3 + 0x18) < 8) {
                  puVar9 = (ushort *)(iVar3 + 4);
                }
                else {
                  puVar9 = *(ushort **)(iVar3 + 4);
                }
                goto LAB_0089f000;
              }
              uVar11 = FUN_0089edf0(psVar4,iVar3);
              iVar6 = (int)((ulonglong)uVar11 >> 0x20);
              if ((int)uVar11 == 0) break;
              uVar11 = FUN_0089e610(local_34);
              iVar8 = (int)uVar11;
            }
          }
        }
      }
    }
    else {
      *(undefined **)(in_ECX + 0x48) = &DAT_00c484d4;
    }
  }
  goto LAB_0089ee44;
  while( true ) {
    uVar1 = puVar9[1];
    bVar10 = uVar1 < *(ushort *)((int)pppppuVar7 + 2);
    if (uVar1 != *(ushort *)((int)pppppuVar7 + 2)) goto LAB_0089f026;
    puVar9 = puVar9 + 2;
    pppppuVar7 = pppppuVar7 + 1;
    if (uVar1 == 0) break;
LAB_0089f000:
    uVar1 = *puVar9;
    bVar10 = uVar1 < *(ushort *)pppppuVar7;
    if (uVar1 != *(ushort *)pppppuVar7) {
LAB_0089f026:
      iVar6 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
      goto LAB_0089f02b;
    }
    if (uVar1 == 0) break;
  }
  iVar6 = 0;
LAB_0089f02b:
  if (iVar6 == 0) {
    local_8 = 0xffffffff;
    FUN_00406560();
    iVar6 = extraout_EDX_01;
  }
  else {
    *(undefined **)(local_3c + 0x48) = &DAT_00c48518;
    local_8 = 0xffffffff;
    FUN_00406560();
    iVar6 = extraout_EDX_00;
  }
LAB_0089ee44:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc,iVar6);
  return;
}



============================================================
DISASSEMBLY
============================================================
0089edf0 : PUSH EBP
0089edf1 : MOV EBP,ESP
0089edf3 : PUSH -0x1
0089edf5 : PUSH 0xb16857
0089edfa : MOV EAX,FS:[0x0]
0089ee00 : PUSH EAX
0089ee01 : SUB ESP,0x4c
0089ee04 : MOV EAX,[0x00d66fa0]
0089ee09 : XOR EAX,EBP
0089ee0b : MOV dword ptr [EBP + -0x10],EAX
0089ee0e : PUSH EBX
0089ee0f : PUSH ESI
0089ee10 : PUSH EDI
0089ee11 : PUSH EAX
0089ee12 : LEA EAX,[EBP + -0xc]
0089ee15 : MOV FS:[0x0],EAX
0089ee1b : MOV EAX,dword ptr [EBP + 0x8]
0089ee1e : MOV EBX,dword ptr [EBP + 0xc]
0089ee21 : MOV EDI,ECX
0089ee23 : LEA ECX,[EBP + -0x30]
0089ee26 : PUSH ECX
0089ee27 : MOV dword ptr [EBP + -0x38],EDI
0089ee2a : CALL 0x0089e610
0089ee2f : MOV ESI,EAX
0089ee31 : TEST ESI,ESI
0089ee33 : JZ 0x0089ee42
0089ee35 : CMP word ptr [ESI],0x3c
0089ee39 : JZ 0x0089ee62
0089ee3b : MOV dword ptr [EDI + 0x48],0xc484d4
0089ee42 : XOR EAX,EAX
0089ee44 : MOV ECX,dword ptr [EBP + -0xc]
0089ee47 : MOV dword ptr FS:[0x0],ECX
0089ee4e : POP ECX
0089ee4f : POP EDI
0089ee50 : POP ESI
0089ee51 : POP EBX
0089ee52 : MOV ECX,dword ptr [EBP + -0x10]
0089ee55 : XOR ECX,EBP
0089ee57 : CALL 0x00633e6b
0089ee5c : MOV ESP,EBP
0089ee5e : POP EBP
0089ee5f : RET 0x8
0089ee62 : MOV EAX,dword ptr [ESI]
0089ee64 : CMP EAX,0x3f003c
0089ee69 : JZ 0x0089ee7e
0089ee6b : CMP EAX,0x21003c
0089ee70 : JNZ 0x0089ee86
0089ee72 : CMP byte ptr [ESI + 0x4],0x2d
0089ee76 : JNZ 0x0089ee86
0089ee78 : CMP byte ptr [ESI + 0x5],0x0
0089ee7c : JNZ 0x0089ee86
0089ee7e : MOV EDX,dword ptr [EBP + -0x30]
0089ee81 : LEA EAX,[ESI + EDX*0x2]
0089ee84 : JMP 0x0089ee44
0089ee86 : MOV ECX,dword ptr [EBP + -0x30]
0089ee89 : LEA EAX,[EBP + -0x31]
0089ee8c : PUSH EAX
0089ee8d : LEA EDX,[ESI + 0x2]
0089ee90 : PUSH EDX
0089ee91 : ADD ECX,-0x2
0089ee94 : PUSH EDI
0089ee95 : CALL 0x0089eb90
0089ee9a : MOV EDI,EAX
0089ee9c : TEST EDI,EDI
0089ee9e : JZ 0x0089ee42
0089eea0 : MOV ECX,dword ptr [EBX + 0x40]
0089eea3 : MOV EAX,dword ptr [EBP + -0x30]
0089eea6 : LEA EAX,[ESI + EAX*0x2]
0089eea9 : TEST ECX,ECX
0089eeab : JNZ 0x0089eeb8
0089eead : MOV dword ptr [EBX + 0x40],EDI
0089eeb0 : MOV dword ptr [EDI + 0x3c],EDI
0089eeb3 : MOV dword ptr [EDI + 0x38],EDI
0089eeb6 : JMP 0x0089eed3
0089eeb8 : MOV dword ptr [EDI + 0x38],ECX
0089eebb : MOV ECX,dword ptr [EBX + 0x40]
0089eebe : MOV EDX,dword ptr [ECX + 0x3c]
0089eec1 : MOV dword ptr [EDI + 0x3c],EDX
0089eec4 : MOV ECX,dword ptr [EBX + 0x40]
0089eec7 : MOV EDX,dword ptr [ECX + 0x3c]
0089eeca : MOV dword ptr [EDX + 0x38],EDI
0089eecd : MOV ECX,dword ptr [EBX + 0x40]
0089eed0 : MOV dword ptr [ECX + 0x3c],EDI
0089eed3 : CMP byte ptr [EBP + -0x31],0x1
0089eed7 : JZ 0x0089ee44
0089eedd : LEA EDX,[EBP + -0x30]
0089eee0 : PUSH EDX
0089eee1 : CALL 0x0089e610
0089eee6 : MOV ESI,EAX
0089eee8 : CMP word ptr [ESI],0x3c
0089eeec : JZ 0x0089ef2d
0089eeee : MOV EBX,dword ptr [EBP + -0x30]
0089eef1 : PUSH ESI
0089eef2 : MOV EDX,EBX
0089eef4 : LEA ECX,[EBP + -0x2c]
0089eef7 : CALL 0x0089e8a0
0089eefc : MOV dword ptr [EBP + -0x4],0x0
0089ef03 : PUSH EAX
0089ef04 : LEA ECX,[EDI + 0x1c]
0089ef07 : CALL 0x00405d70
0089ef0c : MOV dword ptr [EBP + -0x4],0xffffffff
0089ef13 : LEA ECX,[EBP + -0x2c]
0089ef16 : CALL 0x00406560
0089ef1b : LEA EAX,[EBP + -0x30]
0089ef1e : LEA ESI,[ESI + EBX*0x2]
0089ef21 : PUSH EAX
0089ef22 : MOV EAX,ESI
0089ef24 : CALL 0x0089e610
0089ef29 : MOV ESI,EAX
0089ef2b : JMP 0x0089ef3b
0089ef2d : LEA ECX,[EDI + 0x1c]
0089ef30 : PUSH ECX
0089ef31 : MOV EDX,0xc4850c
0089ef36 : CALL 0x00405c00
0089ef3b : TEST ESI,ESI
0089ef3d : JZ 0x0089ee42
0089ef43 : MOV EBX,0x2f
0089ef48 : CMP word ptr [ESI],0x3c
0089ef4c : JNZ 0x0089ef54
0089ef4e : CMP word ptr [ESI + 0x2],BX
0089ef52 : JZ 0x0089ef7a
0089ef54 : MOV ECX,dword ptr [EBP + -0x38]
0089ef57 : PUSH EDI
0089ef58 : PUSH ESI
0089ef59 : CALL 0x0089edf0
0089ef5e : TEST EAX,EAX
0089ef60 : JZ 0x0089ee42
0089ef66 : LEA EDX,[EBP + -0x30]
0089ef69 : PUSH EDX
0089ef6a : CALL 0x0089e610
0089ef6f : MOV ESI,EAX
0089ef71 : TEST ESI,ESI
0089ef73 : JNZ 0x0089ef48
0089ef75 : JMP 0x0089ee42
0089ef7a : XOR EAX,EAX
0089ef7c : MOV dword ptr [EBP + -0x14],0x7
0089ef83 : MOV dword ptr [EBP + -0x18],0x0
0089ef8a : MOV word ptr [EBP + -0x28],AX
0089ef8e : MOV dword ptr [EBP + -0x4],0x1
0089ef95 : MOV EBX,dword ptr [EBP + -0x30]
0089ef98 : PUSH 0xc48510
0089ef9d : LEA ECX,[EBP + -0x3c]
0089efa0 : PUSH ECX
0089efa1 : LEA EDX,[EBP + -0x30]
0089efa4 : PUSH EDX
0089efa5 : LEA EAX,[EBX + -0x3]
0089efa8 : PUSH EAX
0089efa9 : LEA EAX,[ESI + 0x4]
0089efac : CALL 0x0089e520
0089efb1 : MOV EDX,dword ptr [EBP + -0x30]
0089efb4 : PUSH EAX
0089efb5 : LEA ECX,[EBP + -0x58]
0089efb8 : CALL 0x0089e8a0
0089efbd : MOV byte ptr [EBP + -0x4],0x2
0089efc1 : PUSH -0x1
0089efc3 : PUSH 0x0
0089efc5 : PUSH EAX
0089efc6 : LEA ECX,[EBP + -0x2c]
0089efc9 : CALL 0x00405eb0
0089efce : MOV byte ptr [EBP + -0x4],0x1
0089efd2 : LEA ECX,[EBP + -0x58]
0089efd5 : CALL 0x00406560
0089efda : MOV ECX,dword ptr [EBP + -0x28]
0089efdd : MOV EAX,0x8
0089efe2 : CMP dword ptr [EBP + -0x14],EAX
0089efe5 : JNC 0x0089efea
0089efe7 : LEA ECX,[EBP + -0x28]
0089efea : CMP dword ptr [EDI + 0x18],EAX
0089efed : JC 0x0089eff4
0089efef : MOV EDI,dword ptr [EDI + 0x4]
0089eff2 : JMP 0x0089eff7
0089eff4 : ADD EDI,0x4
0089eff7 : MOV EAX,EDI
0089eff9 : LEA ESP,[ESP]
0089f000 : MOV DX,word ptr [EAX]
0089f003 : CMP DX,word ptr [ECX]
0089f006 : JNZ 0x0089f026
0089f008 : TEST DX,DX
0089f00b : JZ 0x0089f022
0089f00d : MOV DX,word ptr [EAX + 0x2]
0089f011 : CMP DX,word ptr [ECX + 0x2]
0089f015 : JNZ 0x0089f026
0089f017 : ADD EAX,0x4
0089f01a : ADD ECX,0x4
0089f01d : TEST DX,DX
0089f020 : JNZ 0x0089f000
0089f022 : XOR EAX,EAX
0089f024 : JMP 0x0089f02b
0089f026 : SBB EAX,EAX
0089f028 : SBB EAX,-0x1
0089f02b : TEST EAX,EAX
0089f02d : JZ 0x0089f04d
0089f02f : MOV ECX,dword ptr [EBP + -0x38]
0089f032 : MOV dword ptr [ECX + 0x48],0xc48518
0089f039 : MOV dword ptr [EBP + -0x4],0xffffffff
0089f040 : LEA ECX,[EBP + -0x2c]
0089f043 : CALL 0x00406560
0089f048 : JMP 0x0089ee42
0089f04d : LEA ESI,[ESI + EBX*0x2]
0089f050 : MOV dword ptr [EBP + -0x4],0xffffffff
0089f057 : LEA ECX,[EBP + -0x2c]
0089f05a : CALL 0x00406560
0089f05f : MOV EAX,ESI
0089f061 : JMP 0x0089ee44

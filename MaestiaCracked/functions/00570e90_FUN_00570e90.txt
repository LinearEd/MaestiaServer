PROGRAM  : Maestia.exe
FUNCTION : FUN_00570e90
ENTRY    : 00570e90
BODY     : [[00570e90, 00570fc9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00570e90(int param_1,undefined4 param_2)

{
  char cVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  GRefCountImpl *this;
  LONG LVar5;
  undefined4 *in_ECX;
  uint unaff_retaddr;
  undefined4 uVar6;
  
  in_ECX[1] = 0;
  in_ECX[2] = 0;
  in_ECX[3] = param_2;
  in_ECX[4] = param_1;
  *in_ECX = &PTR_FUN_00b8d1e4;
  in_ECX[5] = 0;
  in_ECX[6] = 0;
  iVar2 = FUN_00515840(0x54,0);
  if (iVar2 == 0) {
    uVar4 = 0;
  }
  else {
    uVar4 = *(undefined4 *)(*(int *)(in_ECX[3] + 0x6c) + 0x14);
    uVar6 = 0;
    uVar3 = (*(code *)**(undefined4 **)(in_ECX[3] + 8))(0);
    uVar4 = FUN_005a19f0(uVar4,uVar3,uVar6);
  }
  if ((GRefCountImpl *)in_ECX[6] != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release((GRefCountImpl *)in_ECX[6]);
  }
  in_ECX[6] = uVar4;
  FUN_0051b6e0();
  if (*(int *)(in_ECX[3] + 0x68) != 0) {
    uVar4 = (**(code **)(**(int **)(in_ECX[3] + 0x6c) + 0x30))();
    FUN_0051bb20(uVar4);
    cVar1 = FUN_005a23d0(&param_2);
    if (cVar1 != '\0') goto LAB_00570f3f;
  }
  FUN_0051bf30();
LAB_00570f3f:
  iVar2 = FUN_00515840(0x2c,0);
  if (iVar2 == 0) {
    uVar4 = 0;
  }
  else {
    uVar4 = FUN_0056eff0(in_ECX[6],&param_2,param_1 + 0xc);
  }
  if ((GRefCountImpl *)in_ECX[5] != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release((GRefCountImpl *)in_ECX[5]);
  }
  in_ECX[5] = uVar4;
  this = (GRefCountImpl *)(**(code **)(*(int *)(in_ECX[3] + 8) + 0xc))(0x17);
  (**(code **)(*(int *)this + 4))(in_ECX[5]);
  GRefCountImpl::Release(this);
  LVar5 = InterlockedExchangeAdd((LONG *)((unaff_retaddr & 0xfffffffc) + 4),-1);
  if (LVar5 == 1) {
    FUN_00515cf0(unaff_retaddr & 0xfffffffc);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00570e90 : MOV EAX,dword ptr [ESP + 0x8]
00570e94 : PUSH EBP
00570e95 : PUSH ESI
00570e96 : MOV ESI,ECX
00570e98 : MOV ECX,dword ptr [ESP + 0xc]
00570e9c : XOR EBP,EBP
00570e9e : PUSH EDI
00570e9f : MOV dword ptr [ESI + 0x4],EBP
00570ea2 : MOV dword ptr [ESI + 0x8],EBP
00570ea5 : MOV dword ptr [ESI + 0xc],EAX
00570ea8 : MOV dword ptr [ESI + 0x10],ECX
00570eab : MOV dword ptr [ESI],0xb8d1e4
00570eb1 : MOV dword ptr [ESI + 0x14],EBP
00570eb4 : PUSH EBP
00570eb5 : MOV dword ptr [ESI + 0x18],EBP
00570eb8 : MOV ECX,dword ptr [0x00d73250]
00570ebe : PUSH 0x54
00570ec0 : CALL 0x00515840
00570ec5 : MOV EDI,EAX
00570ec7 : CMP EDI,EBP
00570ec9 : JZ 0x00570eed
00570ecb : MOV EAX,dword ptr [ESI + 0xc]
00570ece : MOV EDX,dword ptr [EAX + 0x6c]
00570ed1 : LEA ECX,[EAX + 0x8]
00570ed4 : MOV EAX,dword ptr [ECX]
00570ed6 : PUSH EBX
00570ed7 : MOV EBX,dword ptr [EDX + 0x14]
00570eda : MOV EDX,dword ptr [EAX]
00570edc : PUSH EBP
00570edd : CALL EDX
00570edf : PUSH EAX
00570ee0 : PUSH EBX
00570ee1 : MOV ECX,EDI
00570ee3 : CALL 0x005a19f0
00570ee8 : MOV EDI,EAX
00570eea : POP EBX
00570eeb : JMP 0x00570eef
00570eed : XOR EDI,EDI
00570eef : MOV ECX,dword ptr [ESI + 0x18]
00570ef2 : CMP ECX,EBP
00570ef4 : JZ 0x00570efb
00570ef6 : CALL 0x004ff7e0
00570efb : LEA ECX,[ESP + 0x14]
00570eff : MOV dword ptr [ESI + 0x18],EDI
00570f02 : CALL 0x0051b6e0
00570f07 : MOV EAX,dword ptr [ESI + 0xc]
00570f0a : CMP dword ptr [EAX + 0x68],EBP
00570f0d : JZ 0x00570f36
00570f0f : MOV EAX,dword ptr [EAX + 0x6c]
00570f12 : MOV EDX,dword ptr [EAX]
00570f14 : MOV ECX,EAX
00570f16 : MOV EAX,dword ptr [EDX + 0x30]
00570f19 : CALL EAX
00570f1b : PUSH EAX
00570f1c : LEA ECX,[ESP + 0x18]
00570f20 : CALL 0x0051bb20
00570f25 : LEA ECX,[ESP + 0x14]
00570f29 : PUSH ECX
00570f2a : CALL 0x005a23d0
00570f2f : ADD ESP,0x4
00570f32 : TEST AL,AL
00570f34 : JNZ 0x00570f3f
00570f36 : LEA ECX,[ESP + 0x14]
00570f3a : CALL 0x0051bf30
00570f3f : MOV ECX,dword ptr [0x00d73250]
00570f45 : PUSH EBP
00570f46 : PUSH 0x2c
00570f48 : CALL 0x00515840
00570f4d : CMP EAX,EBP
00570f4f : JZ 0x00570f6d
00570f51 : MOV ECX,dword ptr [ESP + 0x10]
00570f55 : MOV EDX,dword ptr [ESI + 0x18]
00570f58 : ADD ECX,0xc
00570f5b : PUSH ECX
00570f5c : LEA ECX,[ESP + 0x18]
00570f60 : PUSH ECX
00570f61 : PUSH EDX
00570f62 : MOV ECX,EAX
00570f64 : CALL 0x0056eff0
00570f69 : MOV EDI,EAX
00570f6b : JMP 0x00570f6f
00570f6d : XOR EDI,EDI
00570f6f : MOV ECX,dword ptr [ESI + 0x14]
00570f72 : CMP ECX,EBP
00570f74 : JZ 0x00570f7b
00570f76 : CALL 0x004ff7e0
00570f7b : MOV dword ptr [ESI + 0x14],EDI
00570f7e : MOV ECX,dword ptr [ESI + 0xc]
00570f81 : MOV EDX,dword ptr [ECX + 0x8]
00570f84 : MOV EAX,dword ptr [EDX + 0xc]
00570f87 : ADD ECX,0x8
00570f8a : PUSH 0x17
00570f8c : CALL EAX
00570f8e : MOV EDI,EAX
00570f90 : MOV EDX,dword ptr [EDI]
00570f92 : MOV EAX,dword ptr [ESI + 0x14]
00570f95 : MOV EDX,dword ptr [EDX + 0x4]
00570f98 : PUSH EAX
00570f99 : MOV ECX,EDI
00570f9b : CALL EDX
00570f9d : MOV ECX,EDI
00570f9f : CALL 0x004ff7e0
00570fa4 : MOV EDI,dword ptr [ESP + 0x14]
00570fa8 : AND EDI,0xfffffffc
00570fab : PUSH -0x1
00570fad : LEA EAX,[EDI + 0x4]
00570fb0 : PUSH EAX
00570fb1 : CALL dword ptr [0x00b851cc]
00570fb7 : SUB EAX,0x1
00570fba : JNZ 0x00570fc2
00570fbc : PUSH EDI
00570fbd : CALL 0x00515cf0
00570fc2 : POP EDI
00570fc3 : MOV EAX,ESI
00570fc5 : POP ESI
00570fc6 : POP EBP
00570fc7 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a6b960
ENTRY    : 00a6b960
BODY     : [[00a6b960, 00a6bacc]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a6b960(int param_1)

{
  int iVar1;
  char cVar2;
  uint uVar3;
  undefined4 *puVar4;
  int iVar5;
  int *piVar6;
  LPCRITICAL_SECTION local_2c;
  char *local_28;
  undefined4 local_24;
  int local_20;
  undefined4 local_1c;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f621;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2c = (LPCRITICAL_SECTION)(param_1 + 0x70);
  local_20 = 0;
  local_28 = ".\\Objects\\AvaEffectMgr.cpp";
  local_24 = 0x403;
  local_1c = 1;
  FUN_006ef1a0(&local_2c);
  local_8 = 0;
  iVar5 = *(int *)(param_1 + 0x3c) - *(int *)(param_1 + 0x38);
  iVar1 = iVar5 >> 0x1f;
  if (iVar5 / 0xc + iVar1 == iVar1) {
    local_8 = 0xffffffff;
    if (local_20 != 0) {
      LeaveCriticalSection(local_2c);
      ExceptionList = local_10;
      return;
    }
  }
  else {
    piVar6 = *(int **)(param_1 + 0x38);
    if (piVar6 != *(int **)(param_1 + 0x3c)) {
      do {
        if ((char)piVar6[2] == '\0') {
          if ((int *)*piVar6 != (int *)0x0) {
            cVar2 = (**(code **)(*(int *)*piVar6 + 0x30))(uVar3);
            if ((cVar2 != '\0') && (*(char *)(*piVar6 + 7) == '\0')) {
              (**(code **)(*(int *)*piVar6 + 0x18))();
              puVar4 = (undefined4 *)FUN_004408a0(piVar6);
              piVar6 = (int *)*puVar4;
              goto LAB_00a6ba8f;
            }
          }
LAB_00a6ba8c:
          piVar6 = piVar6 + 3;
        }
        else {
          iVar1 = piVar6[1];
          if ((iVar1 == 0) ||
             (((*(int *)(iVar1 + 0x184) != 0 && (*(int *)(iVar1 + 0x184) != 2)) ||
              (*(char *)(iVar1 + 0x180) != '\0')))) goto LAB_00a6ba8c;
          if (*(int **)(iVar1 + 0x2c) != (int *)0x0) {
            (**(code **)(**(int **)(iVar1 + 0x2c) + 0x28))(iVar1 + 0xc);
          }
          *(undefined4 *)(iVar1 + 0x2c) = 0;
          puVar4 = (undefined4 *)FUN_004408a0(piVar6);
          piVar6 = (int *)*puVar4;
        }
LAB_00a6ba8f:
      } while (piVar6 != *(int **)(param_1 + 0x3c));
    }
    local_8 = 0xffffffff;
    if (local_20 != 0) {
      LeaveCriticalSection(local_2c);
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a6b960 : PUSH EBP
00a6b961 : MOV EBP,ESP
00a6b963 : PUSH -0x1
00a6b965 : PUSH 0xb0f621
00a6b96a : MOV EAX,FS:[0x0]
00a6b970 : PUSH EAX
00a6b971 : SUB ESP,0x1c
00a6b974 : PUSH EBX
00a6b975 : PUSH ESI
00a6b976 : PUSH EDI
00a6b977 : MOV EAX,[0x00d66fa0]
00a6b97c : XOR EAX,EBP
00a6b97e : PUSH EAX
00a6b97f : LEA EAX,[EBP + -0xc]
00a6b982 : MOV FS:[0x0],EAX
00a6b988 : MOV EDI,dword ptr [EBP + 0x8]
00a6b98b : LEA ECX,[EBP + -0x28]
00a6b98e : LEA EAX,[EDI + 0x70]
00a6b991 : XOR ESI,ESI
00a6b993 : PUSH ECX
00a6b994 : MOV dword ptr [EBP + -0x1c],ESI
00a6b997 : MOV dword ptr [EBP + -0x28],EAX
00a6b99a : MOV dword ptr [EBP + -0x24],0xc43f44
00a6b9a1 : MOV dword ptr [EBP + -0x20],0x403
00a6b9a8 : MOV dword ptr [EBP + -0x18],0x1
00a6b9af : CALL 0x006ef1a0
00a6b9b4 : MOV dword ptr [EBP + -0x4],ESI
00a6b9b7 : MOV ECX,dword ptr [EDI + 0x3c]
00a6b9ba : SUB ECX,dword ptr [EDI + 0x38]
00a6b9bd : LEA EBX,[EDI + 0x34]
00a6b9c0 : MOV EAX,0x2aaaaaab
00a6b9c5 : IMUL ECX
00a6b9c7 : SAR EDX,0x1
00a6b9c9 : MOV EAX,EDX
00a6b9cb : SHR EAX,0x1f
00a6b9ce : ADD EAX,EDX
00a6b9d0 : JNZ 0x00a6ba03
00a6b9d2 : MOV dword ptr [EBP + -0x4],0xffffffff
00a6b9d9 : CMP dword ptr [EBP + -0x1c],ESI
00a6b9dc : JZ 0x00a6bab9
00a6b9e2 : MOV ECX,dword ptr [EBP + -0x28]
00a6b9e5 : PUSH ECX
00a6b9e6 : CALL dword ptr [0x00b8511c]
00a6b9ec : MOV dword ptr [EBP + -0x1c],ESI
00a6b9ef : MOV ECX,dword ptr [EBP + -0xc]
00a6b9f2 : MOV dword ptr FS:[0x0],ECX
00a6b9f9 : POP ECX
00a6b9fa : POP EDI
00a6b9fb : POP ESI
00a6b9fc : POP EBX
00a6b9fd : MOV ESP,EBP
00a6b9ff : POP EBP
00a6ba00 : RET 0x4
00a6ba03 : MOV ESI,dword ptr [EDI + 0x38]
00a6ba06 : CMP ESI,dword ptr [EDI + 0x3c]
00a6ba09 : JZ 0x00a6ba9b
00a6ba0f : NOP
00a6ba10 : CMP byte ptr [ESI + 0x8],0x0
00a6ba14 : JZ 0x00a6ba5d
00a6ba16 : MOV EDI,dword ptr [ESI + 0x4]
00a6ba19 : TEST EDI,EDI
00a6ba1b : JZ 0x00a6ba8c
00a6ba1d : MOV EAX,dword ptr [EDI + 0x184]
00a6ba23 : TEST EAX,EAX
00a6ba25 : JZ 0x00a6ba2c
00a6ba27 : CMP EAX,0x2
00a6ba2a : JNZ 0x00a6ba8c
00a6ba2c : CMP byte ptr [EDI + 0x180],0x0
00a6ba33 : JNZ 0x00a6ba8c
00a6ba35 : MOV ECX,dword ptr [EDI + 0x2c]
00a6ba38 : TEST ECX,ECX
00a6ba3a : JZ 0x00a6ba47
00a6ba3c : MOV EDX,dword ptr [ECX]
00a6ba3e : MOV EDX,dword ptr [EDX + 0x28]
00a6ba41 : LEA EAX,[EDI + 0xc]
00a6ba44 : PUSH EAX
00a6ba45 : CALL EDX
00a6ba47 : MOV dword ptr [EDI + 0x2c],0x0
00a6ba4e : LEA EAX,[EBP + -0x10]
00a6ba51 : PUSH ESI
00a6ba52 : MOV EDI,EBX
00a6ba54 : CALL 0x004408a0
00a6ba59 : MOV ESI,dword ptr [EAX]
00a6ba5b : JMP 0x00a6ba8f
00a6ba5d : MOV ECX,dword ptr [ESI]
00a6ba5f : TEST ECX,ECX
00a6ba61 : JZ 0x00a6ba8c
00a6ba63 : MOV EAX,dword ptr [ECX]
00a6ba65 : MOV EDX,dword ptr [EAX + 0x30]
00a6ba68 : CALL EDX
00a6ba6a : TEST AL,AL
00a6ba6c : JZ 0x00a6ba8c
00a6ba6e : MOV ECX,dword ptr [ESI]
00a6ba70 : CMP byte ptr [ECX + 0x7],0x0
00a6ba74 : JNZ 0x00a6ba8c
00a6ba76 : MOV EAX,dword ptr [ECX]
00a6ba78 : MOV EDX,dword ptr [EAX + 0x18]
00a6ba7b : CALL EDX
00a6ba7d : LEA EAX,[EBP + -0x14]
00a6ba80 : PUSH ESI
00a6ba81 : MOV EDI,EBX
00a6ba83 : CALL 0x004408a0
00a6ba88 : MOV ESI,dword ptr [EAX]
00a6ba8a : JMP 0x00a6ba8f
00a6ba8c : ADD ESI,0xc
00a6ba8f : MOV EAX,dword ptr [EBP + 0x8]
00a6ba92 : CMP ESI,dword ptr [EAX + 0x3c]
00a6ba95 : JNZ 0x00a6ba10
00a6ba9b : MOV dword ptr [EBP + -0x4],0xffffffff
00a6baa2 : CMP dword ptr [EBP + -0x1c],0x0
00a6baa6 : JZ 0x00a6bab9
00a6baa8 : MOV ECX,dword ptr [EBP + -0x28]
00a6baab : PUSH ECX
00a6baac : CALL dword ptr [0x00b8511c]
00a6bab2 : MOV dword ptr [EBP + -0x1c],0x0
00a6bab9 : MOV ECX,dword ptr [EBP + -0xc]
00a6babc : MOV dword ptr FS:[0x0],ECX
00a6bac3 : POP ECX
00a6bac4 : POP EDI
00a6bac5 : POP ESI
00a6bac6 : POP EBX
00a6bac7 : MOV ESP,EBP
00a6bac9 : POP EBP
00a6baca : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_0052db60
ENTRY    : 0052db60
BODY     : [[0052db60, 0052ddde]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_0052db60(int *param_1,int param_2,int *param_3)

{
  char *pcVar1;
  int iVar2;
  int *piVar3;
  bool bVar4;
  bool bVar5;
  char cVar6;
  int iVar7;
  int *piVar8;
  int iVar9;
  undefined4 *puVar10;
  int in_ECX;
  int iStack_28;
  int iStack_24;
  byte bStack_20;
  int iStack_1c;
  int iStack_18;
  byte bStack_14;
  char acStack_10 [16];
  
  bVar5 = false;
  if (param_3 != (int *)0x0) {
    iVar7 = (**(code **)(*param_3 + 8))();
    if (iVar7 - 2U < 4) {
      param_3 = (int *)(**(code **)(param_3[-0x1a] + 0xe4))();
    }
    else {
      param_3 = param_3 + -4;
    }
    piVar8 = (int *)FUN_0052b420(&iStack_28);
    piVar3 = (int *)*piVar8;
    iVar7 = piVar8[1];
    while (((piVar3 != (int *)0x0 && (*piVar3 != 0)) && (iVar7 <= *(int *)(*piVar3 + 4)))) {
      iVar2 = *piVar3 + iVar7 * 0x18;
      pcVar1 = (char *)(iVar2 + 0x10);
      iVar9 = (**(code **)(param_3[4] + 8))();
      if (iVar9 == 0x17) {
        if ((*pcVar1 == '\b') || (*pcVar1 == '\v')) {
          bVar5 = true;
          puVar10 = (undefined4 *)FUN_00527140(&iStack_1c,param_2);
          if ((int *)*puVar10 != param_3) goto LAB_0052dc34;
          bVar4 = true;
        }
        else {
LAB_0052dc34:
          bVar4 = false;
        }
        if (bVar5) {
          bVar5 = false;
          if (((bStack_14 & 2) == 0) && (iStack_1c != 0)) {
            FUN_00503db0();
          }
          iStack_1c = 0;
          if (((bStack_14 & 1) == 0) && (iStack_18 != 0)) {
            FUN_00503db0();
          }
          iStack_18 = 0;
        }
        if (bVar4) {
LAB_0052dd56:
          iVar7 = *(int *)(iVar2 + 0xc);
          *param_1 = iVar7;
          piVar3 = (int *)(iVar7 + 8);
          *piVar3 = *piVar3 + 1;
          return param_1;
        }
        FUN_0052a890();
      }
      else {
        if ((*pcVar1 == '\x06') && (piVar8 = (int *)FUN_00526fa0(param_2), piVar8 == param_3))
        goto LAB_0052dd56;
        if ((*pcVar1 == '\b') || (*pcVar1 == '\v')) {
          FUN_00527140(&iStack_28,param_2);
          acStack_10[0] = '\0';
          cVar6 = (**(code **)(*(int *)(iStack_28 + 0x10) + 0x2c))
                            (param_2 + 0x78,in_ECX + 0x130,acStack_10);
          if (((cVar6 != '\0') && (acStack_10[0] == '\x06')) &&
             (piVar8 = (int *)FUN_00526fa0(param_2), piVar8 == param_3)) {
            FUN_005259f0(param_1,".prototype");
            FUN_00526bc0();
            if (((bStack_20 & 2) == 0) && (iStack_28 != 0)) {
              FUN_00503db0();
            }
            iStack_28 = 0;
            if (((bStack_20 & 1) == 0) && (iStack_24 != 0)) {
              FUN_00503db0();
            }
            return param_1;
          }
          FUN_00526bc0();
          if (((bStack_20 & 2) == 0) && (iStack_28 != 0)) {
            FUN_00503db0();
          }
          iStack_28 = 0;
          if (((bStack_20 & 1) == 0) && (iStack_24 != 0)) {
            FUN_00503db0();
          }
          iStack_24 = 0;
        }
        FUN_0052a890();
      }
    }
  }
  iVar7 = *(int *)(in_ECX + 0xb8);
  *param_1 = iVar7;
  piVar3 = (int *)(iVar7 + 8);
  *piVar3 = *piVar3 + 1;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0052db60 : SUB ESP,0x38
0052db63 : PUSH EBX
0052db64 : PUSH EBP
0052db65 : PUSH ESI
0052db66 : MOV ESI,dword ptr [ESP + 0x50]
0052db6a : PUSH EDI
0052db6b : MOV EDI,ECX
0052db6d : MOV dword ptr [ESP + 0x14],EDI
0052db71 : MOV dword ptr [ESP + 0x10],0x0
0052db79 : TEST ESI,ESI
0052db7b : JZ 0x0052ddc6
0052db81 : MOV EAX,dword ptr [ESI]
0052db83 : MOV EDX,dword ptr [EAX + 0x8]
0052db86 : MOV ECX,ESI
0052db88 : CALL EDX
0052db8a : ADD EAX,-0x2
0052db8d : CMP EAX,0x3
0052db90 : JA 0x0052dba8
0052db92 : MOV EAX,dword ptr [ESI + -0x68]
0052db95 : MOV EDX,dword ptr [EAX + 0xe4]
0052db9b : LEA ECX,[ESI + -0x68]
0052db9e : CALL EDX
0052dba0 : MOV EBX,EAX
0052dba2 : MOV dword ptr [ESP + 0x54],EBX
0052dba6 : JMP 0x0052dbb1
0052dba8 : ADD ESI,-0x10
0052dbab : MOV dword ptr [ESP + 0x54],ESI
0052dbaf : MOV EBX,ESI
0052dbb1 : MOV EAX,dword ptr [EDI + 0x2a0]
0052dbb7 : LEA ECX,[ESP + 0x20]
0052dbbb : PUSH ECX
0052dbbc : LEA ECX,[EAX + 0x18]
0052dbbf : CALL 0x0052b420
0052dbc4 : MOV ECX,dword ptr [EAX]
0052dbc6 : MOV EAX,dword ptr [EAX + 0x4]
0052dbc9 : MOV EDI,dword ptr [ESP + 0x50]
0052dbcd : MOV dword ptr [ESP + 0x18],ECX
0052dbd1 : MOV dword ptr [ESP + 0x1c],EAX
0052dbd5 : TEST ECX,ECX
0052dbd7 : JZ 0x0052ddc2
0052dbdd : CMP dword ptr [ECX],0x0
0052dbe0 : JZ 0x0052ddc2
0052dbe6 : MOV ECX,dword ptr [ECX]
0052dbe8 : CMP EAX,dword ptr [ECX + 0x4]
0052dbeb : JG 0x0052ddc2
0052dbf1 : LEA EDX,[EAX + EAX*0x2]
0052dbf4 : LEA EAX,[ECX + EDX*0x8]
0052dbf7 : LEA ECX,[EBX + 0x10]
0052dbfa : LEA EBP,[EAX + 0xc]
0052dbfd : LEA ESI,[EAX + 0x10]
0052dc00 : MOV EAX,dword ptr [ECX]
0052dc02 : MOV EDX,dword ptr [EAX + 0x8]
0052dc05 : CALL EDX
0052dc07 : CMP EAX,0x17
0052dc0a : JNZ 0x0052dc96
0052dc10 : MOV AL,byte ptr [ESI]
0052dc12 : CMP AL,0x8
0052dc14 : JZ 0x0052dc1a
0052dc16 : CMP AL,0xb
0052dc18 : JNZ 0x0052dc34
0052dc1a : OR dword ptr [ESP + 0x10],0x1
0052dc1f : PUSH EDI
0052dc20 : LEA EAX,[ESP + 0x30]
0052dc24 : PUSH EAX
0052dc25 : MOV ECX,ESI
0052dc27 : CALL 0x00527140
0052dc2c : CMP dword ptr [EAX],EBX
0052dc2e : JNZ 0x0052dc34
0052dc30 : MOV BL,0x1
0052dc32 : JMP 0x0052dc36
0052dc34 : XOR BL,BL
0052dc36 : TEST byte ptr [ESP + 0x10],0x1
0052dc3b : JZ 0x0052dc74
0052dc3d : AND dword ptr [ESP + 0x10],0xfffffffe
0052dc42 : TEST byte ptr [ESP + 0x34],0x2
0052dc47 : JNZ 0x0052dc56
0052dc49 : MOV ECX,dword ptr [ESP + 0x2c]
0052dc4d : TEST ECX,ECX
0052dc4f : JZ 0x0052dc56
0052dc51 : CALL 0x00503db0
0052dc56 : XOR ESI,ESI
0052dc58 : TEST byte ptr [ESP + 0x34],0x1
0052dc5d : MOV dword ptr [ESP + 0x2c],ESI
0052dc61 : JNZ 0x0052dc70
0052dc63 : MOV ECX,dword ptr [ESP + 0x30]
0052dc67 : CMP ECX,ESI
0052dc69 : JZ 0x0052dc70
0052dc6b : CALL 0x00503db0
0052dc70 : MOV dword ptr [ESP + 0x30],ESI
0052dc74 : TEST BL,BL
0052dc76 : JNZ 0x0052dd56
0052dc7c : MOV EBX,dword ptr [ESP + 0x54]
0052dc80 : LEA ECX,[ESP + 0x18]
0052dc84 : CALL 0x0052a890
0052dc89 : MOV EAX,dword ptr [ESP + 0x1c]
0052dc8d : MOV ECX,dword ptr [ESP + 0x18]
0052dc91 : JMP 0x0052dbd5
0052dc96 : CMP byte ptr [ESI],0x6
0052dc99 : JNZ 0x0052dcab
0052dc9b : PUSH EDI
0052dc9c : MOV ECX,ESI
0052dc9e : CALL 0x00526fa0
0052dca3 : CMP EAX,EBX
0052dca5 : JZ 0x0052dd56
0052dcab : MOV AL,byte ptr [ESI]
0052dcad : CMP AL,0x8
0052dcaf : JZ 0x0052dcb9
0052dcb1 : CMP AL,0xb
0052dcb3 : JNZ 0x0052dd40
0052dcb9 : PUSH EDI
0052dcba : LEA ECX,[ESP + 0x24]
0052dcbe : PUSH ECX
0052dcbf : MOV ECX,ESI
0052dcc1 : CALL 0x00527140
0052dcc6 : MOV ECX,dword ptr [ESP + 0x20]
0052dcca : LEA EAX,[ESP + 0x38]
0052dcce : PUSH EAX
0052dccf : MOV EAX,dword ptr [ESP + 0x18]
0052dcd3 : ADD EAX,0x130
0052dcd8 : ADD ECX,0x10
0052dcdb : PUSH EAX
0052dcdc : MOV byte ptr [ESP + 0x40],0x0
0052dce1 : MOV EDX,dword ptr [ECX]
0052dce3 : MOV EDX,dword ptr [EDX + 0x2c]
0052dce6 : LEA EAX,[EDI + 0x78]
0052dce9 : PUSH EAX
0052dcea : CALL EDX
0052dcec : TEST AL,AL
0052dcee : JZ 0x0052dd05
0052dcf0 : CMP byte ptr [ESP + 0x38],0x6
0052dcf5 : JNZ 0x0052dd05
0052dcf7 : PUSH EDI
0052dcf8 : LEA ECX,[ESP + 0x3c]
0052dcfc : CALL 0x00526fa0
0052dd01 : CMP EAX,EBX
0052dd03 : JZ 0x0052dd6c
0052dd05 : LEA ECX,[ESP + 0x38]
0052dd09 : CALL 0x00526bc0
0052dd0e : TEST byte ptr [ESP + 0x28],0x2
0052dd13 : JNZ 0x0052dd22
0052dd15 : MOV ECX,dword ptr [ESP + 0x20]
0052dd19 : TEST ECX,ECX
0052dd1b : JZ 0x0052dd22
0052dd1d : CALL 0x00503db0
0052dd22 : XOR ESI,ESI
0052dd24 : TEST byte ptr [ESP + 0x28],0x1
0052dd29 : MOV dword ptr [ESP + 0x20],ESI
0052dd2d : JNZ 0x0052dd3c
0052dd2f : MOV ECX,dword ptr [ESP + 0x24]
0052dd33 : CMP ECX,ESI
0052dd35 : JZ 0x0052dd3c
0052dd37 : CALL 0x00503db0
0052dd3c : MOV dword ptr [ESP + 0x24],ESI
0052dd40 : LEA ECX,[ESP + 0x18]
0052dd44 : CALL 0x0052a890
0052dd49 : MOV EAX,dword ptr [ESP + 0x1c]
0052dd4d : MOV ECX,dword ptr [ESP + 0x18]
0052dd51 : JMP 0x0052dbd5
0052dd56 : MOV ECX,dword ptr [EBP]
0052dd59 : MOV EAX,dword ptr [ESP + 0x4c]
0052dd5d : POP EDI
0052dd5e : POP ESI
0052dd5f : POP EBP
0052dd60 : MOV dword ptr [EAX],ECX
0052dd62 : INC dword ptr [ECX + 0x8]
0052dd65 : POP EBX
0052dd66 : ADD ESP,0x38
0052dd69 : RET 0xc
0052dd6c : MOV ESI,dword ptr [ESP + 0x4c]
0052dd70 : PUSH 0xb8b404
0052dd75 : PUSH ESI
0052dd76 : MOV ECX,EBP
0052dd78 : CALL 0x005259f0
0052dd7d : LEA ECX,[ESP + 0x38]
0052dd81 : CALL 0x00526bc0
0052dd86 : TEST byte ptr [ESP + 0x28],0x2
0052dd8b : JNZ 0x0052dd9a
0052dd8d : MOV ECX,dword ptr [ESP + 0x20]
0052dd91 : TEST ECX,ECX
0052dd93 : JZ 0x0052dd9a
0052dd95 : CALL 0x00503db0
0052dd9a : TEST byte ptr [ESP + 0x28],0x1
0052dd9f : MOV dword ptr [ESP + 0x20],0x0
0052dda7 : JNZ 0x0052ddb6
0052dda9 : MOV ECX,dword ptr [ESP + 0x24]
0052ddad : TEST ECX,ECX
0052ddaf : JZ 0x0052ddb6
0052ddb1 : CALL 0x00503db0
0052ddb6 : POP EDI
0052ddb7 : MOV EAX,ESI
0052ddb9 : POP ESI
0052ddba : POP EBP
0052ddbb : POP EBX
0052ddbc : ADD ESP,0x38
0052ddbf : RET 0xc
0052ddc2 : MOV EDI,dword ptr [ESP + 0x14]
0052ddc6 : MOV ECX,dword ptr [EDI + 0xb8]
0052ddcc : MOV EAX,dword ptr [ESP + 0x4c]
0052ddd0 : POP EDI
0052ddd1 : POP ESI
0052ddd2 : POP EBP
0052ddd3 : MOV dword ptr [EAX],ECX
0052ddd5 : INC dword ptr [ECX + 0x8]
0052ddd8 : POP EBX
0052ddd9 : ADD ESP,0x38
0052dddc : RET 0xc

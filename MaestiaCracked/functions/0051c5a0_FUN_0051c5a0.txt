PROGRAM  : Maestia.exe
FUNCTION : FUN_0051c5a0
ENTRY    : 0051c5a0
BODY     : [[0051c5a0, 0051c5fa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051c5a0(int *param_1,int param_2)

{
  int *piVar1;
  undefined4 *in_ECX;
  
  if (param_2 == 0) {
    InterlockedExchangeAdd((LONG *)&DAT_00d65134,1);
    piVar1 = (int *)&DAT_00d65130;
  }
  else {
    piVar1 = (int *)FUN_00515840(param_2 + 0xc,0);
    *(undefined1 *)((int)piVar1 + param_2 + 8) = 0;
    piVar1[1] = 1;
    *piVar1 = param_2;
  }
  *in_ECX = piVar1;
  (**(code **)(*param_1 + 4))(((uint)piVar1 & 0xfffffffc) + 8,param_2);
  return;
}



============================================================
DISASSEMBLY
============================================================
0051c5a0 : PUSH ESI
0051c5a1 : MOV ESI,dword ptr [ESP + 0xc]
0051c5a5 : PUSH EDI
0051c5a6 : MOV EDI,ECX
0051c5a8 : TEST ESI,ESI
0051c5aa : JNZ 0x0051c5c0
0051c5ac : PUSH 0x1
0051c5ae : PUSH 0xd65134
0051c5b3 : CALL dword ptr [0x00b851cc]
0051c5b9 : MOV EAX,0xd65130
0051c5be : JMP 0x0051c5df
0051c5c0 : MOV ECX,dword ptr [0x00d73250]
0051c5c6 : PUSH 0x0
0051c5c8 : LEA EAX,[ESI + 0xc]
0051c5cb : PUSH EAX
0051c5cc : CALL 0x00515840
0051c5d1 : MOV byte ptr [EAX + ESI*0x1 + 0x8],0x0
0051c5d6 : MOV dword ptr [EAX + 0x4],0x1
0051c5dd : MOV dword ptr [EAX],ESI
0051c5df : MOV ECX,dword ptr [ESP + 0xc]
0051c5e3 : MOV dword ptr [EDI],EAX
0051c5e5 : MOV EDX,dword ptr [ECX]
0051c5e7 : AND EAX,0xfffffffc
0051c5ea : ADD EAX,0x8
0051c5ed : PUSH ESI
0051c5ee : PUSH EAX
0051c5ef : MOV EAX,dword ptr [EDX + 0x4]
0051c5f2 : CALL EAX
0051c5f4 : MOV EAX,EDI
0051c5f6 : POP EDI
0051c5f7 : POP ESI
0051c5f8 : RET 0x8

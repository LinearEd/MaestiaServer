PROGRAM  : Maestia.exe
FUNCTION : FUN_008882a0
ENTRY    : 008882a0
BODY     : [[008882a0, 00888452]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008882a0(void)

{
  int iVar1;
  uint uVar2;
  DWORD DVar3;
  int in_ECX;
  uint uVar4;
  undefined4 uVar5;
  uint uVar6;
  int iVar7;
  float fVar8;
  
  uVar5 = 0;
  iVar7 = 0;
  if (*(int *)(in_ECX + 1000) != 0) {
    if (100.0 < *(float *)(in_ECX + 0x3e4)) {
      if (((DAT_0172491c != 0) && (*(int *)(DAT_0172491c + 0x17c) == in_ECX)) &&
         (*(uint *)(in_ECX + 0xa4) < (uint)(*(int *)(in_ECX + 0xb0) * 3) / 10)) {
        uVar2 = (uint)((*(float *)(in_ECX + 0x3e4) - 100.0) * DAT_00d72c24);
        uVar5 = 1;
        if (0xff < (int)uVar2) {
          uVar2 = 0xff;
        }
        iVar7 = (uVar2 | 0xffffff00) << 0x10;
      }
      DVar3 = timeGetTime();
      iVar1 = *(int *)(in_ECX + 0x3e0);
      *(DWORD *)(in_ECX + 0x3e0) = DVar3;
      iVar1 = (DVar3 - iVar1) * 4;
      fVar8 = (float)iVar1;
      if (iVar1 < 0) {
        fVar8 = fVar8 + 4.2949673e+09;
      }
      *(float *)(in_ECX + 0x3e4) = *(float *)(in_ECX + 0x3e4) - fVar8;
      goto LAB_00888370;
    }
    if (*(int *)(in_ECX + 0x5c4) != 0) goto LAB_00888370;
  }
  *(undefined4 *)(in_ECX + 0x3e4) = 0;
LAB_00888370:
  if ((DAT_0172491c != 0) && (*(int *)(DAT_0172491c + 0x17c) == in_ECX)) {
    DVar3 = timeGetTime();
    iVar1 = DAT_017251ac;
    uVar2 = DVar3 - *(int *)(in_ECX + 0x13f8);
    if (uVar2 < 200) {
      fVar8 = (float)(int)uVar2;
      if ((int)uVar2 < 0) {
        fVar8 = fVar8 + 4.2949673e+09;
      }
      uVar6 = 0x96;
      fVar8 = (fVar8 - 100.0) * 0.01;
      fVar8 = 1.0 - fVar8 * fVar8;
      uVar2 = (uint)(fVar8 * 150.0);
      if ((int)uVar2 < 0x97) {
        uVar6 = uVar2 & 0xff;
      }
      else {
        uVar2 = 0x96;
      }
      uVar4 = (uint)(fVar8 * 220.0);
      if (0xdc < (int)uVar4) {
        uVar4 = 0xdc;
      }
      *(uint *)(DAT_017251ac + 0x484) = (uVar6 << 8 | uVar2 & 0xff) << 8 | uVar4 & 0xff;
      *(undefined4 *)(iVar1 + 0x488) = 1;
      return;
    }
    *(undefined4 *)(DAT_017251ac + 0x488) = uVar5;
    *(int *)(iVar1 + 0x484) = iVar7;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
008882a0 : PUSH EBP
008882a1 : MOV EBP,ESP
008882a3 : PUSH ECX
008882a4 : PUSH EBX
008882a5 : PUSH ESI
008882a6 : PUSH EDI
008882a7 : MOV ESI,ECX
008882a9 : XOR EBX,EBX
008882ab : XOR EDI,EDI
008882ad : CMP dword ptr [ESI + 0x3e8],EBX
008882b3 : JZ 0x00888365
008882b9 : MOVSS XMM0,dword ptr [ESI + 0x3e4]
008882c1 : MOVSS XMM1,dword ptr [0x00cdf230]
008882c9 : COMISS XMM0,XMM1
008882cc : JBE 0x0088835d
008882d2 : MOV EAX,[0x0172491c]
008882d7 : TEST EAX,EAX
008882d9 : JZ 0x00888327
008882db : CMP dword ptr [EAX + 0x17c],ESI
008882e1 : JNZ 0x00888327
008882e3 : MOV EAX,dword ptr [ESI + 0xb0]
008882e9 : LEA ECX,[EAX + EAX*0x2]
008882ec : MOV EAX,0xcccccccd
008882f1 : MUL ECX
008882f3 : SHR EDX,0x3
008882f6 : CMP dword ptr [ESI + 0xa4],EDX
008882fc : JNC 0x00888327
008882fe : SUBSS XMM0,XMM1
00888302 : MULSS XMM0,dword ptr [0x00d72c24]
0088830a : CVTTSS2SI EAX,XMM0
0088830e : CMP EAX,0xff
00888313 : LEA EBX,[EDI + 0x1]
00888316 : JLE 0x0088831d
00888318 : MOV EAX,0xff
0088831d : OR EAX,0xffffff00
00888322 : SHL EAX,0x10
00888325 : MOV EDI,EAX
00888327 : CALL dword ptr [0x00b85598]
0088832d : MOV ECX,EAX
0088832f : SUB ECX,dword ptr [ESI + 0x3e0]
00888335 : MOV dword ptr [ESI + 0x3e0],EAX
0088833b : ADD ECX,ECX
0088833d : ADD ECX,ECX
0088833f : MOV dword ptr [EBP + -0x4],ECX
00888342 : FILD dword ptr [EBP + -0x4]
00888345 : TEST ECX,ECX
00888347 : JGE 0x0088834f
00888349 : FADD float ptr [0x00cdf0e0]
0088834f : FSUBR float ptr [ESI + 0x3e4]
00888355 : FSTP float ptr [ESI + 0x3e4]
0088835b : JMP 0x00888370
0088835d : CMP dword ptr [ESI + 0x5c4],EBX
00888363 : JNZ 0x00888370
00888365 : XORPS XMM0,XMM0
00888368 : MOVSS dword ptr [ESI + 0x3e4],XMM0
00888370 : MOV EAX,[0x0172491c]
00888375 : TEST EAX,EAX
00888377 : JZ 0x0088844c
0088837d : CMP dword ptr [EAX + 0x17c],ESI
00888383 : JNZ 0x0088844c
00888389 : CALL dword ptr [0x00b85598]
0088838f : SUB EAX,dword ptr [ESI + 0x13f8]
00888395 : CMP EAX,0xc8
0088839a : JNC 0x0088843b
008883a0 : MOV dword ptr [EBP + -0x4],EAX
008883a3 : FILD dword ptr [EBP + -0x4]
008883a6 : TEST EAX,EAX
008883a8 : JGE 0x008883b0
008883aa : FADD float ptr [0x00cdf0e0]
008883b0 : FSUB float ptr [0x00cdf230]
008883b6 : MOV BL,0x96
008883b8 : FMUL float ptr [0x00cdf23c]
008883be : FSTP float ptr [EBP + -0x4]
008883c1 : MOVSS XMM0,dword ptr [EBP + -0x4]
008883c6 : MOVAPS XMM1,XMM0
008883c9 : MULSS XMM1,XMM0
008883cd : MOVSS XMM0,dword ptr [0x00c10fc4]
008883d5 : SUBSS XMM0,XMM1
008883d9 : MOVAPS XMM1,XMM0
008883dc : MULSS XMM1,dword ptr [0x00cdf22c]
008883e4 : CVTTSS2SI EAX,XMM1
008883e8 : CMP EAX,0x96
008883ed : JG 0x008883f3
008883ef : MOV BL,AL
008883f1 : JMP 0x008883f5
008883f3 : MOV AL,0x96
008883f5 : MULSS XMM0,dword ptr [0x00cdf330]
008883fd : CVTTSS2SI EDX,XMM0
00888401 : CMP EDX,0xdc
00888407 : JLE 0x0088840b
00888409 : MOV DL,0xdc
0088840b : MOV ECX,dword ptr [0x017251ac]
00888411 : MOVZX ESI,BL
00888414 : SHL ESI,0x8
00888417 : MOVZX EAX,AL
0088841a : OR ESI,EAX
0088841c : MOVZX EDX,DL
0088841f : SHL ESI,0x8
00888422 : OR ESI,EDX
00888424 : POP EDI
00888425 : MOV dword ptr [ECX + 0x484],ESI
0088842b : POP ESI
0088842c : MOV dword ptr [ECX + 0x488],0x1
00888436 : POP EBX
00888437 : MOV ESP,EBP
00888439 : POP EBP
0088843a : RET
0088843b : MOV EAX,[0x017251ac]
00888440 : MOV dword ptr [EAX + 0x488],EBX
00888446 : MOV dword ptr [EAX + 0x484],EDI
0088844c : POP EDI
0088844d : POP ESI
0088844e : POP EBX
0088844f : MOV ESP,EBP
00888451 : POP EBP
00888452 : RET

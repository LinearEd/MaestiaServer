PROGRAM  : Maestia.exe
FUNCTION : FUN_007fbe60
ENTRY    : 007fbe60
BODY     : [[007fbe60, 007fbfee] [007fbff1, 007fc24b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007fbe60(int param_1,int param_2)

{
  int *piVar1;
  undefined2 uVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  uint uVar7;
  undefined4 *puVar8;
  uint uVar9;
  undefined2 in_FPUControlWord;
  undefined1 local_484 [4];
  undefined2 local_480;
  undefined4 local_470;
  uint local_46c;
  undefined1 local_468 [4];
  undefined2 local_464;
  undefined4 local_454;
  uint local_450;
  undefined1 local_44c [4];
  int *local_448;
  float local_440;
  float local_43c;
  int local_438;
  float local_434;
  int *local_430;
  float local_42c;
  int *local_428;
  longlong local_424;
  uint local_41c;
  undefined4 local_418;
  undefined4 local_414 [256];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b29462;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_438 = param_1;
  local_14 = uVar3;
  if (DAT_017251b8 != 0) {
    puVar8 = local_414;
    for (iVar6 = 0x100; iVar6 != 0; iVar6 = iVar6 + -1) {
      *puVar8 = 0;
      puVar8 = puVar8 + 1;
    }
    FUN_00445580(local_44c,DAT_017251b8 + 0x4c);
    local_8 = 0;
    local_428 = (int *)*local_448;
    local_430 = local_448;
    if (local_428 != local_448) {
      do {
        piVar1 = local_428;
        *(int *)(param_2 + 4) = *(int *)(param_2 + 4) + 0x14;
        *(int *)(param_2 + 0xc) = *(int *)(param_2 + 0xc) + 0x14;
        local_418 = (int *)local_428[4];
        iVar4 = FUN_007945e0(local_418,local_468);
        local_8._0_1_ = 1;
        iVar6 = FUN_00794660(piVar1[4],local_484);
        local_8._0_1_ = 2;
        if (*(uint *)(iVar4 + 0x18) < 8) {
          local_41c = iVar4 + 4;
        }
        else {
          local_41c = *(int *)(iVar4 + 4);
        }
        if (*(uint *)(iVar6 + 0x18) < 8) {
          iVar6 = iVar6 + 4;
        }
        else {
          iVar6 = *(int *)(iVar6 + 4);
        }
        if (*(char *)(piVar1[4] + 0x44) == '\0') {
          uVar2 = 0;
        }
        else {
          uVar2 = FUN_00746770();
        }
        uVar5 = (**(code **)(*local_418 + 0x20))(uVar2,iVar6,local_41c);
        FUN_0040e4a0(L"[Loader(Type:%d): size %d] Top: %s, Pop: %s",uVar5);
        local_8 = CONCAT31(local_8._1_3_,1);
        if (7 < local_46c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_46c = 7;
        local_470 = 0;
        local_480 = 0;
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_450) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_450 = 7;
        local_440 = *(float *)(local_438 + 0x2e4);
        local_454 = 0;
        local_464 = 0;
        if (local_440 < 1.0) {
          if (0.0 < local_440) {
            local_418 = (int *)CONCAT22(in_FPUControlWord,(undefined2)local_418);
            local_424 = (longlong)ROUND(local_440 * 255.0 + DAT_00d72c24);
            uVar9 = (uint)local_424;
          }
          else {
            uVar9 = 0;
          }
        }
        else {
          uVar9 = 0xff;
        }
        local_43c = *(float *)(local_438 + 0x2e8);
        if (local_43c < 1.0) {
          if (0.0 < local_43c) {
            local_418 = (int *)CONCAT22(in_FPUControlWord,(undefined2)local_418);
            local_424 = (longlong)ROUND(local_43c * 255.0 + DAT_00d72c24);
            local_41c = (uint)local_424;
          }
          else {
            local_41c = 0;
          }
        }
        else {
          local_41c = 0xff;
        }
        local_42c = *(float *)(local_438 + 0x2ec);
        if (local_42c < 1.0) {
          if (0.0 < local_42c) {
            local_418 = (int *)CONCAT22(in_FPUControlWord,(undefined2)local_418);
            local_424 = (longlong)ROUND(local_42c * 255.0 + DAT_00d72c24);
            uVar7 = (uint)local_424;
          }
          else {
            uVar7 = 0;
          }
        }
        else {
          uVar7 = 0xff;
        }
        local_434 = *(float *)(local_438 + 0x2f0);
        if (local_434 < 1.0) {
          if (0.0 < local_434) {
            local_418 = (int *)CONCAT22(in_FPUControlWord,(undefined2)local_418);
            local_424 = (longlong)ROUND(local_434 * 255.0 + DAT_00d72c24);
            iVar6 = (uint)local_424;
          }
          else {
            iVar6 = 0;
          }
        }
        else {
          iVar6 = 0xff;
        }
        (**(code **)(**(int **)(local_438 + 0x26c) + 0x3c))
                  (*(int **)(local_438 + 0x26c),0,local_414,0xffffffff,param_2,0,
                   ((iVar6 << 8 | uVar9) << 8 | local_41c) << 8 | uVar7);
        FUN_00416210();
      } while (local_428 != local_430);
    }
    local_8 = 0xffffffff;
    FUN_0040f3f0(local_44c,uVar3);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
007fbe60 : PUSH EBP
007fbe61 : MOV EBP,ESP
007fbe63 : PUSH -0x1
007fbe65 : PUSH 0xb29462
007fbe6a : MOV EAX,FS:[0x0]
007fbe70 : PUSH EAX
007fbe71 : SUB ESP,0x474
007fbe77 : MOV EAX,[0x00d66fa0]
007fbe7c : XOR EAX,EBP
007fbe7e : MOV dword ptr [EBP + -0x10],EAX
007fbe81 : PUSH EBX
007fbe82 : PUSH ESI
007fbe83 : PUSH EDI
007fbe84 : PUSH EAX
007fbe85 : LEA EAX,[EBP + -0xc]
007fbe88 : MOV FS:[0x0],EAX
007fbe8e : MOV EDX,dword ptr [0x017251b8]
007fbe94 : MOV EAX,dword ptr [EBP + 0x8]
007fbe97 : MOV EBX,dword ptr [EBP + 0xc]
007fbe9a : MOV dword ptr [EBP + 0xfffffbcc],EAX
007fbea0 : TEST EDX,EDX
007fbea2 : JZ 0x007fc22e
007fbea8 : XOR EAX,EAX
007fbeaa : MOVZX ESI,AX
007fbead : MOV EAX,ESI
007fbeaf : SHL ESI,0x10
007fbeb2 : OR EAX,ESI
007fbeb4 : MOV ECX,0x100
007fbeb9 : LEA EDI,[EBP + 0xfffffbf0]
007fbebf : ADD EDX,0x4c
007fbec2 : STOSD.REP ES:EDI
007fbec4 : PUSH EDX
007fbec5 : LEA ECX,[EBP + 0xfffffbb8]
007fbecb : PUSH ECX
007fbecc : CALL 0x00445580
007fbed1 : MOV dword ptr [EBP + -0x4],0x0
007fbed8 : MOV EAX,dword ptr [EBP + 0xfffffbbc]
007fbede : MOV ESI,dword ptr [EAX]
007fbee0 : MOV dword ptr [EBP + 0xfffffbd4],EAX
007fbee6 : MOV dword ptr [EBP + 0xfffffbdc],ESI
007fbeec : CMP ESI,EAX
007fbeee : JZ 0x007fc21b
007fbef4 : MOV EAX,0x14
007fbef9 : ADD dword ptr [EBX + 0x4],EAX
007fbefc : ADD dword ptr [EBX + 0xc],EAX
007fbeff : MOV EDX,dword ptr [ESI + 0x10]
007fbf02 : LEA EAX,[EBP + 0xfffffb9c]
007fbf08 : PUSH EAX
007fbf09 : MOV ECX,EDX
007fbf0b : PUSH ECX
007fbf0c : MOV dword ptr [EBP + 0xfffffbec],EDX
007fbf12 : CALL 0x007945e0
007fbf17 : MOV EDI,EAX
007fbf19 : MOV byte ptr [EBP + -0x4],0x1
007fbf1d : MOV EAX,dword ptr [ESI + 0x10]
007fbf20 : LEA EDX,[EBP + 0xfffffb80]
007fbf26 : PUSH EDX
007fbf27 : PUSH EAX
007fbf28 : CALL 0x00794660
007fbf2d : MOV byte ptr [EBP + -0x4],0x2
007fbf31 : MOV ECX,0x8
007fbf36 : CMP dword ptr [EDI + 0x18],ECX
007fbf39 : JC 0x007fbf46
007fbf3b : MOV EDX,dword ptr [EDI + 0x4]
007fbf3e : MOV dword ptr [EBP + 0xfffffbe8],EDX
007fbf44 : JMP 0x007fbf4f
007fbf46 : ADD EDI,0x4
007fbf49 : MOV dword ptr [EBP + 0xfffffbe8],EDI
007fbf4f : CMP dword ptr [EAX + 0x18],ECX
007fbf52 : JC 0x007fbf59
007fbf54 : MOV EDI,dword ptr [EAX + 0x4]
007fbf57 : JMP 0x007fbf5c
007fbf59 : LEA EDI,[EAX + 0x4]
007fbf5c : MOV ESI,dword ptr [ESI + 0x10]
007fbf5f : CMP byte ptr [ESI + 0x44],0x0
007fbf63 : JZ 0x007fbf72
007fbf65 : MOV ESI,dword ptr [ESI + 0x40]
007fbf68 : CALL 0x00746770
007fbf6d : MOVZX EAX,AX
007fbf70 : JMP 0x007fbf74
007fbf72 : XOR EAX,EAX
007fbf74 : MOV ECX,dword ptr [EBP + 0xfffffbe8]
007fbf7a : PUSH ECX
007fbf7b : MOV ECX,dword ptr [EBP + 0xfffffbec]
007fbf81 : MOVZX EDX,AX
007fbf84 : MOV EAX,dword ptr [ECX]
007fbf86 : PUSH EDI
007fbf87 : PUSH EDX
007fbf88 : MOV EDX,dword ptr [EAX + 0x20]
007fbf8b : CALL EDX
007fbf8d : PUSH EAX
007fbf8e : PUSH 0xc28750
007fbf93 : LEA EDX,[EBP + 0xfffffbf0]
007fbf99 : CALL 0x0040e4a0
007fbf9e : ADD ESP,0x14
007fbfa1 : MOV byte ptr [EBP + -0x4],0x1
007fbfa5 : MOV EDI,0x8
007fbfaa : CMP dword ptr [EBP + 0xfffffb98],EDI
007fbfb0 : JC 0x007fbfbd
007fbfb2 : MOV ECX,dword ptr [EBP + 0xfffffb84]
007fbfb8 : CALL 0x006f04e0
007fbfbd : XOR EAX,EAX
007fbfbf : MOV ESI,0x7
007fbfc4 : XOR ECX,ECX
007fbfc6 : MOV dword ptr [EBP + 0xfffffb98],ESI
007fbfcc : MOV dword ptr [EBP + 0xfffffb94],ECX
007fbfd2 : MOV word ptr [EBP + 0xfffffb84],AX
007fbfd9 : MOV byte ptr [EBP + -0x4],AL
007fbfdc : CMP dword ptr [EBP + 0xfffffbb4],EDI
007fbfe2 : JC 0x007fbff1
007fbfe4 : MOV ECX,dword ptr [EBP + 0xfffffba0]
007fbfea : CALL 0x006f04e0
007fbff1 : MOVSS XMM2,dword ptr [0x00c10fc4]
007fbff9 : XORPS XMM1,XMM1
007fbffc : MOV dword ptr [EBP + 0xfffffbb4],ESI
007fc002 : MOV ESI,dword ptr [EBP + 0xfffffbcc]
007fc008 : MOVSS XMM0,dword ptr [ESI + 0x2e4]
007fc010 : XOR EDX,EDX
007fc012 : COMISS XMM0,XMM2
007fc015 : MOV dword ptr [EBP + 0xfffffbb0],ECX
007fc01b : MOV word ptr [EBP + 0xfffffba0],DX
007fc022 : MOVSS dword ptr [EBP + 0xfffffbc4],XMM0
007fc02a : JC 0x007fc03f
007fc02c : FLD float ptr [0x00d72c24]
007fc032 : MOV EDI,0xff
007fc037 : FLD float ptr [0x00cdf130]
007fc03d : JMP 0x007fc09c
007fc03f : COMISS XMM1,XMM0
007fc042 : JC 0x007fc054
007fc044 : FLD float ptr [0x00d72c24]
007fc04a : XOR EDI,EDI
007fc04c : FLD float ptr [0x00cdf130]
007fc052 : JMP 0x007fc09c
007fc054 : FLD float ptr [EBP + 0xfffffbc4]
007fc05a : FLD float ptr [0x00cdf130]
007fc060 : FNSTCW word ptr [EBP + 0xfffffbee]
007fc066 : MOVZX EAX,word ptr [EBP + 0xfffffbee]
007fc06d : FMUL ST1
007fc06f : FLD float ptr [0x00d72c24]
007fc075 : OR EAX,0xc00
007fc07a : MOV dword ptr [EBP + 0xfffffbe8],EAX
007fc080 : FADD ST2,ST0
007fc082 : FLDCW word ptr [EBP + 0xfffffbe8]
007fc088 : FXCH ST2
007fc08a : FISTP qword ptr [EBP + 0xfffffbe0]
007fc090 : MOV EDI,dword ptr [EBP + 0xfffffbe0]
007fc096 : FLDCW word ptr [EBP + 0xfffffbee]
007fc09c : MOVSS XMM0,dword ptr [ESI + 0x2e8]
007fc0a4 : COMISS XMM0,XMM2
007fc0a7 : MOVSS dword ptr [EBP + 0xfffffbc8],XMM0
007fc0af : JC 0x007fc0bd
007fc0b1 : MOV dword ptr [EBP + 0xfffffbe8],0xff
007fc0bb : JMP 0x007fc10a
007fc0bd : COMISS XMM1,XMM0
007fc0c0 : JC 0x007fc0ca
007fc0c2 : MOV dword ptr [EBP + 0xfffffbe8],ECX
007fc0c8 : JMP 0x007fc10a
007fc0ca : FLD float ptr [EBP + 0xfffffbc8]
007fc0d0 : FNSTCW word ptr [EBP + 0xfffffbee]
007fc0d6 : MOVZX EAX,word ptr [EBP + 0xfffffbee]
007fc0dd : FMUL ST1
007fc0df : OR EAX,0xc00
007fc0e4 : MOV dword ptr [EBP + 0xfffffbe8],EAX
007fc0ea : FADD ST0,ST2
007fc0ec : FLDCW word ptr [EBP + 0xfffffbe8]
007fc0f2 : FISTP qword ptr [EBP + 0xfffffbe0]
007fc0f8 : MOV EAX,dword ptr [EBP + 0xfffffbe0]
007fc0fe : MOV dword ptr [EBP + 0xfffffbe8],EAX
007fc104 : FLDCW word ptr [EBP + 0xfffffbee]
007fc10a : MOVSS XMM0,dword ptr [ESI + 0x2ec]
007fc112 : COMISS XMM0,XMM2
007fc115 : MOVSS dword ptr [EBP + 0xfffffbd8],XMM0
007fc11d : JC 0x007fc126
007fc11f : MOV EDX,0xff
007fc124 : JMP 0x007fc169
007fc126 : COMISS XMM1,XMM0
007fc129 : JC 0x007fc12f
007fc12b : XOR EDX,EDX
007fc12d : JMP 0x007fc169
007fc12f : FLD float ptr [EBP + 0xfffffbd8]
007fc135 : FNSTCW word ptr [EBP + 0xfffffbee]
007fc13b : MOVZX EAX,word ptr [EBP + 0xfffffbee]
007fc142 : FMUL ST1
007fc144 : OR EAX,0xc00
007fc149 : MOV dword ptr [EBP + 0xfffffbe4],EAX
007fc14f : FADD ST0,ST2
007fc151 : FLDCW word ptr [EBP + 0xfffffbe4]
007fc157 : FISTP qword ptr [EBP + 0xfffffbe0]
007fc15d : MOV EDX,dword ptr [EBP + 0xfffffbe0]
007fc163 : FLDCW word ptr [EBP + 0xfffffbee]
007fc169 : MOVSS XMM0,dword ptr [ESI + 0x2f0]
007fc171 : COMISS XMM0,XMM2
007fc174 : MOVSS dword ptr [EBP + 0xfffffbd0],XMM0
007fc17c : JC 0x007fc189
007fc17e : FSTP ST0
007fc180 : MOV EAX,0xff
007fc185 : FSTP ST0
007fc187 : JMP 0x007fc1ce
007fc189 : COMISS XMM1,XMM0
007fc18c : JC 0x007fc196
007fc18e : FSTP ST0
007fc190 : XOR EAX,EAX
007fc192 : FSTP ST0
007fc194 : JMP 0x007fc1ce
007fc196 : FMUL float ptr [EBP + 0xfffffbd0]
007fc19c : FNSTCW word ptr [EBP + 0xfffffbee]
007fc1a2 : MOVZX EAX,word ptr [EBP + 0xfffffbee]
007fc1a9 : FADDP
007fc1ab : OR EAX,0xc00
007fc1b0 : MOV dword ptr [EBP + 0xfffffbe4],EAX
007fc1b6 : FLDCW word ptr [EBP + 0xfffffbe4]
007fc1bc : FISTP qword ptr [EBP + 0xfffffbe0]
007fc1c2 : MOV EAX,dword ptr [EBP + 0xfffffbe0]
007fc1c8 : FLDCW word ptr [EBP + 0xfffffbee]
007fc1ce : MOV ECX,dword ptr [ESI + 0x26c]
007fc1d4 : MOV ESI,dword ptr [ECX]
007fc1d6 : SHL EAX,0x8
007fc1d9 : OR EAX,EDI
007fc1db : SHL EAX,0x8
007fc1de : OR EAX,dword ptr [EBP + 0xfffffbe8]
007fc1e4 : SHL EAX,0x8
007fc1e7 : OR EAX,EDX
007fc1e9 : PUSH EAX
007fc1ea : MOV EAX,dword ptr [ESI + 0x3c]
007fc1ed : PUSH 0x0
007fc1ef : PUSH EBX
007fc1f0 : PUSH -0x1
007fc1f2 : LEA EDX,[EBP + 0xfffffbf0]
007fc1f8 : PUSH EDX
007fc1f9 : PUSH 0x0
007fc1fb : PUSH ECX
007fc1fc : CALL EAX
007fc1fe : LEA EDX,[EBP + 0xfffffbdc]
007fc204 : CALL 0x00416210
007fc209 : MOV ESI,dword ptr [EBP + 0xfffffbdc]
007fc20f : CMP ESI,dword ptr [EBP + 0xfffffbd4]
007fc215 : JNZ 0x007fbef4
007fc21b : MOV dword ptr [EBP + -0x4],0xffffffff
007fc222 : LEA ECX,[EBP + 0xfffffbb8]
007fc228 : PUSH ECX
007fc229 : CALL 0x0040f3f0
007fc22e : MOV ECX,dword ptr [EBP + -0xc]
007fc231 : MOV dword ptr FS:[0x0],ECX
007fc238 : POP ECX
007fc239 : POP EDI
007fc23a : POP ESI
007fc23b : POP EBX
007fc23c : MOV ECX,dword ptr [EBP + -0x10]
007fc23f : XOR ECX,EBP
007fc241 : CALL 0x00633e6b
007fc246 : MOV ESP,EBP
007fc248 : POP EBP
007fc249 : RET 0x8

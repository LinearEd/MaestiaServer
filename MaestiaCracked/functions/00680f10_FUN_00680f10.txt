PROGRAM  : Maestia.exe
FUNCTION : FUN_00680f10
ENTRY    : 00680f10
BODY     : [[00680f10, 0068103b] [00681040, 0068107c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00680f10(undefined4 param_1)

{
  int *piVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  undefined4 *in_ECX;
  char *pcVar5;
  char *pcVar6;
  
  FUN_00680410(param_1);
  piVar1 = in_ECX + 0x1a;
  *in_ECX = &PTR_FUN_00bd80f0;
  *piVar1 = 0;
  in_ECX[0x1b] = 0;
  in_ECX[0x1c] = 0;
  in_ECX[0xb] = 0;
  in_ECX[0x20] = 0;
  in_ECX[0xc] = 0;
  *(undefined1 *)(in_ECX + 0x19) = 0;
  *(undefined1 *)((int)in_ECX + 0x65) = 0;
  in_ECX[0x156] = 0;
  in_ECX[0x153] = 1;
  *(undefined1 *)(in_ECX + 0x158) = 0;
  if ((uint)in_ECX[0x1b] < 0x101) {
    if ((uint)in_ECX[0x1c] < 0x101) {
      FUN_005da0e0(piVar1,0x140);
    }
  }
  else if (0x200 < (in_ECX[0x1c] & 0xfffffffe)) {
    if (*piVar1 == 0) {
      param_1 = 2;
      iVar3 = FUN_00515d60(piVar1,0x200,&param_1);
      *piVar1 = iVar3;
      in_ECX[0x1c] = 0x100;
    }
    else {
      iVar3 = FUN_00515c80(*piVar1,0x200);
      *piVar1 = iVar3;
      in_ECX[0x1c] = 0x100;
    }
  }
  in_ECX[0x1b] = 0x100;
  piVar1 = in_ECX + 8;
  if ((uint)in_ECX[9] < 0x101) {
    if ((uint)in_ECX[10] < 0x101) {
      FUN_005da0e0(piVar1,0x140);
    }
  }
  else if (0x200 < (in_ECX[10] & 0xfffffffe)) {
    if (*piVar1 == 0) {
      param_1 = 2;
      iVar3 = FUN_00515d60(piVar1,0x200,&param_1);
      in_ECX[10] = 0x100;
      in_ECX[9] = 0x100;
      *piVar1 = iVar3;
      pcVar5 = "A";
    }
    else {
      iVar3 = FUN_00515c80(*piVar1,0x200);
      in_ECX[10] = 0x100;
      in_ECX[9] = 0x100;
      *piVar1 = iVar3;
      pcVar5 = "A";
    }
    goto LAB_00681042;
  }
  in_ECX[9] = 0x100;
  pcVar5 = "A";
LAB_00681042:
  do {
    iVar3 = 0;
    pcVar6 = pcVar5;
    do {
      iVar4 = _tolower((int)*pcVar5);
      uVar2 = *(undefined4 *)pcVar6;
      iVar4 = iVar3 + (iVar4 + -0x15) * 3;
      iVar3 = iVar3 + 1;
      pcVar6 = pcVar6 + 4;
      in_ECX[iVar4] = uVar2;
    } while (iVar3 < 3);
    pcVar5 = pcVar5 + 0xc;
  } while ((int)pcVar5 < 0xbd7e9c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00680f10 : MOV EAX,dword ptr [ESP + 0x4]
00680f14 : PUSH EBX
00680f15 : PUSH EBP
00680f16 : PUSH ESI
00680f17 : PUSH EDI
00680f18 : PUSH EAX
00680f19 : MOV ESI,ECX
00680f1b : CALL 0x00680410
00680f20 : XOR EBP,EBP
00680f22 : LEA EDI,[ESI + 0x68]
00680f25 : MOV dword ptr [ESI],0xbd80f0
00680f2b : MOV dword ptr [EDI],EBP
00680f2d : MOV dword ptr [EDI + 0x4],EBP
00680f30 : MOV dword ptr [EDI + 0x8],EBP
00680f33 : MOV dword ptr [ESI + 0x2c],EBP
00680f36 : MOV dword ptr [ESI + 0x80],EBP
00680f3c : MOV dword ptr [ESI + 0x30],EBP
00680f3f : MOV byte ptr [ESI + 0x64],0x0
00680f43 : MOV byte ptr [ESI + 0x65],0x0
00680f47 : MOV dword ptr [ESI + 0x558],EBP
00680f4d : MOV dword ptr [ESI + 0x54c],0x1
00680f57 : MOV byte ptr [ESI + 0x560],0x0
00680f5e : MOV EAX,dword ptr [EDI + 0x4]
00680f61 : MOV EBX,0x100
00680f66 : CMP EAX,EBX
00680f68 : JBE 0x00680faf
00680f6a : MOV ECX,dword ptr [EDI + 0x8]
00680f6d : AND ECX,0xfffffffe
00680f70 : CMP ECX,0x200
00680f76 : JBE 0x00680fc1
00680f78 : MOV EAX,dword ptr [EDI]
00680f7a : CMP EAX,EBP
00680f7c : JZ 0x00680f90
00680f7e : PUSH 0x200
00680f83 : PUSH EAX
00680f84 : CALL 0x00515c80
00680f89 : MOV dword ptr [EDI],EAX
00680f8b : MOV dword ptr [EDI + 0x8],EBX
00680f8e : JMP 0x00680fc1
00680f90 : LEA EDX,[ESP + 0x14]
00680f94 : PUSH EDX
00680f95 : PUSH 0x200
00680f9a : PUSH EDI
00680f9b : MOV dword ptr [ESP + 0x20],0x2
00680fa3 : CALL 0x00515d60
00680fa8 : MOV dword ptr [EDI],EAX
00680faa : MOV dword ptr [EDI + 0x8],EBX
00680fad : JMP 0x00680fc1
00680faf : CMP dword ptr [EDI + 0x8],EBX
00680fb2 : JA 0x00680fc1
00680fb4 : PUSH 0x140
00680fb9 : PUSH EDI
00680fba : MOV ECX,EDI
00680fbc : CALL 0x005da0e0
00680fc1 : MOV dword ptr [EDI + 0x4],EBX
00680fc4 : CMP dword ptr [ESI + 0x24],EBX
00680fc7 : LEA EDI,[ESI + 0x20]
00680fca : JBE 0x00681020
00680fcc : MOV EAX,dword ptr [EDI + 0x8]
00680fcf : AND EAX,0xfffffffe
00680fd2 : CMP EAX,0x200
00680fd7 : JBE 0x00681032
00680fd9 : MOV EAX,dword ptr [EDI]
00680fdb : CMP EAX,EBP
00680fdd : JZ 0x00680ff9
00680fdf : PUSH 0x200
00680fe4 : PUSH EAX
00680fe5 : CALL 0x00515c80
00680fea : MOV dword ptr [EDI + 0x8],EBX
00680fed : MOV dword ptr [EDI + 0x4],EBX
00680ff0 : MOV dword ptr [EDI],EAX
00680ff2 : MOV EBX,0xbd7cb0
00680ff7 : JMP 0x00681042
00680ff9 : LEA ECX,[ESP + 0x14]
00680ffd : PUSH ECX
00680ffe : PUSH 0x200
00681003 : PUSH EDI
00681004 : MOV dword ptr [ESP + 0x20],0x2
0068100c : CALL 0x00515d60
00681011 : MOV dword ptr [EDI + 0x8],EBX
00681014 : MOV dword ptr [EDI + 0x4],EBX
00681017 : MOV dword ptr [EDI],EAX
00681019 : MOV EBX,0xbd7cb0
0068101e : JMP 0x00681042
00681020 : CMP dword ptr [EDI + 0x8],EBX
00681023 : JA 0x00681032
00681025 : PUSH 0x140
0068102a : PUSH EDI
0068102b : MOV ECX,EDI
0068102d : CALL 0x005da0e0
00681032 : MOV dword ptr [EDI + 0x4],EBX
00681035 : MOV EBX,0xbd7cb0
0068103a : JMP 0x00681042
00681040 : XOR EBP,EBP
00681042 : XOR EDI,EDI
00681044 : MOV EBP,EBX
00681046 : MOVSX EDX,byte ptr [EBX]
00681049 : PUSH EDX
0068104a : CALL 0x00637a1c
0068104f : MOV EDX,dword ptr [EBP]
00681052 : ADD EAX,-0x15
00681055 : LEA ECX,[EDI + EAX*0x2]
00681058 : ADD ECX,EAX
0068105a : INC EDI
0068105b : ADD ESP,0x4
0068105e : ADD EBP,0x4
00681061 : CMP EDI,0x3
00681064 : MOV dword ptr [ESI + ECX*0x4],EDX
00681067 : JL 0x00681046
00681069 : ADD EBX,0xc
0068106c : CMP EBX,0xbd7e9c
00681072 : JL 0x00681040
00681074 : POP EDI
00681075 : MOV EAX,ESI
00681077 : POP ESI
00681078 : POP EBP
00681079 : POP EBX
0068107a : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00678360
ENTRY    : 00678360
BODY     : [[00678360, 0067848f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00678360(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  uint *puVar5;
  int *in_ECX;
  int iVar6;
  uint uVar7;
  int iVar8;
  
  piVar2 = (int *)*in_ECX;
  if (piVar2 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar2 * 5) <= piVar2[1] * 4 + 4U) goto LAB_0067839a;
    iVar8 = piVar2[1] * 2 + 2;
  }
  FUN_005e2300(param_1,iVar8);
LAB_0067839a:
  piVar2 = (int *)*in_ECX;
  *piVar2 = *piVar2 + 1;
  param_3 = param_3 & piVar2[1];
  iVar8 = *in_ECX;
  iVar3 = *(int *)(param_3 * 0x10 + 8 + iVar8);
  puVar1 = (uint *)(param_3 * 0x10 + 8 + iVar8);
  if (iVar3 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *(uint *)*param_2;
    puVar1[3] = *(uint *)param_2[1];
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(uVar7 * 0x10 + 8 + iVar8) != -2);
  piVar2 = (int *)(uVar7 * 0x10 + 8 + iVar8);
  if (puVar1[1] != param_3) {
    iVar6 = puVar1[1] * 0x10;
    uVar4 = *(uint *)(iVar6 + 8 + iVar8);
    while (puVar5 = (uint *)(iVar6 + 8 + iVar8), uVar4 != param_3) {
      iVar6 = *puVar5 * 0x10;
      uVar4 = *(uint *)(iVar6 + 8 + iVar8);
    }
    if (piVar2 != (int *)0x0) {
      *piVar2 = iVar3;
      piVar2[1] = puVar1[1];
      piVar2[2] = puVar1[2];
      piVar2[3] = puVar1[3];
    }
    *puVar5 = uVar7;
    puVar1[2] = *(uint *)*param_2;
    puVar1[3] = *(uint *)param_2[1];
    *puVar1 = 0xffffffff;
    puVar1[1] = param_3;
    return;
  }
  if (piVar2 != (int *)0x0) {
    *piVar2 = iVar3;
    piVar2[1] = puVar1[1];
    piVar2[2] = puVar1[2];
    piVar2[3] = puVar1[3];
  }
  puVar1[2] = *(uint *)*param_2;
  puVar1[3] = *(uint *)param_2[1];
  *puVar1 = uVar7;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
00678360 : PUSH EBP
00678361 : PUSH ESI
00678362 : MOV ESI,ECX
00678364 : MOV EAX,dword ptr [ESI]
00678366 : TEST EAX,EAX
00678368 : JNZ 0x00678373
0067836a : MOV EAX,dword ptr [ESP + 0xc]
0067836e : PUSH 0x8
00678370 : PUSH EAX
00678371 : JMP 0x00678395
00678373 : MOV ECX,dword ptr [EAX + 0x4]
00678376 : LEA EDX,[ECX*0x4 + 0x4]
0067837d : MOV ECX,dword ptr [EAX]
0067837f : LEA ECX,[ECX + ECX*0x4]
00678382 : CMP ECX,EDX
00678384 : JBE 0x0067839a
00678386 : MOV EDX,dword ptr [EAX + 0x4]
00678389 : MOV ECX,dword ptr [ESP + 0xc]
0067838d : LEA EAX,[EDX + EDX*0x1 + 0x2]
00678391 : PUSH EAX
00678392 : PUSH ECX
00678393 : MOV ECX,ESI
00678395 : CALL 0x005e2300
0067839a : MOV EAX,dword ptr [ESI]
0067839c : INC dword ptr [EAX]
0067839e : MOV ECX,dword ptr [ESP + 0x14]
006783a2 : AND ECX,dword ptr [EAX + 0x4]
006783a5 : MOV EDX,dword ptr [ESI]
006783a7 : MOV EAX,ECX
006783a9 : SHL EAX,0x4
006783ac : MOV EBP,dword ptr [EAX + EDX*0x1 + 0x8]
006783b0 : LEA EAX,[EAX + EDX*0x1 + 0x8]
006783b4 : CMP EBP,-0x2
006783b7 : JNZ 0x006783da
006783b9 : MOV EDX,dword ptr [ESP + 0x10]
006783bd : MOV dword ptr [EAX],0xffffffff
006783c3 : MOV ESI,dword ptr [EDX]
006783c5 : MOV ESI,dword ptr [ESI]
006783c7 : MOV dword ptr [EAX + 0x8],ESI
006783ca : MOV EDX,dword ptr [EDX + 0x4]
006783cd : FLD float ptr [EDX]
006783cf : POP ESI
006783d0 : FSTP float ptr [EAX + 0xc]
006783d3 : MOV dword ptr [EAX + 0x4],ECX
006783d6 : POP EBP
006783d7 : RET 0xc
006783da : PUSH EDI
006783db : MOV EDI,dword ptr [EDX + 0x4]
006783de : MOV ESI,ECX
006783e0 : PUSH EBX
006783e1 : INC ESI
006783e2 : AND ESI,EDI
006783e4 : MOV EBX,ESI
006783e6 : SHL EBX,0x4
006783e9 : CMP dword ptr [EBX + EDX*0x1 + 0x8],-0x2
006783ee : JNZ 0x006783e1
006783f0 : MOV EBX,dword ptr [EAX + 0x4]
006783f3 : MOV EDI,ESI
006783f5 : SHL EDI,0x4
006783f8 : LEA EDI,[EDI + EDX*0x1 + 0x8]
006783fc : CMP EBX,ECX
006783fe : JNZ 0x00678437
00678400 : TEST EDI,EDI
00678402 : JZ 0x00678418
00678404 : MOV dword ptr [EDI],EBP
00678406 : MOV EDX,dword ptr [EAX + 0x4]
00678409 : MOV dword ptr [EDI + 0x4],EDX
0067840c : MOV EDX,dword ptr [EAX + 0x8]
0067840f : MOV dword ptr [EDI + 0x8],EDX
00678412 : FLD float ptr [EAX + 0xc]
00678415 : FSTP float ptr [EDI + 0xc]
00678418 : MOV EDX,dword ptr [ESP + 0x18]
0067841c : MOV EDI,dword ptr [EDX]
0067841e : MOV EDI,dword ptr [EDI]
00678420 : MOV dword ptr [EAX + 0x8],EDI
00678423 : MOV EDX,dword ptr [EDX + 0x4]
00678426 : FLD float ptr [EDX]
00678428 : POP EBX
00678429 : FSTP float ptr [EAX + 0xc]
0067842c : POP EDI
0067842d : MOV dword ptr [EAX],ESI
0067842f : POP ESI
00678430 : MOV dword ptr [EAX + 0x4],ECX
00678433 : POP EBP
00678434 : RET 0xc
00678437 : SHL EBX,0x4
0067843a : CMP dword ptr [EBX + EDX*0x1 + 0x8],ECX
0067843e : LEA EBX,[EBX + EDX*0x1 + 0x8]
00678442 : JZ 0x00678453
00678444 : MOV EBX,dword ptr [EBX]
00678446 : SHL EBX,0x4
00678449 : CMP dword ptr [EBX + EDX*0x1 + 0x8],ECX
0067844d : LEA EBX,[EBX + EDX*0x1 + 0x8]
00678451 : JNZ 0x00678444
00678453 : TEST EDI,EDI
00678455 : JZ 0x0067846b
00678457 : MOV dword ptr [EDI],EBP
00678459 : MOV EDX,dword ptr [EAX + 0x4]
0067845c : MOV dword ptr [EDI + 0x4],EDX
0067845f : MOV EDX,dword ptr [EAX + 0x8]
00678462 : MOV dword ptr [EDI + 0x8],EDX
00678465 : FLD float ptr [EAX + 0xc]
00678468 : FSTP float ptr [EDI + 0xc]
0067846b : MOV EDX,dword ptr [ESP + 0x18]
0067846f : MOV dword ptr [EBX],ESI
00678471 : MOV ESI,dword ptr [EDX]
00678473 : MOV ESI,dword ptr [ESI]
00678475 : MOV dword ptr [EAX + 0x8],ESI
00678478 : MOV EDX,dword ptr [EDX + 0x4]
0067847b : FLD float ptr [EDX]
0067847d : POP EBX
0067847e : POP EDI
0067847f : FSTP float ptr [EAX + 0xc]
00678482 : POP ESI
00678483 : MOV dword ptr [EAX],0xffffffff
00678489 : MOV dword ptr [EAX + 0x4],ECX
0067848c : POP EBP
0067848d : RET 0xc

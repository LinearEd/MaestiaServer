PROGRAM  : Maestia.exe
FUNCTION : FUN_0053a0f0
ENTRY    : 0053a0f0
BODY     : [[0053a0f0, 0053a188]]

============================================================
DECOMPILED C CODE
============================================================

size_t FUN_0053a0f0(void *param_1,uint param_2)

{
  uint uVar1;
  undefined4 uVar2;
  uint uVar3;
  int iVar4;
  int in_ECX;
  uint _Size;
  
  _Size = 0;
  if (*(int *)(in_ECX + 0x30) == 0) {
    uVar2 = (**(code **)(**(int **)(in_ECX + 0x10) + 0x10))();
    *(undefined4 *)(in_ECX + 0x34) = uVar2;
    *(undefined1 *)(in_ECX + 0x38) = 0;
  }
  uVar1 = *(uint *)(in_ECX + 0x2c);
  if (uVar1 < *(uint *)(in_ECX + 0x30)) {
    uVar3 = *(uint *)(in_ECX + 0x30) - uVar1;
    _Size = param_2;
    if (uVar3 <= param_2) {
      _Size = uVar3;
    }
    _memmove(param_1,(void *)(*(int *)(in_ECX + 0x3c) + uVar1),_Size);
    *(int *)(in_ECX + 0x2c) = *(int *)(in_ECX + 0x2c) + _Size;
    param_2 = param_2 - _Size;
    param_1 = (void *)((int)param_1 + _Size);
  }
  if (*(uint *)(in_ECX + 0x30) <= *(uint *)(in_ECX + 0x2c)) {
    *(undefined4 *)(in_ECX + 0x30) = 0;
    *(undefined4 *)(in_ECX + 0x2c) = 0;
  }
  if (param_2 != 0) {
    iVar4 = (**(code **)(**(int **)(in_ECX + 0x10) + 0x28))(param_1,param_2);
    *(int *)(in_ECX + 0x34) = *(int *)(in_ECX + 0x34) + iVar4;
    _Size = _Size + iVar4;
    if (iVar4 < (int)param_2) {
      _memset((void *)(iVar4 + (int)param_1),0,param_2 - iVar4);
    }
  }
  return _Size;
}



============================================================
DISASSEMBLY
============================================================
0053a0f0 : PUSH EBX
0053a0f1 : PUSH EBP
0053a0f2 : PUSH ESI
0053a0f3 : MOV ESI,ECX
0053a0f5 : XOR EBP,EBP
0053a0f7 : PUSH EDI
0053a0f8 : CMP dword ptr [ESI + 0x30],EBP
0053a0fb : JNZ 0x0053a10e
0053a0fd : MOV ECX,dword ptr [ESI + 0x10]
0053a100 : MOV EAX,dword ptr [ECX]
0053a102 : MOV EDX,dword ptr [EAX + 0x10]
0053a105 : CALL EDX
0053a107 : MOV dword ptr [ESI + 0x34],EAX
0053a10a : MOV byte ptr [ESI + 0x38],0x0
0053a10e : MOV ECX,dword ptr [ESI + 0x2c]
0053a111 : MOV EAX,dword ptr [ESI + 0x30]
0053a114 : MOV EDI,dword ptr [ESP + 0x18]
0053a118 : CMP ECX,EAX
0053a11a : JNC 0x0053a143
0053a11c : SUB EAX,ECX
0053a11e : MOV EBP,EDI
0053a120 : CMP EDI,EAX
0053a122 : JC 0x0053a126
0053a124 : MOV EBP,EAX
0053a126 : MOV EAX,dword ptr [ESI + 0x3c]
0053a129 : MOV EBX,dword ptr [ESP + 0x14]
0053a12d : PUSH EBP
0053a12e : ADD EAX,ECX
0053a130 : PUSH EAX
0053a131 : PUSH EBX
0053a132 : CALL 0x00636880
0053a137 : ADD dword ptr [ESI + 0x2c],EBP
0053a13a : ADD ESP,0xc
0053a13d : SUB EDI,EBP
0053a13f : ADD EBX,EBP
0053a141 : JMP 0x0053a147
0053a143 : MOV EBX,dword ptr [ESP + 0x14]
0053a147 : MOV ECX,dword ptr [ESI + 0x2c]
0053a14a : CMP ECX,dword ptr [ESI + 0x30]
0053a14d : JC 0x0053a157
0053a14f : XOR EAX,EAX
0053a151 : MOV dword ptr [ESI + 0x30],EAX
0053a154 : MOV dword ptr [ESI + 0x2c],EAX
0053a157 : TEST EDI,EDI
0053a159 : JZ 0x0053a180
0053a15b : MOV ECX,dword ptr [ESI + 0x10]
0053a15e : MOV EDX,dword ptr [ECX]
0053a160 : MOV EAX,dword ptr [EDX + 0x28]
0053a163 : PUSH EDI
0053a164 : PUSH EBX
0053a165 : CALL EAX
0053a167 : ADD dword ptr [ESI + 0x34],EAX
0053a16a : ADD EBP,EAX
0053a16c : CMP EAX,EDI
0053a16e : JGE 0x0053a180
0053a170 : SUB EDI,EAX
0053a172 : PUSH EDI
0053a173 : ADD EAX,EBX
0053a175 : PUSH 0x0
0053a177 : PUSH EAX
0053a178 : CALL 0x0063b700
0053a17d : ADD ESP,0xc
0053a180 : POP EDI
0053a181 : POP ESI
0053a182 : MOV EAX,EBP
0053a184 : POP EBP
0053a185 : POP EBX
0053a186 : RET 0x8

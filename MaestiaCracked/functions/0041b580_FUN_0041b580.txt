PROGRAM  : Maestia.exe
FUNCTION : FUN_0041b580
ENTRY    : 0041b580
BODY     : [[0041b580, 0041b641]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_0041b580(undefined4 *param_1)

{
  short sVar1;
  short *psVar2;
  int in_ECX;
  int iVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7949b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  _memset(param_1 + 3,0,0x50);
  param_1[0x20] = 7;
  param_1[0x1f] = 0;
  *(undefined2 *)(param_1 + 0x1b) = 0;
  local_8 = 0;
  *param_1 = *(undefined4 *)(in_ECX + 4);
  param_1[1] = *(undefined4 *)(in_ECX + 8);
  *(undefined2 *)(param_1 + 0x17) = *(undefined2 *)(in_ECX + 0x60);
  param_1[0x18] = *(undefined4 *)(in_ECX + 0x62);
  param_1[0x19] = *(undefined4 *)(in_ECX + 0x66);
  if (*(int *)(in_ECX + 0x6a) != 0) {
    psVar2 = (short *)(in_ECX + 0x6e);
    do {
      sVar1 = *psVar2;
      psVar2 = psVar2 + 1;
    } while (sVar1 != 0);
    FUN_00406360((short *)(in_ECX + 0x6e),(int)psVar2 - (in_ECX + 0x70) >> 1);
  }
  puVar4 = (undefined4 *)(in_ECX + 0xc);
  puVar5 = param_1 + 2;
  for (iVar3 = 0x15; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar5 = *puVar4;
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 1;
  }
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0041b580 : PUSH EBP
0041b581 : MOV EBP,ESP
0041b583 : PUSH -0x1
0041b585 : PUSH 0xb7949b
0041b58a : MOV EAX,FS:[0x0]
0041b590 : PUSH EAX
0041b591 : PUSH ECX
0041b592 : PUSH EBX
0041b593 : PUSH ESI
0041b594 : PUSH EDI
0041b595 : MOV EAX,[0x00d66fa0]
0041b59a : XOR EAX,EBP
0041b59c : PUSH EAX
0041b59d : LEA EAX,[EBP + -0xc]
0041b5a0 : MOV FS:[0x0],EAX
0041b5a6 : MOV ESI,ECX
0041b5a8 : MOV EBX,dword ptr [EBP + 0x8]
0041b5ab : PUSH 0x50
0041b5ad : XOR EDI,EDI
0041b5af : LEA EAX,[EBX + 0xc]
0041b5b2 : PUSH EDI
0041b5b3 : PUSH EAX
0041b5b4 : CALL 0x0063b700
0041b5b9 : LEA ECX,[EBX + 0x68]
0041b5bc : XOR EDX,EDX
0041b5be : MOV dword ptr [ECX + 0x18],0x7
0041b5c5 : MOV dword ptr [ECX + 0x14],EDI
0041b5c8 : ADD ESP,0xc
0041b5cb : MOV word ptr [ECX + 0x4],DX
0041b5cf : MOV dword ptr [EBP + -0x4],EDI
0041b5d2 : MOV EAX,dword ptr [ESI + 0x4]
0041b5d5 : MOV dword ptr [EBX],EAX
0041b5d7 : MOV EDX,dword ptr [ESI + 0x8]
0041b5da : MOV dword ptr [EBX + 0x4],EDX
0041b5dd : MOV AX,word ptr [ESI + 0x60]
0041b5e1 : MOV word ptr [EBX + 0x5c],AX
0041b5e5 : MOV EDX,dword ptr [ESI + 0x62]
0041b5e8 : MOV dword ptr [EBX + 0x60],EDX
0041b5eb : MOV EAX,dword ptr [ESI + 0x66]
0041b5ee : MOV dword ptr [EBX + 0x64],EAX
0041b5f1 : CMP dword ptr [ESI + 0x6a],EDI
0041b5f4 : JZ 0x0041b618
0041b5f6 : LEA EDI,[ESI + 0x6e]
0041b5f9 : MOV EAX,EDI
0041b5fb : LEA EDX,[EAX + 0x2]
0041b5fe : MOV dword ptr [EBP + -0x10],EDX
0041b601 : MOV DX,word ptr [EAX]
0041b604 : ADD EAX,0x2
0041b607 : TEST DX,DX
0041b60a : JNZ 0x0041b601
0041b60c : SUB EAX,dword ptr [EBP + -0x10]
0041b60f : SAR EAX,0x1
0041b611 : PUSH EAX
0041b612 : PUSH EDI
0041b613 : CALL 0x00406360
0041b618 : ADD ESI,0xc
0041b61b : MOV ECX,0x15
0041b620 : LEA EDI,[EBX + 0x8]
0041b623 : MOVSD.REP ES:EDI,ESI
0041b625 : MOV dword ptr [EBP + -0x4],0xffffffff
0041b62c : MOV EAX,EBX
0041b62e : MOV ECX,dword ptr [EBP + -0xc]
0041b631 : MOV dword ptr FS:[0x0],ECX
0041b638 : POP ECX
0041b639 : POP EDI
0041b63a : POP ESI
0041b63b : POP EBX
0041b63c : MOV ESP,EBP
0041b63e : POP EBP
0041b63f : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a6fc60
ENTRY    : 00a6fc60
BODY     : [[00a6fc60, 00a6fe2d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a6fc60(void)

{
  int *piVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  int *in_ECX;
  undefined1 local_68 [28];
  undefined1 local_4c [32];
  undefined2 local_2c;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1c9ef;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  if (*in_ECX != 0) {
    if (*(char *)(DAT_00da93ec + 0x1d5) == '\x01') {
      if (((DAT_0172491c == 0) || (*DAT_00da9894 == 0)) || (*(int *)(*DAT_00da9894 + 0x1a8) == 0))
      goto LAB_00a6fe12;
      FUN_00406460(L"IDS_ERROR_NOT_USABLE");
      local_8 = 0;
      piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar3 = FUN_0081d120(local_4c);
      local_8._0_1_ = 1;
      (**(code **)(*piVar1 + 0x44))(uVar3,3,uVar2);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
    }
    else {
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
      local_8 = 2;
      FUN_00405eb0(in_ECX[4] + 0xe8,0,0xffffffff);
      FUN_008ab4c0();
      if (*(short *)(in_ECX[4] + 0xb8) == 0) {
        FUN_00406460(L"IDS_GUI_GUILD_ESTABLISHMENT_ERROR");
        local_8._0_1_ = 3;
        iVar4 = FUN_0081d120(local_68);
        local_8._0_1_ = 4;
        if (*(uint *)(iVar4 + 0x18) < 8) {
          iVar4 = iVar4 + 4;
        }
        else {
          iVar4 = *(int *)(iVar4 + 4);
        }
        FUN_00406460(iVar4);
        local_8._0_1_ = 5;
        (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_4c,3);
        local_8._0_1_ = 4;
        FUN_00406560();
        local_8._0_1_ = 3;
        FUN_00406560();
        local_8 = CONCAT31(local_8._1_3_,2);
        FUN_00406560();
      }
      else {
        (**(code **)(*(int *)*in_ECX + 0x18))(1,300);
      }
    }
    local_8 = 0xffffffff;
    FUN_00406560();
  }
LAB_00a6fe12:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a6fc60 : PUSH EBP
00a6fc61 : MOV EBP,ESP
00a6fc63 : PUSH -0x1
00a6fc65 : PUSH 0xb1c9ef
00a6fc6a : MOV EAX,FS:[0x0]
00a6fc70 : PUSH EAX
00a6fc71 : SUB ESP,0x74
00a6fc74 : MOV EAX,[0x00d66fa0]
00a6fc79 : XOR EAX,EBP
00a6fc7b : MOV dword ptr [EBP + -0x10],EAX
00a6fc7e : PUSH EBX
00a6fc7f : PUSH ESI
00a6fc80 : PUSH EDI
00a6fc81 : PUSH EAX
00a6fc82 : LEA EAX,[EBP + -0xc]
00a6fc85 : MOV FS:[0x0],EAX
00a6fc8b : MOV ESI,ECX
00a6fc8d : XOR EBX,EBX
00a6fc8f : CMP dword ptr [ESI],EBX
00a6fc91 : JZ 0x00a6fe12
00a6fc97 : MOV EAX,[0x00da93ec]
00a6fc9c : MOV AL,byte ptr [EAX + 0x1d5]
00a6fca2 : CMP AL,0x1
00a6fca4 : JNZ 0x00a6fd2b
00a6fcaa : CMP dword ptr [0x0172491c],EBX
00a6fcb0 : JZ 0x00a6fe12
00a6fcb6 : MOV ECX,dword ptr [0x00da9894]
00a6fcbc : MOV EAX,dword ptr [ECX]
00a6fcbe : CMP EAX,EBX
00a6fcc0 : JZ 0x00a6fe12
00a6fcc6 : CMP dword ptr [EAX + 0x1a8],EBX
00a6fccc : JZ 0x00a6fe12
00a6fcd2 : PUSH 0xc49c00
00a6fcd7 : LEA ECX,[EBP + -0x48]
00a6fcda : CALL 0x00406460
00a6fcdf : MOV dword ptr [EBP + -0x4],EBX
00a6fce2 : MOV EDX,dword ptr [0x00da9894]
00a6fce8 : MOV EAX,dword ptr [EDX]
00a6fcea : MOV ESI,dword ptr [EAX + 0x1a8]
00a6fcf0 : MOV ECX,dword ptr [0x0172491c]
00a6fcf6 : LEA EAX,[EBP + -0x48]
00a6fcf9 : PUSH EAX
00a6fcfa : LEA EDI,[EBP + -0x64]
00a6fcfd : CALL 0x0081d120
00a6fd02 : MOV byte ptr [EBP + -0x4],0x1
00a6fd06 : MOV EDX,dword ptr [ESI]
00a6fd08 : PUSH 0x3
00a6fd0a : PUSH EAX
00a6fd0b : MOV EAX,dword ptr [EDX + 0x44]
00a6fd0e : MOV ECX,ESI
00a6fd10 : CALL EAX
00a6fd12 : MOV byte ptr [EBP + -0x4],BL
00a6fd15 : MOV ECX,EDI
00a6fd17 : CALL 0x00406560
00a6fd1c : MOV dword ptr [EBP + -0x4],0xffffffff
00a6fd23 : LEA ECX,[EBP + -0x48]
00a6fd26 : JMP 0x00a6fe0d
00a6fd2b : XOR ECX,ECX
00a6fd2d : MOV dword ptr [EBP + -0x14],0x7
00a6fd34 : MOV dword ptr [EBP + -0x18],EBX
00a6fd37 : MOV word ptr [EBP + -0x28],CX
00a6fd3b : MOV dword ptr [EBP + -0x4],0x2
00a6fd42 : MOV EAX,dword ptr [ESI + 0x10]
00a6fd45 : PUSH -0x1
00a6fd47 : PUSH EBX
00a6fd48 : ADD EAX,0xe8
00a6fd4d : PUSH EAX
00a6fd4e : LEA ECX,[EBP + -0x2c]
00a6fd51 : CALL 0x00405eb0
00a6fd56 : MOV ECX,dword ptr [ESI]
00a6fd58 : LEA EAX,[EBP + -0x2c]
00a6fd5b : CALL 0x008ab4c0
00a6fd60 : MOV EDX,dword ptr [ESI + 0x10]
00a6fd63 : CMP word ptr [EDX + 0xb8],BX
00a6fd6a : JNZ 0x00a6fdf3
00a6fd70 : PUSH 0xc49c30
00a6fd75 : LEA ECX,[EBP + -0x64]
00a6fd78 : CALL 0x00406460
00a6fd7d : MOV byte ptr [EBP + -0x4],0x3
00a6fd81 : MOV ECX,dword ptr [0x0172491c]
00a6fd87 : LEA EAX,[EBP + -0x64]
00a6fd8a : PUSH EAX
00a6fd8b : LEA EDI,[EBP + -0x80]
00a6fd8e : CALL 0x0081d120
00a6fd93 : MOV BL,0x4
00a6fd95 : MOV byte ptr [EBP + -0x4],BL
00a6fd98 : CMP dword ptr [EAX + 0x18],0x8
00a6fd9c : JC 0x00a6fda3
00a6fd9e : MOV EAX,dword ptr [EAX + 0x4]
00a6fda1 : JMP 0x00a6fda6
00a6fda3 : ADD EAX,0x4
00a6fda6 : PUSH EAX
00a6fda7 : LEA ECX,[EBP + -0x48]
00a6fdaa : CALL 0x00406460
00a6fdaf : MOV byte ptr [EBP + -0x4],0x5
00a6fdb3 : MOV ECX,dword ptr [0x00da9894]
00a6fdb9 : MOV EAX,dword ptr [ECX]
00a6fdbb : MOV ECX,dword ptr [EAX + 0x1a8]
00a6fdc1 : MOV EDX,dword ptr [ECX]
00a6fdc3 : MOV EDX,dword ptr [EDX + 0x44]
00a6fdc6 : PUSH 0x3
00a6fdc8 : LEA EAX,[EBP + -0x48]
00a6fdcb : PUSH EAX
00a6fdcc : CALL EDX
00a6fdce : MOV byte ptr [EBP + -0x4],BL
00a6fdd1 : LEA ECX,[EBP + -0x48]
00a6fdd4 : CALL 0x00406560
00a6fdd9 : MOV byte ptr [EBP + -0x4],0x3
00a6fddd : LEA ECX,[EBP + -0x80]
00a6fde0 : CALL 0x00406560
00a6fde5 : MOV byte ptr [EBP + -0x4],0x2
00a6fde9 : LEA ECX,[EBP + -0x64]
00a6fdec : CALL 0x00406560
00a6fdf1 : JMP 0x00a6fe03
00a6fdf3 : MOV ECX,dword ptr [ESI]
00a6fdf5 : MOV EAX,dword ptr [ECX]
00a6fdf7 : MOV EDX,dword ptr [EAX + 0x18]
00a6fdfa : PUSH 0x12c
00a6fdff : PUSH 0x1
00a6fe01 : CALL EDX
00a6fe03 : MOV dword ptr [EBP + -0x4],0xffffffff
00a6fe0a : LEA ECX,[EBP + -0x2c]
00a6fe0d : CALL 0x00406560
00a6fe12 : MOV ECX,dword ptr [EBP + -0xc]
00a6fe15 : MOV dword ptr FS:[0x0],ECX
00a6fe1c : POP ECX
00a6fe1d : POP EDI
00a6fe1e : POP ESI
00a6fe1f : POP EBX
00a6fe20 : MOV ECX,dword ptr [EBP + -0x10]
00a6fe23 : XOR ECX,EBP
00a6fe25 : CALL 0x00633e6b
00a6fe2a : MOV ESP,EBP
00a6fe2c : POP EBP
00a6fe2d : RET

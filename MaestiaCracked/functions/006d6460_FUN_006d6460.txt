PROGRAM  : Maestia.exe
FUNCTION : FUN_006d6460
ENTRY    : 006d6460
BODY     : [[006d6460, 006d64fe]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006d6460(int *param_1)

{
  byte bVar1;
  undefined4 *puVar2;
  uint uVar3;
  byte *pbVar4;
  int iVar5;
  
  puVar2 = (undefined4 *)param_1[6];
  pbVar4 = (byte *)*puVar2;
  iVar5 = puVar2[1];
  if (iVar5 == 0) {
    uVar3 = (*(code *)puVar2[3])(param_1);
    if ((char)uVar3 == '\0') goto LAB_006d6481;
    pbVar4 = (byte *)*puVar2;
    iVar5 = puVar2[1];
  }
  bVar1 = *pbVar4;
  iVar5 = iVar5 + -1;
  pbVar4 = pbVar4 + 1;
  if (iVar5 == 0) {
    uVar3 = (*(code *)puVar2[3])(param_1);
    if ((char)uVar3 == '\0') {
LAB_006d6481:
      return uVar3 & 0xffffff00;
    }
    pbVar4 = (byte *)*puVar2;
    iVar5 = puVar2[1];
  }
  uVar3 = (uint)*pbVar4;
  if ((bVar1 != 0xff) || (uVar3 != 0xd8)) {
    *(undefined4 *)(*param_1 + 0x14) = 0x35;
    *(uint *)(*param_1 + 0x18) = (uint)bVar1;
    *(uint *)(*param_1 + 0x1c) = uVar3;
    (**(code **)*param_1)(param_1);
  }
  param_1[0x5f] = uVar3;
  puVar2[1] = iVar5 + -1;
  *puVar2 = pbVar4 + 1;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
006d6460 : PUSH EBX
006d6461 : PUSH EBP
006d6462 : MOV EBP,dword ptr [ESP + 0xc]
006d6466 : PUSH ESI
006d6467 : MOV ESI,dword ptr [EBP + 0x18]
006d646a : MOV EBX,dword ptr [ESI]
006d646c : PUSH EDI
006d646d : MOV EDI,dword ptr [ESI + 0x4]
006d6470 : TEST EDI,EDI
006d6472 : JNZ 0x006d648d
006d6474 : MOV EAX,dword ptr [ESI + 0xc]
006d6477 : PUSH EBP
006d6478 : CALL EAX
006d647a : ADD ESP,0x4
006d647d : TEST AL,AL
006d647f : JNZ 0x006d6488
006d6481 : POP EDI
006d6482 : POP ESI
006d6483 : POP EBP
006d6484 : XOR AL,AL
006d6486 : POP EBX
006d6487 : RET
006d6488 : MOV EBX,dword ptr [ESI]
006d648a : MOV EDI,dword ptr [ESI + 0x4]
006d648d : MOVZX ECX,byte ptr [EBX]
006d6490 : DEC EDI
006d6491 : INC EBX
006d6492 : MOV dword ptr [ESP + 0x14],ECX
006d6496 : TEST EDI,EDI
006d6498 : JNZ 0x006d64b0
006d649a : MOV ECX,dword ptr [ESI + 0xc]
006d649d : PUSH EBP
006d649e : CALL ECX
006d64a0 : ADD ESP,0x4
006d64a3 : TEST AL,AL
006d64a5 : JZ 0x006d6481
006d64a7 : MOV EBX,dword ptr [ESI]
006d64a9 : MOV EDI,dword ptr [ESI + 0x4]
006d64ac : MOV ECX,dword ptr [ESP + 0x14]
006d64b0 : MOVZX EAX,byte ptr [EBX]
006d64b3 : DEC EDI
006d64b4 : INC EBX
006d64b5 : MOV dword ptr [ESP + 0x14],EAX
006d64b9 : CMP ECX,0xff
006d64bf : JNZ 0x006d64c8
006d64c1 : CMP EAX,0xd8
006d64c6 : JZ 0x006d64ed
006d64c8 : MOV EDX,dword ptr [EBP]
006d64cb : MOV dword ptr [EDX + 0x14],0x35
006d64d2 : MOV EDX,dword ptr [EBP]
006d64d5 : MOV dword ptr [EDX + 0x18],ECX
006d64d8 : MOV ECX,dword ptr [EBP]
006d64db : MOV dword ptr [ECX + 0x1c],EAX
006d64de : MOV EDX,dword ptr [EBP]
006d64e1 : MOV EAX,dword ptr [EDX]
006d64e3 : PUSH EBP
006d64e4 : CALL EAX
006d64e6 : MOV EAX,dword ptr [ESP + 0x18]
006d64ea : ADD ESP,0x4
006d64ed : MOV dword ptr [EBP + 0x17c],EAX
006d64f3 : MOV dword ptr [ESI + 0x4],EDI
006d64f6 : POP EDI
006d64f7 : MOV dword ptr [ESI],EBX
006d64f9 : POP ESI
006d64fa : POP EBP
006d64fb : MOV AL,0x1
006d64fd : POP EBX
006d64fe : RET

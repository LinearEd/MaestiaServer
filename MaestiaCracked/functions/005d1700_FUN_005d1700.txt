PROGRAM  : Maestia.exe
FUNCTION : FUN_005d1700
ENTRY    : 005d1700
BODY     : [[005d1700, 005d1877]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_005d1700(undefined4 *param_1,uint param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  uint uVar7;
  int local_18;
  undefined1 local_14;
  int local_10;
  int local_c;
  byte local_8;
  
  iVar3 = param_2;
  iVar4 = *(int *)(param_2 + 0x9c);
  piVar1 = (int *)(iVar4 + 8);
  *piVar1 = *piVar1 + 1;
  iVar4 = FUN_00530480(iVar4);
  if (iVar4 == 0) {
    FUN_005cf4c0(&local_10,iVar3);
    if (((local_8 & 2) == 0) && (local_10 != 0)) {
      FUN_00503db0();
    }
    local_10 = 0;
    if (((local_8 & 1) == 0) && (local_c != 0)) {
      FUN_00503db0();
    }
  }
  local_18 = iVar3;
  local_14 = 8;
  puVar5 = (undefined4 *)FUN_00515840(0x34,0);
  if (puVar5 == (undefined4 *)0x0) {
    puVar5 = (undefined4 *)0x0;
  }
  else {
    FUN_00568960(&local_18,FUN_005d1090);
    *puVar5 = &PTR_LAB_00b931f0;
    puVar5[4] = &PTR_LAB_00b90510;
  }
  puVar2 = param_1;
  *(undefined1 *)(param_1 + 2) = 0;
  *param_1 = puVar5;
  param_1[1] = 0;
  iVar4 = FUN_00515840(0x5c,0);
  if (iVar4 == 0) {
    uVar7 = 0;
  }
  else {
    puVar5 = puVar2;
    uVar6 = FUN_00530910(0x25);
    uVar7 = FUN_005d16b0(&local_18,uVar6,puVar5);
    if (uVar7 != 0) {
      *(uint *)(uVar7 + 8) = *(int *)(uVar7 + 8) + 1U & 0x8fffffff;
    }
  }
  param_1 = (undefined4 *)0x27;
  param_2 = uVar7;
  FUN_0050ff10(&param_1,&param_2);
  if (param_2 != 0) {
    FUN_00503db0();
  }
  puVar5 = &param_2;
  param_2 = param_2 & 0xffffff00;
  iVar4 = *(int *)(*(int *)(iVar3 + 0x29c) + 0x10);
  uVar6 = FUN_00526210(puVar2);
  (**(code **)(iVar4 + 0x28))(&local_18,iVar3 + 0xa4,uVar6,puVar5);
  FUN_00526bc0();
  if (uVar7 != 0) {
    FUN_00503db0();
  }
  return puVar2;
}



============================================================
DISASSEMBLY
============================================================
005d1700 : SUB ESP,0x18
005d1703 : PUSH EBX
005d1704 : PUSH EBP
005d1705 : PUSH ESI
005d1706 : MOV ESI,dword ptr [ESP + 0x2c]
005d170a : MOV EAX,dword ptr [ESI + 0x9c]
005d1710 : PUSH EDI
005d1711 : PUSH ECX
005d1712 : MOV ECX,ESP
005d1714 : MOV dword ptr [ECX],EAX
005d1716 : INC dword ptr [EAX + 0x8]
005d1719 : MOV ECX,ESI
005d171b : CALL 0x00530480
005d1720 : XOR EBX,EBX
005d1722 : CMP EAX,EBX
005d1724 : JNZ 0x005d1760
005d1726 : LEA EAX,[ESP + 0x18]
005d172a : PUSH ESI
005d172b : PUSH EAX
005d172c : CALL 0x005cf4c0
005d1731 : ADD ESP,0x8
005d1734 : TEST byte ptr [ESP + 0x20],0x2
005d1739 : JNZ 0x005d1748
005d173b : MOV ECX,dword ptr [ESP + 0x18]
005d173f : CMP ECX,EBX
005d1741 : JZ 0x005d1748
005d1743 : CALL 0x00503db0
005d1748 : TEST byte ptr [ESP + 0x20],0x1
005d174d : MOV dword ptr [ESP + 0x18],EBX
005d1751 : JNZ 0x005d1760
005d1753 : MOV ECX,dword ptr [ESP + 0x1c]
005d1757 : CMP ECX,EBX
005d1759 : JZ 0x005d1760
005d175b : CALL 0x00503db0
005d1760 : MOV ECX,dword ptr [ESI + 0x288]
005d1766 : PUSH EBX
005d1767 : PUSH 0x34
005d1769 : MOV dword ptr [ESP + 0x18],ESI
005d176d : MOV byte ptr [ESP + 0x1c],0x8
005d1772 : CALL 0x00515840
005d1777 : MOV EDI,EAX
005d1779 : CMP EDI,EBX
005d177b : JZ 0x005d179f
005d177d : PUSH 0x5d1090
005d1782 : LEA ECX,[ESP + 0x14]
005d1786 : PUSH ECX
005d1787 : MOV ECX,EDI
005d1789 : CALL 0x00568960
005d178e : MOV dword ptr [EDI],0xb931f0
005d1794 : MOV dword ptr [EDI + 0x10],0xb90510
005d179b : MOV EAX,EDI
005d179d : JMP 0x005d17a1
005d179f : XOR EAX,EAX
005d17a1 : MOV EDI,dword ptr [ESP + 0x2c]
005d17a5 : PUSH EBX
005d17a6 : MOV byte ptr [EDI + 0x8],BL
005d17a9 : MOV dword ptr [EDI],EAX
005d17ab : MOV dword ptr [EDI + 0x4],EBX
005d17ae : MOV ECX,dword ptr [ESI + 0x288]
005d17b4 : PUSH 0x5c
005d17b6 : CALL 0x00515840
005d17bb : MOV EBP,EAX
005d17bd : CMP EBP,EBX
005d17bf : JZ 0x005d1871
005d17c5 : PUSH EDI
005d17c6 : PUSH 0x25
005d17c8 : MOV ECX,ESI
005d17ca : CALL 0x00530910
005d17cf : PUSH EAX
005d17d0 : LEA EDX,[ESP + 0x18]
005d17d4 : PUSH EDX
005d17d5 : MOV ECX,EBP
005d17d7 : CALL 0x005d16b0
005d17dc : MOV EBP,EAX
005d17de : CMP EBP,EBX
005d17e0 : JZ 0x005d17ee
005d17e2 : MOV EAX,dword ptr [EBP + 0x8]
005d17e5 : INC EAX
005d17e6 : AND EAX,0x8fffffff
005d17eb : MOV dword ptr [EBP + 0x8],EAX
005d17ee : LEA ECX,[ESP + 0x30]
005d17f2 : PUSH ECX
005d17f3 : LEA EDX,[ESP + 0x30]
005d17f7 : PUSH EDX
005d17f8 : LEA ECX,[ESI + 0x278]
005d17fe : MOV dword ptr [ESP + 0x38],EBP
005d1802 : MOV dword ptr [ESP + 0x34],0x27
005d180a : CALL 0x0050ff10
005d180f : MOV ECX,dword ptr [ESP + 0x30]
005d1813 : CMP ECX,EBX
005d1815 : JZ 0x005d181c
005d1817 : CALL 0x00503db0
005d181c : MOV EAX,dword ptr [ESI + 0x29c]
005d1822 : LEA ECX,[ESP + 0x30]
005d1826 : PUSH ECX
005d1827 : MOV byte ptr [ESP + 0x34],BL
005d182b : MOV EBX,dword ptr [EAX + 0x10]
005d182e : PUSH EDI
005d182f : LEA ECX,[ESP + 0x20]
005d1833 : CALL 0x00526210
005d1838 : MOV ECX,dword ptr [ESI + 0x29c]
005d183e : PUSH EAX
005d183f : LEA EDX,[ESI + 0xa4]
005d1845 : PUSH EDX
005d1846 : MOV EDX,dword ptr [EBX + 0x28]
005d1849 : LEA EAX,[ESP + 0x1c]
005d184d : PUSH EAX
005d184e : ADD ECX,0x10
005d1851 : CALL EDX
005d1853 : LEA ECX,[ESP + 0x18]
005d1857 : CALL 0x00526bc0
005d185c : TEST EBP,EBP
005d185e : JZ 0x005d1867
005d1860 : MOV ECX,EBP
005d1862 : CALL 0x00503db0
005d1867 : MOV EAX,EDI
005d1869 : POP EDI
005d186a : POP ESI
005d186b : POP EBP
005d186c : POP EBX
005d186d : ADD ESP,0x18
005d1870 : RET
005d1871 : XOR EBP,EBP
005d1873 : JMP 0x005d17ee

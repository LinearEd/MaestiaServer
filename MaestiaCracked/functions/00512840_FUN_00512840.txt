PROGRAM  : Maestia.exe
FUNCTION : FUN_00512840
ENTRY    : 00512840
BODY     : [[00512840, 00512974]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00512840(int *param_1)

{
  int *piVar1;
  undefined4 uVar2;
  int iVar3;
  char *pcVar4;
  uint unaff_EBX;
  int iVar5;
  char cVar6;
  char cVar7;
  char cVar8;
  
  piVar1 = param_1;
  if (param_1 == (int *)0x0) {
    return 0;
  }
  uVar2 = (**(code **)(*param_1 + 0x10))();
  iVar5 = 1;
  param_1 = (int *)0x0;
  iVar3 = (**(code **)(*piVar1 + 0x28))(&param_1,4);
  if (iVar3 < 1) {
    return 1;
  }
  cVar6 = (char)(unaff_EBX >> 8);
  cVar7 = (char)(unaff_EBX >> 0x10);
  cVar8 = (char)(unaff_EBX >> 0x18);
  switch(unaff_EBX & 0xff) {
  case 0x43:
  case 0x46:
    if (cVar6 == 'W') {
      if (cVar7 == 'S') {
        iVar5 = 2;
      }
      break;
    }
    goto LAB_005128c2;
  case 0x44:
    if ((cVar6 == 'D') && (cVar7 == 'S')) {
      iVar5 = 0xe;
    }
    break;
  case 0x47:
    if (cVar6 == 'I') {
      if ((cVar7 == 'F') && (cVar8 == '8')) {
        iVar5 = 0xc;
      }
      break;
    }
LAB_005128c2:
    if ((cVar6 == 'F') && (cVar7 == 'X')) {
      iVar5 = 3;
    }
    break;
  case 0x89:
    if (((cVar6 == 'P') && (cVar7 == 'N')) && (cVar8 == 'G')) {
      iVar5 = 0xb;
    }
    break;
  case 0xff:
    if (cVar6 == -0x28) {
      iVar5 = 10;
    }
  }
  (**(code **)(*piVar1 + 0x38))(uVar2,0);
  if ((((iVar5 == 1) && (pcVar4 = (char *)(**(code **)(*piVar1 + 4))(), pcVar4 != (char *)0x0)) &&
      (pcVar4 = _strrchr(pcVar4,0x2e), pcVar4 != (char *)0x0)) &&
     (iVar3 = FUN_0051b280(pcVar4,&DAT_00b86cf8), iVar3 == 0)) {
    iVar5 = 0xd;
  }
  return iVar5;
}



============================================================
DISASSEMBLY
============================================================
00512840 : PUSH EBX
00512841 : PUSH ESI
00512842 : MOV ESI,dword ptr [ESP + 0xc]
00512846 : XOR EBX,EBX
00512848 : CMP ESI,EBX
0051284a : JNZ 0x00512851
0051284c : POP ESI
0051284d : XOR EAX,EAX
0051284f : POP EBX
00512850 : RET
00512851 : MOV EAX,dword ptr [ESI]
00512853 : MOV EDX,dword ptr [EAX + 0x10]
00512856 : PUSH EBP
00512857 : PUSH EDI
00512858 : MOV ECX,ESI
0051285a : CALL EDX
0051285c : MOV EBP,EAX
0051285e : MOV EAX,dword ptr [ESI]
00512860 : MOV EDX,dword ptr [EAX + 0x28]
00512863 : PUSH 0x4
00512865 : LEA ECX,[ESP + 0x18]
00512869 : PUSH ECX
0051286a : MOV ECX,ESI
0051286c : MOV EDI,0x1
00512871 : MOV byte ptr [ESP + 0x1c],BL
00512875 : MOV byte ptr [ESP + 0x1d],BL
00512879 : MOV byte ptr [ESP + 0x1e],BL
0051287d : MOV byte ptr [ESP + 0x1f],BL
00512881 : CALL EDX
00512883 : TEST EAX,EAX
00512885 : JLE 0x0051296e
0051288b : MOVZX EAX,byte ptr [ESP + 0x14]
00512890 : ADD EAX,-0x43
00512893 : CMP EAX,0xbc
00512898 : JA 0x0051292e
0051289e : MOVZX EAX,byte ptr [EAX + 0x512990]
005128a5 : JMP dword ptr [EAX*0x4 + 0x512978]
005128ac : MOV AL,byte ptr [ESP + 0x15]
005128b0 : CMP AL,0x57
005128b2 : JNZ 0x005128c2
005128b4 : CMP byte ptr [ESP + 0x16],0x53
005128b9 : JNZ 0x0051292e
005128bb : MOV EDI,0x2
005128c0 : JMP 0x0051292e
005128c2 : CMP AL,0x46
005128c4 : JNZ 0x0051292e
005128c6 : CMP byte ptr [ESP + 0x16],0x58
005128cb : JNZ 0x0051292e
005128cd : MOV EDI,0x3
005128d2 : JMP 0x0051292e
005128d4 : CMP byte ptr [ESP + 0x15],0xd8
005128d9 : JNZ 0x0051292e
005128db : MOV EDI,0xa
005128e0 : JMP 0x0051292e
005128e2 : CMP byte ptr [ESP + 0x15],0x50
005128e7 : JNZ 0x0051292e
005128e9 : CMP byte ptr [ESP + 0x16],0x4e
005128ee : JNZ 0x0051292e
005128f0 : CMP byte ptr [ESP + 0x17],0x47
005128f5 : JNZ 0x0051292e
005128f7 : MOV EDI,0xb
005128fc : JMP 0x0051292e
005128fe : MOV AL,byte ptr [ESP + 0x15]
00512902 : CMP AL,0x49
00512904 : JNZ 0x005128c2
00512906 : CMP byte ptr [ESP + 0x16],0x46
0051290b : JNZ 0x0051292e
0051290d : CMP byte ptr [ESP + 0x17],0x38
00512912 : JNZ 0x0051292e
00512914 : MOV EDI,0xc
00512919 : JMP 0x0051292e
0051291b : CMP byte ptr [ESP + 0x15],0x44
00512920 : JNZ 0x0051292e
00512922 : CMP byte ptr [ESP + 0x16],0x53
00512927 : JNZ 0x0051292e
00512929 : MOV EDI,0xe
0051292e : MOV EDX,dword ptr [ESI]
00512930 : MOV EAX,dword ptr [EDX + 0x38]
00512933 : PUSH EBX
00512934 : PUSH EBP
00512935 : MOV ECX,ESI
00512937 : CALL EAX
00512939 : CMP EDI,0x1
0051293c : JNZ 0x0051296e
0051293e : MOV EDX,dword ptr [ESI]
00512940 : MOV EAX,dword ptr [EDX + 0x4]
00512943 : MOV ECX,ESI
00512945 : CALL EAX
00512947 : CMP EAX,EBX
00512949 : JZ 0x0051296e
0051294b : PUSH 0x2e
0051294d : PUSH EAX
0051294e : CALL 0x0063b6d0
00512953 : ADD ESP,0x8
00512956 : CMP EAX,EBX
00512958 : JZ 0x0051296e
0051295a : PUSH 0xb86cf8
0051295f : PUSH EAX
00512960 : CALL 0x0051b280
00512965 : TEST EAX,EAX
00512967 : JNZ 0x0051296e
00512969 : MOV EDI,0xd
0051296e : MOV EAX,EDI
00512970 : POP EDI
00512971 : POP EBP
00512972 : POP ESI
00512973 : POP EBX
00512974 : RET

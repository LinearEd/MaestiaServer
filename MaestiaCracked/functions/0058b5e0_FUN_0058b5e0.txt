PROGRAM  : Maestia.exe
FUNCTION : FUN_0058b5e0
ENTRY    : 0058b5e0
BODY     : [[0058b5e0, 0058b67c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0058b5e0(undefined4 *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  int *in_ECX;
  
  iVar1 = in_ECX[0x29];
  if (param_1 == (undefined4 *)0x0) {
    FUN_00515cf0(iVar1);
    *(byte *)((int)in_ECX + 0x66) = *(byte *)((int)in_ECX + 0x66) & 0xfe;
    in_ECX[0x29] = 0;
  }
  else {
    if (iVar1 == 0) {
      iVar3 = FUN_00515840(0x10,0);
      in_ECX[0x29] = iVar3;
    }
    puVar2 = (undefined4 *)in_ECX[0x29];
    *puVar2 = *param_1;
    puVar2[1] = param_1[1];
    puVar2[2] = param_1[2];
    puVar2[3] = param_1[3];
    *(byte *)((int)in_ECX + 0x66) = *(byte *)((int)in_ECX + 0x66) | 1;
  }
  if ((param_1 != (undefined4 *)0x0) != (iVar1 != 0)) {
    (**(code **)(*in_ECX + 0x3c))();
  }
  *(uint *)(in_ECX[0x28] + 0xb00) = *(uint *)(in_ECX[0x28] + 0xb00) | 0x400;
  return;
}



============================================================
DISASSEMBLY
============================================================
0058b5e0 : PUSH EBX
0058b5e1 : PUSH ESI
0058b5e2 : MOV ESI,ECX
0058b5e4 : MOV EAX,dword ptr [ESI + 0xa4]
0058b5ea : XOR ECX,ECX
0058b5ec : TEST EAX,EAX
0058b5ee : SETNZ CL
0058b5f1 : XOR EDX,EDX
0058b5f3 : PUSH EDI
0058b5f4 : MOV EDI,dword ptr [ESP + 0x10]
0058b5f8 : TEST EDI,EDI
0058b5fa : SETNZ DL
0058b5fd : CMP EDX,ECX
0058b5ff : SETNZ BL
0058b602 : TEST EDI,EDI
0058b604 : JNZ 0x0058b618
0058b606 : PUSH EAX
0058b607 : CALL 0x00515cf0
0058b60c : AND byte ptr [ESI + 0x66],0xfe
0058b610 : MOV dword ptr [ESI + 0xa4],EDI
0058b616 : JMP 0x0058b654
0058b618 : TEST EAX,EAX
0058b61a : JNZ 0x0058b634
0058b61c : MOV EAX,dword ptr [ESI + 0xa0]
0058b622 : MOV ECX,dword ptr [EAX + 0x14]
0058b625 : PUSH 0x0
0058b627 : PUSH 0x10
0058b629 : CALL 0x00515840
0058b62e : MOV dword ptr [ESI + 0xa4],EAX
0058b634 : MOV ECX,dword ptr [EDI]
0058b636 : MOV EAX,dword ptr [ESI + 0xa4]
0058b63c : MOV dword ptr [EAX],ECX
0058b63e : MOV EDX,dword ptr [EDI + 0x4]
0058b641 : MOV dword ptr [EAX + 0x4],EDX
0058b644 : MOV ECX,dword ptr [EDI + 0x8]
0058b647 : MOV dword ptr [EAX + 0x8],ECX
0058b64a : MOV EDX,dword ptr [EDI + 0xc]
0058b64d : MOV dword ptr [EAX + 0xc],EDX
0058b650 : OR byte ptr [ESI + 0x66],0x1
0058b654 : TEST BL,BL
0058b656 : JZ 0x0058b661
0058b658 : MOV EAX,dword ptr [ESI]
0058b65a : MOV EDX,dword ptr [EAX + 0x3c]
0058b65d : MOV ECX,ESI
0058b65f : CALL EDX
0058b661 : MOV ESI,dword ptr [ESI + 0xa0]
0058b667 : OR dword ptr [ESI + 0xb00],0x400
0058b671 : ADD ESI,0xb00
0058b677 : POP EDI
0058b678 : POP ESI
0058b679 : POP EBX
0058b67a : RET 0x4

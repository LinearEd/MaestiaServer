PROGRAM  : Maestia.exe
FUNCTION : vscan_fn
ENTRY    : 0063801a
BODY     : [[0063801a, 00638089]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    _vscan_fn
   
   Library: Visual Studio 2008 Release */

undefined4 __cdecl vscan_fn(code *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int *piVar1;
  undefined4 uVar2;
  int unaff_ESI;
  
  FUN_00644bcf();
  if ((unaff_ESI == 0) || (param_2 == 0)) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = (*param_1)(&stack0xffffffdc,param_2,param_3,param_4);
  }
  return uVar2;
}



============================================================
DISASSEMBLY
============================================================
0063801a : MOV EDI,EDI
0063801c : PUSH EBP
0063801d : MOV EBP,ESP
0063801f : SUB ESP,0x20
00638022 : PUSH EDI
00638023 : PUSH ESI
00638024 : CALL 0x00644bcf
00638029 : XOR EDI,EDI
0063802b : POP ECX
0063802c : CMP ESI,EDI
0063802e : JNZ 0x0063804d
00638030 : CALL 0x0063ab82
00638035 : PUSH EDI
00638036 : PUSH EDI
00638037 : PUSH EDI
00638038 : PUSH EDI
00638039 : PUSH EDI
0063803a : MOV dword ptr [EAX],0x16
00638040 : CALL 0x006372b8
00638045 : ADD ESP,0x14
00638048 : OR EAX,0xffffffff
0063804b : JMP 0x00638087
0063804d : CMP dword ptr [EBP + 0xc],EDI
00638050 : JZ 0x00638030
00638052 : MOV dword ptr [EBP + -0x14],0x49
00638059 : MOV dword ptr [EBP + -0x18],ESI
0063805c : MOV dword ptr [EBP + -0x20],ESI
0063805f : CMP EAX,0x3fffffff
00638064 : JBE 0x0063806f
00638066 : MOV dword ptr [EBP + -0x1c],0x7fffffff
0063806d : JMP 0x00638074
0063806f : ADD EAX,EAX
00638071 : MOV dword ptr [EBP + -0x1c],EAX
00638074 : PUSH dword ptr [EBP + 0x14]
00638077 : LEA EAX,[EBP + -0x20]
0063807a : PUSH dword ptr [EBP + 0x10]
0063807d : PUSH dword ptr [EBP + 0xc]
00638080 : PUSH EAX
00638081 : CALL dword ptr [EBP + 0x8]
00638084 : ADD ESP,0x10
00638087 : POP EDI
00638088 : LEAVE
00638089 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005afcb0
ENTRY    : 005afcb0
BODY     : [[005afcb0, 005aff5a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005afcb0(int *param_1)

{
  int iVar1;
  uint uVar2;
  int in_ECX;
  uint uVar3;
  char *_Str1;
  uint uVar4;
  int *local_2c;
  char *local_28;
  uint local_24;
  byte *local_20;
  int local_1c;
  undefined4 local_18;
  undefined1 local_14;
  undefined4 local_10;
  int local_c;
  char **local_8;
  undefined4 *local_4;
  
  local_24 = param_1[1];
  local_2c = (int *)0x0;
  _Str1 = (char *)*param_1;
  if (local_24 != 0) {
    do {
      uVar4 = 0;
      if (local_24 != 0) {
        do {
          if ((_Str1[uVar4] == '\0') || (_Str1[uVar4] == ':')) break;
          uVar4 = uVar4 + 1;
        } while (uVar4 < local_24);
      }
      if (_Str1 == (char *)0x0) {
        return;
      }
      if (uVar4 == 0) {
        return;
      }
      uVar2 = uVar4 + 1;
      if (local_24 < uVar4 + 1) {
        uVar2 = local_24;
      }
      local_28 = _Str1 + uVar2;
      local_24 = local_24 - uVar2;
      iVar1 = _isdigit((int)*_Str1);
      if (iVar1 != 0) {
switchD_005afd3d_caseD_20:
        FUN_005af510();
        goto LAB_005afe9d;
      }
      switch(*_Str1) {
      case ' ':
      case '#':
      case '+':
      case '-':
      case '.':
        goto switchD_005afd3d_caseD_20;
      default:
        iVar1 = *(int *)(in_ECX + 4);
        if (*(int *)(iVar1 + 0x14) != 0) {
          local_18 = FUN_0063b380();
          local_8 = &local_28;
          local_4 = &local_18;
          local_14 = 1;
          local_10 = 0;
          local_c = iVar1;
          local_2c = (int *)(**(code **)(**(int **)(iVar1 + 0x14) + 4))();
        }
        break;
      case 'e':
        *(byte *)(in_ECX + 0x16) = *(byte *)(in_ECX + 0x16) & 0xfe;
      case 'E':
        uVar2 = 0;
        *(undefined4 *)(in_ECX + 0x1c) = 1;
        if (local_24 != 0) {
          do {
            if ((local_28[uVar2] == '\0') || (local_28[uVar2] == ':')) break;
            uVar2 = uVar2 + 1;
          } while (uVar2 < local_24);
        }
        goto LAB_005afdb1;
      case 'f':
        *(undefined4 *)(in_ECX + 0x1c) = 0;
        FUN_005ad8f0(&stack0xffffffbc,0x3a);
        FUN_005af510();
        break;
      case 'g':
        *(byte *)(in_ECX + 0x16) = *(byte *)(in_ECX + 0x16) & 0xfe;
      case 'G':
        uVar2 = 0;
        *(undefined4 *)(in_ECX + 0x1c) = 2;
        if (local_24 != 0) {
          do {
            if ((local_28[uVar2] == '\0') || (local_28[uVar2] == ':')) break;
            uVar2 = uVar2 + 1;
          } while (uVar2 < local_24);
        }
LAB_005afdb1:
        FUN_005af510();
        break;
      case 's':
        if (_Str1[1] == 'w') {
          iVar1 = FUN_0051dbc0();
          if (iVar1 == 0) {
            local_2c = (int *)0x0;
          }
          else {
            FUN_0063b380();
            local_2c = (int *)FUN_005af970();
          }
          local_28 = local_28 + local_24;
          local_24 = 0;
          goto LAB_005aff0f;
        }
        iVar1 = _strncmp(_Str1,"sep",3);
        if ((iVar1 == 0) && (FUN_005ad8f0(), local_1c != 0)) {
          *(byte *)(in_ECX + 0x15) =
               *(byte *)(in_ECX + 0x15) ^ (*(byte *)(in_ECX + 0x15) ^ *local_20) & 0x7f;
        }
      }
LAB_005afe9d:
      _Str1 = local_28;
    } while (local_24 != 0);
LAB_005aff0f:
    if (local_2c != (int *)0x0) {
      uVar2 = param_1[1];
      uVar3 = uVar4 + 1;
      if (uVar2 < uVar4 + 1) {
        uVar3 = uVar2;
      }
      local_20 = (byte *)(*param_1 + uVar3);
      local_1c = uVar2 - uVar3;
      if (local_1c != 0) {
        (**(code **)(*local_2c + 8))();
      }
      FUN_005ae8a0(in_ECX);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005afcb0 : SUB ESP,0x2c
005afcb3 : MOV EAX,dword ptr [ESP + 0x30]
005afcb7 : MOV EDX,dword ptr [EAX]
005afcb9 : PUSH EBX
005afcba : PUSH EBP
005afcbb : PUSH ESI
005afcbc : PUSH EDI
005afcbd : MOV EDI,ECX
005afcbf : MOV ECX,dword ptr [EAX + 0x4]
005afcc2 : XOR EBP,EBP
005afcc4 : MOV dword ptr [ESP + 0x14],EDX
005afcc8 : MOV dword ptr [ESP + 0x18],ECX
005afccc : MOV dword ptr [ESP + 0x10],EBP
005afcd0 : CMP ECX,EBP
005afcd2 : JZ 0x005aff51
005afcd8 : XOR EBX,EBX
005afcda : CMP ECX,EBP
005afcdc : JBE 0x005afcf0
005afcde : MOV EDI,EDI
005afce0 : MOV AL,byte ptr [EBX + EDX*0x1]
005afce3 : TEST AL,AL
005afce5 : JZ 0x005afcf0
005afce7 : CMP AL,0x3a
005afce9 : JZ 0x005afcf0
005afceb : INC EBX
005afcec : CMP EBX,ECX
005afcee : JC 0x005afce0
005afcf0 : MOV ESI,EDX
005afcf2 : CMP EDX,EBP
005afcf4 : JZ 0x005aff51
005afcfa : CMP EBX,EBP
005afcfc : JZ 0x005aff51
005afd02 : LEA EAX,[EBX + 0x1]
005afd05 : CMP ECX,EAX
005afd07 : JNC 0x005afd0b
005afd09 : MOV EAX,ECX
005afd0b : ADD EDX,EAX
005afd0d : SUB ECX,EAX
005afd0f : MOV dword ptr [ESP + 0x14],EDX
005afd13 : MOV dword ptr [ESP + 0x18],ECX
005afd17 : MOVSX EAX,byte ptr [ESI]
005afd1a : PUSH EAX
005afd1b : CALL 0x006397a2
005afd20 : ADD ESP,0x4
005afd23 : TEST EAX,EAX
005afd25 : JNZ 0x005afd44
005afd27 : MOVSX EAX,byte ptr [ESI]
005afd2a : ADD EAX,-0x20
005afd2d : CMP EAX,0x53
005afd30 : JA 0x005afe40
005afd36 : MOVZX ECX,byte ptr [EAX + 0x5aff7c]
005afd3d : JMP dword ptr [ECX*0x4 + 0x5aff5c]
005afd44 : SUB ESP,0x8
005afd47 : MOV EAX,ESP
005afd49 : MOV dword ptr [EAX],ESI
005afd4b : LEA ECX,[EDI + 0x10]
005afd4e : MOV dword ptr [EAX + 0x4],EBX
005afd51 : CALL 0x005af510
005afd56 : JMP 0x005afe9d
005afd5b : SUB ESP,0x8
005afd5e : MOV EDX,ESP
005afd60 : PUSH 0x3a
005afd62 : PUSH EDX
005afd63 : LEA ECX,[ESP + 0x24]
005afd67 : MOV dword ptr [EDI + 0x1c],EBP
005afd6a : CALL 0x005ad8f0
005afd6f : LEA ECX,[EDI + 0x10]
005afd72 : CALL 0x005af510
005afd77 : JMP 0x005afe9d
005afd7c : AND byte ptr [EDI + 0x16],0xfe
005afd80 : MOV EDX,dword ptr [ESP + 0x18]
005afd84 : MOV ESI,dword ptr [ESP + 0x14]
005afd88 : SUB ESP,0x8
005afd8b : XOR EAX,EAX
005afd8d : MOV dword ptr [EDI + 0x1c],0x1
005afd94 : MOV EBP,ESP
005afd96 : TEST EDX,EDX
005afd98 : JBE 0x005afdb1
005afd9a : LEA EBX,[EBX]
005afda0 : MOV CL,byte ptr [EAX + ESI*0x1]
005afda3 : TEST CL,CL
005afda5 : JZ 0x005afdb1
005afda7 : CMP CL,0x3a
005afdaa : JZ 0x005afdb1
005afdac : INC EAX
005afdad : CMP EAX,EDX
005afdaf : JC 0x005afda0
005afdb1 : MOV dword ptr [EBP],ESI
005afdb4 : LEA ECX,[EDI + 0x10]
005afdb7 : MOV dword ptr [EBP + 0x4],EAX
005afdba : CALL 0x005af510
005afdbf : XOR EBP,EBP
005afdc1 : JMP 0x005afe9d
005afdc6 : AND byte ptr [EDI + 0x16],0xfe
005afdca : MOV EDX,dword ptr [ESP + 0x18]
005afdce : MOV ESI,dword ptr [ESP + 0x14]
005afdd2 : SUB ESP,0x8
005afdd5 : XOR EAX,EAX
005afdd7 : MOV dword ptr [EDI + 0x1c],0x2
005afdde : MOV EBP,ESP
005afde0 : TEST EDX,EDX
005afde2 : JBE 0x005afdb1
005afde4 : MOV CL,byte ptr [EAX + ESI*0x1]
005afde7 : TEST CL,CL
005afde9 : JZ 0x005afdb1
005afdeb : CMP CL,0x3a
005afdee : JZ 0x005afdb1
005afdf0 : INC EAX
005afdf1 : CMP EAX,EDX
005afdf3 : JC 0x005afde4
005afdf5 : JMP 0x005afdb1
005afdf7 : CMP byte ptr [ESI + 0x1],0x77
005afdfb : JZ 0x005afeae
005afe01 : PUSH 0x3
005afe03 : PUSH 0xb8f690
005afe08 : PUSH ESI
005afe09 : CALL 0x0063abcb
005afe0e : ADD ESP,0xc
005afe11 : TEST EAX,EAX
005afe13 : JNZ 0x005afe9d
005afe19 : PUSH 0x3a
005afe1b : LEA EAX,[ESP + 0x20]
005afe1f : PUSH EAX
005afe20 : LEA ECX,[ESP + 0x1c]
005afe24 : CALL 0x005ad8f0
005afe29 : CMP dword ptr [ESP + 0x20],EBP
005afe2d : JZ 0x005afe9d
005afe2f : MOV CL,byte ptr [EDI + 0x15]
005afe32 : MOV EDX,dword ptr [ESP + 0x1c]
005afe36 : XOR CL,byte ptr [EDX]
005afe38 : AND CL,0x7f
005afe3b : XOR byte ptr [EDI + 0x15],CL
005afe3e : JMP 0x005afe9d
005afe40 : MOV ESI,dword ptr [EDI + 0x4]
005afe43 : CMP dword ptr [ESI + 0x14],EBP
005afe46 : JZ 0x005afe9d
005afe48 : FLD double ptr [EDI + 0x20]
005afe4b : FLDZ
005afe4d : FCOMP
005afe4f : FNSTSW AX
005afe51 : TEST AH,0x5
005afe54 : JP 0x005afe5e
005afe56 : FADD double ptr [0x00cdf120]
005afe5c : JMP 0x005afe64
005afe5e : FSUB double ptr [0x00cdf120]
005afe64 : CALL 0x0063b380
005afe69 : MOV dword ptr [ESP + 0x24],EAX
005afe6d : LEA EAX,[ESP + 0x14]
005afe71 : MOV dword ptr [ESP + 0x34],EAX
005afe75 : LEA ECX,[ESP + 0x24]
005afe79 : MOV byte ptr [ESP + 0x28],0x1
005afe7e : MOV dword ptr [ESP + 0x2c],EBP
005afe82 : MOV dword ptr [ESP + 0x30],ESI
005afe86 : MOV dword ptr [ESP + 0x38],ECX
005afe8a : MOV ECX,dword ptr [ESI + 0x14]
005afe8d : MOV EDX,dword ptr [ECX]
005afe8f : MOV EDX,dword ptr [EDX + 0x4]
005afe92 : LEA EAX,[ESP + 0x30]
005afe96 : PUSH EAX
005afe97 : CALL EDX
005afe99 : MOV dword ptr [ESP + 0x10],EAX
005afe9d : MOV ECX,dword ptr [ESP + 0x18]
005afea1 : CMP ECX,EBP
005afea3 : JZ 0x005aff0f
005afea5 : MOV EDX,dword ptr [ESP + 0x14]
005afea9 : JMP 0x005afcd8
005afeae : MOV EAX,dword ptr [EDI + 0x4]
005afeb1 : PUSH 0x24
005afeb3 : LEA ECX,[EAX + 0xf4]
005afeb9 : CALL 0x0051dbc0
005afebe : MOV ESI,EAX
005afec0 : CMP ESI,EBP
005afec2 : JZ 0x005afeff
005afec4 : FLD double ptr [EDI + 0x20]
005afec7 : FLDZ
005afec9 : FCOMP
005afecb : FNSTSW AX
005afecd : TEST AH,0x5
005afed0 : JP 0x005afeda
005afed2 : FADD double ptr [0x00cdf120]
005afed8 : JMP 0x005afee0
005afeda : FSUB double ptr [0x00cdf120]
005afee0 : CALL 0x0063b380
005afee5 : LEA ECX,[ESP + 0x10]
005afee9 : MOV dword ptr [ESP + 0x10],EAX
005afeed : MOV EAX,dword ptr [EDI + 0x4]
005afef0 : PUSH ECX
005afef1 : PUSH EAX
005afef2 : MOV ECX,ESI
005afef4 : CALL 0x005af970
005afef9 : MOV dword ptr [ESP + 0x10],EAX
005afefd : JMP 0x005aff03
005afeff : MOV dword ptr [ESP + 0x10],EBP
005aff03 : MOV EDX,dword ptr [ESP + 0x18]
005aff07 : ADD dword ptr [ESP + 0x14],EDX
005aff0b : MOV dword ptr [ESP + 0x18],EBP
005aff0f : MOV ESI,dword ptr [ESP + 0x10]
005aff13 : CMP ESI,EBP
005aff15 : JZ 0x005aff51
005aff17 : MOV EDX,dword ptr [ESP + 0x40]
005aff1b : MOV EAX,dword ptr [EDX + 0x4]
005aff1e : LEA ECX,[EBX + 0x1]
005aff21 : CMP EAX,ECX
005aff23 : JNC 0x005aff27
005aff25 : MOV ECX,EAX
005aff27 : MOV EDX,dword ptr [EDX]
005aff29 : ADD EDX,ECX
005aff2b : SUB EAX,ECX
005aff2d : MOV dword ptr [ESP + 0x1c],EDX
005aff31 : MOV dword ptr [ESP + 0x20],EAX
005aff35 : JZ 0x005aff45
005aff37 : MOV EAX,dword ptr [ESI]
005aff39 : MOV EDX,dword ptr [EAX + 0x8]
005aff3c : LEA ECX,[ESP + 0x1c]
005aff40 : PUSH ECX
005aff41 : MOV ECX,ESI
005aff43 : CALL EDX
005aff45 : MOV ECX,dword ptr [EDI + 0x4]
005aff48 : PUSH 0x1
005aff4a : PUSH ESI
005aff4b : PUSH EDI
005aff4c : CALL 0x005ae8a0
005aff51 : POP EDI
005aff52 : POP ESI
005aff53 : POP EBP
005aff54 : POP EBX
005aff55 : ADD ESP,0x2c
005aff58 : RET 0x4

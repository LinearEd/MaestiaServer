PROGRAM  : Maestia.exe
FUNCTION : FUN_007ace70
ENTRY    : 007ace70
BODY     : [[007ace70, 007acfb5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007ace70(void)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  char cVar4;
  uint uVar5;
  int iVar6;
  int *piVar7;
  uint uVar8;
  int in_ECX;
  int *piVar9;
  int unaff_ESI;
  int local_3c;
  int local_38;
  int *local_34;
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b39b74;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar5;
  if (*(char *)(in_ECX + 0x2bf) != '\0') {
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    local_8 = 0;
    piVar9 = (int *)**(int **)(in_ECX + 0x334);
    local_38 = in_ECX;
    local_34 = piVar9;
    if (piVar9 != *(int **)(in_ECX + 0x334)) {
      do {
        iVar3 = local_38;
        local_34 = piVar9;
        FUN_00405eb0(piVar9 + 2,0,0xffffffff);
        iVar6 = 0;
        if (*(int *)(iVar3 + 0x424) != 0) {
          iVar6 = FUN_007795d0();
        }
        local_3c = iVar6;
        if ((iVar6 != 0) && (cVar4 = FUN_007d5cf0(iVar6), cVar4 != '\0')) {
          piVar2 = *(int **)(unaff_ESI + 8);
          piVar1 = *(int **)(unaff_ESI + 4);
          for (piVar7 = piVar1; piVar7 != piVar2; piVar7 = piVar7 + 1) {
            if (*piVar7 == iVar6) goto LAB_007acf5e;
          }
          if (piVar1 == (int *)0x0) {
            uVar8 = 0;
          }
          else {
            uVar8 = *(int *)(unaff_ESI + 0xc) - (int)piVar1 >> 2;
          }
          if ((uint)((int)piVar2 - (int)piVar1 >> 2) < uVar8) {
            *piVar2 = iVar6;
            *(int **)(unaff_ESI + 8) = piVar2 + 1;
            piVar9 = local_34;
          }
          else {
            FUN_0042fe80(unaff_ESI,piVar2,&local_3c);
            piVar9 = local_34;
          }
        }
LAB_007acf5e:
        piVar9 = (int *)*piVar9;
        local_34 = piVar9;
      } while (piVar9 != (int *)*(int *)(local_38 + 0x334));
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar5);
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
007ace70 : PUSH EBP
007ace71 : MOV EBP,ESP
007ace73 : PUSH -0x1
007ace75 : PUSH 0xb39b74
007ace7a : MOV EAX,FS:[0x0]
007ace80 : PUSH EAX
007ace81 : SUB ESP,0x30
007ace84 : MOV EAX,[0x00d66fa0]
007ace89 : XOR EAX,EBP
007ace8b : MOV dword ptr [EBP + -0x10],EAX
007ace8e : PUSH EBX
007ace8f : PUSH EDI
007ace90 : PUSH EAX
007ace91 : LEA EAX,[EBP + -0xc]
007ace94 : MOV FS:[0x0],EAX
007ace9a : MOV EDI,ECX
007ace9c : CMP byte ptr [EDI + 0x2bf],0x0
007acea3 : MOV dword ptr [EBP + -0x34],EDI
007acea6 : JZ 0x007acf9b
007aceac : XOR EAX,EAX
007aceae : XOR ECX,ECX
007aceb0 : MOV dword ptr [EBP + -0x14],0x7
007aceb7 : MOV dword ptr [EBP + -0x18],EAX
007aceba : MOV word ptr [EBP + -0x28],CX
007acebe : MOV dword ptr [EBP + -0x4],EAX
007acec1 : MOV EAX,dword ptr [EDI + 0x334]
007acec7 : MOV EBX,dword ptr [EAX]
007acec9 : MOV dword ptr [EBP + -0x30],EBX
007acecc : CMP EBX,EAX
007acece : JZ 0x007acf72
007aced4 : JMP 0x007aced8
007aced6 : MOV EDI,EAX
007aced8 : PUSH -0x1
007aceda : LEA EAX,[EBX + 0x8]
007acedd : PUSH 0x0
007acedf : PUSH EAX
007acee0 : LEA ECX,[EBP + -0x2c]
007acee3 : CALL 0x00405eb0
007acee8 : MOV EDI,dword ptr [EDI + 0x424]
007aceee : TEST EDI,EDI
007acef0 : JZ 0x007acefc
007acef2 : LEA ECX,[EBP + -0x2c]
007acef5 : CALL 0x007795d0
007acefa : MOV EDI,EAX
007acefc : MOV dword ptr [EBP + -0x38],EDI
007aceff : TEST EDI,EDI
007acf01 : JZ 0x007acf5e
007acf03 : PUSH EDI
007acf04 : CALL 0x007d5cf0
007acf09 : TEST AL,AL
007acf0b : JZ 0x007acf5e
007acf0d : MOV EDX,dword ptr [ESI + 0x4]
007acf10 : MOV ECX,dword ptr [ESI + 0x8]
007acf13 : MOV EAX,EDX
007acf15 : CMP EAX,ECX
007acf17 : JZ 0x007acf2b
007acf19 : LEA ESP,[ESP]
007acf20 : CMP dword ptr [EAX],EDI
007acf22 : JZ 0x007acf5e
007acf24 : ADD EAX,0x4
007acf27 : CMP EAX,ECX
007acf29 : JNZ 0x007acf20
007acf2b : TEST EDX,EDX
007acf2d : JNZ 0x007acf33
007acf2f : XOR EAX,EAX
007acf31 : JMP 0x007acf3b
007acf33 : MOV EAX,dword ptr [ESI + 0xc]
007acf36 : SUB EAX,EDX
007acf38 : SAR EAX,0x2
007acf3b : MOV EBX,ECX
007acf3d : SUB EBX,EDX
007acf3f : SAR EBX,0x2
007acf42 : CMP EBX,EAX
007acf44 : JNC 0x007acf50
007acf46 : MOV dword ptr [ECX],EDI
007acf48 : ADD ECX,0x4
007acf4b : MOV dword ptr [ESI + 0x8],ECX
007acf4e : JMP 0x007acf5b
007acf50 : LEA EDX,[EBP + -0x38]
007acf53 : PUSH EDX
007acf54 : PUSH ECX
007acf55 : PUSH ESI
007acf56 : CALL 0x0042fe80
007acf5b : MOV EBX,dword ptr [EBP + -0x30]
007acf5e : MOV EBX,dword ptr [EBX]
007acf60 : MOV EAX,dword ptr [EBP + -0x34]
007acf63 : MOV dword ptr [EBP + -0x30],EBX
007acf66 : CMP EBX,dword ptr [EAX + 0x334]
007acf6c : JNZ 0x007aced6
007acf72 : MOV dword ptr [EBP + -0x4],0xffffffff
007acf79 : CMP dword ptr [EBP + -0x14],0x8
007acf7d : JC 0x007acf87
007acf7f : MOV ECX,dword ptr [EBP + -0x28]
007acf82 : CALL 0x006f04e0
007acf87 : XOR ECX,ECX
007acf89 : MOV dword ptr [EBP + -0x14],0x7
007acf90 : MOV dword ptr [EBP + -0x18],0x0
007acf97 : MOV word ptr [EBP + -0x28],CX
007acf9b : MOV ECX,dword ptr [EBP + -0xc]
007acf9e : MOV dword ptr FS:[0x0],ECX
007acfa5 : POP ECX
007acfa6 : POP EDI
007acfa7 : POP EBX
007acfa8 : MOV ECX,dword ptr [EBP + -0x10]
007acfab : XOR ECX,EBP
007acfad : CALL 0x00633e6b
007acfb2 : MOV ESP,EBP
007acfb4 : POP EBP
007acfb5 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00712480
ENTRY    : 00712480
BODY     : [[00712480, 007127f2]]

============================================================
DECOMPILED C CODE
============================================================

byte FUN_00712480(int *param_1,int param_2)

{
  int *piVar1;
  byte bVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  ushort uVar6;
  short sVar7;
  bool bVar8;
  uint local_8;
  
  local_8 = 0;
  do {
    uVar3 = param_1[0x1b];
    if (uVar3 < 0x106) {
      FUN_00711f90();
      uVar3 = param_1[0x1b];
      if ((uVar3 < 0x106) && (param_2 == 0)) {
        return 0;
      }
      if (uVar3 == 0) {
        iVar4 = param_1[0x15];
        if (iVar4 < 0) {
          iVar5 = 0;
        }
        else {
          iVar5 = param_1[0xc] + iVar4;
        }
        FUN_0070fce0(iVar5,param_1[0x19] - iVar4);
        param_1[0x15] = param_1[0x19];
        FUN_00711800();
        if (*(int *)(*param_1 + 0x10) == 0) {
          return (param_2 != 4) - 1U & 2;
        }
        return (param_2 == 4) * '\x02' + 1;
      }
    }
    if (2 < uVar3) {
      uVar3 = (param_1[0x10] << ((byte)param_1[0x14] & 0x1f) ^
              (uint)*(byte *)(param_1[0xc] + 2 + param_1[0x19])) & param_1[0x13];
      param_1[0x10] = uVar3;
      *(undefined2 *)(param_1[0xe] + (param_1[0xb] & param_1[0x19]) * 2) =
           *(undefined2 *)(param_1[0xf] + uVar3 * 2);
      local_8 = (uint)*(ushort *)(param_1[0xe] + (param_1[0x19] & param_1[0xb]) * 2);
      *(short *)(param_1[0xf] + param_1[0x10] * 2) = (short)param_1[0x19];
    }
    if ((local_8 != 0) && (param_1[0x19] - local_8 <= param_1[9] - 0x106U)) {
      if (param_1[0x20] < 2) {
        iVar4 = FUN_00711540(local_8);
        param_1[0x16] = iVar4;
      }
      else if ((param_1[0x20] == 3) && (param_1[0x19] - local_8 == 1)) {
        iVar4 = FUN_007114a0();
        param_1[0x16] = iVar4;
      }
    }
    if ((uint)param_1[0x16] < 3) {
      bVar2 = *(byte *)(param_1[0x19] + param_1[0xc]);
      *(undefined2 *)(param_1[0x5a7] + param_1[0x5a6] * 2) = 0;
      *(byte *)(param_1[0x5a4] + param_1[0x5a6]) = bVar2;
      param_1[0x5a6] = param_1[0x5a6] + 1;
      *(short *)(param_1 + bVar2 + 0x23) = (short)param_1[bVar2 + 0x23] + 1;
      bVar8 = param_1[0x5a6] == param_1[0x5a5] + -1;
      param_1[0x1b] = param_1[0x1b] + -1;
LAB_007126fe:
      param_1[0x19] = param_1[0x19] + 1;
    }
    else {
      sVar7 = (short)param_1[0x19] - (short)param_1[0x1a];
      iVar4 = param_1[0x16];
      *(short *)(param_1[0x5a7] + param_1[0x5a6] * 2) = sVar7;
      bVar2 = (char)iVar4 - 3;
      *(byte *)(param_1[0x5a4] + param_1[0x5a6]) = bVar2;
      param_1[0x5a6] = param_1[0x5a6] + 1;
      *(short *)(param_1 + (byte)(&DAT_00bfe240)[bVar2] + 0x124) =
           (short)param_1[(byte)(&DAT_00bfe240)[bVar2] + 0x124] + 1;
      uVar6 = sVar7 - 1;
      if (uVar6 < 0x100) {
        bVar2 = (&DAT_00bfe040)[uVar6];
      }
      else {
        bVar2 = (&DAT_00bfe140)[uVar6 >> 7];
      }
      *(short *)(param_1 + bVar2 + 0x260) = (short)param_1[bVar2 + 0x260] + 1;
      bVar8 = param_1[0x5a6] == param_1[0x5a5] + -1;
      uVar3 = param_1[0x16];
      param_1[0x1b] = param_1[0x1b] - uVar3;
      if ((uVar3 <= (uint)param_1[0x1e]) && (2 < (uint)param_1[0x1b])) {
        param_1[0x16] = uVar3 - 1;
        do {
          param_1[0x19] = param_1[0x19] + 1;
          uVar3 = ((uint)*(byte *)(param_1[0x19] + 2U + param_1[0xc]) ^
                  param_1[0x10] << ((byte)param_1[0x14] & 0x1f)) & param_1[0x13];
          param_1[0x10] = uVar3;
          *(undefined2 *)(param_1[0xe] + (param_1[0xb] & param_1[0x19]) * 2) =
               *(undefined2 *)(param_1[0xf] + uVar3 * 2);
          local_8 = (uint)*(ushort *)(param_1[0xe] + (param_1[0x19] & param_1[0xb]) * 2);
          *(short *)(param_1[0xf] + param_1[0x10] * 2) = (short)param_1[0x19];
          piVar1 = param_1 + 0x16;
          *piVar1 = *piVar1 + -1;
        } while (*piVar1 != 0);
        goto LAB_007126fe;
      }
      param_1[0x19] = param_1[0x19] + uVar3;
      param_1[0x16] = 0;
      uVar3 = (uint)*(byte *)(param_1[0xc] + param_1[0x19]);
      param_1[0x10] = uVar3;
      param_1[0x10] =
           (uVar3 << ((byte)param_1[0x14] & 0x1f) ^
           (uint)((byte *)(param_1[0xc] + param_1[0x19]))[1]) & param_1[0x13];
    }
    if (bVar8) {
      iVar4 = param_1[0x15];
      if (iVar4 < 0) {
        iVar5 = 0;
      }
      else {
        iVar5 = param_1[0xc] + iVar4;
      }
      FUN_0070fce0(iVar5,param_1[0x19] - iVar4);
      iVar4 = *param_1;
      param_1[0x15] = param_1[0x19];
      uVar3 = *(uint *)(*(int *)(iVar4 + 0x1c) + 0x14);
      if (*(uint *)(iVar4 + 0x10) < uVar3) {
        uVar3 = *(uint *)(iVar4 + 0x10);
      }
      if (uVar3 != 0) {
        _memcpy(*(void **)(iVar4 + 0xc),*(void **)(*(int *)(iVar4 + 0x1c) + 0x10),uVar3);
        *(int *)(iVar4 + 0xc) = *(int *)(iVar4 + 0xc) + uVar3;
        piVar1 = (int *)(*(int *)(iVar4 + 0x1c) + 0x10);
        *piVar1 = *piVar1 + uVar3;
        *(int *)(iVar4 + 0x14) = *(int *)(iVar4 + 0x14) + uVar3;
        *(int *)(iVar4 + 0x10) = *(int *)(iVar4 + 0x10) - uVar3;
        piVar1 = (int *)(*(int *)(iVar4 + 0x1c) + 0x14);
        *piVar1 = *piVar1 - uVar3;
        iVar4 = *(int *)(iVar4 + 0x1c);
        if (*(int *)(iVar4 + 0x14) == 0) {
          *(undefined4 *)(iVar4 + 0x10) = *(undefined4 *)(iVar4 + 8);
        }
      }
      if (*(int *)(*param_1 + 0x10) == 0) {
        return 0;
      }
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00712480 : PUSH EBP
00712481 : MOV EBP,ESP
00712483 : PUSH ECX
00712484 : PUSH EBX
00712485 : PUSH ESI
00712486 : MOV ESI,dword ptr [EBP + 0x8]
00712489 : PUSH EDI
0071248a : MOV dword ptr [EBP + -0x4],0x0
00712491 : MOV EAX,dword ptr [ESI + 0x6c]
00712494 : CMP EAX,0x106
00712499 : JNC 0x007124bf
0071249b : MOV EDI,ESI
0071249d : CALL 0x00711f90
007124a2 : MOV EAX,dword ptr [ESI + 0x6c]
007124a5 : MOV EBX,dword ptr [EBP + 0xc]
007124a8 : CMP EAX,0x106
007124ad : JNC 0x007124b7
007124af : TEST EBX,EBX
007124b1 : JZ 0x00712787
007124b7 : TEST EAX,EAX
007124b9 : JZ 0x00712790
007124bf : CMP EAX,0x3
007124c2 : JC 0x00712510
007124c4 : MOV EAX,dword ptr [ESI + 0x40]
007124c7 : MOV ECX,dword ptr [ESI + 0x50]
007124ca : MOV EDX,dword ptr [ESI + 0x64]
007124cd : MOV EDI,dword ptr [ESI + 0x2c]
007124d0 : SHL EAX,CL
007124d2 : MOV ECX,dword ptr [ESI + 0x30]
007124d5 : MOVZX ECX,byte ptr [ECX + EDX*0x1 + 0x2]
007124da : XOR EAX,ECX
007124dc : AND EAX,dword ptr [ESI + 0x4c]
007124df : MOV ECX,dword ptr [ESI + 0x3c]
007124e2 : MOV dword ptr [ESI + 0x40],EAX
007124e5 : MOVZX EAX,word ptr [ECX + EAX*0x2]
007124e9 : AND EDI,EDX
007124eb : MOV EDX,dword ptr [ESI + 0x38]
007124ee : MOV word ptr [EDX + EDI*0x2],AX
007124f2 : MOV ECX,dword ptr [ESI + 0x64]
007124f5 : AND ECX,dword ptr [ESI + 0x2c]
007124f8 : MOV EDX,dword ptr [ESI + 0x38]
007124fb : MOVZX EAX,word ptr [EDX + ECX*0x2]
007124ff : MOV ECX,dword ptr [ESI + 0x40]
00712502 : MOV EDX,dword ptr [ESI + 0x3c]
00712505 : MOV dword ptr [EBP + -0x4],EAX
00712508 : MOVZX EAX,word ptr [ESI + 0x64]
0071250c : MOV word ptr [EDX + ECX*0x2],AX
00712510 : MOV EDX,dword ptr [EBP + -0x4]
00712513 : TEST EDX,EDX
00712515 : JZ 0x00712546
00712517 : MOV EAX,dword ptr [ESI + 0x64]
0071251a : MOV ECX,dword ptr [ESI + 0x24]
0071251d : SUB EAX,EDX
0071251f : SUB ECX,0x106
00712525 : CMP EAX,ECX
00712527 : JA 0x00712546
00712529 : MOV ECX,dword ptr [ESI + 0x80]
0071252f : CMP ECX,0x2
00712532 : JGE 0x007125bf
00712538 : PUSH EDX
00712539 : MOV EDI,ESI
0071253b : CALL 0x00711540
00712540 : ADD ESP,0x4
00712543 : MOV dword ptr [ESI + 0x58],EAX
00712546 : MOV EDI,0x1
0071254b : CMP dword ptr [ESI + 0x58],0x3
0071254f : JC 0x007126a8
00712555 : MOV DX,word ptr [ESI + 0x64]
00712559 : SUB DX,word ptr [ESI + 0x68]
0071255d : MOV AL,byte ptr [ESI + 0x58]
00712560 : MOV EBX,dword ptr [ESI + 0x169c]
00712566 : MOVZX ECX,DX
00712569 : MOV EDX,dword ptr [ESI + 0x1698]
0071256f : MOV word ptr [EBX + EDX*0x2],CX
00712573 : MOV EDX,dword ptr [ESI + 0x1690]
00712579 : MOV EBX,dword ptr [ESI + 0x1698]
0071257f : SUB AL,0x3
00712581 : MOV byte ptr [EDX + EBX*0x1],AL
00712584 : ADD dword ptr [ESI + 0x1698],EDI
0071258a : MOVZX EAX,AL
0071258d : MOVZX EDX,byte ptr [EAX + 0xbfe240]
00712594 : ADD word ptr [ESI + EDX*0x4 + 0x490],DI
0071259c : LEA EAX,[ESI + EDX*0x4 + 0x490]
007125a3 : ADD ECX,0xffff
007125a9 : MOV EAX,0x100
007125ae : CMP CX,AX
007125b1 : JNC 0x007125de
007125b3 : MOVZX ECX,CX
007125b6 : MOVZX EAX,byte ptr [ECX + 0xbfe040]
007125bd : JMP 0x007125eb
007125bf : CMP ECX,0x3
007125c2 : JNZ 0x00712546
007125c4 : MOV EDI,0x1
007125c9 : CMP EAX,EDI
007125cb : JNZ 0x0071254b
007125d1 : CALL 0x007114a0
007125d6 : MOV dword ptr [ESI + 0x58],EAX
007125d9 : JMP 0x0071254b
007125de : MOVZX EDX,CX
007125e1 : SHR EDX,0x7
007125e4 : MOVZX EAX,byte ptr [EDX + 0xbfe140]
007125eb : ADD word ptr [ESI + EAX*0x4 + 0x980],DI
007125f3 : MOV EAX,dword ptr [ESI + 0x1694]
007125f9 : SUB EAX,EDI
007125fb : XOR EBX,EBX
007125fd : CMP dword ptr [ESI + 0x1698],EAX
00712603 : MOV EAX,dword ptr [ESI + 0x58]
00712606 : SETZ BL
00712609 : SUB dword ptr [ESI + 0x6c],EAX
0071260c : MOV ECX,dword ptr [ESI + 0x6c]
0071260f : MOV dword ptr [EBP + 0x8],EBX
00712612 : CMP EAX,dword ptr [ESI + 0x78]
00712615 : JA 0x0071267d
00712617 : CMP ECX,0x3
0071261a : JC 0x0071267d
0071261c : DEC EAX
0071261d : MOV dword ptr [ESI + 0x58],EAX
00712620 : ADD dword ptr [ESI + 0x64],EDI
00712623 : MOV EDX,dword ptr [ESI + 0x64]
00712626 : MOV ECX,dword ptr [ESI + 0x30]
00712629 : MOVZX EAX,byte ptr [EDX + ECX*0x1 + 0x2]
0071262e : MOV EBX,dword ptr [ESI + 0x40]
00712631 : MOV ECX,dword ptr [ESI + 0x50]
00712634 : SHL EBX,CL
00712636 : MOV ECX,dword ptr [ESI + 0x3c]
00712639 : XOR EAX,EBX
0071263b : AND EAX,dword ptr [ESI + 0x4c]
0071263e : MOV EBX,dword ptr [ESI + 0x2c]
00712641 : MOV dword ptr [ESI + 0x40],EAX
00712644 : MOVZX EAX,word ptr [ECX + EAX*0x2]
00712648 : AND EBX,EDX
0071264a : MOV EDX,dword ptr [ESI + 0x38]
0071264d : MOV word ptr [EDX + EBX*0x2],AX
00712651 : MOV ECX,dword ptr [ESI + 0x64]
00712654 : AND ECX,dword ptr [ESI + 0x2c]
00712657 : MOV EDX,dword ptr [ESI + 0x38]
0071265a : MOVZX EAX,word ptr [EDX + ECX*0x2]
0071265e : MOV ECX,dword ptr [ESI + 0x40]
00712661 : MOV EDX,dword ptr [ESI + 0x3c]
00712664 : MOV dword ptr [EBP + -0x4],EAX
00712667 : MOVZX EAX,word ptr [ESI + 0x64]
0071266b : MOV word ptr [EDX + ECX*0x2],AX
0071266f : ADD dword ptr [ESI + 0x58],-0x1
00712673 : JNZ 0x00712620
00712675 : MOV EBX,dword ptr [EBP + 0x8]
00712678 : JMP 0x007126fe
0071267d : ADD dword ptr [ESI + 0x64],EAX
00712680 : MOV ECX,dword ptr [ESI + 0x64]
00712683 : MOV EDX,dword ptr [ESI + 0x30]
00712686 : ADD EDX,ECX
00712688 : MOV ECX,dword ptr [ESI + 0x50]
0071268b : MOV dword ptr [ESI + 0x58],0x0
00712692 : MOVZX EAX,byte ptr [EDX]
00712695 : MOV dword ptr [ESI + 0x40],EAX
00712698 : SHL EAX,CL
0071269a : MOVZX ECX,byte ptr [EDX + 0x1]
0071269e : XOR EAX,ECX
007126a0 : AND EAX,dword ptr [ESI + 0x4c]
007126a3 : MOV dword ptr [ESI + 0x40],EAX
007126a6 : JMP 0x00712701
007126a8 : MOV EDX,dword ptr [ESI + 0x64]
007126ab : MOV EAX,dword ptr [ESI + 0x30]
007126ae : MOV AL,byte ptr [EDX + EAX*0x1]
007126b1 : MOV ECX,dword ptr [ESI + 0x1698]
007126b7 : MOV EDX,dword ptr [ESI + 0x169c]
007126bd : XOR EBX,EBX
007126bf : MOV word ptr [EDX + ECX*0x2],BX
007126c3 : MOV ECX,dword ptr [ESI + 0x1690]
007126c9 : MOV EDX,dword ptr [ESI + 0x1698]
007126cf : MOV byte ptr [ECX + EDX*0x1],AL
007126d2 : ADD dword ptr [ESI + 0x1698],EDI
007126d8 : MOVZX EAX,AL
007126db : ADD word ptr [ESI + EAX*0x4 + 0x8c],DI
007126e3 : MOV ECX,dword ptr [ESI + 0x1694]
007126e9 : LEA EAX,[ESI + EAX*0x4 + 0x8c]
007126f0 : SUB ECX,EDI
007126f2 : CMP dword ptr [ESI + 0x1698],ECX
007126f8 : SETZ BL
007126fb : DEC dword ptr [ESI + 0x6c]
007126fe : ADD dword ptr [ESI + 0x64],EDI
00712701 : TEST EBX,EBX
00712703 : JZ 0x00712491
00712709 : MOV ECX,dword ptr [ESI + 0x54]
0071270c : TEST ECX,ECX
0071270e : JL 0x00712717
00712710 : MOV EAX,dword ptr [ESI + 0x30]
00712713 : ADD EAX,ECX
00712715 : JMP 0x00712719
00712717 : XOR EAX,EAX
00712719 : MOV EDX,dword ptr [ESI + 0x64]
0071271c : SUB EDX,ECX
0071271e : PUSH EDX
0071271f : PUSH EAX
00712720 : XOR EDI,EDI
00712722 : MOV EAX,ESI
00712724 : CALL 0x0070fce0
00712729 : MOV EAX,dword ptr [ESI + 0x64]
0071272c : MOV EDI,dword ptr [ESI]
0071272e : MOV dword ptr [ESI + 0x54],EAX
00712731 : MOV EAX,dword ptr [EDI + 0x1c]
00712734 : MOV EBX,dword ptr [EAX + 0x14]
00712737 : MOV ECX,dword ptr [EDI + 0x10]
0071273a : ADD ESP,0x8
0071273d : CMP EBX,ECX
0071273f : CMOVA EBX,ECX
00712742 : TEST EBX,EBX
00712744 : JZ 0x0071277b
00712746 : MOV ECX,dword ptr [EAX + 0x10]
00712749 : MOV EDX,dword ptr [EDI + 0xc]
0071274c : PUSH EBX
0071274d : PUSH ECX
0071274e : PUSH EDX
0071274f : CALL 0x0063ae40
00712754 : MOV EAX,dword ptr [EDI + 0x1c]
00712757 : ADD dword ptr [EDI + 0xc],EBX
0071275a : ADD dword ptr [EAX + 0x10],EBX
0071275d : ADD dword ptr [EDI + 0x14],EBX
00712760 : SUB dword ptr [EDI + 0x10],EBX
00712763 : MOV EAX,dword ptr [EDI + 0x1c]
00712766 : SUB dword ptr [EAX + 0x14],EBX
00712769 : MOV EDI,dword ptr [EDI + 0x1c]
0071276c : ADD ESP,0xc
0071276f : CMP dword ptr [EDI + 0x14],0x0
00712773 : JNZ 0x0071277b
00712775 : MOV EAX,dword ptr [EDI + 0x8]
00712778 : MOV dword ptr [EDI + 0x10],EAX
0071277b : MOV ECX,dword ptr [ESI]
0071277d : CMP dword ptr [ECX + 0x10],0x0
00712781 : JNZ 0x00712491
00712787 : POP EDI
00712788 : POP ESI
00712789 : XOR EAX,EAX
0071278b : POP EBX
0071278c : MOV ESP,EBP
0071278e : POP EBP
0071278f : RET
00712790 : MOV ECX,dword ptr [ESI + 0x54]
00712793 : TEST ECX,ECX
00712795 : JL 0x0071279e
00712797 : MOV EAX,dword ptr [ESI + 0x30]
0071279a : ADD EAX,ECX
0071279c : JMP 0x007127a0
0071279e : XOR EAX,EAX
007127a0 : MOV EDI,dword ptr [ESI + 0x64]
007127a3 : XOR EDX,EDX
007127a5 : CMP EBX,0x4
007127a8 : SETZ DL
007127ab : SUB EDI,ECX
007127ad : PUSH EDI
007127ae : PUSH EAX
007127af : MOV EAX,ESI
007127b1 : MOV EDI,EDX
007127b3 : CALL 0x0070fce0
007127b8 : MOV EAX,dword ptr [ESI + 0x64]
007127bb : MOV dword ptr [ESI + 0x54],EAX
007127be : MOV EAX,dword ptr [ESI]
007127c0 : ADD ESP,0x8
007127c3 : CALL 0x00711800
007127c8 : MOV ECX,dword ptr [ESI]
007127ca : XOR EAX,EAX
007127cc : CMP dword ptr [ECX + 0x10],EAX
007127cf : JNZ 0x007127e2
007127d1 : CMP EBX,0x4
007127d4 : SETNZ AL
007127d7 : POP EDI
007127d8 : POP ESI
007127d9 : POP EBX
007127da : DEC EAX
007127db : AND EAX,0x2
007127de : MOV ESP,EBP
007127e0 : POP EBP
007127e1 : RET
007127e2 : CMP EBX,0x4
007127e5 : SETZ AL
007127e8 : POP EDI
007127e9 : POP ESI
007127ea : POP EBX
007127eb : LEA EAX,[EAX + EAX*0x1 + 0x1]
007127ef : MOV ESP,EBP
007127f1 : POP EBP
007127f2 : RET

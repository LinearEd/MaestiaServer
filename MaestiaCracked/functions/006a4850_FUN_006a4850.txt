PROGRAM  : Maestia.exe
FUNCTION : FUN_006a4850
ENTRY    : 006a4850
BODY     : [[006a4850, 006a48e3]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a4850(uint *param_1,uint *param_2,undefined4 param_3)

{
  byte *pbVar1;
  uint uVar2;
  uint *puVar3;
  int iVar4;
  byte *unaff_EBX;
  byte *pbVar5;
  byte *pbVar6;
  uint local_4;
  
  pbVar6 = (byte *)*param_1;
  pbVar5 = pbVar6 + 1;
  iVar4 = 0;
  if (pbVar5 <= unaff_EBX) {
    local_4 = (uint)*pbVar6;
    if (local_4 == 0) {
      *param_1 = (uint)pbVar5;
      return iVar4;
    }
    while (pbVar6 = pbVar5, pbVar5 + 2 <= unaff_EBX) {
      pbVar1 = pbVar5 + 1;
      pbVar6 = pbVar5 + 2;
      pbVar5 = pbVar6 + *pbVar5;
      if (unaff_EBX < pbVar5) break;
      if (param_2 != (uint *)0x0) {
        uVar2 = param_2[1];
        puVar3 = param_2;
        while (uVar2 != 0) {
          if (*puVar3 == (uint)*pbVar1) {
            iVar4 = (*(code *)puVar3[1])(pbVar6,pbVar5,param_3);
            if (iVar4 != 0) goto LAB_006a48c2;
            break;
          }
          uVar2 = puVar3[3];
          puVar3 = puVar3 + 2;
        }
      }
      local_4 = local_4 - 1;
      pbVar6 = pbVar5;
      if (local_4 == 0) {
LAB_006a48c2:
        *param_1 = (uint)pbVar6;
        return iVar4;
      }
    }
  }
  *param_1 = (uint)pbVar6;
  return 8;
}



============================================================
DISASSEMBLY
============================================================
006a4850 : PUSH ECX
006a4851 : PUSH EBP
006a4852 : MOV EBP,dword ptr [ESP + 0x10]
006a4856 : PUSH ESI
006a4857 : PUSH EDI
006a4858 : MOV EDI,dword ptr [ESP + 0x14]
006a485c : MOV ESI,dword ptr [EDI]
006a485e : LEA ECX,[ESI + 0x1]
006a4861 : XOR EAX,EAX
006a4863 : CMP ECX,EBX
006a4865 : JA 0x006a48cd
006a4867 : MOVZX EDX,byte ptr [ESI]
006a486a : MOV dword ptr [ESP + 0xc],EDX
006a486e : MOV ESI,ECX
006a4870 : TEST EDX,EDX
006a4872 : JBE 0x006a48dd
006a4874 : LEA ECX,[ESI + 0x2]
006a4877 : CMP ECX,EBX
006a4879 : JA 0x006a48cd
006a487b : MOVZX ECX,byte ptr [ESI]
006a487e : MOVZX EDX,byte ptr [ESI + 0x1]
006a4882 : INC ESI
006a4883 : INC ESI
006a4884 : LEA EDI,[ECX + ESI*0x1]
006a4887 : CMP EDI,EBX
006a4889 : JA 0x006a48cd
006a488b : TEST EBP,EBP
006a488d : JZ 0x006a48b9
006a488f : CMP dword ptr [EBP + 0x4],0x0
006a4893 : MOV ECX,EBP
006a4895 : JZ 0x006a48b9
006a4897 : CMP dword ptr [ECX],EDX
006a4899 : JZ 0x006a48a6
006a489b : ADD ECX,0x8
006a489e : CMP dword ptr [ECX + 0x4],0x0
006a48a2 : JNZ 0x006a4897
006a48a4 : JMP 0x006a48b9
006a48a6 : MOV EDX,dword ptr [ESP + 0x1c]
006a48aa : MOV EAX,dword ptr [ECX + 0x4]
006a48ad : PUSH EDX
006a48ae : PUSH EDI
006a48af : PUSH ESI
006a48b0 : CALL EAX
006a48b2 : ADD ESP,0xc
006a48b5 : TEST EAX,EAX
006a48b7 : JNZ 0x006a48c2
006a48b9 : SUB dword ptr [ESP + 0xc],0x1
006a48be : MOV ESI,EDI
006a48c0 : JNZ 0x006a4874
006a48c2 : MOV ECX,dword ptr [ESP + 0x14]
006a48c6 : POP EDI
006a48c7 : MOV dword ptr [ECX],ESI
006a48c9 : POP ESI
006a48ca : POP EBP
006a48cb : POP ECX
006a48cc : RET
006a48cd : MOV EDX,dword ptr [ESP + 0x14]
006a48d1 : POP EDI
006a48d2 : MOV dword ptr [EDX],ESI
006a48d4 : POP ESI
006a48d5 : MOV EAX,0x8
006a48da : POP EBP
006a48db : POP ECX
006a48dc : RET
006a48dd : MOV dword ptr [EDI],ESI
006a48df : POP EDI
006a48e0 : POP ESI
006a48e1 : POP EBP
006a48e2 : POP ECX
006a48e3 : RET

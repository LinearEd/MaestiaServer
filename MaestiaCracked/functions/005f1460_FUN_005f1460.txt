PROGRAM  : Maestia.exe
FUNCTION : FUN_005f1460
ENTRY    : 005f1460
BODY     : [[005f1460, 005f17dd]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005f1460(float param_1,int param_2,float param_3,float param_4,int param_5,float param_6,
                 ushort *param_7,ushort *param_8)

{
  uint uVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  int iVar5;
  int iVar6;
  int in_ECX;
  int iVar7;
  int local_8;
  
  iVar6 = (int)param_6;
  iVar5 = param_5;
  *(char *)((int)param_6 + 6) = (char)param_2;
  *(undefined1 *)((int)param_6 + 7) = *(undefined1 *)(param_5 + 7);
  *(undefined1 *)((int)param_6 + 10) = *(undefined1 *)(param_5 + 10);
  *param_7 = (ushort)(param_2 << 4);
  fVar2 = (float)param_2;
  if (param_2 < 0) {
    fVar2 = fVar2 + 4.2949673e+09;
  }
  param_1 = fVar2 / param_1;
  if (param_1 < 1.0) {
    param_1 = 1.0;
  }
  iVar7 = *(int *)(in_ECX + 0xc) + *(int *)(in_ECX + 0x10) * -2 + -2;
  fVar3 = param_1 * param_3 * (float)*(byte *)(param_5 + 8) * 0.0625;
  param_1 = param_3 * (float)*(byte *)(param_5 + 9) * 0.0625 * param_1;
  fVar2 = param_1 + param_1 + fVar2 * 0.0009765625 * param_4;
  fVar4 = (float)iVar7;
  if (iVar7 < 0) {
    fVar4 = fVar4 + 4.2949673e+09;
  }
  *param_8 = 0x100;
  if (fVar4 < fVar2) {
    fVar4 = fVar4 / fVar2;
    param_5._0_2_ = (ushort)(int)ROUND(fVar4 * (float)*param_7);
    *param_7 = (ushort)param_5;
    param_5._0_2_ = (ushort)(int)ROUND(fVar4 * 256.0 + 0.5);
    *param_8 = (ushort)param_5;
    *(byte *)((int)param_6 + 7) = *(byte *)((int)param_6 + 7) & 0xfd;
    param_1 = fVar4 * param_1;
    fVar3 = fVar3 * fVar4;
  }
  param_6 = fVar3;
  if (15.75 < param_6) {
    param_6 = 15.75;
  }
  if (15.75 < param_1) {
    param_1 = 15.75;
  }
  param_6._0_1_ = (char)(int)ROUND(param_6 * 16.0 + 0.5);
  *(char *)(iVar6 + 8) = param_6._0_1_;
  uVar1 = (uint)ROUND(param_1 * 16.0 + 0.5);
  param_6._0_1_ = (char)uVar1;
  *(char *)(iVar6 + 9) = param_6._0_1_;
  if ((*(byte *)(iVar5 + 7) & 0x81) == 0) {
    local_8 = (int)(longlong)ROUND((float)(uVar1 & 0xff) * 0.0625 + 0.5);
    if ((local_8 == 0) && (param_6._0_1_ != '\0')) {
      local_8 = 1;
    }
    fVar2 = (float)local_8;
    if (local_8 < 0) {
      fVar2 = fVar2 + 4.2949673e+09;
    }
    if (fVar2 < param_1) {
      fVar2 = (float)(int)((uint)*param_7 * local_8);
      if ((int)((uint)*param_7 * local_8) < 0) {
        fVar2 = fVar2 + 4.2949673e+09;
      }
      param_6._0_2_ = (ushort)(int)ROUND(fVar2 / param_1);
      *param_7 = param_6._0_2_;
      fVar2 = (float)(int)((uint)*param_8 * local_8);
      if ((int)((uint)*param_8 * local_8) < 0) {
        fVar2 = fVar2 + 4.2949673e+09;
      }
      param_6._0_2_ = (ushort)(int)ROUND(fVar2 / param_1);
      *param_8 = param_6._0_2_;
      return;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005f1460 : SUB ESP,0x8
005f1463 : MOV EAX,dword ptr [ESP + 0x10]
005f1467 : MOV EDX,dword ptr [ESP + 0x20]
005f146b : PUSH EBX
005f146c : PUSH EBP
005f146d : MOV EBP,dword ptr [ESP + 0x2c]
005f1471 : PUSH ESI
005f1472 : MOV ESI,dword ptr [ESP + 0x28]
005f1476 : MOV byte ptr [EDX + 0x6],AL
005f1479 : PUSH EDI
005f147a : MOV EDI,ECX
005f147c : MOVZX ECX,byte ptr [ESI + 0x7]
005f1480 : MOV byte ptr [EDX + 0x7],CL
005f1483 : MOVZX ECX,byte ptr [ESI + 0xa]
005f1487 : MOV byte ptr [EDX + 0xa],CL
005f148a : MOV ECX,EAX
005f148c : SHL ECX,0x4
005f148f : MOV dword ptr [ESP + 0x20],EAX
005f1493 : MOV word ptr [EBP],CX
005f1497 : FILD dword ptr [ESP + 0x20]
005f149b : TEST EAX,EAX
005f149d : JGE 0x005f14a5
005f149f : FADD float ptr [0x00cdf0e0]
005f14a5 : FSTP float ptr [ESP + 0x20]
005f14a9 : FLD float ptr [ESP + 0x20]
005f14ad : FLD ST0
005f14af : FDIV float ptr [ESP + 0x1c]
005f14b3 : FSTP float ptr [ESP + 0x20]
005f14b7 : FLD1
005f14b9 : FLD float ptr [ESP + 0x20]
005f14bd : FCOM
005f14bf : FNSTSW AX
005f14c1 : TEST AH,0x5
005f14c4 : JP 0x005f14d2
005f14c6 : FSTP ST0
005f14c8 : FSTP float ptr [ESP + 0x20]
005f14cc : FLD float ptr [ESP + 0x20]
005f14d0 : JMP 0x005f14d4
005f14d2 : FSTP ST1
005f14d4 : MOVZX EAX,byte ptr [ESI + 0x8]
005f14d8 : MOVZX ECX,byte ptr [ESI + 0x9]
005f14dc : MOV dword ptr [ESP + 0x20],EAX
005f14e0 : MOV EAX,dword ptr [EDI + 0x10]
005f14e3 : ADD EAX,EAX
005f14e5 : FILD dword ptr [ESP + 0x20]
005f14e9 : FLD double ptr [0x00b86b28]
005f14ef : FMUL ST1
005f14f1 : FXCH
005f14f3 : FSTP float ptr [ESP + 0x20]
005f14f7 : FLD float ptr [ESP + 0x20]
005f14fb : MOV dword ptr [ESP + 0x20],ECX
005f14ff : FLD float ptr [ESP + 0x24]
005f1503 : MOV ECX,dword ptr [EDI + 0xc]
005f1506 : FLD ST0
005f1508 : SUB ECX,EAX
005f150a : FMULP ST2
005f150c : SUB ECX,0x2
005f150f : FLD ST3
005f1511 : FMULP ST2
005f1513 : FXCH
005f1515 : FSTP float ptr [ESP + 0x30]
005f1519 : FILD dword ptr [ESP + 0x20]
005f151d : FMUL ST2
005f151f : FSTP float ptr [ESP + 0x20]
005f1523 : FMUL float ptr [ESP + 0x20]
005f1527 : FMULP ST2
005f1529 : FXCH
005f152b : FSTP float ptr [ESP + 0x20]
005f152f : FXCH
005f1531 : FMUL double ptr [0x00b8bee0]
005f1537 : FSTP float ptr [ESP + 0x2c]
005f153b : FLD float ptr [ESP + 0x2c]
005f153f : MOV dword ptr [ESP + 0x2c],ECX
005f1543 : FMUL float ptr [ESP + 0x28]
005f1547 : FLD float ptr [ESP + 0x20]
005f154b : FLD ST0
005f154d : FADD ST0,ST1
005f154f : FADDP ST2,ST0
005f1551 : FXCH
005f1553 : FSTP float ptr [ESP + 0x20]
005f1557 : FILD dword ptr [ESP + 0x2c]
005f155b : TEST ECX,ECX
005f155d : JGE 0x005f1565
005f155f : FADD float ptr [0x00cdf0e0]
005f1565 : MOV EDI,dword ptr [ESP + 0x38]
005f1569 : FSTP float ptr [ESP + 0x2c]
005f156d : FLD float ptr [ESP + 0x20]
005f1571 : MOV EAX,0x100
005f1576 : FLD float ptr [ESP + 0x2c]
005f157a : MOV word ptr [EDI],AX
005f157d : FCOM
005f157f : FNSTSW AX
005f1581 : FLD double ptr [0x00cdf120]
005f1587 : TEST AH,0x5
005f158a : JP 0x005f17be
005f1590 : FXCH
005f1592 : MOVZX ECX,word ptr [EBP]
005f1596 : FDIVRP ST2,ST0
005f1598 : MOV dword ptr [ESP + 0x2c],ECX
005f159c : FXCH
005f159e : FSTP float ptr [ESP + 0x20]
005f15a2 : FILD dword ptr [ESP + 0x2c]
005f15a6 : FLD float ptr [ESP + 0x20]
005f15aa : FLD ST0
005f15ac : FMULP ST2
005f15ae : FNSTCW word ptr [ESP + 0x20]
005f15b2 : FXCH
005f15b4 : MOVZX EAX,word ptr [ESP + 0x20]
005f15b9 : OR EAX,0xc00
005f15be : MOV dword ptr [ESP + 0x2c],EAX
005f15c2 : FLDCW word ptr [ESP + 0x2c]
005f15c6 : FISTP dword ptr [ESP + 0x2c]
005f15ca : MOV AX,word ptr [ESP + 0x2c]
005f15cf : MOV word ptr [EBP],AX
005f15d3 : FLDCW word ptr [ESP + 0x20]
005f15d7 : FLD double ptr [0x00b93758]
005f15dd : FMUL ST1
005f15df : FNSTCW word ptr [ESP + 0x20]
005f15e3 : FADD ST0,ST2
005f15e5 : MOVZX EAX,word ptr [ESP + 0x20]
005f15ea : OR EAX,0xc00
005f15ef : MOV dword ptr [ESP + 0x2c],EAX
005f15f3 : FLDCW word ptr [ESP + 0x2c]
005f15f7 : FISTP dword ptr [ESP + 0x2c]
005f15fb : MOV CX,word ptr [ESP + 0x2c]
005f1600 : MOV word ptr [EDI],CX
005f1603 : AND byte ptr [EDX + 0x7],0xfd
005f1607 : FLDCW word ptr [ESP + 0x20]
005f160b : FLD float ptr [ESP + 0x30]
005f160f : FMUL ST1
005f1611 : FSTP float ptr [ESP + 0x30]
005f1615 : FMULP ST2
005f1617 : FXCH
005f1619 : FSTP float ptr [ESP + 0x20]
005f161d : FLD float ptr [ESP + 0x20]
005f1621 : FXCH
005f1623 : FLD float ptr [ESP + 0x30]
005f1627 : FLD double ptr [0x00b94f38]
005f162d : FCOM
005f162f : FNSTSW AX
005f1631 : FSTP ST1
005f1633 : FLD float ptr [0x00b94f30]
005f1639 : TEST AH,0x5
005f163c : JP 0x005f1642
005f163e : FST float ptr [ESP + 0x30]
005f1642 : FXCH
005f1644 : FCOMP ST3
005f1646 : FNSTSW AX
005f1648 : TEST AH,0x5
005f164b : JP 0x005f17c7
005f1651 : FSTP ST2
005f1653 : FXCH
005f1655 : FSTP float ptr [ESP + 0x20]
005f1659 : FLD float ptr [ESP + 0x20]
005f165d : FXCH
005f165f : FLD float ptr [ESP + 0x30]
005f1663 : FLD double ptr [0x00b86b68]
005f1669 : FNSTCW word ptr [ESP + 0x20]
005f166d : MOVZX EAX,word ptr [ESP + 0x20]
005f1672 : FMUL ST1
005f1674 : OR EAX,0xc00
005f1679 : FXCH
005f167b : MOV dword ptr [ESP + 0x30],EAX
005f167f : FADD ST0,ST2
005f1681 : FLDCW word ptr [ESP + 0x30]
005f1685 : FISTP dword ptr [ESP + 0x30]
005f1689 : MOV AL,byte ptr [ESP + 0x30]
005f168d : MOV byte ptr [EDX + 0x8],AL
005f1690 : FLDCW word ptr [ESP + 0x20]
005f1694 : FNSTCW word ptr [ESP + 0x20]
005f1698 : FMUL ST2
005f169a : MOVZX EAX,word ptr [ESP + 0x20]
005f169f : OR EAX,0xc00
005f16a4 : MOV dword ptr [ESP + 0x30],EAX
005f16a8 : FADD ST0,ST1
005f16aa : FLDCW word ptr [ESP + 0x30]
005f16ae : FISTP dword ptr [ESP + 0x30]
005f16b2 : MOV BL,byte ptr [ESP + 0x30]
005f16b6 : MOV byte ptr [EDX + 0x9],BL
005f16b9 : TEST byte ptr [ESI + 0x7],0x81
005f16bd : FLDCW word ptr [ESP + 0x20]
005f16c1 : JNZ 0x005f17ce
005f16c7 : MOVZX ECX,BL
005f16ca : MOV dword ptr [ESP + 0x20],ECX
005f16ce : FILD dword ptr [ESP + 0x20]
005f16d2 : FMULP ST3
005f16d4 : FXCH ST2
005f16d6 : FSTP float ptr [ESP + 0x20]
005f16da : FLD float ptr [ESP + 0x20]
005f16de : FNSTCW word ptr [ESP + 0x20]
005f16e2 : MOVZX EAX,word ptr [ESP + 0x20]
005f16e7 : FADDP ST2,ST0
005f16e9 : OR EAX,0xc00
005f16ee : FXCH
005f16f0 : MOV dword ptr [ESP + 0x30],EAX
005f16f4 : FLDCW word ptr [ESP + 0x30]
005f16f8 : FISTP qword ptr [ESP + 0x10]
005f16fc : MOV ECX,dword ptr [ESP + 0x10]
005f1700 : FLDCW word ptr [ESP + 0x20]
005f1704 : TEST ECX,ECX
005f1706 : JNZ 0x005f1711
005f1708 : TEST BL,BL
005f170a : JZ 0x005f1711
005f170c : MOV ECX,0x1
005f1711 : MOV EDX,ECX
005f1713 : MOV dword ptr [ESP + 0x20],EDX
005f1717 : FILD dword ptr [ESP + 0x20]
005f171b : TEST EDX,EDX
005f171d : JGE 0x005f1725
005f171f : FADD float ptr [0x00cdf0e0]
005f1725 : FCOMP
005f1727 : FNSTSW AX
005f1729 : TEST AH,0x5
005f172c : JP 0x005f17d2
005f1732 : MOVZX EAX,word ptr [EBP]
005f1736 : IMUL EAX,ECX
005f1739 : MOV dword ptr [ESP + 0x20],EAX
005f173d : FILD dword ptr [ESP + 0x20]
005f1741 : TEST EAX,EAX
005f1743 : JGE 0x005f174b
005f1745 : FADD float ptr [0x00cdf0e0]
005f174b : FDIV ST0,ST1
005f174d : FNSTCW word ptr [ESP + 0x20]
005f1751 : MOVZX EAX,word ptr [ESP + 0x20]
005f1756 : OR EAX,0xc00
005f175b : MOV dword ptr [ESP + 0x30],EAX
005f175f : FLDCW word ptr [ESP + 0x30]
005f1763 : FISTP dword ptr [ESP + 0x30]
005f1767 : MOV DX,word ptr [ESP + 0x30]
005f176c : MOV word ptr [EBP],DX
005f1770 : MOVZX EAX,word ptr [EDI]
005f1773 : FLDCW word ptr [ESP + 0x20]
005f1777 : IMUL EAX,ECX
005f177a : MOV dword ptr [ESP + 0x20],EAX
005f177e : FILD dword ptr [ESP + 0x20]
005f1782 : TEST EAX,EAX
005f1784 : JGE 0x005f178c
005f1786 : FADD float ptr [0x00cdf0e0]
005f178c : FDIVRP
005f178e : FNSTCW word ptr [ESP + 0x20]
005f1792 : MOVZX EAX,word ptr [ESP + 0x20]
005f1797 : OR EAX,0xc00
005f179c : MOV dword ptr [ESP + 0x30],EAX
005f17a0 : FLDCW word ptr [ESP + 0x30]
005f17a4 : FISTP dword ptr [ESP + 0x30]
005f17a8 : MOV CX,word ptr [ESP + 0x30]
005f17ad : MOV word ptr [EDI],CX
005f17b0 : POP EDI
005f17b1 : FLDCW word ptr [ESP + 0x1c]
005f17b5 : POP ESI
005f17b6 : POP EBP
005f17b7 : POP EBX
005f17b8 : ADD ESP,0x8
005f17bb : RET 0x20
005f17be : FSTP ST2
005f17c0 : FSTP ST0
005f17c2 : JMP 0x005f1623
005f17c7 : FSTP ST0
005f17c9 : JMP 0x005f165f
005f17ce : FSTP ST1
005f17d0 : FSTP ST0
005f17d2 : POP EDI
005f17d3 : FSTP ST0
005f17d5 : POP ESI
005f17d6 : POP EBP
005f17d7 : POP EBX
005f17d8 : ADD ESP,0x8
005f17db : RET 0x20

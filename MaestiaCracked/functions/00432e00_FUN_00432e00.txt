PROGRAM  : Maestia.exe
FUNCTION : FUN_00432e00
ENTRY    : 00432e00
BODY     : [[00432e00, 00433060]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00432e00(int param_1,int param_2,code *param_3,int *param_4,int param_5)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  void **ppvVar4;
  char cVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  uint uVar9;
  undefined1 auStack_60 [32];
  undefined4 uStack_40;
  undefined4 *puStack_3c;
  undefined4 uStack_38;
  undefined1 *puStack_34;
  uint uStack_30;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  iVar3 = param_1;
  puStack_c = &LAB_00b78e94;
  uStack_30 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_8 = 0;
  ppvVar4 = &local_10;
  local_10 = ExceptionList;
  while( true ) {
    ExceptionList = ppvVar4;
    iVar8 = param_1 * 2 + 2;
    if (param_2 <= iVar8) break;
    uVar9 = param_5 + iVar8;
    uVar7 = uVar9 - 1;
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    if (*(uint *)(iVar6 + 0x14) <= uVar7) {
      if (param_4 == (int *)0x0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *param_4;
      }
      uVar7 = uVar7 - *(int *)(iVar6 + 0x14);
    }
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    puStack_34 = *(undefined1 **)(*(int *)(iVar6 + 0x10) + uVar7 * 4);
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    if (*(uint *)(iVar6 + 0x14) <= uVar9) {
      if (param_4 == (int *)0x0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *param_4;
      }
      uVar9 = uVar9 - *(int *)(iVar6 + 0x14);
    }
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    uStack_38 = *(undefined4 *)(*(int *)(iVar6 + 0x10) + uVar9 * 4);
    puStack_3c = (undefined4 *)0x432ebc;
    cVar5 = (*param_3)();
    if (cVar5 != '\0') {
      iVar8 = param_1 * 2 + 1;
    }
    uVar7 = param_5 + iVar8;
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    if (*(uint *)(iVar6 + 0x14) <= uVar7) {
      if (param_4 == (int *)0x0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *param_4;
      }
      uVar7 = uVar7 - *(int *)(iVar6 + 0x14);
    }
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    puVar1 = *(undefined4 **)(*(int *)(iVar6 + 0x10) + uVar7 * 4);
    uVar7 = param_5 + param_1;
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    if (*(uint *)(iVar6 + 0x14) <= uVar7) {
      if (param_4 == (int *)0x0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *param_4;
      }
      uVar7 = uVar7 - *(int *)(iVar6 + 0x14);
    }
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    puVar2 = *(undefined4 **)(*(int *)(iVar6 + 0x10) + uVar7 * 4);
    *puVar2 = *puVar1;
    puStack_34 = (undefined1 *)0xffffffff;
    uStack_38 = 0;
    puStack_3c = puVar1 + 3;
    puVar2[1] = puVar1[1];
    puVar2[2] = puVar1[2];
    uStack_40 = 0x432f50;
    FUN_00405eb0();
    *(undefined1 *)(puVar2 + 10) = *(undefined1 *)(puVar1 + 10);
    ppvVar4 = ExceptionList;
    param_1 = iVar8;
  }
  if (iVar8 == param_2) {
    uVar7 = param_5 + -1 + param_2;
    if (param_4 == (int *)0x0) {
      iVar8 = 0;
    }
    else {
      iVar8 = *param_4;
    }
    if (*(uint *)(iVar8 + 0x14) <= uVar7) {
      if (param_4 == (int *)0x0) {
        iVar8 = 0;
      }
      else {
        iVar8 = *param_4;
      }
      uVar7 = uVar7 - *(int *)(iVar8 + 0x14);
    }
    if (param_4 == (int *)0x0) {
      iVar8 = 0;
    }
    else {
      iVar8 = *param_4;
    }
    puVar1 = *(undefined4 **)(*(int *)(iVar8 + 0x10) + uVar7 * 4);
    uVar7 = param_5 + param_1;
    if (param_4 == (int *)0x0) {
      iVar8 = 0;
    }
    else {
      iVar8 = *param_4;
    }
    if (*(uint *)(iVar8 + 0x14) <= uVar7) {
      if (param_4 == (int *)0x0) {
        iVar8 = 0;
      }
      else {
        iVar8 = *param_4;
      }
      uVar7 = uVar7 - *(int *)(iVar8 + 0x14);
    }
    if (param_4 == (int *)0x0) {
      iVar8 = 0;
    }
    else {
      iVar8 = *param_4;
    }
    puVar2 = *(undefined4 **)(*(int *)(iVar8 + 0x10) + uVar7 * 4);
    *puVar2 = *puVar1;
    puStack_34 = (undefined1 *)0xffffffff;
    uStack_38 = 0;
    puStack_3c = puVar1 + 3;
    puVar2[1] = puVar1[1];
    puVar2[2] = puVar1[2];
    uStack_40 = 0x432ffe;
    FUN_00405eb0();
    param_1 = param_2 + -1;
    *(undefined1 *)(puVar2 + 10) = *(undefined1 *)(puVar1 + 10);
  }
  FUN_00430dd0(auStack_60);
  local_8 = local_8 & 0xffffff00;
  FUN_004333d0(param_1,iVar3,param_3,param_4,param_5);
  local_8 = 0xffffffff;
  uStack_38 = 0x43304f;
  puStack_34 = &stack0x00000018;
  FUN_004199f0();
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00432e00 : PUSH EBP
00432e01 : MOV EBP,ESP
00432e03 : PUSH -0x1
00432e05 : PUSH 0xb78e94
00432e0a : MOV EAX,FS:[0x0]
00432e10 : PUSH EAX
00432e11 : SUB ESP,0x10
00432e14 : PUSH EBX
00432e15 : PUSH ESI
00432e16 : PUSH EDI
00432e17 : MOV EAX,[0x00d66fa0]
00432e1c : XOR EAX,EBP
00432e1e : PUSH EAX
00432e1f : LEA EAX,[EBP + -0xc]
00432e22 : MOV FS:[0x0],EAX
00432e28 : MOV EAX,dword ptr [EBP + 0x10]
00432e2b : MOV dword ptr [EBP + -0x18],EAX
00432e2e : MOV dword ptr [EBP + -0x4],0x0
00432e35 : MOV ESI,dword ptr [EBP + 0x8]
00432e38 : MOV EDX,dword ptr [EBP + 0xc]
00432e3b : LEA EBX,[ESI + ESI*0x1 + 0x2]
00432e3f : CMP EBX,EDX
00432e41 : MOV dword ptr [EBP + -0x1c],ESI
00432e44 : JGE 0x00432f6e
00432e4a : MOV ESI,dword ptr [EBP + 0x18]
00432e4d : MOV EAX,dword ptr [EBP + 0x14]
00432e50 : LEA EDI,[ESI + EBX*0x1]
00432e53 : MOV dword ptr [EBP + -0x10],ESI
00432e56 : LEA ECX,[EDI + -0x1]
00432e59 : TEST EAX,EAX
00432e5b : JZ 0x00432e61
00432e5d : MOV EDX,dword ptr [EAX]
00432e5f : JMP 0x00432e63
00432e61 : XOR EDX,EDX
00432e63 : CMP dword ptr [EDX + 0x14],ECX
00432e66 : JA 0x00432e75
00432e68 : TEST EAX,EAX
00432e6a : JZ 0x00432e70
00432e6c : MOV EDX,dword ptr [EAX]
00432e6e : JMP 0x00432e72
00432e70 : XOR EDX,EDX
00432e72 : SUB ECX,dword ptr [EDX + 0x14]
00432e75 : TEST EAX,EAX
00432e77 : JZ 0x00432e7d
00432e79 : MOV EDX,dword ptr [EAX]
00432e7b : JMP 0x00432e7f
00432e7d : XOR EDX,EDX
00432e7f : MOV EAX,dword ptr [EBP + 0x14]
00432e82 : MOV EDX,dword ptr [EDX + 0x10]
00432e85 : MOV ECX,dword ptr [EDX + ECX*0x4]
00432e88 : MOV dword ptr [EBP + -0x10],ESI
00432e8b : TEST EAX,EAX
00432e8d : JZ 0x00432e93
00432e8f : MOV EDX,dword ptr [EAX]
00432e91 : JMP 0x00432e95
00432e93 : XOR EDX,EDX
00432e95 : CMP dword ptr [EDX + 0x14],EDI
00432e98 : JA 0x00432ea7
00432e9a : TEST EAX,EAX
00432e9c : JZ 0x00432ea2
00432e9e : MOV EDX,dword ptr [EAX]
00432ea0 : JMP 0x00432ea4
00432ea2 : XOR EDX,EDX
00432ea4 : SUB EDI,dword ptr [EDX + 0x14]
00432ea7 : TEST EAX,EAX
00432ea9 : JZ 0x00432eaf
00432eab : MOV EAX,dword ptr [EAX]
00432ead : JMP 0x00432eb1
00432eaf : XOR EAX,EAX
00432eb1 : MOV EAX,dword ptr [EAX + 0x10]
00432eb4 : MOV EDI,dword ptr [EAX + EDI*0x4]
00432eb7 : PUSH ECX
00432eb8 : PUSH EDI
00432eb9 : CALL dword ptr [EBP + -0x18]
00432ebc : ADD ESP,0x8
00432ebf : TEST AL,AL
00432ec1 : JZ 0x00432ec4
00432ec3 : DEC EBX
00432ec4 : MOV EAX,dword ptr [EBP + 0x14]
00432ec7 : MOV ECX,dword ptr [EBP + 0x18]
00432eca : MOV dword ptr [EBP + -0x10],ECX
00432ecd : LEA ESI,[ECX + EBX*0x1]
00432ed0 : TEST EAX,EAX
00432ed2 : JZ 0x00432ed8
00432ed4 : MOV EDX,dword ptr [EAX]
00432ed6 : JMP 0x00432eda
00432ed8 : XOR EDX,EDX
00432eda : CMP dword ptr [EDX + 0x14],ESI
00432edd : JA 0x00432eec
00432edf : TEST EAX,EAX
00432ee1 : JZ 0x00432ee7
00432ee3 : MOV EDX,dword ptr [EAX]
00432ee5 : JMP 0x00432ee9
00432ee7 : XOR EDX,EDX
00432ee9 : SUB ESI,dword ptr [EDX + 0x14]
00432eec : TEST EAX,EAX
00432eee : JZ 0x00432ef4
00432ef0 : MOV EDX,dword ptr [EAX]
00432ef2 : JMP 0x00432ef6
00432ef4 : XOR EDX,EDX
00432ef6 : MOV EDX,dword ptr [EDX + 0x10]
00432ef9 : MOV EDI,dword ptr [EDX + ESI*0x4]
00432efc : MOV EDX,dword ptr [EBP + 0x8]
00432eff : MOV dword ptr [EBP + -0x10],ECX
00432f02 : ADD ECX,EDX
00432f04 : TEST EAX,EAX
00432f06 : JZ 0x00432f0c
00432f08 : MOV EDX,dword ptr [EAX]
00432f0a : JMP 0x00432f0e
00432f0c : XOR EDX,EDX
00432f0e : CMP dword ptr [EDX + 0x14],ECX
00432f11 : JA 0x00432f20
00432f13 : TEST EAX,EAX
00432f15 : JZ 0x00432f1b
00432f17 : MOV EDX,dword ptr [EAX]
00432f19 : JMP 0x00432f1d
00432f1b : XOR EDX,EDX
00432f1d : SUB ECX,dword ptr [EDX + 0x14]
00432f20 : TEST EAX,EAX
00432f22 : JZ 0x00432f28
00432f24 : MOV EAX,dword ptr [EAX]
00432f26 : JMP 0x00432f2a
00432f28 : XOR EAX,EAX
00432f2a : MOV EAX,dword ptr [EAX + 0x10]
00432f2d : MOV ESI,dword ptr [EAX + ECX*0x4]
00432f30 : MOV ECX,dword ptr [EDI]
00432f32 : MOV dword ptr [ESI],ECX
00432f34 : MOV EDX,dword ptr [EDI + 0x4]
00432f37 : PUSH -0x1
00432f39 : PUSH 0x0
00432f3b : LEA ECX,[EDI + 0xc]
00432f3e : MOV dword ptr [ESI + 0x4],EDX
00432f41 : MOV EAX,dword ptr [EDI + 0x8]
00432f44 : PUSH ECX
00432f45 : LEA ECX,[ESI + 0xc]
00432f48 : MOV dword ptr [ESI + 0x8],EAX
00432f4b : CALL 0x00405eb0
00432f50 : MOV DL,byte ptr [EDI + 0x28]
00432f53 : MOV dword ptr [EBP + 0x8],EBX
00432f56 : LEA EBX,[EBX + EBX*0x1 + 0x2]
00432f5a : CMP EBX,dword ptr [EBP + 0xc]
00432f5d : MOV byte ptr [ESI + 0x28],DL
00432f60 : JL 0x00432e4a
00432f66 : MOV EDX,dword ptr [EBP + 0xc]
00432f69 : MOV ESI,dword ptr [EBP + 0x8]
00432f6c : CMP EBX,EDX
00432f6e : JNZ 0x0043300b
00432f74 : MOV EAX,dword ptr [EBP + 0x14]
00432f77 : MOV ECX,dword ptr [EBP + 0x18]
00432f7a : MOV dword ptr [EBP + -0x10],ECX
00432f7d : LEA EDI,[ECX + EDX*0x1 + -0x1]
00432f81 : TEST EAX,EAX
00432f83 : JZ 0x00432f89
00432f85 : MOV EDX,dword ptr [EAX]
00432f87 : JMP 0x00432f8b
00432f89 : XOR EDX,EDX
00432f8b : CMP dword ptr [EDX + 0x14],EDI
00432f8e : JA 0x00432f9d
00432f90 : TEST EAX,EAX
00432f92 : JZ 0x00432f98
00432f94 : MOV EDX,dword ptr [EAX]
00432f96 : JMP 0x00432f9a
00432f98 : XOR EDX,EDX
00432f9a : SUB EDI,dword ptr [EDX + 0x14]
00432f9d : TEST EAX,EAX
00432f9f : JZ 0x00432fa5
00432fa1 : MOV EDX,dword ptr [EAX]
00432fa3 : JMP 0x00432fa7
00432fa5 : XOR EDX,EDX
00432fa7 : MOV EDX,dword ptr [EDX + 0x10]
00432faa : MOV EDI,dword ptr [EDX + EDI*0x4]
00432fad : MOV dword ptr [EBP + -0x10],ECX
00432fb0 : ADD ECX,ESI
00432fb2 : TEST EAX,EAX
00432fb4 : JZ 0x00432fba
00432fb6 : MOV EDX,dword ptr [EAX]
00432fb8 : JMP 0x00432fbc
00432fba : XOR EDX,EDX
00432fbc : CMP dword ptr [EDX + 0x14],ECX
00432fbf : JA 0x00432fce
00432fc1 : TEST EAX,EAX
00432fc3 : JZ 0x00432fc9
00432fc5 : MOV EDX,dword ptr [EAX]
00432fc7 : JMP 0x00432fcb
00432fc9 : XOR EDX,EDX
00432fcb : SUB ECX,dword ptr [EDX + 0x14]
00432fce : TEST EAX,EAX
00432fd0 : JZ 0x00432fd6
00432fd2 : MOV EAX,dword ptr [EAX]
00432fd4 : JMP 0x00432fd8
00432fd6 : XOR EAX,EAX
00432fd8 : MOV EAX,dword ptr [EAX + 0x10]
00432fdb : MOV ESI,dword ptr [EAX + ECX*0x4]
00432fde : MOV ECX,dword ptr [EDI]
00432fe0 : MOV dword ptr [ESI],ECX
00432fe2 : MOV EDX,dword ptr [EDI + 0x4]
00432fe5 : PUSH -0x1
00432fe7 : PUSH 0x0
00432fe9 : LEA ECX,[EDI + 0xc]
00432fec : MOV dword ptr [ESI + 0x4],EDX
00432fef : MOV EAX,dword ptr [EDI + 0x8]
00432ff2 : PUSH ECX
00432ff3 : LEA ECX,[ESI + 0xc]
00432ff6 : MOV dword ptr [ESI + 0x8],EAX
00432ff9 : CALL 0x00405eb0
00432ffe : MOV EAX,dword ptr [EBP + 0xc]
00433001 : MOV DL,byte ptr [EDI + 0x28]
00433004 : DEC EAX
00433005 : MOV byte ptr [ESI + 0x28],DL
00433008 : MOV dword ptr [EBP + 0x8],EAX
0043300b : SUB ESP,0x30
0043300e : MOV ECX,ESP
00433010 : MOV dword ptr [EBP + -0x10],ESP
00433013 : PUSH ECX
00433014 : LEA EDI,[EBP + 0x1c]
00433017 : CALL 0x00430dd0
0043301c : MOV byte ptr [EBP + -0x4],0x1
00433020 : MOV EDX,dword ptr [EBP + 0x18]
00433023 : MOV EAX,dword ptr [EBP + 0x14]
00433026 : MOV ECX,dword ptr [EBP + -0x18]
00433029 : PUSH EDX
0043302a : MOV EDX,dword ptr [EBP + -0x1c]
0043302d : PUSH EAX
0043302e : MOV EAX,dword ptr [EBP + 0x8]
00433031 : PUSH ECX
00433032 : PUSH EDX
00433033 : PUSH EAX
00433034 : MOV byte ptr [EBP + -0x4],0x0
00433038 : CALL 0x004333d0
0043303d : ADD ESP,0x44
00433040 : MOV dword ptr [EBP + -0x4],0xffffffff
00433047 : MOV ECX,EDI
00433049 : PUSH ECX
0043304a : CALL 0x004199f0
0043304f : MOV ECX,dword ptr [EBP + -0xc]
00433052 : MOV dword ptr FS:[0x0],ECX
00433059 : POP ECX
0043305a : POP EDI
0043305b : POP ESI
0043305c : POP EBX
0043305d : MOV ESP,EBP
0043305f : POP EBP
00433060 : RET

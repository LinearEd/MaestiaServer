PROGRAM  : Maestia.exe
FUNCTION : FUN_006e5310
ENTRY    : 006e5310
BODY     : [[006e5310, 006e5589]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006e5310(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  undefined1 *puVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  int iVar8;
  byte *pbVar9;
  int iVar10;
  undefined4 *puVar11;
  byte *pbVar12;
  byte *pbVar13;
  int local_c;
  
  iVar2 = *(int *)(param_2 + 0x1c);
  puVar11 = (undefined4 *)(param_3 + -4);
  FUN_006e4f00(puVar11,*(int *)(param_1 + 0xdc) + 2);
  iVar10 = *(int *)(param_1 + 0xb4) * -0x50 + 0x4000;
  iVar8 = *(int *)(param_1 + 0xb4) * 0x10;
  local_c = 0;
  if (0 < *(int *)(param_2 + 0xc)) {
    do {
      pbVar3 = (byte *)puVar11[2];
      puVar4 = *(undefined1 **)(param_4 + local_c * 4);
      pbVar5 = (byte *)puVar11[1];
      pbVar6 = (byte *)*puVar11;
      pbVar7 = (byte *)puVar11[3];
      pbVar9 = pbVar5 + 2;
      pbVar13 = pbVar7 + 2;
      pbVar12 = pbVar6 + 2;
      *puVar4 = (char)(((uint)*pbVar13 +
                       (uint)*pbVar12 + (uint)*pbVar6 +
                       ((uint)*pbVar9 +
                        (uint)pbVar3[2] + (uint)*pbVar5 + (uint)pbVar7[1] + (uint)pbVar6[1] +
                        (uint)*pbVar3 + (uint)*pbVar6) * 2 + (uint)*pbVar7 * 3) * iVar8 + 0x8000 +
                       ((uint)pbVar5[1] + (uint)pbVar3[1] + (uint)*pbVar5 + (uint)*pbVar3) * iVar10
                      >> 0x10);
      iVar1 = iVar2 * 8 + -2;
      while( true ) {
        puVar4 = puVar4 + 1;
        pbVar3 = pbVar3 + 2;
        if (iVar1 == 0) break;
        *puVar4 = (char)(((uint)pbVar13[-1] +
                          ((uint)pbVar13[1] + (uint)pbVar12[1] + (uint)pbVar3[-1] + (uint)pbVar9[-1]
                           + (uint)*pbVar13 + (uint)pbVar3[2] + (uint)*pbVar12 + (uint)pbVar9[2]) *
                          2 + (uint)pbVar12[-1] + (uint)pbVar12[2] + (uint)pbVar13[2]) * iVar8 +
                         0x8000 + ((uint)pbVar3[1] + (uint)pbVar9[1] + (uint)*pbVar3 + (uint)*pbVar9
                                  ) * iVar10 >> 0x10);
        pbVar9 = pbVar9 + 2;
        pbVar12 = pbVar12 + 2;
        pbVar13 = pbVar13 + 2;
        iVar1 = iVar1 + -1;
      }
      *puVar4 = (char)(((uint)pbVar12[-1] +
                       (uint)pbVar13[-1] + (uint)pbVar12[1] +
                       ((uint)*pbVar12 +
                        (uint)*pbVar13 + (uint)pbVar9[1] + (uint)pbVar3[-1] + (uint)pbVar9[-1] +
                        (uint)pbVar3[1] + (uint)pbVar12[1]) * 2 + (uint)pbVar13[1] * 3) * iVar8 +
                       0x8000 + ((uint)*pbVar9 + (uint)*pbVar3 + (uint)pbVar9[1] + (uint)pbVar3[1])
                                * iVar10 >> 0x10);
      local_c = local_c + 1;
      puVar11 = puVar11 + 2;
    } while (local_c < *(int *)(param_2 + 0xc));
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006e5310 : SUB ESP,0x28
006e5313 : MOV EAX,dword ptr [ESP + 0x30]
006e5317 : PUSH EBX
006e5318 : PUSH EBP
006e5319 : MOV EBP,dword ptr [ESP + 0x3c]
006e531d : PUSH ESI
006e531e : MOV ESI,dword ptr [EAX + 0x1c]
006e5321 : PUSH EDI
006e5322 : MOV EDI,dword ptr [ESP + 0x3c]
006e5326 : MOV ECX,dword ptr [EDI + 0xdc]
006e532c : MOV EBX,dword ptr [EDI + 0x1c]
006e532f : ADD ESI,ESI
006e5331 : ADD ECX,0x2
006e5334 : ADD ESI,ESI
006e5336 : PUSH ECX
006e5337 : ADD ESI,ESI
006e5339 : ADD EBP,-0x4
006e533c : LEA EAX,[ESI + ESI*0x1]
006e533f : PUSH EBP
006e5340 : CALL 0x006e4f00
006e5345 : MOV EAX,dword ptr [EDI + 0xb4]
006e534b : LEA EDX,[EAX + EAX*0x4]
006e534e : SHL EDX,0x4
006e5351 : MOV ECX,0x4000
006e5356 : SUB ECX,EDX
006e5358 : SHL EAX,0x4
006e535b : MOV dword ptr [ESP + 0x44],ECX
006e535f : MOV dword ptr [ESP + 0x4c],EAX
006e5363 : MOV EAX,dword ptr [ESP + 0x48]
006e5367 : XOR ECX,ECX
006e5369 : ADD ESP,0x8
006e536c : CMP dword ptr [EAX + 0xc],ECX
006e536f : MOV dword ptr [ESP + 0x2c],ECX
006e5373 : JLE 0x006e5582
006e5379 : ADD ESI,-0x2
006e537c : MOV dword ptr [ESP + 0x34],ESI
006e5380 : MOV EAX,EBP
006e5382 : MOV dword ptr [ESP + 0x28],EBP
006e5386 : MOV EBX,dword ptr [EAX + 0x8]
006e5389 : MOV EDX,dword ptr [ESP + 0x48]
006e538d : MOV ESI,dword ptr [EDX + ECX*0x4]
006e5390 : MOV EDX,dword ptr [EAX + 0x4]
006e5393 : MOV ECX,dword ptr [EAX]
006e5395 : MOV EAX,dword ptr [EAX + 0xc]
006e5398 : LEA EBP,[EDX + 0x2]
006e539b : MOV dword ptr [ESP + 0x1c],EBP
006e539f : MOVZX EBP,byte ptr [EAX]
006e53a2 : MOV dword ptr [ESP + 0x10],EBP
006e53a6 : MOVZX EBP,byte ptr [ECX]
006e53a9 : MOV dword ptr [ESP + 0x30],EBP
006e53ad : MOVZX EBP,byte ptr [EBX]
006e53b0 : MOV dword ptr [ESP + 0x18],EBP
006e53b4 : MOVZX EBP,byte ptr [EDX]
006e53b7 : MOV dword ptr [ESP + 0x14],EBP
006e53bb : LEA EBP,[EAX + 0x2]
006e53be : MOVZX EAX,byte ptr [EAX + 0x1]
006e53c2 : MOV dword ptr [ESP + 0x24],EBP
006e53c6 : LEA EBP,[ECX + 0x2]
006e53c9 : MOVZX ECX,byte ptr [ECX + 0x1]
006e53cd : ADD EAX,ECX
006e53cf : MOVZX ECX,byte ptr [EBX + 0x2]
006e53d3 : ADD ECX,dword ptr [ESP + 0x14]
006e53d7 : MOVZX EDX,byte ptr [EDX + 0x1]
006e53db : ADD ECX,EAX
006e53dd : MOV EAX,dword ptr [ESP + 0x30]
006e53e1 : MOV dword ptr [ESP + 0x20],EBP
006e53e5 : MOV EBP,dword ptr [ESP + 0x1c]
006e53e9 : MOVZX EBP,byte ptr [EBP]
006e53ed : LEA EDI,[EBX + 0x2]
006e53f0 : ADD EBP,ECX
006e53f2 : MOV ECX,dword ptr [ESP + 0x20]
006e53f6 : MOVZX ECX,byte ptr [ECX]
006e53f9 : ADD EBP,dword ptr [ESP + 0x18]
006e53fd : ADD ECX,EAX
006e53ff : ADD EBP,EAX
006e5401 : ADD EBP,dword ptr [ESP + 0x10]
006e5405 : MOV EAX,dword ptr [ESP + 0x24]
006e5409 : MOVZX EAX,byte ptr [EAX]
006e540c : LEA ECX,[ECX + EBP*0x2]
006e540f : ADD EAX,ECX
006e5411 : MOVZX ECX,byte ptr [EBX + 0x1]
006e5415 : ADD ECX,dword ptr [ESP + 0x14]
006e5419 : ADD EAX,dword ptr [ESP + 0x10]
006e541d : ADD EDX,ECX
006e541f : ADD EDX,dword ptr [ESP + 0x18]
006e5423 : IMUL EAX,dword ptr [ESP + 0x44]
006e5428 : IMUL EDX,dword ptr [ESP + 0x3c]
006e542d : LEA EAX,[EAX + EDX*0x1 + 0x8000]
006e5434 : MOV EDX,dword ptr [ESP + 0x34]
006e5438 : SAR EAX,0x10
006e543b : MOV byte ptr [ESI],AL
006e543d : MOV EAX,dword ptr [ESP + 0x1c]
006e5441 : INC ESI
006e5442 : MOV ECX,EDI
006e5444 : MOV EDI,dword ptr [ESP + 0x24]
006e5448 : MOV dword ptr [ESP + 0x10],ESI
006e544c : MOV ESI,dword ptr [ESP + 0x20]
006e5450 : MOV dword ptr [ESP + 0x24],EDX
006e5454 : TEST EDX,EDX
006e5456 : JBE 0x006e54f0
006e545c : LEA ESP,[ESP]
006e5460 : MOVZX EBX,byte ptr [ESI + 0x1]
006e5464 : MOVZX EDX,byte ptr [EDI + 0x1]
006e5468 : ADD EDX,EBX
006e546a : MOVZX EBX,byte ptr [ECX + -0x1]
006e546e : ADD EDX,EBX
006e5470 : MOVZX EBX,byte ptr [EAX + -0x1]
006e5474 : ADD EDX,EBX
006e5476 : MOVZX EBX,byte ptr [EDI]
006e5479 : ADD EDX,EBX
006e547b : MOVZX EBX,byte ptr [ECX + 0x2]
006e547f : ADD EDX,EBX
006e5481 : MOVZX EBX,byte ptr [ESI]
006e5484 : ADD EDX,EBX
006e5486 : MOVZX EBX,byte ptr [EAX + 0x2]
006e548a : ADD EDX,EBX
006e548c : MOVZX EBX,byte ptr [EDI + -0x1]
006e5490 : MOVZX EBP,byte ptr [EAX + 0x1]
006e5494 : LEA EDX,[EBX + EDX*0x2]
006e5497 : MOVZX EBX,byte ptr [ESI + -0x1]
006e549b : ADD EDX,EBX
006e549d : MOVZX EBX,byte ptr [ESI + 0x2]
006e54a1 : ADD EDX,EBX
006e54a3 : MOVZX EBX,byte ptr [EDI + 0x2]
006e54a7 : ADD EDX,EBX
006e54a9 : MOVZX EBX,byte ptr [ECX + 0x1]
006e54ad : IMUL EDX,dword ptr [ESP + 0x44]
006e54b2 : ADD EBX,EBP
006e54b4 : MOVZX EBP,byte ptr [ECX]
006e54b7 : ADD EBX,EBP
006e54b9 : MOVZX EBP,byte ptr [EAX]
006e54bc : ADD EBX,EBP
006e54be : IMUL EBX,dword ptr [ESP + 0x3c]
006e54c3 : MOV EBP,dword ptr [ESP + 0x10]
006e54c7 : LEA EDX,[EDX + EBX*0x1 + 0x8000]
006e54ce : SAR EDX,0x10
006e54d1 : MOV byte ptr [EBP],DL
006e54d4 : INC EBP
006e54d5 : ADD EAX,0x2
006e54d8 : ADD ECX,0x2
006e54db : ADD ESI,0x2
006e54de : ADD EDI,0x2
006e54e1 : SUB dword ptr [ESP + 0x24],0x1
006e54e6 : MOV dword ptr [ESP + 0x10],EBP
006e54ea : JNZ 0x006e5460
006e54f0 : MOVZX EBX,byte ptr [ECX + -0x1]
006e54f4 : MOVZX EBP,byte ptr [EAX + -0x1]
006e54f8 : MOVZX EDX,byte ptr [EAX + 0x1]
006e54fc : ADD EBX,EBP
006e54fe : MOVZX EBP,byte ptr [EDI]
006e5501 : ADD EBP,EDX
006e5503 : MOV dword ptr [ESP + 0x24],EDX
006e5507 : MOVZX EDX,byte ptr [ESI]
006e550a : ADD EBP,EBX
006e550c : MOVZX EBX,byte ptr [ESI + 0x1]
006e5510 : MOVZX ESI,byte ptr [ESI + -0x1]
006e5514 : ADD EDX,EBP
006e5516 : MOV EBP,EDX
006e5518 : MOVZX EDX,byte ptr [ECX + 0x1]
006e551c : MOVZX ECX,byte ptr [ECX]
006e551f : ADD ECX,dword ptr [ESP + 0x24]
006e5523 : ADD EBP,EDX
006e5525 : MOV dword ptr [ESP + 0x20],EDX
006e5529 : MOVZX EDX,byte ptr [EDI + 0x1]
006e552d : MOVZX EDI,byte ptr [EDI + -0x1]
006e5531 : ADD EBP,EBX
006e5533 : ADD EBP,EDX
006e5535 : ADD EDI,EBX
006e5537 : LEA EDI,[EDI + EBP*0x2]
006e553a : ADD ESI,EDI
006e553c : ADD ESI,EDX
006e553e : MOVZX EDX,byte ptr [EAX]
006e5541 : IMUL ESI,dword ptr [ESP + 0x44]
006e5546 : ADD EDX,ECX
006e5548 : ADD EDX,dword ptr [ESP + 0x20]
006e554c : MOV ECX,dword ptr [ESP + 0x10]
006e5550 : IMUL EDX,dword ptr [ESP + 0x3c]
006e5555 : LEA EAX,[ESI + EDX*0x1 + 0x8000]
006e555c : MOV EDX,dword ptr [ESP + 0x40]
006e5560 : SAR EAX,0x10
006e5563 : MOV byte ptr [ECX],AL
006e5565 : MOV ECX,dword ptr [ESP + 0x2c]
006e5569 : MOV EAX,dword ptr [ESP + 0x28]
006e556d : INC ECX
006e556e : ADD EAX,0x8
006e5571 : CMP ECX,dword ptr [EDX + 0xc]
006e5574 : MOV dword ptr [ESP + 0x28],EAX
006e5578 : MOV dword ptr [ESP + 0x2c],ECX
006e557c : JL 0x006e5386
006e5582 : POP EDI
006e5583 : POP ESI
006e5584 : POP EBP
006e5585 : POP EBX
006e5586 : ADD ESP,0x28
006e5589 : RET

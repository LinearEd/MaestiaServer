PROGRAM  : Maestia.exe
FUNCTION : FUN_0060bd80
ENTRY    : 0060bd80
BODY     : [[0060bd80, 0060bec8] [0060bed0, 0060c225]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0060bd80(void)

{
  undefined4 *puVar1;
  undefined2 uVar2;
  uint *puVar3;
  int iVar4;
  uint uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  int in_ECX;
  uint uVar8;
  uint local_40;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  uint *local_4;
  
  local_40 = 0;
  if (*(int *)(in_ECX + 0x4c) != 0) {
    puVar1 = (undefined4 *)(in_ECX + 8);
    do {
      puVar3 = (uint *)*puVar1;
      iVar4 = *(int *)(*(int *)(in_ECX + 0x58) + (local_40 >> 6) * 4);
      uVar2 = *(undefined2 *)(iVar4 + (local_40 & 0x3f) * 8);
      iVar4 = iVar4 + (local_40 & 0x3f) * 8;
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        FUN_00609600(uVar8);
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)uVar2;
      *puVar3 = *puVar3 + 1;
      puVar3 = (uint *)*puVar1;
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        FUN_00609600(uVar8);
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)((ushort)uVar2 >> 8);
      *puVar3 = *puVar3 + 1;
      puVar3 = (uint *)*puVar1;
      uVar2 = *(undefined2 *)(iVar4 + 2);
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        FUN_00609600(uVar8);
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)uVar2;
      *puVar3 = *puVar3 + 1;
      puVar3 = (uint *)*puVar1;
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        FUN_00609600(uVar8);
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)((ushort)uVar2 >> 8);
      *puVar3 = *puVar3 + 1;
      FUN_0060a410(*(undefined4 *)(iVar4 + 4));
      local_40 = local_40 + 1;
    } while (local_40 < *(uint *)(in_ECX + 0x4c));
  }
  puVar3 = (uint *)(in_ECX + 0x5c);
  local_4 = puVar3;
  FUN_00609700(puVar3,0,*(undefined4 *)(in_ECX + 0x5c),&LAB_00608d90);
  puVar1 = (undefined4 *)(in_ECX + 8);
  FUN_0060a600(*puVar3);
  local_40 = 0;
  if (*puVar3 != 0) {
    do {
      puVar3 = (uint *)*puVar1;
      iVar4 = *(int *)(*(int *)(in_ECX + 0x68) + (local_40 >> 6) * 4);
      uVar2 = *(undefined2 *)(iVar4 + (local_40 & 0x3f) * 8);
      iVar4 = iVar4 + (local_40 & 0x3f) * 8;
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        if (puVar3[2] <= uVar8) {
          if (puVar3[3] == 0) {
            local_34 = 0x105;
            uVar5 = FUN_00515d60(puVar3,0x400,&local_34);
          }
          else {
            uVar5 = FUN_00515c80(puVar3[3],puVar3[2] * 4 + 0x400);
          }
          puVar3[2] = puVar3[2] + 0x100;
          puVar3[3] = uVar5;
        }
        local_30 = 0x105;
        uVar6 = FUN_00515d60(puVar3,0x1000,&local_30);
        *(undefined4 *)(puVar3[3] + uVar8 * 4) = uVar6;
        puVar3[1] = puVar3[1] + 1;
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)uVar2;
      *puVar3 = *puVar3 + 1;
      puVar3 = (uint *)*puVar1;
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        if (puVar3[2] <= uVar8) {
          if (puVar3[3] == 0) {
            local_2c = 0x105;
            uVar5 = FUN_00515d60(puVar3,0x400,&local_2c);
          }
          else {
            uVar5 = FUN_00515c80(puVar3[3],puVar3[2] * 4 + 0x400);
          }
          puVar3[2] = puVar3[2] + 0x100;
          puVar3[3] = uVar5;
        }
        local_28 = 0x105;
        uVar6 = FUN_00515d60(puVar3,0x1000,&local_28);
        *(undefined4 *)(puVar3[3] + uVar8 * 4) = uVar6;
        puVar3[1] = puVar3[1] + 1;
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)((ushort)uVar2 >> 8);
      *puVar3 = *puVar3 + 1;
      puVar3 = (uint *)*puVar1;
      uVar2 = *(undefined2 *)(iVar4 + 2);
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        if (puVar3[2] <= uVar8) {
          if (puVar3[3] == 0) {
            local_24 = 0x105;
            uVar5 = FUN_00515d60(puVar3,0x400,&local_24);
          }
          else {
            uVar5 = FUN_00515c80(puVar3[3],puVar3[2] * 4 + 0x400);
          }
          puVar3[2] = puVar3[2] + 0x100;
          puVar3[3] = uVar5;
        }
        local_20 = 0x105;
        uVar6 = FUN_00515d60(puVar3,0x1000,&local_20);
        *(undefined4 *)(puVar3[3] + uVar8 * 4) = uVar6;
        puVar3[1] = puVar3[1] + 1;
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)uVar2;
      *puVar3 = *puVar3 + 1;
      puVar3 = (uint *)*puVar1;
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        if (puVar3[2] <= uVar8) {
          if (puVar3[3] == 0) {
            local_1c = 0x105;
            uVar5 = FUN_00515d60(puVar3,0x400,&local_1c);
          }
          else {
            uVar5 = FUN_00515c80(puVar3[3],puVar3[2] * 4 + 0x400);
          }
          puVar3[2] = puVar3[2] + 0x100;
          puVar3[3] = uVar5;
        }
        local_18 = 0x105;
        uVar6 = FUN_00515d60(puVar3,0x1000,&local_18);
        *(undefined4 *)(puVar3[3] + uVar8 * 4) = uVar6;
        puVar3[1] = puVar3[1] + 1;
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)((ushort)uVar2 >> 8);
      *puVar3 = *puVar3 + 1;
      puVar3 = (uint *)*puVar1;
      uVar6 = *(undefined4 *)(iVar4 + 4);
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        if (puVar3[2] <= uVar8) {
          if (puVar3[3] == 0) {
            local_14 = 0x105;
            uVar5 = FUN_00515d60(puVar3,0x400,&local_14);
          }
          else {
            uVar5 = FUN_00515c80(puVar3[3],puVar3[2] * 4 + 0x400);
          }
          puVar3[2] = puVar3[2] + 0x100;
          puVar3[3] = uVar5;
        }
        local_10 = 0x105;
        uVar7 = FUN_00515d60(puVar3,0x1000,&local_10);
        *(undefined4 *)(puVar3[3] + uVar8 * 4) = uVar7;
        puVar3[1] = puVar3[1] + 1;
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)uVar6;
      *puVar3 = *puVar3 + 1;
      puVar3 = (uint *)*puVar1;
      uVar8 = *puVar3 >> 0xc;
      if (puVar3[1] <= uVar8) {
        if (puVar3[2] <= uVar8) {
          if (puVar3[3] == 0) {
            local_c = 0x105;
            uVar5 = FUN_00515d60(puVar3,0x400,&local_c);
          }
          else {
            uVar5 = FUN_00515c80(puVar3[3],puVar3[2] * 4 + 0x400);
          }
          puVar3[2] = puVar3[2] + 0x100;
          puVar3[3] = uVar5;
        }
        local_8 = 0x105;
        uVar7 = FUN_00515d60(puVar3,0x1000,&local_8);
        *(undefined4 *)(puVar3[3] + uVar8 * 4) = uVar7;
        puVar3[1] = puVar3[1] + 1;
      }
      *(char *)((*puVar3 & 0xfff) + *(int *)(puVar3[3] + uVar8 * 4)) = (char)((uint)uVar6 >> 8);
      *puVar3 = *puVar3 + 1;
      local_40 = local_40 + 1;
    } while (local_40 < *local_4);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0060bd80 : SUB ESP,0x40
0060bd83 : PUSH EBX
0060bd84 : PUSH EBP
0060bd85 : PUSH ESI
0060bd86 : MOV ESI,ECX
0060bd88 : XOR EAX,EAX
0060bd8a : PUSH EDI
0060bd8b : MOV dword ptr [ESP + 0x14],ESI
0060bd8f : MOV dword ptr [ESP + 0x10],EAX
0060bd93 : CMP dword ptr [ESI + 0x4c],EAX
0060bd96 : JBE 0x0060be91
0060bd9c : LEA EBP,[ESI + 0x8]
0060bd9f : JMP 0x0060bda5
0060bda1 : MOV EAX,dword ptr [ESP + 0x10]
0060bda5 : MOV EDX,dword ptr [ESI + 0x58]
0060bda8 : MOV ESI,dword ptr [EBP]
0060bdab : MOV EDI,dword ptr [ESI]
0060bdad : MOV ECX,EAX
0060bdaf : SHR ECX,0x6
0060bdb2 : MOV ECX,dword ptr [EDX + ECX*0x4]
0060bdb5 : AND EAX,0x3f
0060bdb8 : MOVZX EBX,word ptr [ECX + EAX*0x8]
0060bdbc : LEA EAX,[ECX + EAX*0x8]
0060bdbf : SHR EDI,0xc
0060bdc2 : MOV dword ptr [ESP + 0x18],EAX
0060bdc6 : CMP EDI,dword ptr [ESI + 0x4]
0060bdc9 : JC 0x0060bdd3
0060bdcb : PUSH EDI
0060bdcc : MOV ECX,ESI
0060bdce : CALL 0x00609600
0060bdd3 : MOV EAX,dword ptr [ESI]
0060bdd5 : MOV EDX,dword ptr [ESI + 0xc]
0060bdd8 : MOV ECX,dword ptr [EDX + EDI*0x4]
0060bddb : AND EAX,0xfff
0060bde0 : MOV byte ptr [EAX + ECX*0x1],BL
0060bde3 : INC dword ptr [ESI]
0060bde5 : MOV ESI,dword ptr [EBP]
0060bde8 : MOV EDI,dword ptr [ESI]
0060bdea : SHR EDI,0xc
0060bded : SHR EBX,0x8
0060bdf0 : CMP EDI,dword ptr [ESI + 0x4]
0060bdf3 : JC 0x0060bdfd
0060bdf5 : PUSH EDI
0060bdf6 : MOV ECX,ESI
0060bdf8 : CALL 0x00609600
0060bdfd : MOV EDX,dword ptr [ESI + 0xc]
0060be00 : MOV EAX,dword ptr [ESI]
0060be02 : MOV ECX,dword ptr [EDX + EDI*0x4]
0060be05 : MOV EDX,dword ptr [ESP + 0x18]
0060be09 : AND EAX,0xfff
0060be0e : MOV byte ptr [EAX + ECX*0x1],BL
0060be11 : INC dword ptr [ESI]
0060be13 : MOV ESI,dword ptr [EBP]
0060be16 : MOV EDI,dword ptr [ESI]
0060be18 : MOVSX EBX,word ptr [EDX + 0x2]
0060be1c : SHR EDI,0xc
0060be1f : CMP EDI,dword ptr [ESI + 0x4]
0060be22 : JC 0x0060be2c
0060be24 : PUSH EDI
0060be25 : MOV ECX,ESI
0060be27 : CALL 0x00609600
0060be2c : MOV ECX,dword ptr [ESI]
0060be2e : MOV EAX,dword ptr [ESI + 0xc]
0060be31 : MOV EDX,dword ptr [EAX + EDI*0x4]
0060be34 : AND ECX,0xfff
0060be3a : MOV byte ptr [ECX + EDX*0x1],BL
0060be3d : INC dword ptr [ESI]
0060be3f : MOV ESI,dword ptr [EBP]
0060be42 : MOV EDI,dword ptr [ESI]
0060be44 : SHR EDI,0xc
0060be47 : SAR EBX,0x8
0060be4a : CMP EDI,dword ptr [ESI + 0x4]
0060be4d : JC 0x0060be57
0060be4f : PUSH EDI
0060be50 : MOV ECX,ESI
0060be52 : CALL 0x00609600
0060be57 : MOV EAX,dword ptr [ESI + 0xc]
0060be5a : MOV ECX,dword ptr [ESI]
0060be5c : MOV EDX,dword ptr [EAX + EDI*0x4]
0060be5f : MOV EAX,dword ptr [ESP + 0x18]
0060be63 : AND ECX,0xfff
0060be69 : MOV byte ptr [ECX + EDX*0x1],BL
0060be6c : INC dword ptr [ESI]
0060be6e : MOV ECX,dword ptr [EAX + 0x4]
0060be71 : PUSH ECX
0060be72 : MOV ECX,EBP
0060be74 : CALL 0x0060a410
0060be79 : MOV EAX,dword ptr [ESP + 0x10]
0060be7d : MOV EDX,dword ptr [ESP + 0x14]
0060be81 : INC EAX
0060be82 : MOV dword ptr [ESP + 0x10],EAX
0060be86 : MOV ESI,EDX
0060be88 : CMP EAX,dword ptr [EDX + 0x4c]
0060be8b : JC 0x0060bda1
0060be91 : MOV EAX,dword ptr [ESI + 0x5c]
0060be94 : LEA EDI,[ESI + 0x5c]
0060be97 : PUSH 0x608d90
0060be9c : PUSH EAX
0060be9d : PUSH 0x0
0060be9f : PUSH EDI
0060bea0 : MOV dword ptr [ESP + 0x5c],EDI
0060bea4 : CALL 0x00609700
0060bea9 : MOV ECX,dword ptr [EDI]
0060beab : ADD ESP,0x10
0060beae : LEA EBP,[ESI + 0x8]
0060beb1 : PUSH ECX
0060beb2 : MOV ECX,EBP
0060beb4 : CALL 0x0060a600
0060beb9 : XOR EAX,EAX
0060bebb : MOV dword ptr [ESP + 0x10],EAX
0060bebf : CMP dword ptr [EDI],EAX
0060bec1 : JBE 0x0060c21e
0060bec7 : JMP 0x0060bed4
0060bed0 : MOV ESI,dword ptr [ESP + 0x14]
0060bed4 : MOV ECX,dword ptr [ESI + 0x68]
0060bed7 : MOV ESI,dword ptr [EBP]
0060beda : MOV EDI,dword ptr [ESI]
0060bedc : MOV EDX,EAX
0060bede : SHR EDX,0x6
0060bee1 : MOV EDX,dword ptr [ECX + EDX*0x4]
0060bee4 : AND EAX,0x3f
0060bee7 : MOVZX EBX,word ptr [EDX + EAX*0x8]
0060beeb : LEA EAX,[EDX + EAX*0x8]
0060beee : SHR EDI,0xc
0060bef1 : MOV dword ptr [ESP + 0x18],EAX
0060bef5 : CMP EDI,dword ptr [ESI + 0x4]
0060bef8 : JC 0x0060bf5b
0060befa : MOV ECX,dword ptr [ESI + 0x8]
0060befd : CMP EDI,ECX
0060beff : JC 0x0060bf3a
0060bf01 : MOV EAX,dword ptr [ESI + 0xc]
0060bf04 : TEST EAX,EAX
0060bf06 : JZ 0x0060bf18
0060bf08 : LEA ECX,[ECX*0x4 + 0x400]
0060bf0f : PUSH ECX
0060bf10 : PUSH EAX
0060bf11 : CALL 0x00515c80
0060bf16 : JMP 0x0060bf30
0060bf18 : LEA EAX,[ESP + 0x1c]
0060bf1c : PUSH EAX
0060bf1d : PUSH 0x400
0060bf22 : PUSH ESI
0060bf23 : MOV dword ptr [ESP + 0x28],0x105
0060bf2b : CALL 0x00515d60
0060bf30 : ADD dword ptr [ESI + 0x8],0x100
0060bf37 : MOV dword ptr [ESI + 0xc],EAX
0060bf3a : LEA ECX,[ESP + 0x20]
0060bf3e : PUSH ECX
0060bf3f : PUSH 0x1000
0060bf44 : PUSH ESI
0060bf45 : MOV dword ptr [ESP + 0x2c],0x105
0060bf4d : CALL 0x00515d60
0060bf52 : MOV EDX,dword ptr [ESI + 0xc]
0060bf55 : MOV dword ptr [EDX + EDI*0x4],EAX
0060bf58 : INC dword ptr [ESI + 0x4]
0060bf5b : MOV ECX,dword ptr [ESI]
0060bf5d : MOV EAX,dword ptr [ESI + 0xc]
0060bf60 : MOV EDX,dword ptr [EAX + EDI*0x4]
0060bf63 : AND ECX,0xfff
0060bf69 : MOV byte ptr [ECX + EDX*0x1],BL
0060bf6c : INC dword ptr [ESI]
0060bf6e : MOV ESI,dword ptr [EBP]
0060bf71 : MOV EDI,dword ptr [ESI]
0060bf73 : SHR EDI,0xc
0060bf76 : SHR EBX,0x8
0060bf79 : CMP EDI,dword ptr [ESI + 0x4]
0060bf7c : JC 0x0060bfdf
0060bf7e : MOV ECX,dword ptr [ESI + 0x8]
0060bf81 : CMP EDI,ECX
0060bf83 : JC 0x0060bfbe
0060bf85 : MOV EAX,dword ptr [ESI + 0xc]
0060bf88 : TEST EAX,EAX
0060bf8a : JZ 0x0060bf9c
0060bf8c : LEA ECX,[ECX*0x4 + 0x400]
0060bf93 : PUSH ECX
0060bf94 : PUSH EAX
0060bf95 : CALL 0x00515c80
0060bf9a : JMP 0x0060bfb4
0060bf9c : LEA EAX,[ESP + 0x24]
0060bfa0 : PUSH EAX
0060bfa1 : PUSH 0x400
0060bfa6 : PUSH ESI
0060bfa7 : MOV dword ptr [ESP + 0x30],0x105
0060bfaf : CALL 0x00515d60
0060bfb4 : ADD dword ptr [ESI + 0x8],0x100
0060bfbb : MOV dword ptr [ESI + 0xc],EAX
0060bfbe : LEA ECX,[ESP + 0x28]
0060bfc2 : PUSH ECX
0060bfc3 : PUSH 0x1000
0060bfc8 : PUSH ESI
0060bfc9 : MOV dword ptr [ESP + 0x34],0x105
0060bfd1 : CALL 0x00515d60
0060bfd6 : MOV EDX,dword ptr [ESI + 0xc]
0060bfd9 : MOV dword ptr [EDX + EDI*0x4],EAX
0060bfdc : INC dword ptr [ESI + 0x4]
0060bfdf : MOV EAX,dword ptr [ESI + 0xc]
0060bfe2 : MOV ECX,dword ptr [ESI]
0060bfe4 : MOV EDX,dword ptr [EAX + EDI*0x4]
0060bfe7 : MOV EAX,dword ptr [ESP + 0x18]
0060bfeb : AND ECX,0xfff
0060bff1 : MOV byte ptr [ECX + EDX*0x1],BL
0060bff4 : INC dword ptr [ESI]
0060bff6 : MOV ESI,dword ptr [EBP]
0060bff9 : MOV EDI,dword ptr [ESI]
0060bffb : MOVZX EBX,word ptr [EAX + 0x2]
0060bfff : SHR EDI,0xc
0060c002 : CMP EDI,dword ptr [ESI + 0x4]
0060c005 : JC 0x0060c068
0060c007 : MOV ECX,dword ptr [ESI + 0x8]
0060c00a : CMP EDI,ECX
0060c00c : JC 0x0060c047
0060c00e : MOV EAX,dword ptr [ESI + 0xc]
0060c011 : TEST EAX,EAX
0060c013 : JZ 0x0060c025
0060c015 : LEA ECX,[ECX*0x4 + 0x400]
0060c01c : PUSH ECX
0060c01d : PUSH EAX
0060c01e : CALL 0x00515c80
0060c023 : JMP 0x0060c03d
0060c025 : LEA ECX,[ESP + 0x2c]
0060c029 : PUSH ECX
0060c02a : PUSH 0x400
0060c02f : PUSH ESI
0060c030 : MOV dword ptr [ESP + 0x38],0x105
0060c038 : CALL 0x00515d60
0060c03d : ADD dword ptr [ESI + 0x8],0x100
0060c044 : MOV dword ptr [ESI + 0xc],EAX
0060c047 : LEA EDX,[ESP + 0x30]
0060c04b : PUSH EDX
0060c04c : PUSH 0x1000
0060c051 : PUSH ESI
0060c052 : MOV dword ptr [ESP + 0x3c],0x105
0060c05a : CALL 0x00515d60
0060c05f : MOV ECX,dword ptr [ESI + 0xc]
0060c062 : MOV dword ptr [ECX + EDI*0x4],EAX
0060c065 : INC dword ptr [ESI + 0x4]
0060c068 : MOV EAX,dword ptr [ESI]
0060c06a : MOV EDX,dword ptr [ESI + 0xc]
0060c06d : MOV ECX,dword ptr [EDX + EDI*0x4]
0060c070 : AND EAX,0xfff
0060c075 : MOV byte ptr [EAX + ECX*0x1],BL
0060c078 : INC dword ptr [ESI]
0060c07a : MOV ESI,dword ptr [EBP]
0060c07d : MOV EDI,dword ptr [ESI]
0060c07f : SHR EDI,0xc
0060c082 : SHR EBX,0x8
0060c085 : CMP EDI,dword ptr [ESI + 0x4]
0060c088 : JC 0x0060c0eb
0060c08a : MOV ECX,dword ptr [ESI + 0x8]
0060c08d : CMP EDI,ECX
0060c08f : JC 0x0060c0ca
0060c091 : MOV EAX,dword ptr [ESI + 0xc]
0060c094 : TEST EAX,EAX
0060c096 : JZ 0x0060c0a8
0060c098 : LEA ECX,[ECX*0x4 + 0x400]
0060c09f : PUSH ECX
0060c0a0 : PUSH EAX
0060c0a1 : CALL 0x00515c80
0060c0a6 : JMP 0x0060c0c0
0060c0a8 : LEA EDX,[ESP + 0x34]
0060c0ac : PUSH EDX
0060c0ad : PUSH 0x400
0060c0b2 : PUSH ESI
0060c0b3 : MOV dword ptr [ESP + 0x40],0x105
0060c0bb : CALL 0x00515d60
0060c0c0 : ADD dword ptr [ESI + 0x8],0x100
0060c0c7 : MOV dword ptr [ESI + 0xc],EAX
0060c0ca : LEA EAX,[ESP + 0x38]
0060c0ce : PUSH EAX
0060c0cf : PUSH 0x1000
0060c0d4 : PUSH ESI
0060c0d5 : MOV dword ptr [ESP + 0x44],0x105
0060c0dd : CALL 0x00515d60
0060c0e2 : MOV ECX,dword ptr [ESI + 0xc]
0060c0e5 : MOV dword ptr [ECX + EDI*0x4],EAX
0060c0e8 : INC dword ptr [ESI + 0x4]
0060c0eb : MOV EDX,dword ptr [ESI + 0xc]
0060c0ee : MOV EAX,dword ptr [ESI]
0060c0f0 : MOV ECX,dword ptr [EDX + EDI*0x4]
0060c0f3 : MOV EDX,dword ptr [ESP + 0x18]
0060c0f7 : AND EAX,0xfff
0060c0fc : MOV byte ptr [EAX + ECX*0x1],BL
0060c0ff : INC dword ptr [ESI]
0060c101 : MOV ESI,dword ptr [EBP]
0060c104 : MOV EDI,dword ptr [ESI]
0060c106 : MOV EBX,dword ptr [EDX + 0x4]
0060c109 : SHR EDI,0xc
0060c10c : CMP EDI,dword ptr [ESI + 0x4]
0060c10f : JC 0x0060c172
0060c111 : MOV ECX,dword ptr [ESI + 0x8]
0060c114 : CMP EDI,ECX
0060c116 : JC 0x0060c151
0060c118 : MOV EAX,dword ptr [ESI + 0xc]
0060c11b : TEST EAX,EAX
0060c11d : JZ 0x0060c12f
0060c11f : LEA ECX,[ECX*0x4 + 0x400]
0060c126 : PUSH ECX
0060c127 : PUSH EAX
0060c128 : CALL 0x00515c80
0060c12d : JMP 0x0060c147
0060c12f : LEA EAX,[ESP + 0x3c]
0060c133 : PUSH EAX
0060c134 : PUSH 0x400
0060c139 : PUSH ESI
0060c13a : MOV dword ptr [ESP + 0x48],0x105
0060c142 : CALL 0x00515d60
0060c147 : ADD dword ptr [ESI + 0x8],0x100
0060c14e : MOV dword ptr [ESI + 0xc],EAX
0060c151 : LEA ECX,[ESP + 0x40]
0060c155 : PUSH ECX
0060c156 : PUSH 0x1000
0060c15b : PUSH ESI
0060c15c : MOV dword ptr [ESP + 0x4c],0x105
0060c164 : CALL 0x00515d60
0060c169 : MOV EDX,dword ptr [ESI + 0xc]
0060c16c : MOV dword ptr [EDX + EDI*0x4],EAX
0060c16f : INC dword ptr [ESI + 0x4]
0060c172 : MOV ECX,dword ptr [ESI]
0060c174 : MOV EAX,dword ptr [ESI + 0xc]
0060c177 : MOV EDX,dword ptr [EAX + EDI*0x4]
0060c17a : AND ECX,0xfff
0060c180 : MOV byte ptr [ECX + EDX*0x1],BL
0060c183 : INC dword ptr [ESI]
0060c185 : MOV ESI,dword ptr [EBP]
0060c188 : MOV EDI,dword ptr [ESI]
0060c18a : SHR EDI,0xc
0060c18d : SAR EBX,0x8
0060c190 : CMP EDI,dword ptr [ESI + 0x4]
0060c193 : JC 0x0060c1f6
0060c195 : MOV ECX,dword ptr [ESI + 0x8]
0060c198 : CMP EDI,ECX
0060c19a : JC 0x0060c1d5
0060c19c : MOV EAX,dword ptr [ESI + 0xc]
0060c19f : TEST EAX,EAX
0060c1a1 : JZ 0x0060c1b3
0060c1a3 : LEA ECX,[ECX*0x4 + 0x400]
0060c1aa : PUSH ECX
0060c1ab : PUSH EAX
0060c1ac : CALL 0x00515c80
0060c1b1 : JMP 0x0060c1cb
0060c1b3 : LEA EAX,[ESP + 0x44]
0060c1b7 : PUSH EAX
0060c1b8 : PUSH 0x400
0060c1bd : PUSH ESI
0060c1be : MOV dword ptr [ESP + 0x50],0x105
0060c1c6 : CALL 0x00515d60
0060c1cb : ADD dword ptr [ESI + 0x8],0x100
0060c1d2 : MOV dword ptr [ESI + 0xc],EAX
0060c1d5 : LEA ECX,[ESP + 0x48]
0060c1d9 : PUSH ECX
0060c1da : PUSH 0x1000
0060c1df : PUSH ESI
0060c1e0 : MOV dword ptr [ESP + 0x54],0x105
0060c1e8 : CALL 0x00515d60
0060c1ed : MOV EDX,dword ptr [ESI + 0xc]
0060c1f0 : MOV dword ptr [EDX + EDI*0x4],EAX
0060c1f3 : INC dword ptr [ESI + 0x4]
0060c1f6 : MOV EAX,dword ptr [ESI + 0xc]
0060c1f9 : MOV ECX,dword ptr [ESI]
0060c1fb : MOV EDX,dword ptr [EAX + EDI*0x4]
0060c1fe : MOV EAX,dword ptr [ESP + 0x10]
0060c202 : AND ECX,0xfff
0060c208 : MOV byte ptr [ECX + EDX*0x1],BL
0060c20b : MOV ECX,dword ptr [ESP + 0x4c]
0060c20f : INC dword ptr [ESI]
0060c211 : INC EAX
0060c212 : MOV dword ptr [ESP + 0x10],EAX
0060c216 : CMP EAX,dword ptr [ECX]
0060c218 : JC 0x0060bed0
0060c21e : POP EDI
0060c21f : POP ESI
0060c220 : POP EBP
0060c221 : POP EBX
0060c222 : ADD ESP,0x40
0060c225 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0087d430
ENTRY    : 0087d430
BODY     : [[0087d430, 0087d5d7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0087d430(int param_1)

{
  int iVar1;
  char cVar2;
  uint uVar3;
  undefined4 uVar4;
  int in_ECX;
  undefined1 local_54 [28];
  int local_38;
  int local_34;
  undefined1 local_30 [28];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar1 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b50c1a;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar3;
  if (param_1 != 0) {
    local_38 = param_1;
    FUN_004437f0(&local_38);
    if ((local_34 == *(int *)(iVar1 + 0x44)) || (iVar1 = *(int *)(local_34 + 0x10), iVar1 == 0)) {
      FUN_008018d0(L"[AvaTalkNpc::SetStore] ClZoneNpcSetData* pData NULL");
    }
    else {
      if (*(char *)(iVar1 + 0x9f) != '\0') {
        *(undefined1 *)(in_ECX + 0x5d0) = 1;
        *(undefined1 *)(in_ECX + 0x5d1) = 1;
      }
      if ((*(uint *)(iVar1 + 0xa0) & 0x800) != 0) {
        *(undefined1 *)(in_ECX + 0x5cf) = 1;
      }
      if (*(int *)(in_ECX + 0x16d0) == 1) {
        FUN_00405c00(in_ECX + 0xc);
        *(undefined1 *)(in_ECX + 0x5d0) = 1;
      }
      else {
        uVar4 = FUN_00404350(iVar1 + 0xa5,uVar3);
        local_8 = 0;
        FUN_00405eb0(uVar4,0,0xffffffff);
        local_8 = 0xffffffff;
        FUN_00406560();
        FUN_00824a20(DAT_0172491c,0);
        local_8 = 1;
        cVar2 = FUN_00404010();
        if (cVar2 == '\0') {
          FUN_00405eb0(local_30,0,0xffffffff);
        }
        else {
          uVar4 = FUN_00403450(local_54,in_ECX + 0xc);
          local_8._0_1_ = 2;
          FUN_00405eb0(uVar4,0,0xffffffff);
          local_8 = CONCAT31(local_8._1_3_,1);
          FUN_00406560();
        }
        if (*(int *)(in_ECX + 0x3f8) != 0) {
          FUN_007a6c40(*(undefined4 *)(in_ECX + 0x42c));
        }
        local_8 = 0xffffffff;
        FUN_00406560();
      }
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0087d430 : PUSH EBP
0087d431 : MOV EBP,ESP
0087d433 : PUSH -0x1
0087d435 : PUSH 0xb50c1a
0087d43a : MOV EAX,FS:[0x0]
0087d440 : PUSH EAX
0087d441 : SUB ESP,0x44
0087d444 : MOV EAX,[0x00d66fa0]
0087d449 : XOR EAX,EBP
0087d44b : MOV dword ptr [EBP + -0x10],EAX
0087d44e : PUSH EBX
0087d44f : PUSH ESI
0087d450 : PUSH EDI
0087d451 : PUSH EAX
0087d452 : LEA EAX,[EBP + -0xc]
0087d455 : MOV FS:[0x0],EAX
0087d45b : MOV EAX,dword ptr [EBP + 0x8]
0087d45e : MOV EBX,ECX
0087d460 : TEST EAX,EAX
0087d462 : JZ 0x0087d5ba
0087d468 : MOV ESI,dword ptr [0x00d7c54c]
0087d46e : MOV dword ptr [EBP + -0x34],EAX
0087d471 : LEA EAX,[EBP + -0x34]
0087d474 : PUSH EAX
0087d475 : LEA ECX,[ESI + 0x40]
0087d478 : LEA EAX,[EBP + -0x30]
0087d47b : CALL 0x004437f0
0087d480 : MOV ESI,dword ptr [ESI + 0x44]
0087d483 : MOV EAX,dword ptr [EBP + -0x30]
0087d486 : CMP EAX,ESI
0087d488 : JZ 0x0087d491
0087d48a : MOV EDI,dword ptr [EAX + 0x10]
0087d48d : TEST EDI,EDI
0087d48f : JNZ 0x0087d4a9
0087d491 : MOV ESI,dword ptr [0x00da98e8]
0087d497 : PUSH 0xc443a0
0087d49c : CALL 0x008018d0
0087d4a1 : ADD ESP,0x4
0087d4a4 : JMP 0x0087d5ba
0087d4a9 : CMP byte ptr [EDI + 0x9f],0x0
0087d4b0 : JZ 0x0087d4c0
0087d4b2 : MOV byte ptr [EBX + 0x5d0],0x1
0087d4b9 : MOV byte ptr [EBX + 0x5d1],0x1
0087d4c0 : TEST dword ptr [EDI + 0xa0],0x800
0087d4ca : JZ 0x0087d4d3
0087d4cc : MOV byte ptr [EBX + 0x5cf],0x1
0087d4d3 : CMP dword ptr [EBX + 0x16d0],0x1
0087d4da : JNZ 0x0087d4f6
0087d4dc : LEA ECX,[EBX + 0xc]
0087d4df : PUSH ECX
0087d4e0 : MOV EDX,0xc4439c
0087d4e5 : CALL 0x00405c00
0087d4ea : MOV byte ptr [EBX + 0x5d0],0x1
0087d4f1 : JMP 0x0087d5ba
0087d4f6 : LEA EDX,[EDI + 0xa5]
0087d4fc : PUSH EDX
0087d4fd : LEA ESI,[EBP + -0x50]
0087d500 : CALL 0x00404350
0087d505 : ADD ESP,0x4
0087d508 : MOV dword ptr [EBP + -0x4],0x0
0087d50f : PUSH -0x1
0087d511 : PUSH 0x0
0087d513 : PUSH EAX
0087d514 : LEA ECX,[EBX + 0x16a8]
0087d51a : CALL 0x00405eb0
0087d51f : MOV dword ptr [EBP + -0x4],0xffffffff
0087d526 : MOV ECX,ESI
0087d528 : CALL 0x00406560
0087d52d : MOV EAX,[0x0172491c]
0087d532 : PUSH 0x0
0087d534 : LEA EDX,[EDI + 0x18]
0087d537 : PUSH EAX
0087d538 : LEA ESI,[EBP + -0x2c]
0087d53b : CALL 0x00824a20
0087d540 : MOV dword ptr [EBP + -0x4],0x1
0087d547 : LEA EDI,[EBX + 0xc]
0087d54a : MOV EAX,EDI
0087d54c : MOV ECX,ESI
0087d54e : CALL 0x00404010
0087d553 : TEST AL,AL
0087d555 : JZ 0x0087d584
0087d557 : LEA ECX,[EBP + -0x50]
0087d55a : PUSH EDI
0087d55b : PUSH ECX
0087d55c : MOV ECX,ESI
0087d55e : CALL 0x00403450
0087d563 : ADD ESP,0x8
0087d566 : MOV byte ptr [EBP + -0x4],0x2
0087d56a : PUSH -0x1
0087d56c : PUSH 0x0
0087d56e : PUSH EAX
0087d56f : MOV ECX,EDI
0087d571 : CALL 0x00405eb0
0087d576 : MOV byte ptr [EBP + -0x4],0x1
0087d57a : LEA ECX,[EBP + -0x50]
0087d57d : CALL 0x00406560
0087d582 : JMP 0x0087d593
0087d584 : PUSH -0x1
0087d586 : PUSH 0x0
0087d588 : LEA EDX,[EBP + -0x2c]
0087d58b : PUSH EDX
0087d58c : MOV ECX,EDI
0087d58e : CALL 0x00405eb0
0087d593 : MOV ESI,dword ptr [EBX + 0x3f8]
0087d599 : TEST ESI,ESI
0087d59b : JZ 0x0087d5ab
0087d59d : MOV EAX,dword ptr [EBX + 0x42c]
0087d5a3 : PUSH EAX
0087d5a4 : MOV EAX,EDI
0087d5a6 : CALL 0x007a6c40
0087d5ab : MOV dword ptr [EBP + -0x4],0xffffffff
0087d5b2 : LEA ECX,[EBP + -0x2c]
0087d5b5 : CALL 0x00406560
0087d5ba : MOV ECX,dword ptr [EBP + -0xc]
0087d5bd : MOV dword ptr FS:[0x0],ECX
0087d5c4 : POP ECX
0087d5c5 : POP EDI
0087d5c6 : POP ESI
0087d5c7 : POP EBX
0087d5c8 : MOV ECX,dword ptr [EBP + -0x10]
0087d5cb : XOR ECX,EBP
0087d5cd : CALL 0x00633e6b
0087d5d2 : MOV ESP,EBP
0087d5d4 : POP EBP
0087d5d5 : RET 0x4

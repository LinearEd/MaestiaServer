PROGRAM  : Maestia.exe
FUNCTION : FUN_006dd6c0
ENTRY    : 006dd6c0
BODY     : [[006dd6c0, 006dd818] [006dd820, 006dd8ec] [006dd8f0, 006dd980]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006dd6c0(int *param_1,undefined4 *param_2,int param_3)

{
  char *pcVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int *piVar8;
  undefined4 *local_838;
  int *local_834;
  int local_830 [257];
  int local_42c [256];
  char cStack_29;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined1 local_8;
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_838;
  local_834 = param_1;
  local_838 = param_2;
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  _memset(local_830,0,0x404);
  piVar8 = local_42c;
  for (iVar4 = 0x101; iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar8 = -1;
    piVar8 = piVar8 + 1;
  }
  *(undefined4 *)(param_3 + 0x400) = 1;
  while( true ) {
    iVar4 = -1;
    iVar7 = 1000000000;
    iVar5 = 0;
    do {
      iVar6 = *(int *)(param_3 + iVar5 * 4);
      if ((iVar6 != 0) && (iVar6 <= iVar7)) {
        iVar4 = iVar5;
        iVar7 = iVar6;
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 < 0x101);
    iVar7 = -1;
    iVar5 = 1000000000;
    iVar6 = 0;
    do {
      iVar3 = *(int *)(param_3 + iVar6 * 4);
      if (((iVar3 != 0) && (iVar3 <= iVar5)) && (iVar6 != iVar4)) {
        iVar7 = iVar6;
        iVar5 = iVar3;
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 < 0x101);
    if (iVar7 < 0) break;
    piVar8 = (int *)(param_3 + iVar4 * 4);
    *piVar8 = *piVar8 + *(int *)(param_3 + iVar7 * 4);
    local_830[iVar4] = local_830[iVar4] + 1;
    iVar5 = local_42c[iVar4];
    piVar8 = local_42c + iVar4;
    *(undefined4 *)(param_3 + iVar7 * 4) = 0;
    while (-1 < iVar5) {
      iVar4 = *piVar8;
      local_830[iVar4] = local_830[iVar4] + 1;
      piVar8 = local_42c + iVar4;
      iVar5 = local_42c[iVar4];
    }
    local_830[iVar7] = local_830[iVar7] + 1;
    local_42c[iVar4] = iVar7;
    piVar8 = local_42c + iVar7;
    for (iVar4 = local_42c[iVar7]; -1 < iVar4; iVar4 = local_42c[iVar4]) {
      iVar4 = *piVar8;
      local_830[iVar4] = local_830[iVar4] + 1;
      piVar8 = local_42c + iVar4;
    }
  }
  iVar4 = 0;
  do {
    iVar7 = local_830[iVar4];
    if (iVar7 != 0) {
      if (0x20 < iVar7) {
        *(undefined4 *)(*local_834 + 0x14) = 0x27;
        (**(code **)*local_834)(local_834);
      }
      *(char *)((int)&local_28 + iVar7) = *(char *)((int)&local_28 + iVar7) + '\x01';
    }
    iVar4 = iVar4 + 1;
  } while (iVar4 < 0x101);
  iVar7 = 0x10;
  iVar4 = 0x1e;
  do {
    cVar2 = *(char *)((int)&local_28 + iVar4 + 2);
    while (cVar2 != '\0') {
      cVar2 = *(char *)((int)&local_28 + iVar4);
      iVar5 = iVar4;
      while (cVar2 == '\0') {
        cVar2 = (&cStack_29)[iVar5];
        iVar5 = iVar5 + -1;
      }
      pcVar1 = (char *)((int)&local_28 + iVar4 + 2);
      *pcVar1 = *pcVar1 + -2;
      pcVar1 = (char *)((int)&local_28 + iVar4 + 1);
      *pcVar1 = *pcVar1 + '\x01';
      pcVar1 = (char *)((int)&local_28 + iVar5 + 1);
      *pcVar1 = *pcVar1 + '\x02';
      *(char *)((int)&local_28 + iVar5) = *(char *)((int)&local_28 + iVar5) + -1;
      cVar2 = *(char *)((int)&local_28 + iVar4 + 2);
    }
    iVar4 = iVar4 + -1;
    iVar7 = iVar7 + -1;
  } while (iVar7 != 0);
  iVar4 = 0x10;
  cVar2 = (char)local_18;
  while (cVar2 == '\0') {
    cVar2 = (&cStack_29)[iVar4];
    iVar4 = iVar4 + -1;
  }
  *(char *)((int)&local_28 + iVar4) = *(char *)((int)&local_28 + iVar4) + -1;
  *local_838 = local_28;
  local_838[1] = local_24;
  local_838[2] = local_20;
  local_838[3] = local_1c;
  *(char *)(local_838 + 4) = (char)local_18;
  iVar4 = 0;
  iVar7 = 1;
  do {
    iVar5 = 0;
    do {
      if (local_830[iVar5] == iVar7) {
        *(char *)((int)local_838 + iVar4 + 0x11) = (char)iVar5;
        iVar4 = iVar4 + 1;
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 < 0x100);
    iVar7 = iVar7 + 1;
  } while (iVar7 < 0x21);
  *(undefined1 *)((int)local_838 + 0x111) = 0;
  __security_check_cookie(local_4 ^ (uint)&local_838);
  return;
}



============================================================
DISASSEMBLY
============================================================
006dd6c0 : SUB ESP,0x838
006dd6c6 : MOV EAX,[0x00d66fa0]
006dd6cb : XOR EAX,ESP
006dd6cd : MOV dword ptr [ESP + 0x834],EAX
006dd6d4 : MOV EAX,dword ptr [ESP + 0x83c]
006dd6db : MOV ECX,dword ptr [ESP + 0x840]
006dd6e2 : PUSH EBX
006dd6e3 : MOV EBX,dword ptr [ESP + 0x848]
006dd6ea : PUSH EBP
006dd6eb : PUSH ESI
006dd6ec : PUSH EDI
006dd6ed : MOV dword ptr [ESP + 0x14],EAX
006dd6f1 : XOR EAX,EAX
006dd6f3 : PUSH 0x404
006dd6f8 : PUSH EAX
006dd6f9 : LEA EDX,[ESP + 0x20]
006dd6fd : PUSH EDX
006dd6fe : MOV dword ptr [ESP + 0x1c],ECX
006dd702 : MOV dword ptr [ESP + 0x82c],EAX
006dd709 : MOV dword ptr [ESP + 0x830],EAX
006dd710 : MOV dword ptr [ESP + 0x834],EAX
006dd717 : MOV dword ptr [ESP + 0x838],EAX
006dd71e : MOV dword ptr [ESP + 0x83c],EAX
006dd725 : MOV dword ptr [ESP + 0x840],EAX
006dd72c : MOV dword ptr [ESP + 0x844],EAX
006dd733 : MOV dword ptr [ESP + 0x848],EAX
006dd73a : MOV byte ptr [ESP + 0x84c],AL
006dd741 : CALL 0x0063b700
006dd746 : ADD ESP,0xc
006dd749 : MOV ECX,0x101
006dd74e : OR EAX,0xffffffff
006dd751 : LEA EDI,[ESP + 0x41c]
006dd758 : MOV EBP,0x1
006dd75d : STOSD.REP ES:EDI
006dd75f : MOV dword ptr [EBX + 0x400],EBP
006dd765 : OR EAX,0xffffffff
006dd768 : MOV ESI,0x3b9aca00
006dd76d : XOR ECX,ECX
006dd76f : NOP
006dd770 : MOV EDX,dword ptr [EBX + ECX*0x4]
006dd773 : TEST EDX,EDX
006dd775 : JZ 0x006dd77f
006dd777 : CMP EDX,ESI
006dd779 : JG 0x006dd77f
006dd77b : MOV ESI,EDX
006dd77d : MOV EAX,ECX
006dd77f : ADD ECX,EBP
006dd781 : CMP ECX,0x100
006dd787 : JLE 0x006dd770
006dd789 : OR EDX,0xffffffff
006dd78c : MOV EDI,0x3b9aca00
006dd791 : XOR ECX,ECX
006dd793 : MOV ESI,dword ptr [EBX + ECX*0x4]
006dd796 : TEST ESI,ESI
006dd798 : JZ 0x006dd7a6
006dd79a : CMP ESI,EDI
006dd79c : JG 0x006dd7a6
006dd79e : CMP ECX,EAX
006dd7a0 : JZ 0x006dd7a6
006dd7a2 : MOV EDI,ESI
006dd7a4 : MOV EDX,ECX
006dd7a6 : ADD ECX,EBP
006dd7a8 : CMP ECX,0x100
006dd7ae : JLE 0x006dd793
006dd7b0 : TEST EDX,EDX
006dd7b2 : JL 0x006dd83c
006dd7b8 : MOV ECX,dword ptr [EBX + EDX*0x4]
006dd7bb : ADD dword ptr [EBX + EAX*0x4],ECX
006dd7be : ADD dword ptr [ESP + EAX*0x4 + 0x18],EBP
006dd7c2 : CMP dword ptr [ESP + EAX*0x4 + 0x41c],0x0
006dd7ca : LEA ECX,[ESP + EAX*0x4 + 0x41c]
006dd7d1 : MOV dword ptr [EBX + EDX*0x4],0x0
006dd7d8 : JL 0x006dd7f7
006dd7da : LEA EBX,[EBX]
006dd7e0 : MOV EAX,dword ptr [ECX]
006dd7e2 : ADD dword ptr [ESP + EAX*0x4 + 0x18],EBP
006dd7e6 : CMP dword ptr [ESP + EAX*0x4 + 0x41c],0x0
006dd7ee : LEA ECX,[ESP + EAX*0x4 + 0x41c]
006dd7f5 : JGE 0x006dd7e0
006dd7f7 : ADD dword ptr [ESP + EDX*0x4 + 0x18],EBP
006dd7fb : MOV dword ptr [ESP + EAX*0x4 + 0x41c],EDX
006dd802 : CMP dword ptr [ESP + EDX*0x4 + 0x41c],0x0
006dd80a : LEA EAX,[ESP + EDX*0x4 + 0x41c]
006dd811 : JL 0x006dd765
006dd817 : JMP 0x006dd820
006dd820 : MOV EAX,dword ptr [EAX]
006dd822 : ADD dword ptr [ESP + EAX*0x4 + 0x18],EBP
006dd826 : CMP dword ptr [ESP + EAX*0x4 + 0x41c],0x0
006dd82e : LEA EAX,[ESP + EAX*0x4 + 0x41c]
006dd835 : JGE 0x006dd820
006dd837 : JMP 0x006dd765
006dd83c : XOR EDI,EDI
006dd83e : LEA EBX,[EDI + 0x27]
006dd841 : MOV ESI,dword ptr [ESP + EDI*0x4 + 0x18]
006dd845 : TEST ESI,ESI
006dd847 : JZ 0x006dd86f
006dd849 : CMP ESI,0x20
006dd84c : JLE 0x006dd861
006dd84e : MOV EAX,dword ptr [ESP + 0x14]
006dd852 : MOV EDX,dword ptr [EAX]
006dd854 : MOV dword ptr [EDX + 0x14],EBX
006dd857 : MOV ECX,dword ptr [EAX]
006dd859 : MOV EDX,dword ptr [ECX]
006dd85b : PUSH EAX
006dd85c : CALL EDX
006dd85e : ADD ESP,0x4
006dd861 : INC byte ptr [ESP + ESI*0x1 + 0x820]
006dd868 : LEA EAX,[ESP + ESI*0x1 + 0x820]
006dd86f : ADD EDI,EBP
006dd871 : CMP EDI,0x100
006dd877 : JLE 0x006dd841
006dd879 : MOV ESI,0x10
006dd87e : MOV ECX,0x1e
006dd883 : MOV EDX,ESI
006dd885 : CMP byte ptr [ESP + ECX*0x1 + 0x822],0x0
006dd88d : JBE 0x006dd8db
006dd88f : NOP
006dd890 : CMP byte ptr [ESP + ECX*0x1 + 0x820],0x0
006dd898 : MOV EAX,ECX
006dd89a : JNZ 0x006dd8ac
006dd89c : LEA ESP,[ESP]
006dd8a0 : SUB EAX,EBP
006dd8a2 : CMP byte ptr [ESP + EAX*0x1 + 0x820],0x0
006dd8aa : JZ 0x006dd8a0
006dd8ac : ADD byte ptr [ESP + ECX*0x1 + 0x822],0xfe
006dd8b4 : INC byte ptr [ESP + ECX*0x1 + 0x821]
006dd8bb : ADD byte ptr [ESP + EAX*0x1 + 0x821],0x2
006dd8c3 : DEC byte ptr [ESP + EAX*0x1 + 0x820]
006dd8ca : CMP byte ptr [ESP + ECX*0x1 + 0x822],0x0
006dd8d2 : LEA EAX,[ESP + EAX*0x1 + 0x820]
006dd8d9 : JA 0x006dd890
006dd8db : SUB ECX,EBP
006dd8dd : SUB ESI,EBP
006dd8df : JNZ 0x006dd885
006dd8e1 : CMP byte ptr [ESP + 0x830],0x0
006dd8e9 : JNZ 0x006dd8fc
006dd8eb : JMP 0x006dd8f0
006dd8f0 : SUB EDX,EBP
006dd8f2 : CMP byte ptr [ESP + EDX*0x1 + 0x820],0x0
006dd8fa : JZ 0x006dd8f0
006dd8fc : DEC byte ptr [ESP + EDX*0x1 + 0x820]
006dd903 : MOV ESI,dword ptr [ESP + 0x10]
006dd907 : MOV ECX,dword ptr [ESP + 0x824]
006dd90e : LEA EAX,[ESP + EDX*0x1 + 0x820]
006dd915 : MOV EAX,dword ptr [ESP + 0x820]
006dd91c : MOV EDX,dword ptr [ESP + 0x828]
006dd923 : MOV dword ptr [ESI],EAX
006dd925 : MOV EAX,dword ptr [ESP + 0x82c]
006dd92c : MOV dword ptr [ESI + 0x4],ECX
006dd92f : MOV CL,byte ptr [ESP + 0x830]
006dd936 : MOV dword ptr [ESI + 0x8],EDX
006dd939 : MOV dword ptr [ESI + 0xc],EAX
006dd93c : MOV byte ptr [ESI + 0x10],CL
006dd93f : XOR ECX,ECX
006dd941 : MOV EDX,EBP
006dd943 : XOR EAX,EAX
006dd945 : CMP dword ptr [ESP + EAX*0x4 + 0x18],EDX
006dd949 : JNZ 0x006dd951
006dd94b : MOV byte ptr [ESI + ECX*0x1 + 0x11],AL
006dd94f : ADD ECX,EBP
006dd951 : ADD EAX,EBP
006dd953 : CMP EAX,0xff
006dd958 : JLE 0x006dd945
006dd95a : ADD EDX,EBP
006dd95c : CMP EDX,0x20
006dd95f : JLE 0x006dd943
006dd961 : MOV ECX,dword ptr [ESP + 0x844]
006dd968 : POP EDI
006dd969 : MOV byte ptr [ESI + 0x111],0x0
006dd970 : POP ESI
006dd971 : POP EBP
006dd972 : POP EBX
006dd973 : XOR ECX,ESP
006dd975 : CALL 0x00633e6b
006dd97a : ADD ESP,0x838
006dd980 : RET

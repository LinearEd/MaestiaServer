PROGRAM  : Maestia.exe
FUNCTION : FUN_00677520
ENTRY    : 00677520
BODY     : [[00677520, 006775f9] [00677600, 00677642]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00677520(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_0067755a;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_006772f0(param_1,iVar7);
LAB_0067755a:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0xc);
  if (*(int *)(iVar7 + 8 + param_3 * 0xc) == -2) {
    *puVar1 = 0xffffffff;
    *(short *)(puVar1 + 1) = (short)*param_2;
    puVar1[2] = param_2[1];
    return;
  }
  uVar5 = param_3;
  do {
    uVar5 = uVar5 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar5 * 0xc) != -2);
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
  uVar6 = (uint)(ushort)puVar1[1] & *(uint *)(iVar7 + 4);
  if (uVar6 == param_3) {
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      *(short *)(puVar2 + 1) = (short)puVar1[1];
      puVar2[2] = puVar1[2];
    }
    puVar1[1] = *param_2;
    uVar6 = param_2[1];
    *puVar1 = uVar5;
    puVar1[2] = uVar6;
    return;
  }
  puVar3 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
  for (uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 0xc); uVar6 != param_3;
      uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 0xc)) {
    uVar6 = *puVar3;
    puVar3 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    *(short *)(puVar2 + 1) = (short)puVar1[1];
    puVar2[2] = puVar1[2];
  }
  *puVar3 = uVar5;
  puVar1[1] = *param_2;
  uVar5 = param_2[1];
  *puVar1 = 0xffffffff;
  puVar1[2] = uVar5;
  return;
}



============================================================
DISASSEMBLY
============================================================
00677520 : PUSH ESI
00677521 : MOV ESI,ECX
00677523 : MOV EAX,dword ptr [ESI]
00677525 : PUSH EDI
00677526 : TEST EAX,EAX
00677528 : JNZ 0x00677533
0067752a : MOV EAX,dword ptr [ESP + 0xc]
0067752e : PUSH 0x8
00677530 : PUSH EAX
00677531 : JMP 0x00677555
00677533 : MOV ECX,dword ptr [EAX + 0x4]
00677536 : LEA EDX,[ECX*0x4 + 0x4]
0067753d : MOV ECX,dword ptr [EAX]
0067753f : LEA ECX,[ECX + ECX*0x4]
00677542 : CMP ECX,EDX
00677544 : JBE 0x0067755a
00677546 : MOV EDX,dword ptr [EAX + 0x4]
00677549 : MOV ECX,dword ptr [ESP + 0xc]
0067754d : LEA EAX,[EDX + EDX*0x1 + 0x2]
00677551 : PUSH EAX
00677552 : PUSH ECX
00677553 : MOV ECX,ESI
00677555 : CALL 0x006772f0
0067755a : MOV ECX,dword ptr [ESI]
0067755c : MOV EAX,dword ptr [ESP + 0x14]
00677560 : AND EAX,dword ptr [ECX + 0x4]
00677563 : INC dword ptr [ECX]
00677565 : MOV ESI,dword ptr [ESI]
00677567 : LEA EDX,[EAX + EAX*0x2]
0067756a : MOV ECX,dword ptr [ESI + EDX*0x4 + 0x8]
0067756e : LEA EDX,[ESI + EDX*0x4 + 0x8]
00677572 : MOV EDI,0xfffffffe
00677577 : CMP ECX,EDI
00677579 : JNZ 0x00677597
0067757b : MOV EAX,dword ptr [ESP + 0x10]
0067757f : MOV dword ptr [EDX],0xffffffff
00677585 : MOV CX,word ptr [EAX]
00677588 : MOV word ptr [EDX + 0x4],CX
0067758c : MOV EAX,dword ptr [EAX + 0x4]
0067758f : POP EDI
00677590 : MOV dword ptr [EDX + 0x8],EAX
00677593 : POP ESI
00677594 : RET 0xc
00677597 : PUSH EBX
00677598 : PUSH EBP
00677599 : MOV EBP,dword ptr [ESI + 0x4]
0067759c : MOV ECX,EAX
0067759e : MOV EDI,EDI
006775a0 : INC ECX
006775a1 : AND ECX,EBP
006775a3 : LEA EBX,[ECX + ECX*0x2]
006775a6 : CMP dword ptr [ESI + EBX*0x4 + 0x8],EDI
006775aa : JNZ 0x006775a0
006775ac : LEA EDI,[ECX + ECX*0x2]
006775af : LEA EBX,[ESI + EDI*0x4 + 0x8]
006775b3 : MOVZX EDI,word ptr [EDX + 0x4]
006775b7 : AND EDI,EBP
006775b9 : CMP EDI,EAX
006775bb : JNZ 0x006775eb
006775bd : TEST EBX,EBX
006775bf : JZ 0x006775d3
006775c1 : MOV EAX,dword ptr [EDX]
006775c3 : MOV dword ptr [EBX],EAX
006775c5 : MOV AX,word ptr [EDX + 0x4]
006775c9 : MOV word ptr [EBX + 0x4],AX
006775cd : MOV EAX,dword ptr [EDX + 0x8]
006775d0 : MOV dword ptr [EBX + 0x8],EAX
006775d3 : MOV EAX,dword ptr [ESP + 0x18]
006775d7 : MOV ESI,dword ptr [EAX]
006775d9 : POP EBP
006775da : MOV dword ptr [EDX + 0x4],ESI
006775dd : MOV EAX,dword ptr [EAX + 0x4]
006775e0 : POP EBX
006775e1 : POP EDI
006775e2 : MOV dword ptr [EDX],ECX
006775e4 : MOV dword ptr [EDX + 0x8],EAX
006775e7 : POP ESI
006775e8 : RET 0xc
006775eb : LEA EDI,[EDI + EDI*0x2]
006775ee : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
006775f2 : LEA EDI,[ESI + EDI*0x4 + 0x8]
006775f6 : JZ 0x0067760f
006775f8 : JMP 0x00677600
00677600 : MOV EDI,dword ptr [EDI]
00677602 : LEA EDI,[EDI + EDI*0x2]
00677605 : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
00677609 : LEA EDI,[ESI + EDI*0x4 + 0x8]
0067760d : JNZ 0x00677600
0067760f : TEST EBX,EBX
00677611 : JZ 0x00677625
00677613 : MOV EAX,dword ptr [EDX]
00677615 : MOV dword ptr [EBX],EAX
00677617 : MOV AX,word ptr [EDX + 0x4]
0067761b : MOV word ptr [EBX + 0x4],AX
0067761f : MOV EAX,dword ptr [EDX + 0x8]
00677622 : MOV dword ptr [EBX + 0x8],EAX
00677625 : MOV EAX,dword ptr [ESP + 0x18]
00677629 : MOV dword ptr [EDI],ECX
0067762b : MOV ECX,dword ptr [EAX]
0067762d : POP EBP
0067762e : POP EBX
0067762f : MOV dword ptr [EDX + 0x4],ECX
00677632 : MOV EAX,dword ptr [EAX + 0x4]
00677635 : POP EDI
00677636 : MOV dword ptr [EDX],0xffffffff
0067763c : MOV dword ptr [EDX + 0x8],EAX
0067763f : POP ESI
00677640 : RET 0xc

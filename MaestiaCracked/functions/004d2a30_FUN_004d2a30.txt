PROGRAM  : Maestia.exe
FUNCTION : FUN_004d2a30
ENTRY    : 004d2a30
BODY     : [[004d2a30, 004d2b6a] [004d2b7c, 004d2c59]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004d2a30(uint param_1,undefined4 *param_2,uint param_3)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  uint in_ECX;
  undefined4 *puVar5;
  int iVar6;
  uint uVar7;
  undefined4 *puVar8;
  undefined8 uVar9;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar2 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b79e90;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar6 = *(int *)(param_1 + 4);
  if (iVar6 == 0) {
    uVar7 = 0;
  }
  else {
    uVar7 = *(int *)(param_1 + 0xc) - iVar6 >> 3;
  }
  if (in_ECX != 0) {
    iVar6 = *(int *)(param_1 + 8) - iVar6 >> 3;
    uVar9 = CONCAT44(iVar6,*(int *)(param_1 + 8));
    if (0x1fffffffU - iVar6 < in_ECX) {
      uVar9 = FUN_00452880();
    }
    iVar6 = (int)uVar9;
    uVar1 = (int)((ulonglong)uVar9 >> 0x20) + in_ECX;
    if (uVar7 < uVar1) {
      if (0x1fffffff - (uVar7 >> 1) < uVar7) {
        param_1 = 0;
      }
      else {
        param_1 = uVar7 + (uVar7 >> 1);
      }
      if (param_1 < uVar1) {
        param_1 = uVar1;
      }
      iVar6 = FUN_0040c2e0();
      local_8 = 0;
      FUN_004e8b90();
      FUN_004f64d0(*(undefined4 *)(iVar2 + 4),param_2);
      FUN_004f64d0(param_2,*(undefined4 *)(iVar2 + 8));
      local_8 = 0xffffffff;
      if (*(int *)(iVar2 + 4) == 0) {
        *(uint *)(iVar2 + 0xc) = iVar6 + param_1 * 8;
        *(uint *)(iVar2 + 8) =
             iVar6 + (in_ECX + (*(int *)(iVar2 + 8) - *(int *)(iVar2 + 4) >> 3)) * 8;
        *(int *)(iVar2 + 4) = iVar6;
        ExceptionList = local_10;
        return;
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if ((uint)(iVar6 - (int)param_2 >> 3) < in_ECX) {
      FUN_004f64d0(param_2,iVar6);
      local_8 = 2;
      param_3 = param_3 & 0xffffff00;
      FUN_004e8b10(*(int *)(param_1 + 8),in_ECX - (*(int *)(param_1 + 8) - (int)param_2 >> 3),
                   param_2,param_3);
      local_8 = 0xffffffff;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + in_ECX * 8;
    }
    else {
      puVar8 = (undefined4 *)(iVar6 + in_ECX * -8);
      uVar3 = FUN_004f64d0(puVar8,iVar6);
      *(undefined4 *)(param_1 + 8) = uVar3;
      if (param_2 != puVar8) {
        puVar5 = puVar8 + in_ECX * 2;
        do {
          puVar4 = puVar8 + -2;
          puVar5[-2] = *puVar4;
          puVar5[-1] = puVar8[-1];
          puVar8 = puVar4;
          puVar5 = puVar5 + -2;
        } while (puVar4 != param_2);
      }
    }
    FUN_004db6f0(param_2);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
004d2a30 : PUSH EBP
004d2a31 : MOV EBP,ESP
004d2a33 : PUSH -0x1
004d2a35 : PUSH 0xb79e90
004d2a3a : MOV EAX,FS:[0x0]
004d2a40 : PUSH EAX
004d2a41 : SUB ESP,0x18
004d2a44 : PUSH EBX
004d2a45 : PUSH ESI
004d2a46 : PUSH EDI
004d2a47 : MOV EAX,[0x00d66fa0]
004d2a4c : XOR EAX,EBP
004d2a4e : PUSH EAX
004d2a4f : LEA EAX,[EBP + -0xc]
004d2a52 : MOV FS:[0x0],EAX
004d2a58 : MOV dword ptr [EBP + -0x10],ESP
004d2a5b : MOV ESI,ECX
004d2a5d : MOV EBX,dword ptr [EBP + 0x8]
004d2a60 : MOV ECX,dword ptr [EBX + 0x4]
004d2a63 : TEST ECX,ECX
004d2a65 : JNZ 0x004d2a6b
004d2a67 : XOR EDI,EDI
004d2a69 : JMP 0x004d2a75
004d2a6b : MOV EAX,dword ptr [EBX + 0xc]
004d2a6e : SUB EAX,ECX
004d2a70 : SAR EAX,0x3
004d2a73 : MOV EDI,EAX
004d2a75 : TEST ESI,ESI
004d2a77 : JZ 0x004d2c46
004d2a7d : MOV EAX,dword ptr [EBX + 0x8]
004d2a80 : MOV EDX,EAX
004d2a82 : SUB EDX,ECX
004d2a84 : SAR EDX,0x3
004d2a87 : MOV ECX,0x1fffffff
004d2a8c : SUB ECX,EDX
004d2a8e : CMP ECX,ESI
004d2a90 : JNC 0x004d2a97
004d2a92 : CALL 0x00452880
004d2a97 : LEA ECX,[EDX + ESI*0x1]
004d2a9a : CMP EDI,ECX
004d2a9c : JNC 0x004d2b7c
004d2aa2 : MOV EAX,EDI
004d2aa4 : SHR EAX,0x1
004d2aa6 : MOV EDX,0x1fffffff
004d2aab : SUB EDX,EAX
004d2aad : CMP EDX,EDI
004d2aaf : JNC 0x004d2abd
004d2ab1 : MOV dword ptr [EBP + 0x8],0x0
004d2ab8 : MOV EDI,dword ptr [EBP + 0x8]
004d2abb : JMP 0x004d2ac2
004d2abd : ADD EDI,EAX
004d2abf : MOV dword ptr [EBP + 0x8],EDI
004d2ac2 : CMP EDI,ECX
004d2ac4 : JNC 0x004d2acb
004d2ac6 : MOV dword ptr [EBP + 0x8],ECX
004d2ac9 : MOV EDI,ECX
004d2acb : MOV ECX,EDI
004d2acd : CALL 0x0040c2e0
004d2ad2 : MOV dword ptr [EBP + -0x18],EAX
004d2ad5 : MOV ECX,dword ptr [EBP + 0xc]
004d2ad8 : SUB ECX,dword ptr [EBX + 0x4]
004d2adb : SAR ECX,0x3
004d2ade : MOV dword ptr [EBP + -0x20],ECX
004d2ae1 : MOV dword ptr [EBP + -0x4],0x0
004d2ae8 : LEA EDI,[EAX + ECX*0x8]
004d2aeb : MOV EDX,dword ptr [EBP + 0x10]
004d2aee : CALL 0x004e8b90
004d2af3 : MOV dword ptr [EBP + -0x1c],0x1
004d2afa : MOV EAX,dword ptr [EBP + 0xc]
004d2afd : PUSH EAX
004d2afe : MOV ECX,dword ptr [EBX + 0x4]
004d2b01 : PUSH ECX
004d2b02 : MOV EDI,dword ptr [EBP + -0x18]
004d2b05 : MOV EDX,EDI
004d2b07 : CALL 0x004f64d0
004d2b0c : MOV dword ptr [EBP + -0x1c],0x2
004d2b13 : MOV EDX,dword ptr [EBP + -0x20]
004d2b16 : ADD EDX,ESI
004d2b18 : LEA EDX,[EDI + EDX*0x8]
004d2b1b : MOV EAX,dword ptr [EBX + 0x8]
004d2b1e : PUSH EAX
004d2b1f : MOV ECX,dword ptr [EBP + 0xc]
004d2b22 : PUSH ECX
004d2b23 : CALL 0x004f64d0
004d2b28 : MOV dword ptr [EBP + -0x4],0xffffffff
004d2b2f : MOV ECX,dword ptr [EBX + 0x4]
004d2b32 : MOV EDX,dword ptr [EBX + 0x8]
004d2b35 : SUB EDX,ECX
004d2b37 : SAR EDX,0x3
004d2b3a : ADD ESI,EDX
004d2b3c : TEST ECX,ECX
004d2b3e : JZ 0x004d2b45
004d2b40 : CALL 0x006f04e0
004d2b45 : MOV EAX,dword ptr [EBP + 0x8]
004d2b48 : LEA ECX,[EDI + EAX*0x8]
004d2b4b : MOV dword ptr [EBX + 0xc],ECX
004d2b4e : LEA EDX,[EDI + ESI*0x8]
004d2b51 : MOV dword ptr [EBX + 0x8],EDX
004d2b54 : MOV dword ptr [EBX + 0x4],EDI
004d2b57 : MOV ECX,dword ptr [EBP + -0xc]
004d2b5a : MOV dword ptr FS:[0x0],ECX
004d2b61 : POP ECX
004d2b62 : POP EDI
004d2b63 : POP ESI
004d2b64 : POP EBX
004d2b65 : MOV ESP,EBP
004d2b67 : POP EBP
004d2b68 : RET 0xc
004d2b7c : MOV EDX,EAX
004d2b7e : MOV ECX,dword ptr [EBP + 0xc]
004d2b81 : SUB EDX,ECX
004d2b83 : SAR EDX,0x3
004d2b86 : PUSH EAX
004d2b87 : CMP EDX,ESI
004d2b89 : JNC 0x004d2beb
004d2b8b : MOV EDX,dword ptr [EBP + 0x10]
004d2b8e : MOV EDI,dword ptr [EDX]
004d2b90 : MOV dword ptr [EBP + -0x24],EDI
004d2b93 : MOV EDX,dword ptr [EDX + 0x4]
004d2b96 : MOV dword ptr [EBP + -0x20],EDX
004d2b99 : LEA EDI,[ESI*0x8 + 0x0]
004d2ba0 : LEA EDX,[EDI + ECX*0x1]
004d2ba3 : PUSH ECX
004d2ba4 : CALL 0x004f64d0
004d2ba9 : MOV dword ptr [EBP + -0x4],0x2
004d2bb0 : MOV EAX,dword ptr [EBX + 0x8]
004d2bb3 : MOV ECX,EAX
004d2bb5 : SUB ECX,dword ptr [EBP + 0xc]
004d2bb8 : SAR ECX,0x3
004d2bbb : SUB ESI,ECX
004d2bbd : MOV byte ptr [EBP + 0x10],0x0
004d2bc1 : MOV EDX,dword ptr [EBP + 0x10]
004d2bc4 : PUSH EDX
004d2bc5 : MOV ECX,dword ptr [EBP + 0xc]
004d2bc8 : PUSH ECX
004d2bc9 : PUSH ESI
004d2bca : PUSH EAX
004d2bcb : LEA EDX,[EBP + -0x24]
004d2bce : CALL 0x004e8b10
004d2bd3 : ADD ESP,0x10
004d2bd6 : MOV dword ptr [EBP + -0x4],0xffffffff
004d2bdd : ADD dword ptr [EBX + 0x8],EDI
004d2be0 : MOV EDX,dword ptr [EBX + 0x8]
004d2be3 : SUB EDX,EDI
004d2be5 : MOV EAX,dword ptr [EBP + 0xc]
004d2be8 : PUSH EAX
004d2be9 : JMP 0x004d2c3b
004d2beb : MOV ECX,dword ptr [EBP + 0x10]
004d2bee : MOV EDX,dword ptr [ECX]
004d2bf0 : MOV dword ptr [EBP + -0x24],EDX
004d2bf3 : MOV ECX,dword ptr [ECX + 0x4]
004d2bf6 : MOV dword ptr [EBP + -0x20],ECX
004d2bf9 : ADD ESI,ESI
004d2bfb : ADD ESI,ESI
004d2bfd : ADD ESI,ESI
004d2bff : MOV EDI,EAX
004d2c01 : SUB EDI,ESI
004d2c03 : PUSH EDI
004d2c04 : MOV EDX,EAX
004d2c06 : CALL 0x004f64d0
004d2c0b : MOV dword ptr [EBX + 0x8],EAX
004d2c0e : MOV EAX,EDI
004d2c10 : MOV ECX,dword ptr [EBP + 0xc]
004d2c13 : MOV EDX,ECX
004d2c15 : CMP ECX,EAX
004d2c17 : JZ 0x004d2c37
004d2c19 : LEA ECX,[ESI + EAX*0x1]
004d2c1c : LEA ESP,[ESP]
004d2c20 : SUB EAX,0x8
004d2c23 : SUB ECX,0x8
004d2c26 : MOV EDI,dword ptr [EAX]
004d2c28 : MOV dword ptr [ECX],EDI
004d2c2a : MOV EDI,dword ptr [EAX + 0x4]
004d2c2d : MOV dword ptr [ECX + 0x4],EDI
004d2c30 : CMP EAX,EDX
004d2c32 : JNZ 0x004d2c20
004d2c34 : MOV ECX,dword ptr [EBP + 0xc]
004d2c37 : LEA EDX,[ESI + ECX*0x1]
004d2c3a : PUSH ECX
004d2c3b : LEA ECX,[EBP + -0x24]
004d2c3e : CALL 0x004db6f0
004d2c43 : ADD ESP,0x4
004d2c46 : MOV ECX,dword ptr [EBP + -0xc]
004d2c49 : MOV dword ptr FS:[0x0],ECX
004d2c50 : POP ECX
004d2c51 : POP EDI
004d2c52 : POP ESI
004d2c53 : POP EBX
004d2c54 : MOV ESP,EBP
004d2c56 : POP EBP
004d2c57 : RET 0xc
